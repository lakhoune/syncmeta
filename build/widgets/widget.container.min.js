import{css as t,html as e,LitElement as n}from"lit";import"https://unpkg.com/jquery@3.6.0/dist/jquery.js";import"https://cdnjs.cloudflare.com/ajax/libs/jquery-migrate/1.4.1/jquery-migrate.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.9.2/jquery.contextMenu.js";import"https://cdnjs.cloudflare.com/ajax/libs/dagre/0.8.5/dagre.min.js";import{Text as i,Map as r,Doc as o}from"yjs";import{WebsocketProvider as a}from"y-websocket";import"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js";import{QuillBinding as s}from"y-quill";import"https://cdnjs.cloudflare.com/ajax/libs/graphlib/2.1.8/graphlib.min.js";function l(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}const u=t=>e=>"function"==typeof e?((t,e)=>(customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:n,elements:i}=e;return{kind:n,elements:i,finisher(e){customElements.define(t,e)}}})(t,e)
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var c;function d(t,e,n){return"*"===t||(t.length>0?-1!==t.indexOf(e):!n)}function f(t,e,n){var i,r=t=t||{},o=e=e||{};if(n)for(i=0;i<n.length;i++)r[n[i]]=o[n[i]];else for(i in o)r[i]=o[i];return t}function p(t){return"[object Number]"===Object.prototype.toString.call(t)}function h(t){return"string"==typeof t}function g(t){return"boolean"==typeof t}function v(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function b(t){return"[object Function]"===Object.prototype.toString.call(t)}function m(t){if(h(t))return""+t;if(g(t))return!!t;if(o=t,"[object Date]"===Object.prototype.toString.call(o))return new Date(t.getTime());if(b(t))return t;if(Array.isArray(t)){for(var e=[],n=0;n<t.length;n++)e.push(m(t[n]));return e}if(v(t)){var i={};for(var r in t)i[r]=m(t[r]);return i}return t;var o}function E(t,e,n,i){var r,o,a={},s={};for(n=n||[],i=i||[],o=0;o<n.length;o++)a[n[o]]=!0;for(o=0;o<i.length;o++)s[i[o]]=!0;var l=m(t);for(o in e)if(null==l[o]||s[o])l[o]=e[o];else if(a[o])(r=[]).push.apply(r,Array.isArray(l[o])?l[o]:[l[o]]),r.push(e[o]),l[o]=r;else if(h(e[o])||g(e[o])||b(e[o])||p(e[o]))l[o]=e[o];else if(Array.isArray(e[o]))r=[],Array.isArray(l[o])&&r.push.apply(r,l[o]),r.push.apply(r,e[o]),l[o]=r;else if(v(e[o]))for(var u in v(l[o])||(l[o]={}),e[o])l[o][u]=e[o][u];return l}function w(t,e,n){for(var i=0;i<n.length;i++){var r=n[i][0][n[i][1]].apply(n[i][0],n[i][2]);if(r===e)return r}return t}function O(t,e,n,i){return function t(r){if(null!=r){if(h(r))return function(t){var n=t.match(/(\${.*?})/g);if(null!=n)for(var i=0;i<n.length;i++){var r=e[n[i].substring(2,n[i].length-1)]||"";null!=r&&(t=t.replace(n[i],r))}if(null!=(n=t.match(/({{.*?}})/g)))for(var o=0;o<n.length;o++){var a=e[n[o].substring(2,n[o].length-2)]||"";null!=a&&(t=t.replace(n[o],a))}return t}(r);if(!b(r)||i||null!=n&&0!==(r.name||"").indexOf(n)){if(Array.isArray(r)){for(var o=[],a=0;a<r.length;a++)o.push(t(r[a]));return o}if(v(r)){var s={};for(var l in r)s[l]=t(r[l]);return s}return r}return r(e)}}(t)}function T(t,e){if(!t)return null;for(var n=0;n<t.length;n++)e(t[n])}function x(t,e){if(t)for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}function A(t,e){var n=x(t,e);return-1===n?null:t[n]}function S(t,e){var n=null;return t.forEach((function(t){e(t)&&(n=t)})),n}function I(t,e){var n=x(t,e);return n>-1&&t.splice(n,1),-1!==n}function k(t){if(null!=Array.fromArray)return Array.from(t);var e=[];return Array.prototype.push.apply(e,t),e}function P(t,e){var n=t.indexOf(e);return n>-1&&t.splice(n,1),-1!==n}function N(t,e,n,i){var r=t[e];return null==r&&(r=[],t[e]=r),r[i?"unshift":"push"](n),r}function C(t,e,n){return-1===t.indexOf(e)&&(n?t.unshift(e):t.push(e),!0)}null===(c=window.HTMLSlotElement)||void 0===c||c.prototype.assignedElements;for(var j=[],M=0;M<256;M++)j[M]=(M<16?"0":"")+M.toString(16);function D(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return j[255&t]+j[t>>8&255]+j[t>>16&255]+j[t>>24&255]+"-"+j[255&e]+j[e>>8&255]+"-"+j[e>>16&15|64]+j[e>>24&255]+"-"+j[63&n|128]+j[n>>8&255]+"-"+j[n>>16&255]+j[n>>24&255]+j[255&i]+j[i>>8&255]+j[i>>16&255]+j[i>>24&255]}function R(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.cos(n/360*Math.PI*2),a=Math.sin(n/360*Math.PI*2);return{x:i*o-r*a+e.x,y:r*o+i*a+e.y,cr:o,sr:a}}function L(t){if(null==t)return null;for(var e=t.replace(/^\s\s*/,""),n=/\s/,i=e.length;n.test(e.charAt(--i)););return e.slice(0,i+1)}function Y(t,e){for(var n=[],i=0;i<t.length;i++)n.push(e(t[i]));return n}function V(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("undefined"!=typeof console)try{var i=arguments[arguments.length-1];console.log(i)}catch(t){}}function B(t){return t<0?-1:t>0?1:0}function F(t,e,n){return function(){var i=null;try{null!=e&&(i=e.apply(this,arguments))}catch(t){V("jsPlumb function failed : "+t)}if(null!=t&&(null==n||i!==n))try{i=t.apply(this,arguments)}catch(t){V("wrapped function failed : "+t)}return i}}function G(t,e,n){return t.has(e)||t.set(e,n()),t.get(e)}function q(t,e){for(var n=t.__proto__;null!=n;){if(n instanceof e)return!0;n=n.__proto__}return!1}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function z(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function J(t,e,n){return e&&z(t.prototype,e),n&&z(t,n),t}function W(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H(t){return H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},H(t)}function X(t,e){return X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},X(t,e)}function Z(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=H(t);if(e){var r=H(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return Z(this,n)}}var Q=function(){function t(){U(this,t),W(this,"_listeners",{}),W(this,"eventsSuspended",!1),W(this,"tick",!1),W(this,"eventsToDieOn",{ready:!0}),W(this,"queue",[])}return J(t,[{key:"fire",value:function(t,e,n){var i=null;if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[t]){var r=this._listeners[t].length,o=0,a=!1;if(!this.shouldFireEvent||this.shouldFireEvent(t,e,n))for(;!a&&o<r&&!1!==i;){if(this.eventsToDieOn[t])this._listeners[t][o](e,n);else try{i=this._listeners[t][o](e,n)}catch(e){V("jsPlumb: fire failed for event "+t+" : "+(e.message||e))}o++,null!=this._listeners&&null!=this._listeners[t]||(a=!0)}}this.tick=!1,this._drain()}return i}},{key:"_drain",value:function(){var t=this.queue.pop();t&&this.fire.apply(this,t)}},{key:"unbind",value:function(t,e){if(0===arguments.length)this._listeners={};else if(1===arguments.length){if("string"==typeof t)delete this._listeners[t];else if(t.__jsPlumb){var n;for(var i in t.__jsPlumb)n=t.__jsPlumb[i],P(this._listeners[n]||[],t)}}else 2===arguments.length&&P(this._listeners[t]||[],e);return this}},{key:"getListener",value:function(t){return this._listeners[t]||[]}},{key:"isSuspendEvents",value:function(){return this.eventsSuspended}},{key:"setSuspendEvents",value:function(t){this.eventsSuspended=t}},{key:"bind",value:function(t,e,n){var i=this,r=function(t){N(i._listeners,t,e,n),e.__jsPlumb=e.__jsPlumb||{},e.__jsPlumb[D()]=t};if("string"==typeof t)r(t);else if(null!=t.length)for(var o=0;o<t.length;o++)r(t[o]);return this}},{key:"silently",value:function(t){this.setSuspendEvents(!0);try{t()}catch(t){V("Cannot execute silent function "+t)}this.setSuspendEvents(!1)}}]),t}();!function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(n,Q);var e=K(n);function n(){return U(this,n),e.apply(this,arguments)}J(n,[{key:"shouldFireEvent",value:function(t,e,n){return!0}}])}();var tt,et,nt=[null,[1,-1],[1,1],[-1,1],[-1,-1]],it=[null,[-1,-1],[-1,1],[1,1],[1,-1]],rt=2*Math.PI;function ot(t,e){return e.x===t.x?e.y>t.y?1/0:-1/0:e.y===t.y?e.x>t.x?0:-0:(e.y-t.y)/(e.x-t.x)}function at(t,e){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function st(t,e){return e.x>t.x||e.x==t.x?e.y>t.y?2:1:e.y>t.y?3:4}function lt(t,e){var n=t.x,i=t.x+t.w,r=t.y,o=t.y+t.h,a=e.x,s=e.x+e.w,l=e.y,u=e.y+e.h;return n<=a&&a<=i&&r<=l&&l<=o||n<=s&&s<=i&&r<=l&&l<=o||n<=a&&a<=i&&r<=u&&u<=o||n<=s&&a<=i&&r<=u&&u<=o||a<=n&&n<=s&&l<=r&&r<=u||a<=i&&i<=s&&l<=r&&r<=u||a<=n&&n<=s&&l<=o&&o<=u||a<=i&&n<=s&&l<=o&&o<=u}function ut(t,e,n){var i=ot(t,e),r=st(t,e),o=n>0?nt[r]:it[r],a=Math.atan(i),s=Math.abs(n*Math.sin(a))*o[1],l=Math.abs(n*Math.cos(a))*o[0];return{x:t.x+l,y:t.y+s}}function ct(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function dt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}!function(t){t.Circle="Circle",t.Ellipse="Ellipse",t.Triangle="Triangle",t.Diamond="Diamond",t.Rectangle="Rectangle",t.Square="Square"}(tt||(tt={})),function(t){t.Assign="Assign",t.AutoDefault="AutoDefault",t.Bottom="Bottom",t.BottomLeft="BottomLeft",t.BottomRight="BottomRight",t.Center="Center",t.Continuous="Continuous",t.ContinuousBottom="ContinuousBottom",t.ContinuousLeft="ContinuousLeft",t.ContinuousRight="ContinuousRight",t.ContinuousTop="ContinuousTop",t.ContinuousLeftRight="ContinuousLeftRight",t.ContinuousTopBottom="ContinuousTopBottom",t.Left="Left",t.Perimeter="Perimeter",t.Right="Right",t.Top="Top",t.TopLeft="TopLeft",t.TopRight="TopRight"}(et||(et={}));var ft=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=e,dt(this,"x1",void 0),dt(this,"x2",void 0),dt(this,"y1",void 0),dt(this,"y2",void 0),dt(this,"extents",{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}),dt(this,"type",void 0),this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2}var e,n,i;return e=t,(n=[{key:"findClosestPointOnPath",value:function(t,e){return{d:1/0,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null}}},{key:"lineIntersection",value:function(t,e,n,i){return[]}},{key:"boxIntersection",value:function(t,e,n,i){var r=[];return r.push.apply(r,this.lineIntersection(t,e,t+n,e)),r.push.apply(r,this.lineIntersection(t+n,e,t+n,e+i)),r.push.apply(r,this.lineIntersection(t+n,e+i,t,e+i)),r.push.apply(r,this.lineIntersection(t,e+i,t,e)),r}},{key:"boundingBoxIntersection",value:function(t){return this.boxIntersection(t.x,t.y,t.w,t.h)}}])&&ct(e.prototype,n),i&&ct(e,i),t}(),pt="undefined",ht="default",gt="true",vt="false",yt="*";function bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Et(t,e,n){return e&&mt(t.prototype,e),n&&mt(t,n),t}function wt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}function Tt(t,e){return Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Tt(t,e)}function xt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ot(t);if(e){var r=Ot(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?xt(t):e}(this,n)}}function St(t,e,n){return St="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ot(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}},St(t,e,n||t)}function It(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}(t,e)||Pt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(t){return function(t){if(Array.isArray(t))return Nt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Pt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(t,e){if(t){if("string"==typeof t)return Nt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nt(t,e):void 0}}function Nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Ct={},jt={},Mt={},Dt={get:function(t,e,n){var i=Ct[e];if(i)return new i(t,n);throw{message:"jsPlumb: unknown endpoint type '"+e+"'"}},clone:function(t){var e=Mt[t.type];return Dt.get(t.endpoint,t.type,e.getParams(t))},compute:function(t,e,n,i){var r=jt[t.type];if(null!=r)return r(t,e,n,i);V("jsPlumb: cannot find endpoint calculator for endpoint of type ",t.type)},registerHandler:function(t){Mt[t.type]=t,Ct[t.type]=t.cls,jt[t.type]=t.compute}},Rt=function(){function t(e,n){bt(this,t),this.endpoint=e,wt(this,"typeId",void 0),wt(this,"x",void 0),wt(this,"y",void 0),wt(this,"w",void 0),wt(this,"h",void 0),wt(this,"computedValue",void 0),wt(this,"bounds",{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}),wt(this,"classes",[]),wt(this,"instance",void 0),wt(this,"type",void 0),n=n||{},this.instance=e.instance,e.cssClass&&this.classes.push(e.cssClass),n.cssClass&&this.classes.push(n.cssClass)}return Et(t,[{key:"addClass",value:function(t){this.classes.push(t),this.instance.addEndpointClass(this.endpoint,t)}},{key:"removeClass",value:function(t){this.classes=this.classes.filter((function(e){return e!==t})),this.instance.removeEndpointClass(this.endpoint,t)}},{key:"compute",value:function(t,e,n){this.computedValue=Dt.compute(this,t,e,n),this.bounds.xmin=this.x,this.bounds.ymin=this.y,this.bounds.xmax=this.x+this.w,this.bounds.ymax=this.y+this.h}},{key:"setVisible",value:function(t){this.instance.setEndpointVisible(this.endpoint,t)}}]),t}(),Lt=function(t){_t(n,Rt);var e=At(n);function n(t,i){var r;return bt(this,n),wt(xt(r=e.call(this,t,i)),"radius",void 0),wt(xt(r),"defaultOffset",void 0),wt(xt(r),"defaultInnerRadius",void 0),wt(xt(r),"type",n.type),i=i||{},r.radius=i.radius||5,r.defaultOffset=.5*r.radius,r.defaultInnerRadius=r.radius/3,r}return n}();wt(Lt,"type","Dot");var Yt={type:Lt.type,cls:Lt,compute:function(t,e,n,i){var r=e.curX-t.radius,o=e.curY-t.radius,a=2*t.radius,s=2*t.radius;if(i&&i.stroke){var l=i.strokeWidth||1;r-=l,o-=l,a+=2*l,s+=2*l}return t.x=r,t.y=o,t.w=a,t.h=s,[r,o,a,s,t.radius]},getParams:function(t){return{radius:t.radius}}},Vt=function(t){_t(n,Rt);var e=At(n);function n(t,i){var r;return bt(this,n),wt(xt(r=e.call(this,t,i)),"type",n.type),r}return n}();wt(Vt,"type","Blank");var Bt={type:Vt.type,cls:Vt,compute:function(t,e,n,i){return t.x=e.curX,t.y=e.curY,t.w=10,t.h=0,[e.curX,e.curY,10,0]},getParams:function(t){return{}}},$t=function(t){_t(n,Rt);var e=At(n);function n(t,i){var r;return bt(this,n),wt(xt(r=e.call(this,t,i)),"width",void 0),wt(xt(r),"height",void 0),wt(xt(r),"type",n.type),i=i||{},r.width=i.width||10,r.height=i.height||10,r}return Et(n,null,[{key:"_getParams",value:function(t){return{width:t.width,height:t.height}}}]),n}();wt($t,"type","Rectangle");var Ft={type:$t.type,cls:$t,compute:function(t,e,n,i){var r=i.width||t.width,o=i.height||t.height,a=e.curX-r/2,s=e.curY-o/2;return t.x=a,t.y=s,t.w=r,t.h=o,[a,s,r,o]},getParams:function(t){return{width:t.width,height:t.height}}},Gt=function(){function t(e,n){bt(this,t),this.connection=e,wt(this,"type",void 0),wt(this,"edited",!1),wt(this,"stub",void 0),wt(this,"sourceStub",void 0),wt(this,"targetStub",void 0),wt(this,"maxStub",void 0),wt(this,"typeId",void 0),wt(this,"gap",void 0),wt(this,"sourceGap",void 0),wt(this,"targetGap",void 0),wt(this,"segments",[]),wt(this,"totalLength",0),wt(this,"segmentProportions",[]),wt(this,"segmentProportionalLengths",[]),wt(this,"paintInfo",null),wt(this,"strokeWidth",void 0),wt(this,"x",void 0),wt(this,"y",void 0),wt(this,"w",void 0),wt(this,"h",void 0),wt(this,"segment",void 0),wt(this,"bounds",{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}),wt(this,"cssClass",void 0),wt(this,"hoverClass",void 0),wt(this,"geometry",void 0),this.stub=n.stub||this.getDefaultStubs(),this.sourceStub=Array.isArray(this.stub)?this.stub[0]:this.stub,this.targetStub=Array.isArray(this.stub)?this.stub[1]:this.stub,this.gap=n.gap||0,this.sourceGap=Array.isArray(this.gap)?this.gap[0]:this.gap,this.targetGap=Array.isArray(this.gap)?this.gap[1]:this.gap,this.maxStub=Math.max(this.sourceStub,this.targetStub),this.cssClass=n.cssClass||"",this.hoverClass=n.hoverClass||""}return Et(t,[{key:"getTypeDescriptor",value:function(){return"connector"}},{key:"getIdPrefix",value:function(){return"_jsplumb_connector"}},{key:"setGeometry",value:function(t,e){this.geometry=t,this.edited=null!=t&&!e}},{key:"exportGeometry",value:function(){return this.geometry}},{key:"importGeometry",value:function(t){return this.geometry=t,!0}},{key:"resetGeometry",value:function(){this.geometry=null,this.edited=!1}},{key:"transformAnchorPlacement",value:function(t,e,n){return{x:t.x,y:t.y,ox:t.ox,oy:t.oy,curX:t.curX+e,curY:t.curY+n}}},{key:"resetBounds",value:function(){this.bounds={xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}}},{key:"findSegmentForPoint",value:function(t,e){for(var n={d:1/0,s:null,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null,index:null,connectorLocation:null},i=0;i<this.segments.length;i++){var r=this.segments[i].findClosestPointOnPath(t,e);r.d<n.d&&(n.d=r.d,n.l=r.l,n.x=r.x,n.y=r.y,n.s=this.segments[i],n.x1=r.x1,n.x2=r.x2,n.y1=r.y1,n.y2=r.y2,n.index=i,n.connectorLocation=this.segmentProportions[i][0]+r.l*(this.segmentProportions[i][1]-this.segmentProportions[i][0]))}return n}},{key:"lineIntersection",value:function(t,e,n,i){for(var r=[],o=0;o<this.segments.length;o++)r.push.apply(r,this.segments[o].lineIntersection(t,e,n,i));return r}},{key:"boxIntersection",value:function(t,e,n,i){for(var r=[],o=0;o<this.segments.length;o++)r.push.apply(r,this.segments[o].boxIntersection(t,e,n,i));return r}},{key:"boundingBoxIntersection",value:function(t){for(var e=[],n=0;n<this.segments.length;n++)e.push.apply(e,this.segments[n].boundingBoxIntersection(t));return e}},{key:"_updateSegmentProportions",value:function(){for(var t=0,e=0;e<this.segments.length;e++){var n=this.segments[e].getLength();this.segmentProportionalLengths[e]=n/this.totalLength,this.segmentProportions[e]=[t,t+=n/this.totalLength]}}},{key:"_findSegmentForLocation",value:function(t,e){var n,i,r;if(e&&(t=t>0?t/this.totalLength:(this.totalLength+t)/this.totalLength),1===t)n=this.segments.length-1,r=1;else if(0===t)r=0,n=0;else if(t>=.5){for(n=0,r=0,i=this.segmentProportions.length-1;i>-1;i--)if(this.segmentProportions[i][1]>=t&&this.segmentProportions[i][0]<=t){n=i,r=(t-this.segmentProportions[i][0])/this.segmentProportionalLengths[i];break}}else for(n=this.segmentProportions.length-1,r=1,i=0;i<this.segmentProportions.length;i++)if(this.segmentProportions[i][1]>=t){n=i,r=(t-this.segmentProportions[i][0])/this.segmentProportionalLengths[i];break}return{segment:this.segments[n],proportion:r,index:n}}},{key:"_addSegment",value:function(t,e){if(e.x1!==e.x2||e.y1!==e.y2){var n=new t(e);this.segments.push(n),this.totalLength+=n.getLength(),this.updateBounds(n)}}},{key:"_clearSegments",value:function(){this.totalLength=0,this.segments.length=0,this.segmentProportions.length=0,this.segmentProportionalLengths.length=0}},{key:"getLength",value:function(){return this.totalLength}},{key:"_prepareCompute",value:function(t){this.strokeWidth=t.strokeWidth;var e=t.sourcePos.curX,n=t.targetPos.curX,i=t.sourcePos.curY,r=t.targetPos.curY,o=st({x:e,y:i},{x:n,y:r}),a=n<e,s=r<i,l=[t.sourcePos.ox,t.sourcePos.oy],u=[t.targetPos.ox,t.targetPos.oy],c=a?n:e,d=s?r:i,f=Math.abs(n-e),p=Math.abs(r-i),h=0===l[0]&&0===l[1],g=0===u[0]&&0===u[1];if(h||g){var v=f>p?0:1,y=[1,0][v],b=0===v?e:i,m=0===v?n:r;h&&(l[v]=b>m?-1:1,l[y]=0),g&&(u[v]=b>m?1:-1,u[y]=0)}var E=a?f+this.sourceGap*l[0]:this.sourceGap*l[0],w=s?p+this.sourceGap*l[1]:this.sourceGap*l[1],_=a?this.targetGap*u[0]:f+this.targetGap*u[0],O=s?this.targetGap*u[1]:p+this.targetGap*u[1],T=l[0]*u[0]+l[1]*u[1],x={sx:E,sy:w,tx:_,ty:O,xSpan:Math.abs(_-E),ySpan:Math.abs(O-w),mx:(E+_)/2,my:(w+O)/2,so:l,to:u,x:c,y:d,w:f,h:p,segment:o,startStubX:E+l[0]*this.sourceStub,startStubY:w+l[1]*this.sourceStub,endStubX:_+u[0]*this.targetStub,endStubY:O+u[1]*this.targetStub,isXGreaterThanStubTimes2:Math.abs(E-_)>this.sourceStub+this.targetStub,isYGreaterThanStubTimes2:Math.abs(w-O)>this.sourceStub+this.targetStub,opposite:-1===T,perpendicular:0===T,orthogonal:1===T,sourceAxis:0===l[0]?"y":"x",points:[c,d,f,p,E,w,_,O],stubs:[this.sourceStub,this.targetStub]};return x.anchorOrientation=x.opposite?"opposite":x.orthogonal?"orthogonal":"perpendicular",x}},{key:"updateBounds",value:function(t){var e=t.extents;this.bounds.xmin=Math.min(this.bounds.xmin,e.xmin),this.bounds.xmax=Math.max(this.bounds.xmax,e.xmax),this.bounds.ymin=Math.min(this.bounds.ymin,e.ymin),this.bounds.ymax=Math.max(this.bounds.ymax,e.ymax)}},{key:"dumpSegmentsToConsole",value:function(){V("SEGMENTS:");for(var t=0;t<this.segments.length;t++)V(this.segments[t].type,""+this.segments[t].getLength(),""+this.segmentProportions[t])}},{key:"pointOnPath",value:function(t,e){var n=this._findSegmentForLocation(t,e);return n.segment&&n.segment.pointOnPath(n.proportion,!1)||{x:0,y:0}}},{key:"gradientAtPoint",value:function(t,e){var n=this._findSegmentForLocation(t,e);return n.segment&&n.segment.gradientAtPoint(n.proportion,!1)||0}},{key:"pointAlongPathFrom",value:function(t,e,n){var i=this._findSegmentForLocation(t,n);return i.segment&&i.segment.pointAlongPathFrom(i.proportion,e,!1)||{x:0,y:0}}},{key:"compute",value:function(t){this.paintInfo=this._prepareCompute(t),this._clearSegments(),this._compute(this.paintInfo,t),this.x=this.paintInfo.points[0],this.y=this.paintInfo.points[1],this.w=this.paintInfo.points[2],this.h=this.paintInfo.points[3],this.segment=this.paintInfo.segment,this._updateSegmentProportions()}},{key:"setAnchorOrientation",value:function(t,e){}}]),t}(),qt=function(t){_t(n,ft);var e=At(n);function n(t){var i;return bt(this,n),wt(xt(i=e.call(this,t)),"length",void 0),wt(xt(i),"m",void 0),wt(xt(i),"m2",void 0),wt(xt(i),"type",n.segmentType),i._setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),i}return Et(n,[{key:"getPath",value:function(t){return(t?"M "+this.x1+" "+this.y1+" ":"")+"L "+this.x2+" "+this.y2}},{key:"_recalc",value:function(){this.length=Math.sqrt(Math.pow(this.x2-this.x1,2)+Math.pow(this.y2-this.y1,2)),this.m=ot({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.m2=-1/this.m,this.extents={xmin:Math.min(this.x1,this.x2),ymin:Math.min(this.y1,this.y2),xmax:Math.max(this.x1,this.x2),ymax:Math.max(this.y1,this.y2)}}},{key:"getLength",value:function(){return this.length}},{key:"getGradient",value:function(){return this.m}},{key:"_setCoordinates",value:function(t){this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2,this._recalc()}},{key:"pointOnPath",value:function(t,e){if(0!==t||e){if(1!==t||e){var n=e?t>0?t:this.length+t:t*this.length;return ut({x:this.x1,y:this.y1},{x:this.x2,y:this.y2},n)}return{x:this.x2,y:this.y2}}return{x:this.x1,y:this.y1}}},{key:"gradientAtPoint",value:function(t,e){return this.m}},{key:"pointAlongPathFrom",value:function(t,e,n){var i=this.pointOnPath(t,n),r=e<=0?{x:this.x1,y:this.y1}:{x:this.x2,y:this.y2};return e<=0&&Math.abs(e)>1&&(e*=-1),ut(i,r,e)}},{key:"within",value:function(t,e,n){return n>=Math.min(t,e)&&n<=Math.max(t,e)}},{key:"closest",value:function(t,e,n){return Math.abs(n-t)<Math.abs(n-e)?t:e}},{key:"findClosestPointOnPath",value:function(t,e){var n={d:1/0,x:null,y:null,l:null,x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};if(0===this.m)n.y=this.y1,n.x=this.within(this.x1,this.x2,t)?t:this.closest(this.x1,this.x2,t);else if(this.m===1/0||this.m===-1/0)n.x=this.x1,n.y=this.within(this.y1,this.y2,e)?e:this.closest(this.y1,this.y2,e);else{var i=this.y1-this.m*this.x1,r=(e-this.m2*t-i)/(this.m-this.m2),o=this.m*r+i;n.x=this.within(this.x1,this.x2,r)?r:this.closest(this.x1,this.x2,r),n.y=this.within(this.y1,this.y2,o)?o:this.closest(this.y1,this.y2,o)}var a=at({x:n.x,y:n.y},{x:this.x1,y:this.y1});return n.d=at({x:t,y:e},n),n.l=a/length,n}},{key:"_pointLiesBetween",value:function(t,e,n){return n>e?e<=t&&t<=n:e>=t&&t>=n}},{key:"lineIntersection",value:function(t,e,n,i){var r=Math.abs(ot({x:t,y:e},{x:n,y:i})),o=Math.abs(this.m),a=o===1/0?this.x1:this.y1-o*this.x1,s=[],l=r===1/0?t:e-r*t;if(r!==o)if(r===1/0&&0===o)this._pointLiesBetween(t,this.x1,this.x2)&&this._pointLiesBetween(this.y1,e,i)&&s.push({x:t,y:this.y1});else if(0===r&&o===1/0)this._pointLiesBetween(e,this.y1,this.y2)&&this._pointLiesBetween(this.x1,t,n)&&s.push({x:this.x1,y:e});else{var u,c;r===1/0?(u=t,this._pointLiesBetween(u,this.x1,this.x2)&&(c=o*t+a,this._pointLiesBetween(c,e,i)&&s.push({x:u,y:c}))):0===r?(c=e,this._pointLiesBetween(c,this.y1,this.y2)&&(u=(e-a)/o,this._pointLiesBetween(u,t,n)&&s.push({x:u,y:c}))):(c=o*(u=(l-a)/(o-r))+a,this._pointLiesBetween(u,this.x1,this.x2)&&this._pointLiesBetween(c,this.y1,this.y2)&&s.push({x:u,y:c}))}return s}},{key:"boxIntersection",value:function(t,e,n,i){var r=[];return r.push.apply(r,this.lineIntersection(t,e,t+n,e)),r.push.apply(r,this.lineIntersection(t+n,e,t+n,e+i)),r.push.apply(r,this.lineIntersection(t+n,e+i,t,e+i)),r.push.apply(r,this.lineIntersection(t,e+i,t,e)),r}}]),n}();wt(qt,"segmentType","Straight");var Ut=function(t){_t(n,Gt);var e=At(n);function n(){var t;bt(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return wt(xt(t=e.call.apply(e,[this].concat(r))),"type",n.type),t}return Et(n,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(t,e){this._addSegment(qt,{x1:t.sx,y1:t.sy,x2:t.startStubX,y2:t.startStubY}),this._addSegment(qt,{x1:t.startStubX,y1:t.startStubY,x2:t.endStubX,y2:t.endStubY}),this._addSegment(qt,{x1:t.endStubX,y1:t.endStubY,x2:t.tx,y2:t.ty}),this.geometry={source:e.sourcePos,target:e.targetPos}}},{key:"transformGeometry",value:function(t,e,n){return{source:this.transformAnchorPlacement(t.source,e,n),target:this.transformAnchorPlacement(t.target,e,n)}}}]),n}();wt(Ut,"type","Straight");var zt={},Jt=function(t,e,n){var i=zt[e];if(i)return new i(t,n);throw{message:"jsPlumb: unknown connector type '"+e+"'"}},Wt=function(t,e){zt[t]=e};function Ht(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.map((function(t){return"."+t})).join(",")}function Xt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.map((function(t){return"["+t+"]"})).join(",")}var Zt="source",Kt="target",Qt="block",te="none",ee="absolute",ne="fixed",ie="data-jtk-group",re="data-jtk-managed",oe="data-jtk-not-draggable",ae="tabindex",se="data-jtk-scope-",le="checkCondition",ue="jtk-connector",ce="jtk-endpoint",de="jtk-floating-endpoint",fe="jtk-group-collapsed",pe="jtk-group-expanded",he="jtk-overlay",ge="internal.connection",ve="connection:move",ye="internal.endpoint:unregistered",be="internal.connection:detached",me="maxConnections",Ee="zoom",we="isDetachAllowed",_e="beforeDetach",Oe=Xt(re),Te="paintStyle";function xe(t){var e=null;return(e=h(t)?{type:t,options:{}}:t).options.id=e.options.id||D(),e}var Ae=function(t){_t(n,Q);var e=At(n);function n(t,i,r){var o;for(var a in bt(this,n),(o=e.call(this)).instance=t,o.component=i,wt(xt(o),"id",void 0),wt(xt(o),"type",void 0),wt(xt(o),"cssClass",void 0),wt(xt(o),"visible",!0),wt(xt(o),"location",void 0),wt(xt(o),"events",void 0),wt(xt(o),"attributes",void 0),r=r||{},o.id=r.id||D(),o.cssClass=r.cssClass||"",o.setLocation(r.location),o.events=r.events||{},o.attributes=r.attributes||{},o.events)o.bind(a,o.events[a]);return o}return Et(n,[{key:"setLocation",value:function(t){var e=null==this.location?.5:this.location;if(null!=t)try{var n="string"==typeof t?parseFloat(t):t;isNaN(n)||(e=n)}catch(t){}this.location=e}},{key:"shouldFireEvent",value:function(t,e,n){return!0}},{key:"setVisible",value:function(t){this.visible=t,this.instance.setOverlayVisible(this,t)}},{key:"isVisible",value:function(){return this.visible}}]),n}(),Se={},Ie={get:function(t,e,n,i){var r=Se[e];if(r)return new r(t,n,i);throw{message:"jsPlumb: unknown overlay type '"+e+"'"}},register:function(t,e){Se[t]=e}},ke=function(t){_t(n,Ae);var e=At(n);function n(t,i,r){var o;return bt(this,n),(o=e.call(this,t,i,r)).instance=t,o.component=i,wt(xt(o),"label",void 0),wt(xt(o),"labelText",void 0),wt(xt(o),"type",n.type),wt(xt(o),"cachedDimensions",void 0),r=r||{label:""},o.setLabel(r.label),o}return Et(n,[{key:"getLabel",value:function(){return b(this.label)?this.label(this):this.labelText}},{key:"setLabel",value:function(t){this.label=t,this.labelText=null,this.instance.updateLabel(this)}},{key:"getDimensions",value:function(){return{w:1,h:1}}},{key:"updateFrom",value:function(t){null!=t.label&&this.setLabel(t.label),null!=t.location&&(this.setLocation(t.location),this.instance.updateLabel(this))}}]),n}();function Pe(t){return t.type===ke.type}function Ne(t){return null==t?null:t.split(" ").filter((function(t){return null!=t&&t.length>0}))}function Ce(t,e,n){for(var i in e)t[i]=n}wt(ke,"type","Label"),Ie.register(ke.type,ke);var je="connector",Me="override",De="cssClass",Re="__default",Le="anchor",Ye="anchors",Ve="__label",Be="overlay",$e="remove";function Fe(t,e){if(t.getDefaultType){var n=t.getTypeDescriptor(),i={},r=t.getDefaultType(),o=f({},r);Ce(i,r,Re),t._types.forEach((function(e){if(e!==Re){var r=t.instance.getType(e,n);if(null!=r){var a=new Set([je,Le,Ye]);if(r.mergeStrategy===Me)for(var s in r)a.add(s);o=E(o,r,[De],(l=[],a.forEach((function(t){l.push(t)})),l)),Ce(i,r,e)}}var l})),e&&(o=O(o,e,"_")),t.applyType(o,i)}}function Ge(t,e){var n=t.instance.getType(e,t.getTypeDescriptor());null!=n&&n.cssClass&&t.removeClass(n.cssClass)}function qe(t){if(t.paintStyle&&t.hoverPaintStyle){var e={};f(e,t.paintStyle),f(e,t.hoverPaintStyle),t.hoverPaintStyle=e}}var Ue,ze,Je,We,He=function(t){_t(n,Q);var e=At(n);function n(t,i){var r;if(bt(this,n),(r=e.call(this)).instance=t,wt(xt(r),"defaultLabelLocation",.5),wt(xt(r),"overlays",{}),wt(xt(r),"overlayPositions",{}),wt(xt(r),"overlayPlacements",{}),wt(xt(r),"clone",void 0),wt(xt(r),"deleted",void 0),wt(xt(r),"segment",void 0),wt(xt(r),"x",void 0),wt(xt(r),"y",void 0),wt(xt(r),"w",void 0),wt(xt(r),"h",void 0),wt(xt(r),"id",void 0),wt(xt(r),"visible",!0),wt(xt(r),"typeId",void 0),wt(xt(r),"params",{}),wt(xt(r),"paintStyle",void 0),wt(xt(r),"hoverPaintStyle",void 0),wt(xt(r),"paintStyleInUse",void 0),wt(xt(r),"_hover",!1),wt(xt(r),"lastPaintedAt",void 0),wt(xt(r),"data",void 0),wt(xt(r),"_defaultType",void 0),wt(xt(r),"events",void 0),wt(xt(r),"parameters",void 0),wt(xt(r),"_types",void 0),wt(xt(r),"_typeCache",void 0),wt(xt(r),"cssClass",void 0),wt(xt(r),"hoverClass",void 0),wt(xt(r),"beforeDetach",void 0),wt(xt(r),"beforeDrop",void 0),i=i||{},r.cssClass=i.cssClass||"",r.hoverClass=i.hoverClass||t.defaults.hoverClass,r.beforeDetach=i.beforeDetach,r.beforeDrop=i.beforeDrop,r._types=new Set,r._typeCache={},r.parameters=m(i.parameters||{}),r.id=i.id||r.getIdPrefix()+(new Date).getTime(),r._defaultType={parameters:r.parameters,scope:i.scope||r.instance.defaultScope,overlays:{}},i.events)for(var o in i.events)r.bind(o,i.events[o]);r.clone=function(){var e=Object.create(r.constructor.prototype);return r.constructor.apply(e,[t,i]),e},r.overlays={},r.overlayPositions={};var a=i.overlays||[],s={},l=r.getDefaultOverlayKey();if(l){var u=r.instance.defaults[l];u&&a.push.apply(a,kt(u));for(var c=0;c<a.length;c++){var d=xe(a[c]);s[d.options.id]=d}}return r._defaultType.overlays=s,i.label&&(r.getDefaultType().overlays[Ve]={type:ke.type,options:{label:i.label,location:i.labelLocation||r.defaultLabelLocation,id:Ve,cssClass:"jtk-default-label"}}),r}return Et(n,[{key:"isDetachAllowed",value:function(t){var e=!0;if(this.beforeDetach)try{e=this.beforeDetach(t)}catch(t){V("jsPlumb: beforeDetach callback failed",t)}return e}},{key:"isDropAllowed",value:function(t,e,n,i,r){var o,a={sourceId:t,targetId:e,scope:n,connection:i,dropEndpoint:r};if(this.beforeDrop)try{o=this.beforeDrop(a)}catch(t){V("jsPlumb: beforeDrop callback failed",t)}else o=this.instance.checkCondition("beforeDrop",a);return o}},{key:"getDefaultType",value:function(){return this._defaultType}},{key:"appendToDefaultType",value:function(t){for(var e in t)this._defaultType[e]=t[e]}},{key:"getId",value:function(){return this.id}},{key:"cacheTypeItem",value:function(t,e,n){this._typeCache[n]=this._typeCache[n]||{},this._typeCache[n][t]=e}},{key:"getCachedTypeItem",value:function(t,e){return this._typeCache[e]?this._typeCache[e][t]:null}},{key:"setType",value:function(t,e){this.clearTypes(),(Ne(t)||[]).forEach(this._types.add,this._types),Fe(this,e)}},{key:"getType",value:function(){return Array.from(this._types.keys())}},{key:"reapplyTypes",value:function(t){Fe(this,t)}},{key:"hasType",value:function(t){return this._types.has(t)}},{key:"addType",value:function(t,e){var n=Ne(t),i=!1;if(null!=n){for(var r=0,o=n.length;r<o;r++)this._types.has(n[r])||(this._types.add(n[r]),i=!0);i&&Fe(this,e)}}},{key:"removeType",value:function(t,e){var n,i=this,r=Ne(t),o=!1;if(null!=r){for(var a=0,s=r.length;a<s;a++)n=r[a],o=!!i._types.has(n)&&(Ge(i,n),i._types.delete(n),!0)||o;o&&Fe(this,e)}}},{key:"clearTypes",value:function(t){var e=this;this._types.forEach((function(t){Ge(e,t)})),this._types.clear(),Fe(this,t)}},{key:"toggleType",value:function(t,e){var n=Ne(t);if(null!=n){for(var i=0,r=n.length;i<r;i++)this._types.has(n[i])?(Ge(this,n[i]),this._types.delete(n[i])):this._types.add(n[i]);Fe(this,e)}}},{key:"applyType",value:function(t,e){if(this.setPaintStyle(t.paintStyle),this.setHoverPaintStyle(t.hoverPaintStyle),this.mergeParameters(t.parameters),this.paintStyleInUse=this.getPaintStyle(),t.overlays){var n,i={};for(n in t.overlays){var r=this.overlays[t.overlays[n].options.id];if(r)r.updateFrom(t.overlays[n].options),i[t.overlays[n].options.id]=!0,this.instance.reattachOverlay(r,this);else{var o=this.getCachedTypeItem(Be,t.overlays[n].options.id);null!=o?(this.instance.reattachOverlay(o,this),o.setVisible(!0),o.updateFrom(t.overlays[n].options),this.overlays[o.id]=o):o=this.addOverlay(t.overlays[n]),i[o.id]=!0}}for(n in this.overlays)null==i[this.overlays[n].id]&&this.removeOverlay(this.overlays[n].id,!0)}}},{key:"setPaintStyle",value:function(t){this.paintStyle=t,this.paintStyleInUse=this.paintStyle,qe(this)}},{key:"getPaintStyle",value:function(){return this.paintStyle}},{key:"setHoverPaintStyle",value:function(t){this.hoverPaintStyle=t,qe(this)}},{key:"getHoverPaintStyle",value:function(){return this.hoverPaintStyle}},{key:"destroy",value:function(){for(var t in this.overlays)this.instance.destroyOverlay(this.overlays[t]);this.overlays={},this.overlayPositions={},this.unbind(),this.clone=null}},{key:"isHover",value:function(){return this._hover}},{key:"mergeParameters",value:function(t){null!=t&&f(this.parameters,t)}},{key:"setVisible",value:function(t){this.visible=t,t?this.showOverlays():this.hideOverlays()}},{key:"isVisible",value:function(){return this.visible}},{key:"setAbsoluteOverlayPosition",value:function(t,e){this.overlayPositions[t.id]=e}},{key:"getAbsoluteOverlayPosition",value:function(t){return this.overlayPositions?this.overlayPositions[t.id]:null}},{key:"_clazzManip",value:function(t,e){for(var n in this.overlays)"add"===t?this.instance.addOverlayClass(this.overlays[n],e):t===$e&&this.instance.removeOverlayClass(this.overlays[n],e)}},{key:"addClass",value:function(t,e){var n=(this.cssClass||"").split(" ");n.push(t),this.cssClass=n.join(" "),this._clazzManip("add",t)}},{key:"removeClass",value:function(t,e){var n=(this.cssClass||"").split(" ");this.cssClass=n.filter((function(e){return e!==t})).join(" "),this._clazzManip($e,t)}},{key:"getClass",value:function(){return this.cssClass}},{key:"shouldFireEvent",value:function(t,e,n){return!0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(t){this.data=t||{}}},{key:"mergeData",value:function(t){this.data=f(this.data,t)}},{key:"addOverlay",value:function(t){var e=function(t,e){var n=null;if(h(e))n=Ie.get(t.instance,e,t,{});else if(null!=e.type&&null!=e.options){var i=e,r=f({},i.options);n=Ie.get(t.instance,i.type,t,r)}else n=e;return n.id=n.id||D(),t.cacheTypeItem(Be,n,n.id),t.overlays[n.id]=n,n}(this,t);if(this.getData&&e.type===ke.type&&!h(t)){var n=this.getData(),i=t.options;if(n){var r=n[i.labelLocationAttribute||"labelLocation"];r&&(e.location=r)}}return e}},{key:"getOverlay",value:function(t){return this.overlays[t]}},{key:"getOverlays",value:function(){return this.overlays}},{key:"hideOverlay",value:function(t){var e=this.getOverlay(t);e&&e.setVisible(!1)}},{key:"hideOverlays",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i in e=e||[],this.overlays)0!==e.length&&-1===e.indexOf(i)||this.overlays[i].setVisible(!1)}},{key:"showOverlay",value:function(t){var e=this.getOverlay(t);e&&e.setVisible(!0)}},{key:"showOverlays",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i in e=e||[],this.overlays)0!==e.length&&-1===e.indexOf(i)||this.overlays[i].setVisible(!0)}},{key:"removeAllOverlays",value:function(){for(var t in this.overlays)this.instance.destroyOverlay(this.overlays[t]);this.overlays={},this.overlayPositions=null,this.overlayPlacements={}}},{key:"removeOverlay",value:function(t,e){var n=this.overlays[t];n&&(n.setVisible(!1),e||this.instance.destroyOverlay(n),delete this.overlays[t],this.overlayPositions&&delete this.overlayPositions[t],this.overlayPlacements&&delete this.overlayPlacements[t])}},{key:"removeOverlays",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var i=0,r=e.length;i<r;i++)this.removeOverlay(arguments[i])}},{key:"getLabel",value:function(){var t=this.getLabelOverlay();return null!=t?t.getLabel():null}},{key:"getLabelOverlay",value:function(){return this.getOverlay(Ve)}},{key:"setLabel",value:function(t){var e,n,i,r=this.getLabelOverlay();if(r)if(h(t)||b(t))r.setLabel(t);else{var o=t;o.label&&r.setLabel(o.label),o.location&&(r.location=o.location)}else{var a=h(t)||b(t)?{label:t}:t;e=this,i=f({cssClass:(n=a).cssClass,id:Ve,component:e},n),r=new ke(e.instance,e,i),this.overlays[Ve]=r}}}]),n}();!function(t){t.top="top",t.left="left",t.right="right",t.bottom="bottom"}(We||(We={}));var Xe=We.top,Ze=We.left,Ke=We.right,Qe=We.bottom,tn=[Ze,Ke],en=[Xe,Qe],nn=function(){function t(e,n,i){bt(this,t),this.instance=e,this.element=n,wt(this,"isFloating",!0),wt(this,"isContinuous",void 0),wt(this,"isDynamic",void 0),wt(this,"locations",[]),wt(this,"currentLocation",0),wt(this,"locked",!1),wt(this,"cssClass",""),wt(this,"timestamp",null),wt(this,"type","Floating"),wt(this,"id",D()),wt(this,"orientation",[0,0]),wt(this,"size",void 0),this.size=e.viewport.getPosition(i),this.locations.push({x:.5,y:.5,ox:this.orientation[0],oy:this.orientation[1],offx:0,offy:0,iox:this.orientation[0],ioy:this.orientation[1],cls:""})}return Et(t,[{key:"_updateOrientationInRouter",value:function(){this.instance.router.setAnchorOrientation(this,[this.locations[0].ox,this.locations[0].oy])}},{key:"over",value:function(t){this.orientation=this.instance.router.getEndpointOrientation(t),this.locations[0].ox=this.orientation[0],this.locations[0].oy=this.orientation[1],this._updateOrientationInRouter()}},{key:"out",value:function(){this.orientation=null,this.locations[0].ox=this.locations[0].iox,this.locations[0].oy=this.locations[0].ioy,this._updateOrientationInRouter()}}]),t}(),rn=(wt(Ue={},Xe,Qe),wt(Ue,Ke,Ze),wt(Ue,Ze,Ke),wt(Ue,Qe,Xe),Ue),on=(wt(ze={},Xe,Ke),wt(ze,Ke,Qe),wt(ze,Ze,Xe),wt(ze,Qe,Ze),ze),an=(wt(Je={},Xe,Ze),wt(Je,Ke,Xe),wt(Je,Ze,Qe),wt(Je,Qe,Ke),Je);function sn(t){return 0===t.faces.length?Xe:t.faces[0]}function ln(t,e){return-1!==t.faces.indexOf(e)}function un(t,e){return null==t.lockedAxis?null==t.lockedFace?!0===ln(t,e):t.lockedFace===e:-1!==t.lockedAxis.indexOf(e)}function cn(t,e){if(ln(t,e))return e;if(ln(t,rn[e]))return rn[e];var n=function(t,e){return(t.clockwise?on:an)[e]}(t,e);if(ln(t,n))return n;var i=function(t,e){return(t.clockwise?an:on)[e]}(t,e);return ln(t,i)?i:e}var dn={x:.5,y:0,ox:0,oy:-1,offx:0,offy:0},fn={x:.5,y:1,ox:0,oy:1,offx:0,offy:0},pn={x:0,y:.5,ox:-1,oy:0,offx:0,offy:0},hn={x:1,y:.5,ox:1,oy:0,offx:0,offy:0},gn={Top:[dn],Bottom:[fn],Left:[pn],Right:[hn],TopLeft:[{x:0,y:0,ox:0,oy:-1,offx:0,offy:0}],TopRight:[{x:1,y:0,ox:1,oy:-1,offx:0,offy:0}],BottomLeft:[{x:0,y:1,ox:0,oy:1,offx:0,offy:0}],BottomRight:[{x:1,y:1,ox:0,oy:1,offx:0,offy:0}],Center:[{x:.5,y:.5,ox:0,oy:0,offx:0,offy:0}],AutoDefault:[dn,pn,fn,hn]},vn={Continuous:{faces:[Xe,Ze,Qe,Ke]},ContinuousTop:{faces:[Xe]},ContinuousRight:{faces:[Ke]},ContinuousBottom:{faces:[Qe]},ContinuousLeft:{faces:[Ze]},ContinuousLeftRight:{faces:[Ze,Ke]},ContinuousTopBottom:{faces:[Xe,Qe]}};function yn(t,e){if(e=e||{},t===et.Perimeter)return function(t){t=t||{};var e=t.anchorCount||60,n=t.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");if(!xn.has(n))throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var i=xn.get(n)(e);t.rotation&&(i=function(t,e){for(var n=[],i=e/180*Math.PI,r=0;r<t.length;r++){var o=t[r].x-.5,a=t[r].y-.5;n.push({x:o*Math.cos(i)-a*Math.sin(i)+.5,y:o*Math.sin(i)+a*Math.cos(i)+.5,ox:t[r].ox,oy:t[r].oy,offx:0,offy:0,iox:0,ioy:0,cls:""})}return n}(i,t.rotation));var r=bn(et.Perimeter,i,t),o=f(r,{shape:n});return o}(e);var n=gn[t];if(null!=n)return bn(t,Y(n,(function(t){return f({iox:t.ox,ioy:t.oy},t)})),e);if(null!=(n=vn[t]))return function(t,e,n){var i={type:t,locations:[],currentLocation:0,locked:!1,id:D(),cssClass:n.cssClass||"",isFloating:!1,isContinuous:!0,timestamp:null,faces:n.faces||e,lockedFace:null,lockedAxis:null,clockwise:!(!1===n.clockwise),__currentFace:null};return Object.defineProperty(i,mn,{get:function(){return this.__currentFace},set:function(t){this.__currentFace=cn(this,t)}}),i}(t,n.faces,e);throw{message:"jsPlumb: unknown anchor type '"+t+"'"}}function bn(t,e,n){return{type:t,locations:e,currentLocation:0,locked:!1,id:D(),isFloating:!1,isContinuous:!1,isDynamic:e.length>1,timestamp:null,cssClass:n.cssClass||""}}var mn="currentFace";function En(t){return t.length<7&&t.every(p)||7===t.length&&t.slice(0,5).every(p)&&h(t[6])}function wn(t){if(h(t))return yn(t,null);if(Array.isArray(t)){if(En(t)){var e=t;return bn(null,[{x:e[0],y:e[1],ox:e[2],oy:e[3],offx:null==e[4]?0:e[4],offy:null==e[5]?0:e[5],iox:e[2],ioy:e[3],cls:e[6]||""}],{cssClass:e[6]||""})}return bn("Dynamic",Y(t,(function(t){if(h(t)){var e=gn[t];return null!=e?f({iox:e[0].ox,ioy:e[0].oy,cls:""},e[0]):null}if(En(t))return{x:t[0],y:t[1],ox:t[2],oy:t[3],offx:null==t[4]?0:t[4],offy:null==t[5]?0:t[5],iox:t[2],ioy:t[3],cls:t[6]||""}})).filter((function(t){return null!=t})),{})}var n=t;return yn(n.type,n.options)}function _n(t){for(var e=.5,n=2*Math.PI/t,i=[],r=0,o=0;o<t;o++){var a=e+e*Math.sin(r),s=e+e*Math.cos(r);i.push({x:a,y:s,ox:0,oy:0,offx:0,offy:0,iox:0,ioy:0,cls:""}),r+=n}return i}function On(t,e){for(var n=[],i=0;i<t.length;i++)n.push([t[i][0],t[i][1],t[i][2],t[i][3],1/t.length,t[i][4],t[i][5]]);return function(t,e){for(var n=e/t.length,i=[],r=function(t,r,o,a,s,l,u){for(var c=(o-t)/(n=e*s),d=(a-r)/n,f=0;f<n;f++)i.push({x:t+c*f,y:r+d*f,ox:null==l?0:l,oy:null==u?0:u,offx:0,offy:0,iox:0,ioy:0,cls:""})},o=0;o<t.length;o++)r.apply(null,t[o]);return i}(n,e)}function Tn(t){return On([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]],t)}var xn=new Map;xn.set(tt.Circle,_n),xn.set(tt.Ellipse,_n),xn.set(tt.Rectangle,Tn),xn.set(tt.Square,Tn),xn.set(tt.Diamond,(function(t){return On([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]],t)})),xn.set(tt.Triangle,(function(t){return On([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]],t)}));var An="anchors",Sn="connector";function In(t,e,n,i,r,o,a){var s;if(e)t.endpoints[n]=e,e.addConnection(t);else{var l=a||t.endpointSpec||t.endpointsSpec[n]||t.instance.defaults.endpoints[n]||t.instance.defaults.endpoint,u=t.endpointStyles[n]||t.endpointStyle||t.instance.defaults.endpointStyles[n]||t.instance.defaults.endpointStyle;null==u.fill&&null!=t.paintStyle&&(u.fill=t.paintStyle.stroke),null==u.outlineStroke&&null!=t.paintStyle&&(u.outlineStroke=t.paintStyle.outlineStroke),null==u.outlineWidth&&null!=t.paintStyle&&(u.outlineWidth=t.paintStyle.outlineWidth);var c=t.endpointHoverStyles[n]||t.endpointHoverStyle||t.endpointHoverStyle||t.instance.defaults.endpointHoverStyles[n]||t.instance.defaults.endpointHoverStyle;null!=t.hoverPaintStyle&&(null==c&&(c={}),null==c.fill&&(c.fill=t.hoverPaintStyle.stroke));var d=t.uuids?t.uuids[n]:null;i=null!=i?i:null!=t.instance.defaults.anchors?t.instance.defaults.anchors[n]:t.instance.defaults.anchor,s=t.instance._internal_newEndpoint({paintStyle:u,hoverPaintStyle:c,endpoint:l,connections:[t],uuid:d,element:r,scope:t.scope,anchor:i,reattachConnections:t.reattach||t.instance.defaults.reattachConnections,connectionsDetachable:t.detachable||t.instance.defaults.connectionsDetachable}),t.instance._refreshEndpoint(s),null==e&&(s.deleteOnEmpty=!0),t.endpoints[n]=s}return s}var kn=function(t){_t(n,He);var e=At(n);function n(t,i){var r;bt(this,n),(r=e.call(this,t,i)).instance=t,wt(xt(r),"connector",void 0),wt(xt(r),"defaultLabelLocation",.5),wt(xt(r),"scope",void 0),wt(xt(r),"typeId","_jsplumb_connection"),wt(xt(r),"previousConnection",void 0),wt(xt(r),"sourceId",void 0),wt(xt(r),"targetId",void 0),wt(xt(r),"source",void 0),wt(xt(r),"target",void 0),wt(xt(r),"detachable",!0),wt(xt(r),"reattach",!1),wt(xt(r),"uuids",void 0),wt(xt(r),"cost",1),wt(xt(r),"directed",void 0),wt(xt(r),"endpoints",[null,null]),wt(xt(r),"endpointStyles",void 0),wt(xt(r),"endpointSpec",void 0),wt(xt(r),"endpointsSpec",void 0),wt(xt(r),"endpointStyle",{}),wt(xt(r),"endpointHoverStyle",{}),wt(xt(r),"endpointHoverStyles",void 0),wt(xt(r),"suspendedEndpoint",void 0),wt(xt(r),"suspendedIndex",void 0),wt(xt(r),"suspendedElement",void 0),wt(xt(r),"suspendedElementId",void 0),wt(xt(r),"suspendedElementType",void 0),wt(xt(r),"_forceReattach",void 0),wt(xt(r),"_forceDetach",void 0),wt(xt(r),"proxies",[]),wt(xt(r),"pending",!1),r.id=i.id,r.previousConnection=i.previousConnection,r.source=i.source,r.target=i.target,i.sourceEndpoint?(r.source=i.sourceEndpoint.element,r.sourceId=i.sourceEndpoint.elementId):r.sourceId=t.getId(r.source),i.targetEndpoint?(r.target=i.targetEndpoint.element,r.targetId=i.targetEndpoint.elementId):r.targetId=t.getId(r.target),r.scope=i.scope;var o=i.anchors?i.anchors[0]:i.anchor,a=i.anchors?i.anchors[1]:i.anchor;t.manage(r.source),t.manage(r.target),r.visible=!0,r.params={cssClass:i.cssClass,hoverClass:i.hoverClass,"pointer-events":i["pointer-events"],overlays:i.overlays},r.lastPaintedAt=null,i.type&&(i.endpoints=i.endpoints||r.instance._deriveEndpointAndAnchorSpec(i.type).endpoints),r.endpointSpec=i.endpoint,r.endpointsSpec=i.endpoints||[null,null],r.endpointStyle=i.endpointStyle,r.endpointHoverStyle=i.endpointHoverStyle,r.endpointStyles=i.endpointStyles||[null,null],r.endpointHoverStyles=i.endpointHoverStyles||[null,null],r.paintStyle=i.paintStyle,r.hoverPaintStyle=i.hoverPaintStyle,r.uuids=i.uuids,r.makeEndpoint(!0,r.source,r.sourceId,o,i.sourceEndpoint),r.makeEndpoint(!1,r.target,r.targetId,a,i.targetEndpoint),r.scope||(r.scope=r.endpoints[0].scope),null!=i.deleteEndpointsOnEmpty&&(r.endpoints[0].deleteOnEmpty=i.deleteEndpointsOnEmpty,r.endpoints[1].deleteOnEmpty=i.deleteEndpointsOnEmpty);var s=r.instance.defaults.connectionsDetachable;!1===i.detachable&&(s=!1),!1===r.endpoints[0].connectionsDetachable&&(s=!1),!1===r.endpoints[1].connectionsDetachable&&(s=!1),r.endpointsSpec=i.endpoints||[null,null],r.endpointSpec=i.endpoint||null;var l=i.reattach||r.endpoints[0].reattachConnections||r.endpoints[1].reattachConnections||r.instance.defaults.reattachConnections,u=f({},r.endpoints[0].connectorStyle||r.endpoints[1].connectorStyle||i.paintStyle||r.instance.defaults.paintStyle);if(r.appendToDefaultType({detachable:s,reattach:l,paintStyle:u,hoverPaintStyle:f({},r.endpoints[0].connectorHoverStyle||r.endpoints[1].connectorHoverStyle||i.hoverPaintStyle||r.instance.defaults.hoverPaintStyle)}),i.outlineWidth&&(u.outlineWidth=i.outlineWidth),i.outlineColor&&(u.outlineStroke=i.outlineColor),i.lineWidth&&(u.strokeWidth=i.lineWidth),i.color&&(u.stroke=i.color),!r.instance._suspendDrawing){var c=r.instance._suspendedAt||D();r.instance._paintEndpoint(r.endpoints[0],{timestamp:c}),r.instance._paintEndpoint(r.endpoints[1],{timestamp:c})}r.cost=i.cost||r.endpoints[0].connectionCost,r.directed=i.directed,null==i.directed&&(r.directed=r.endpoints[0].connectionsDirected);var d=f({},r.endpoints[1].parameters);f(d,r.endpoints[0].parameters),f(d,r.parameters),r.parameters=d,r.paintStyleInUse=r.getPaintStyle()||{},r._setConnector(r.endpoints[0].connector||r.endpoints[1].connector||i.connector||r.instance.defaults.connector,!0);var p=null!=i.data&&v(i.data)?i.data:{};r.setData(p);var h=[ht,r.endpoints[0].edgeType,r.endpoints[1].edgeType,i.type].join(" ");return/[^\s]/.test(h)&&r.addType(h,i.data),r}return Et(n,[{key:"getIdPrefix",value:function(){return"_jsPlumb_c"}},{key:"getDefaultOverlayKey",value:function(){return"connectionOverlays"}},{key:"getXY",value:function(){return{x:this.connector.x,y:this.connector.y}}},{key:"makeEndpoint",value:function(t,e,n,i,r){return n=n||this.instance.getId(e),In(this,r,t?0:1,i,e)}},{key:"getTypeDescriptor",value:function(){return n.type}},{key:"isDetachable",value:function(t){return!1!==this.detachable&&(null!=t?!0===t.connectionsDetachable:!0===this.detachable)}},{key:"setDetachable",value:function(t){this.detachable=!0===t}},{key:"isReattach",value:function(){return!0===this.reattach||!0===this.endpoints[0].reattachConnections||!0===this.endpoints[1].reattachConnections}},{key:"setReattach",value:function(t){this.reattach=!0===t}},{key:"applyType",value:function(t,e){var i=null;null!=t.connector&&(null==(i=this.getCachedTypeItem(Sn,e.connector))&&(i=this.prepareConnector(t.connector,e.connector),this.cacheTypeItem(Sn,i,e.connector)),this.setPreparedConnector(i)),St(Ot(n.prototype),"applyType",this).call(this,t,e),null!=t.detachable&&this.setDetachable(t.detachable),null!=t.reattach&&this.setReattach(t.reattach),t.scope&&(this.scope=t.scope);var r=null;t.anchor?null==(r=this.getCachedTypeItem(An,e.anchor))&&(r=[wn(t.anchor),wn(t.anchor)],this.cacheTypeItem(An,r,e.anchor)):t.anchors&&null==(r=this.getCachedTypeItem(An,e.anchors))&&(r=[wn(t.anchors[0]),wn(t.anchors[1])],this.cacheTypeItem(An,r,e.anchors)),null!=r&&(this.instance.router.setConnectionAnchors(this,r),this.instance.router.isDynamicAnchor(this.endpoints[1])&&this.instance.repaint(this.endpoints[1].element)),this.instance.applyConnectorType(this.connector,t)}},{key:"addClass",value:function(t,e){St(Ot(n.prototype),"addClass",this).call(this,t),e&&(this.endpoints[0].addClass(t),this.endpoints[1].addClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(t)),this.connector&&this.instance.addConnectorClass(this.connector,t)}},{key:"removeClass",value:function(t,e){St(Ot(n.prototype),"removeClass",this).call(this,t),e&&(this.endpoints[0].removeClass(t),this.endpoints[1].removeClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(t)),this.connector&&this.instance.removeConnectorClass(this.connector,t)}},{key:"setVisible",value:function(t){St(Ot(n.prototype),"setVisible",this).call(this,t),this.connector&&this.instance.setConnectorVisible(this.connector,t),this.instance._paintConnection(this)}},{key:"destroy",value:function(){St(Ot(n.prototype),"destroy",this).call(this),this.endpoints=null,this.endpointStyles=null,this.source=null,this.target=null,this.instance.destroyConnector(this),this.connector=null,this.deleted=!0}},{key:"getUuids",value:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]}},{key:"prepareConnector",value:function(t,e){var n,i={cssClass:this.params.cssClass,hoverClass:this.params.hoverClass,"pointer-events":this.params["pointer-events"]};if(h(t))n=this.instance._makeConnector(this,t,i);else{var r=t;n=this.instance._makeConnector(this,r.type,E(r.options||{},i))}return null!=e&&(n.typeId=e),n}},{key:"setPreparedConnector",value:function(t,e,n,i){if(this.connector!==t){var r,o="";if(null!=this.connector&&(r=this.connector,o=this.instance.getConnectorClass(this.connector),this.instance.destroyConnector(this)),this.connector=t,i&&this.cacheTypeItem(Sn,t,i),this.addClass(o),null!=r){var a=this.getOverlays();for(var s in a)this.instance.reattachOverlay(a[s],this)}e||this.instance._paintConnection(this)}}},{key:"_setConnector",value:function(t,e,n,i){var r=this.prepareConnector(t,i);this.setPreparedConnector(r,e,n,i)}},{key:"replaceEndpoint",value:function(t,e){var n=this.endpoints[t],i=(n.elementId,this.instance.getEndpoints(n.element)),r=i.indexOf(n),o=In(this,null,t,null,n.element,0,e);this.endpoints[t]=o,i.splice(r,1,o),n.detachFromConnection(this),this.instance.deleteEndpoint(n),this.instance.fire("endpoint:replaced",{previous:n,current:o})}}]),n}();wt(kn,"type","connection");var Pn=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],Nn=function(t){_t(n,He);var e=At(n);function n(t,i){var r;bt(this,n),(r=e.call(this,t,i)).instance=t,wt(xt(r),"connections",[]),wt(xt(r),"endpoint",void 0),wt(xt(r),"element",void 0),wt(xt(r),"elementId",void 0),wt(xt(r),"dragAllowedWhenFull",!0),wt(xt(r),"timestamp",void 0),wt(xt(r),"portId",void 0),wt(xt(r),"maxConnections",void 0),wt(xt(r),"proxiedBy",void 0),wt(xt(r),"connectorClass",void 0),wt(xt(r),"connectorHoverClass",void 0),wt(xt(r),"finalEndpoint",void 0),wt(xt(r),"enabled",!0),wt(xt(r),"isSource",void 0),wt(xt(r),"isTarget",void 0),wt(xt(r),"isTemporarySource",void 0),wt(xt(r),"connectionCost",1),wt(xt(r),"connectionsDirected",void 0),wt(xt(r),"connectionsDetachable",void 0),wt(xt(r),"reattachConnections",void 0),wt(xt(r),"currentAnchorClass",void 0),wt(xt(r),"referenceEndpoint",void 0),wt(xt(r),"edgeType",void 0),wt(xt(r),"connector",void 0),wt(xt(r),"connectorOverlays",void 0),wt(xt(r),"connectorStyle",void 0),wt(xt(r),"connectorHoverStyle",void 0),wt(xt(r),"deleteOnEmpty",void 0),wt(xt(r),"uuid",void 0),wt(xt(r),"scope",void 0),wt(xt(r),"_anchor",void 0),wt(xt(r),"defaultLabelLocation",[.5,.5]),r.appendToDefaultType({edgeType:i.edgeType,maxConnections:null==i.maxConnections?r.instance.defaults.maxConnections:i.maxConnections,paintStyle:i.paintStyle||r.instance.defaults.endpointStyle,hoverPaintStyle:i.hoverPaintStyle||r.instance.defaults.endpointHoverStyle,connectorStyle:i.connectorStyle,connectorHoverStyle:i.connectorHoverStyle,connectorClass:i.connectorClass,connectorHoverClass:i.connectorHoverClass,connectorOverlays:i.connectorOverlays,connector:i.connector}),r.enabled=!(!1===i.enabled),r.visible=!0,r.element=i.element,r.uuid=i.uuid,r.portId=i.portId,r.elementId=i.elementId,r.connectionCost=null==i.connectionCost?1:i.connectionCost,r.connectionsDirected=i.connectionsDirected,r.currentAnchorClass="",r.events={},r.connectorOverlays=i.connectorOverlays,r.connectorStyle=i.connectorStyle,r.connectorHoverStyle=i.connectorHoverStyle,r.connector=i.connector,r.edgeType=i.edgeType,r.connectorClass=i.connectorClass,r.connectorHoverClass=i.connectorHoverClass,r.deleteOnEmpty=!0===i.deleteOnEmpty,r.isSource=i.source||!1,r.isTemporarySource=i.isTemporarySource||!1,r.isTarget=i.target||!1,r.connections=i.connections||[],r.scope=i.scope||t.defaultScope,r.timestamp=null,r.reattachConnections=i.reattachConnections||t.defaults.reattachConnections,r.connectionsDetachable=t.defaults.connectionsDetachable,!1===i.connectionsDetachable&&(r.connectionsDetachable=!1),r.dragAllowedWhenFull=!1!==i.dragAllowedWhenFull,i.onMaxConnections&&r.bind(me,i.onMaxConnections);var o=i.endpoint||i.existingEndpoint||t.defaults.endpoint;if(r.setEndpoint(o),null!=i.preparedAnchor)r.setPreparedAnchor(i.preparedAnchor);else{var a=i.anchor?i.anchor:i.anchors?i.anchors:t.defaults.anchor||et.Top;r.setAnchor(a)}var s=[ht,i.type||""].join(" ");return r.addType(s,i.data),r}return Et(n,[{key:"getIdPrefix",value:function(){return"_jsplumb_e"}},{key:"getTypeDescriptor",value:function(){return"endpoint"}},{key:"getXY",value:function(){return{x:this.endpoint.x,y:this.endpoint.y}}},{key:"getDefaultOverlayKey",value:function(){return"endpointOverlays"}},{key:"_updateAnchorClass",value:function(){var t=this._anchor&&this._anchor.cssClass;if(null!=t&&t.length>0){var e=this.instance.endpointAnchorClassPrefix+"-"+this.currentAnchorClass;this.currentAnchorClass=t;var n=this.instance.endpointAnchorClassPrefix+(this.currentAnchorClass?"-"+this.currentAnchorClass:"");e!==n&&(this.removeClass(e),this.addClass(n),this.instance.removeClass(this.element,e),this.instance.addClass(this.element,n))}}},{key:"setPreparedAnchor",value:function(t){return this.instance.router.setAnchor(this,t),this._updateAnchorClass(),this}},{key:"_anchorLocationChanged",value:function(t){this.fire("anchor:changed",{endpoint:this,anchor:t}),this._updateAnchorClass()}},{key:"setAnchor",value:function(t){var e=this.instance.router.prepareAnchor(t);return this.setPreparedAnchor(e),this}},{key:"addConnection",value:function(t){this.connections.push(t),this.instance._refreshEndpoint(this)}},{key:"detachFromConnection",value:function(t,e,n){(e=null==e?this.connections.indexOf(t):e)>=0&&(this.connections.splice(e,1),this.instance._refreshEndpoint(this)),!n&&this.deleteOnEmpty&&0===this.connections.length&&this.instance.deleteEndpoint(this)}},{key:"deleteEveryConnection",value:function(t){for(var e=this.connections.length,n=0;n<e;n++)this.instance.deleteConnection(this.connections[0],t)}},{key:"detachFrom",value:function(t){for(var e=[],n=0;n<this.connections.length;n++)this.connections[n].endpoints[1]!==t&&this.connections[n].endpoints[0]!==t||e.push(this.connections[n]);for(var i=0,r=e.length;i<r;i++)this.instance.deleteConnection(e[0]);return this}},{key:"setVisible",value:function(t,e,i){if(St(Ot(n.prototype),"setVisible",this).call(this,t),this.endpoint.setVisible(t),t?this.showOverlays():this.hideOverlays(),!e)for(var r=0;r<this.connections.length;r++)if(this.connections[r].setVisible(t),!i){var o=this===this.connections[r].endpoints[0]?1:0;1===this.connections[r].endpoints[o].connections.length&&this.connections[r].endpoints[o].setVisible(t,!0,!0)}}},{key:"applyType",value:function(t,e){St(Ot(n.prototype),"applyType",this).call(this,t,e),this.setPaintStyle(t.endpointStyle||t.paintStyle),this.setHoverPaintStyle(t.endpointHoverStyle||t.hoverPaintStyle),this.connectorStyle=t.connectorStyle,this.connectorHoverStyle=t.connectorHoverStyle,this.connector=t.connector,this.connectorOverlays=t.connectorOverlays,this.edgeType=t.edgeType,null!=t.maxConnections&&(this.maxConnections=t.maxConnections),t.scope&&(this.scope=t.scope),f(t,Pn),this.instance.applyEndpointType(this,t)}},{key:"destroy",value:function(){St(Ot(n.prototype),"destroy",this).call(this),this.deleted=!0,null!=this.endpoint&&this.instance.destroyEndpoint(this)}},{key:"isFull",value:function(){return 0===this.maxConnections||!(this.isFloating()||this.maxConnections<0||this.connections.length<this.maxConnections)}},{key:"isFloating",value:function(){return this.instance.router.isFloating(this)}},{key:"isConnectedTo",value:function(t){var e=!1;if(t)for(var n=0;n<this.connections.length;n++)if(this.connections[n].endpoints[1]===t||this.connections[n].endpoints[0]===t){e=!0;break}return e}},{key:"setDragAllowedWhenFull",value:function(t){this.dragAllowedWhenFull=t}},{key:"getUuid",value:function(){return this.uuid}},{key:"connectorSelector",value:function(){return this.connections[0]}},{key:"prepareEndpoint",value:function(t,e){var n,i={cssClass:this.cssClass,endpoint:this};if(q(t,Rt)){var r=t;(n=Dt.clone(r)).classes=i.cssClass.split(" ")}else if(h(t))n=Dt.get(this,t,i);else{var o=t;f(i,o.options||{}),n=Dt.get(this,o.type,i)}return n.typeId=e,n}},{key:"setEndpoint",value:function(t){var e=this.prepareEndpoint(t);this.setPreparedEndpoint(e)}},{key:"setPreparedEndpoint",value:function(t){null!=this.endpoint&&this.instance.destroyEndpoint(this),this.endpoint=t}},{key:"addClass",value:function(t,e){St(Ot(n.prototype),"addClass",this).call(this,t,e),null!=this.endpoint&&this.endpoint.addClass(t)}},{key:"removeClass",value:function(t,e){St(Ot(n.prototype),"removeClass",this).call(this,t,e),null!=this.endpoint&&this.endpoint.removeClass(t)}}]),n}(),Cn=function t(e,n){bt(this,t),this.instance=e,this.el=n,wt(this,"group",void 0)},jn=function(t){_t(n,Cn);var e=At(n);function n(t,i,r){var o;bt(this,n),(o=e.call(this,t,i)).instance=t,wt(xt(o),"children",[]),wt(xt(o),"collapsed",!1),wt(xt(o),"droppable",void 0),wt(xt(o),"enabled",void 0),wt(xt(o),"orphan",void 0),wt(xt(o),"constrain",void 0),wt(xt(o),"proxied",void 0),wt(xt(o),"ghost",void 0),wt(xt(o),"revert",void 0),wt(xt(o),"prune",void 0),wt(xt(o),"dropOverride",void 0),wt(xt(o),"anchor",void 0),wt(xt(o),"endpoint",void 0),wt(xt(o),"connections",{source:[],target:[],internal:[]}),wt(xt(o),"manager",void 0),wt(xt(o),"id",void 0),wt(xt(o),"elId",void 0);var a=o.el;return a._isJsPlumbGroup=!0,a._jsPlumbGroup=xt(o),o.elId=t.getId(i),o.orphan=!0===r.orphan,o.revert=!0!==o.orphan&&!1!==r.revert,o.droppable=!1!==r.droppable,o.ghost=!0===r.ghost,o.enabled=!1!==r.enabled,o.prune=!0!==o.orphan&&!0===r.prune,o.constrain=o.ghost||!0===r.constrain,o.proxied=!1!==r.proxied,o.id=r.id||D(),o.dropOverride=!0===r.dropOverride,o.anchor=r.anchor,o.endpoint=r.endpoint,o.anchor=r.anchor,t.setAttribute(i,ie,""),o}return Et(n,[{key:"contentArea",get:function(){return this.instance.getGroupContentArea(this)}},{key:"overrideDrop",value:function(t,e){return this.dropOverride&&(this.revert||this.prune||this.orphan)}},{key:"getAnchor",value:function(t,e){return this.anchor||"Continuous"}},{key:"getEndpoint",value:function(t,e){return this.endpoint||{type:Lt.type,options:{radius:10}}}},{key:"add",value:function(t,e){var n=this.instance.getGroupContentArea(this),i=t;if(null!=i._jsPlumbParentGroup){if(i._jsPlumbParentGroup===this)return;i._jsPlumbParentGroup.remove(t,!0,e,!1)}i._jsPlumbParentGroup=this,this.children.push(new Cn(this.instance,t)),this.instance._appendElement(i,n),this.manager._updateConnectionsForGroup(this)}},{key:"resolveNode",value:function(t){return null==t?null:A(this.children,(function(e){return e.el===t}))}},{key:"remove",value:function(t,e,n,i,r){var o=this.resolveNode(t);null!=o&&this._doRemove(o,e,n,i,r)}},{key:"_doRemove",value:function(t,e,n,i,r){var o=t.el;if(delete o._jsPlumbParentGroup,I(this.children,(function(e){return e===t})),e)try{this.instance.getGroupContentArea(this).removeChild(o)}catch(t){V("Could not remove element from Group "+t)}if(!n){var a={group:this,el:o};r&&(a.targetGroup=r),this.instance.fire("group:member:removed",a)}i||this.manager._updateConnectionsForGroup(this)}},{key:"removeAll",value:function(t,e){for(var n=0,i=this.children.length;n<i;n++){var r=this.children[0];this._doRemove(r,t,e,!0),this.instance.unmanage(r.el,!0)}this.children.length=0,this.manager._updateConnectionsForGroup(this)}},{key:"orphanAll",value:function(){for(var t={},e=0;e<this.children.length;e++){var n=this.manager.orphan(this.children[e].el,!1);t[n.id]=n.pos}return this.children.length=0,t}},{key:"addGroup",value:function(t){if(this.instance.allowNestedGroups&&t!==this){if(this.instance.groupManager.isAncestor(this,t))return!1;null!=t.group&&t.group.removeGroup(t);var e=this.instance.getId(t.el);this.instance.getManagedElements()[e].group=this.elId;var n=this.instance.getOffsetRelativeToRoot(t.el),i=this.collapsed?this.instance.getOffsetRelativeToRoot(this.el):this.instance.getOffsetRelativeToRoot(this.instance.getGroupContentArea(this));t.el._jsPlumbParentGroup=this,this.children.push(t),this.instance._appendElementToGroup(this,t.el),t.group=this;var r={x:n.x-i.x,y:n.y-i.y};return this.instance.setPosition(t.el,r),this.instance.fire("group:nested:added",{parent:this,child:t}),!0}return!1}},{key:"removeGroup",value:function(t){if(t.group===this){var e=t.el,n=this.instance.getGroupContentArea(this);n===e.parentNode&&n.removeChild(t.el);var i=this.instance.getId(t.el),r=this.instance.getManagedElements()[i];r&&delete r.group,this.children=this.children.filter((function(e){return e.id!==t.id})),delete t.group,delete e._jsPlumbParentGroup,this.instance.fire("group:nested:removed",{parent:this,child:t})}}},{key:"getGroups",value:function(){return this.children.filter((function(t){return t.constructor===n}))}},{key:"getNodes",value:function(){return this.children.filter((function(t){return t.constructor===Cn}))}},{key:"collapseParent",get:function(){var t=null;if(null==this.group)return null;for(var e=this.group;null!=e;)e.collapsed&&(t=e),e=e.group;return t}}]),n}(),Mn=function(){function t(e){var n=this;bt(this,t),this.instance=e,wt(this,"groupMap",{}),wt(this,"_connectionSourceMap",{}),wt(this,"_connectionTargetMap",{}),e.bind(ge,(function(t){var e=n.getGroupFor(t.source),i=n.getGroupFor(t.target);null!=e&&null!=i&&e===i?(n._connectionSourceMap[t.connection.id]=e,n._connectionTargetMap[t.connection.id]=e,C(e.connections.internal,t.connection)):(null!=e&&(t.target._jsPlumbGroup===e?C(e.connections.internal,t.connection):C(e.connections.source,t.connection),n._connectionSourceMap[t.connection.id]=e),null!=i&&(t.source._jsPlumbGroup===i?C(i.connections.internal,t.connection):C(i.connections.target,t.connection),n._connectionTargetMap[t.connection.id]=i))})),e.bind(be,(function(t){n._cleanupDetachedConnection(t.connection)})),e.bind(ve,(function(t){var e=t.originalEndpoint.element,i=n.getGroupFor(e),r=t.connection.endpoints[t.index].element,o=n.getGroupFor(r),a=0===t.index?n._connectionSourceMap:n._connectionTargetMap,s=0===t.index?n._connectionTargetMap:n._connectionSourceMap;null!=o?(a[t.connection.id]=o,t.connection.source===t.connection.target&&(s[t.connection.id]=o)):(delete a[t.connection.id],t.connection.source===t.connection.target&&delete s[t.connection.id]),null!=i&&n._updateConnectionsForGroup(i),null!=o&&n._updateConnectionsForGroup(o)}))}return Et(t,[{key:"_cleanupDetachedConnection",value:function(t){t.proxies.length=0;var e,n=this._connectionSourceMap[t.id];null!=n&&(e=function(e){return e.id===t.id},I(n.connections.source,e),I(n.connections.target,e),I(n.connections.internal,e),delete this._connectionSourceMap[t.id]),null!=(n=this._connectionTargetMap[t.id])&&(e=function(e){return e.id===t.id},I(n.connections.source,e),I(n.connections.target,e),I(n.connections.internal,e),delete this._connectionTargetMap[t.id])}},{key:"addGroup",value:function(t){var e=t.el;if(null!=this.groupMap[t.id])throw new Error("cannot create Group ["+t.id+"]; a Group with that ID exists");if(null!=e._isJsPlumbGroup)throw new Error("cannot create Group ["+t.id+"]; the given element is already a Group");var n=new jn(this.instance,t.el,t);return this.groupMap[n.id]=n,t.collapsed&&this.collapseGroup(n),this.instance.manage(n.el),this.instance.addClass(n.el,pe),n.manager=this,this._updateConnectionsForGroup(n),this.instance.fire("group:added",{group:n}),n}},{key:"getGroup",value:function(t){var e=t;if(h(t)&&null==(e=this.groupMap[t]))throw new Error("No such group ["+t+"]");return e}},{key:"getGroupFor",value:function(t){for(var e=t,n=this.instance.getContainer(),i=!1,r=null;!i;)null==e||e===n?i=!0:e._jsPlumbParentGroup?(r=e._jsPlumbParentGroup,i=!0):e=e.parentNode;return r}},{key:"getGroups",value:function(){var t=[];for(var e in this.groupMap)t.push(this.groupMap[e]);return t}},{key:"removeGroup",value:function(t,e,n,i){var r=this,o=this.getGroup(t);this.expandGroup(o,!0);var a={};return T(o.children,(function(t){var e=r.instance.getManagedElements()[r.instance.getId(t.el)];e&&delete e.group})),e?(T(o.getGroups(),(function(t){return r.removeGroup(t,e,n)})),o.removeAll(n,i)):(o.group&&T(o.children,(function(t){return o.group.add(t.el)})),a=o.orphanAll()),o.group&&o.group.removeGroup(o),this.instance.unmanage(o.el,!0),delete this.groupMap[o.id],this.instance.fire("group:removed",{group:o}),a}},{key:"removeAllGroups",value:function(t,e,n){for(var i in this.groupMap)this.removeGroup(this.groupMap[i],t,e,n)}},{key:"forEach",value:function(t){for(var e in this.groupMap)t(this.groupMap[e])}},{key:"orphan",value:function(t,e){var n=t;if(n._jsPlumbParentGroup){var i=n._jsPlumbParentGroup,r=this.instance.getId(n),o=this.instance.getOffset(t);return!0!==e&&i.group?this.instance._appendElementToGroup(i.group,t):this.instance._appendElementToContainer(t),this.instance.setPosition(t,o),delete n._jsPlumbParentGroup,{id:r,pos:o}}}},{key:"_updateConnectionsForGroup",value:function(t){var e=this;t.connections.source.length=0,t.connections.target.length=0,t.connections.internal.length=0;var n=t.children.slice().map((function(t){return t.el})),i=[];if(T(n,(function(t){Array.prototype.push.apply(i,e.instance.getSelector(t,Oe))})),Array.prototype.push.apply(n,i),n.length>0){var r,o,a=this.instance.getConnections({source:n,scope:yt},!0),s=this.instance.getConnections({target:n,scope:yt},!0),l={},u=function(n){for(var i=0;i<n.length;i++)l[n[i].id]||(l[n[i].id]=!0,r=e.getGroupFor(n[i].source),o=e.getGroupFor(n[i].target),n[i].source===t.el&&o===t||n[i].target===t.el&&r===t?t.connections.internal.push(n[i]):r===t?(o!==t?t.connections.source.push(n[i]):t.connections.internal.push(n[i]),e._connectionSourceMap[n[i].id]=t):o===t&&(t.connections.target.push(n[i]),e._connectionTargetMap[n[i].id]=t))};u(a),u(s)}}},{key:"_collapseConnection",value:function(t,e,n){var i=t.endpoints[0===e?1:0].element;if(i._jsPlumbParentGroup&&!i._jsPlumbParentGroup.proxied&&i._jsPlumbParentGroup.collapsed)return!1;var r=t.endpoints[0].element._jsPlumbParentGroup,o=null!=r?r.collapseParent||r:null,a=t.endpoints[1].element._jsPlumbParentGroup,s=null!=a?a.collapseParent||a:null;if(null==o||null==s||o.id!==s.id){var l=n.el;return this.instance.getId(l),this.instance.proxyConnection(t,e,l,(function(t,e){return n.getEndpoint(t,e)}),(function(t,e){return n.getAnchor(t,e)})),!0}return!1}},{key:"_expandConnection",value:function(t,e,n){this.instance.unproxyConnection(t,e)}},{key:"isElementDescendant",value:function(t,e){for(var n=this.instance.getContainer();;){if(null==t||t===n)return!1;if(t===e)return!0;t=t.parentNode}}},{key:"collapseGroup",value:function(t){var e=this,n=this.getGroup(t);if(null!=n&&!n.collapsed){var i=n.el;if(null==n.collapseParent){if(this.instance.setGroupVisible(n,!1),n.collapsed=!0,this.instance.removeClass(i,pe),this.instance.addClass(i,fe),n.proxied){var r=new Set,o=function(t,i){for(var o=0;o<t.length;o++){var a=t[o];!0===e._collapseConnection(a,i,n)&&r.add(a.id)}};o(n.connections.source,0),o(n.connections.target,1),T(n.getGroups(),(function(t){e.cascadeCollapse(n,t,r)}))}this.instance.revalidate(i),this.repaintGroup(n),this.instance.fire("group:collapse",{group:n})}else n.collapsed=!0,this.instance.removeClass(i,pe),this.instance.addClass(i,fe)}}},{key:"cascadeCollapse",value:function(t,e,n){var i=this;if(t.proxied){var r=function(e,r){for(var o=0;o<e.length;o++){var a=e[o];n.has(a.id)||!0===i._collapseConnection(a,r,t)&&n.add(a.id)}};r(e.connections.source,0),r(e.connections.target,1)}T(e.getGroups(),(function(e){i.cascadeCollapse(t,e,n)}))}},{key:"expandGroup",value:function(t,e){var n=this,i=this.getGroup(t);if(null!=i){var r=i.el;if(null==i.collapseParent){if(this.instance.setGroupVisible(i,!0),i.collapsed=!1,this.instance.addClass(r,pe),this.instance.removeClass(r,fe),i.proxied){var o=function(t,e){for(var r=0;r<t.length;r++){var o=t[r];n._expandConnection(o,e,i)}};o(i.connections.source,0),o(i.connections.target,1);T(i.getGroups(),(function t(e,i){if(i||e.collapsed){var r=function(t,i){for(var r=0;r<t.length;r++){var o=t[r];n._collapseConnection(o,i,e.collapseParent||e)}};r(e.connections.source,0),r(e.connections.target,1),T(e.connections.internal,(function(t){return t.setVisible(!1)})),T(e.getGroups(),(function(e){return t(e,!0)}))}else n.expandGroup(e,!0)}))}this.instance.revalidate(r),this.repaintGroup(i),e||this.instance.fire("group:expand",{group:i})}else i.collapsed=!1,this.instance.addClass(r,pe),this.instance.removeClass(r,fe)}}},{key:"toggleGroup",value:function(t){null!=(t=this.getGroup(t))&&(t.collapsed?this.expandGroup(t):this.collapseGroup(t))}},{key:"repaintGroup",value:function(t){for(var e=this.getGroup(t).children,n=0;n<e.length;n++)this.instance.revalidate(e[n].el)}},{key:"addToGroup",value:function(t,e){var n=this,i=this.getGroup(t);if(i){for(var r=i.el,o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];T(a,(function(t){var o=t,a=null!=o._isJsPlumbGroup,s=o._jsPlumbGroup,l=o._jsPlumbParentGroup;if(l!==i){var u=n.instance.manage(t),c=n.instance.getOffset(t),d=i.collapsed?n.instance.getOffsetRelativeToRoot(r):n.instance.getOffset(n.instance.getGroupContentArea(i));u.group=i.elId,null!=l&&(l.remove(t,!1,e,!1,i),n._updateConnectionsForGroup(l)),a?i.addGroup(s):i.add(t,e);var f=function(t,e){var r=0===e?1:0;t.each((function(t){t.setVisible(!1),t.endpoints[r].element._jsPlumbGroup===i?(t.endpoints[r].setVisible(!1),n._expandConnection(t,r,i)):(t.endpoints[e].setVisible(!1),n._collapseConnection(t,e,i))}))};i.collapsed&&(f(n.instance.select({source:t}),0),f(n.instance.select({target:t}),1)),n.instance.getId(t);var p={x:c.x-d.x,y:c.y-d.y};if(n.instance.setPosition(t,p),n._updateConnectionsForGroup(i),n.instance.revalidate(t),!e){var h={group:i,el:t,pos:p};l&&(h.sourceGroup=l),n.instance.fire("group:member:added",h)}}}))}}},{key:"removeFromGroup",value:function(t,e){var n=this,i=this.getGroup(t);if(i){for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];T(o,(function(t){if(i.collapsed){var r=function(e,r){for(var o=0;o<e.length;o++){var a=e[o];if(a.proxies)for(var s=0;s<a.proxies.length;s++)if(null!=a.proxies[s]){var l=a.proxies[s].originalEp.element;(l===t||n.isElementDescendant(l,t))&&n._expandConnection(a,r,i)}}};r(i.connections.source.slice(),0),r(i.connections.target.slice(),1)}i.remove(t,null,e);var o=n.instance.getManagedElements()[n.instance.getId(t)];o&&delete o.group}))}}},{key:"getAncestors",value:function(t){for(var e=[],n=t.group;null!=n;)e.push(n),n=n.group;return e}},{key:"isAncestor",value:function(t,e){return null!=t&&null!=e&&-1!==this.getAncestors(t).indexOf(e)}},{key:"getDescendants",value:function(t){var e=[];return function t(n){var i=n.getGroups();e.push.apply(e,kt(i)),T(i,t)}(t),e}},{key:"isDescendant",value:function(t,e){return null!=t&&null!=e&&-1!==this.getDescendants(e).indexOf(t)}},{key:"reset",value:function(){this._connectionSourceMap={},this._connectionTargetMap={},this.groupMap={}}}]),t}(),Dn=function(){function t(e,n){bt(this,t),this.instance=e,this.entries=n}return Et(t,[{key:"length",get:function(){return this.entries.length}},{key:"each",value:function(t){return T(this.entries,(function(e){return t(e)})),this}},{key:"get",value:function(t){return this.entries[t]}},{key:"addClass",value:function(t,e){return this.each((function(n){return n.addClass(t,e)})),this}},{key:"removeClass",value:function(t,e){return this.each((function(n){return n.removeClass(t,e)})),this}},{key:"removeAllOverlays",value:function(){return this.each((function(t){return t.removeAllOverlays()})),this}},{key:"setLabel",value:function(t){return this.each((function(e){return e.setLabel(t)})),this}},{key:"clear",value:function(){return this.entries.length=0,this}},{key:"map",value:function(t){var e=[];return this.each((function(n){return e.push(t(n))})),e}},{key:"addOverlay",value:function(t){return this.each((function(e){return e.addOverlay(t)})),this}},{key:"removeOverlay",value:function(t){return this.each((function(e){return e.removeOverlay(t)})),this}},{key:"removeOverlays",value:function(){return this.each((function(t){return t.removeOverlays()})),this}},{key:"showOverlay",value:function(t){return this.each((function(e){return e.showOverlay(t)})),this}},{key:"hideOverlay",value:function(t){return this.each((function(e){return e.hideOverlay(t)})),this}},{key:"setPaintStyle",value:function(t){return this.each((function(e){return e.setPaintStyle(t)})),this}},{key:"setHoverPaintStyle",value:function(t){return this.each((function(e){return e.setHoverPaintStyle(t)})),this}},{key:"setSuspendEvents",value:function(t){return this.each((function(e){return e.setSuspendEvents(t)})),this}},{key:"setParameter",value:function(t,e){return this.each((function(n){return n.parameters[t]=e})),this}},{key:"setParameters",value:function(t){return this.each((function(e){return e.parameters=t})),this}},{key:"setVisible",value:function(t){return this.each((function(e){return e.setVisible(t)})),this}},{key:"addType",value:function(t){return this.each((function(e){return e.addType(t)})),this}},{key:"toggleType",value:function(t){return this.each((function(e){return e.toggleType(t)})),this}},{key:"removeType",value:function(t){return this.each((function(e){return e.removeType(t)})),this}},{key:"bind",value:function(t,e){return this.each((function(n){return n.bind(t,e)})),this}},{key:"unbind",value:function(t,e){return this.each((function(n){return n.unbind(t,e)})),this}},{key:"setHover",value:function(t){var e=this;return this.each((function(n){return e.instance.setHover(n,t)})),this}}]),t}(),Rn=function(t){_t(n,Dn);var e=At(n);function n(){return bt(this,n),e.apply(this,arguments)}return Et(n,[{key:"setEnabled",value:function(t){return this.each((function(e){return e.enabled=t})),this}},{key:"setAnchor",value:function(t){return this.each((function(e){return e.setAnchor(t)})),this}},{key:"deleteEveryConnection",value:function(){return this.each((function(t){return t.deleteEveryConnection()})),this}},{key:"deleteAll",value:function(){var t=this;return this.each((function(e){return t.instance.deleteEndpoint(e)})),this.clear(),this}}]),n}(),Ln=function(t){_t(n,Dn);var e=At(n);function n(){return bt(this,n),e.apply(this,arguments)}return Et(n,[{key:"setDetachable",value:function(t){return this.each((function(e){return e.setDetachable(t)})),this}},{key:"setReattach",value:function(t){return this.each((function(e){return e.setReattach(t)})),this}},{key:"setConnector",value:function(t){return this.each((function(e){return e._setConnector(t)})),this}},{key:"deleteAll",value:function(){var t=this;this.each((function(e){return t.instance.deleteConnection(e)})),this.clear()}},{key:"repaint",value:function(){var t=this;return this.each((function(e){return t.instance._paintConnection(e)})),this}}]),n}(),Yn=function t(){bt(this,t),wt(this,"affectedElements",new Set)};function Vn(){return{x:0,y:0,w:0,h:0,r:0,c:{x:0,y:0},x2:0,y2:0,t:{x:0,y:0,c:{x:0,y:0},w:0,h:0,r:0,x2:0,y2:0,cr:0,sr:0},dirty:!0}}var Bn=function(t,e){var n=0;return e[1]>t[1]?n=-1:e[1]<t[1]&&(n=1),n},$n=function(t,e){return-1*Bn(t,e)};function Fn(t,e,n,i){!function(t,e,n,i){if(0===e.length)e.push(t);else{for(var r=i?-1:1,o=0,a=e.length,s=Math.floor((o+a)/2);a>o;)n(t,e[s])*r<0?a=s:o=s+1,s=Math.floor((o+a)/2);e.splice(s,0,t)}}([t,e],n,Bn,i)}function Gn(t,e){var n=x(e,(function(e){return e[0]===t}));n>-1&&e.splice(n,1)}var qn,Un=function(t){_t(n,Q);var e=At(n);function n(t){var i;return bt(this,n),(i=e.call(this)).instance=t,wt(xt(i),"_currentTransaction",null),wt(xt(i),"_sortedElements",{xmin:[],xmax:[],ymin:[],ymax:[]}),wt(xt(i),"_elementMap",new Map),wt(xt(i),"_transformedElementMap",new Map),wt(xt(i),"_bounds",{minx:0,maxx:0,miny:0,maxy:0}),i}return Et(n,[{key:"_updateBounds",value:function(t,e,n){null!=e&&(Gn(t,this._sortedElements.xmin),Gn(t,this._sortedElements.xmax),Gn(t,this._sortedElements.ymin),Gn(t,this._sortedElements.ymax),Fn(t,e.t.x,this._sortedElements.xmin,!1),Fn(t,e.t.x+e.t.w,this._sortedElements.xmax,!0),Fn(t,e.t.y,this._sortedElements.ymin,!1),Fn(t,e.t.y+e.t.h,this._sortedElements.ymax,!0),!0!==n&&this._recalculateBounds())}},{key:"_recalculateBounds",value:function(){this._bounds.minx=this._sortedElements.xmin.length>0?this._sortedElements.xmin[0][1]:0,this._bounds.maxx=this._sortedElements.xmax.length>0?this._sortedElements.xmax[0][1]:0,this._bounds.miny=this._sortedElements.ymin.length>0?this._sortedElements.ymin[0][1]:0,this._bounds.maxy=this._sortedElements.ymax.length>0?this._sortedElements.ymax[0][1]:0}},{key:"recomputeBounds",value:function(){var t=this;this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.forEach((function(e,n){t._sortedElements.xmin.push([n,e.t.x]),t._sortedElements.xmax.push([n,e.t.x+e.t.w]),t._sortedElements.ymin.push([n,e.t.y]),t._sortedElements.ymax.push([n,e.t.y+e.t.h])})),this._sortedElements.xmin.sort(Bn),this._sortedElements.ymin.sort(Bn),this._sortedElements.xmax.sort($n),this._sortedElements.ymax.sort($n),this._recalculateBounds()}},{key:"_finaliseUpdate",value:function(t,e,n){e.t=function(t,e,n,i,r){var o=t+n/2,a=e+i/2,s=Math.cos(r/360*Math.PI*2),l=Math.sin(r/360*Math.PI*2),u=function(t,e){return{x:o+Math.round((t-o)*s-(e-a)*l),y:a+Math.round((e-a)*s-(t-o)*l)}},c=u(t,e),d=u(t+n,e),f=u(t+n,e+i),p=u(t,e+i),h=u(t+n/2,e+i/2),g=Math.min(c.x,d.x,f.x,p.x),v=Math.max(c.x,d.x,f.x,p.x),y=Math.min(c.y,d.y,f.y,p.y),b=Math.max(c.y,d.y,f.y,p.y);return{x:g,y:y,w:v-g,h:b-y,c:h,r:r,x2:v,y2:b,cr:s,sr:l}}(e.x,e.y,e.w,e.h,e.r),this._transformedElementMap.set(t,e.t),!0!==n&&this._updateBounds(t,e,n)}},{key:"shouldFireEvent",value:function(t,e,n){return!0}},{key:"startTransaction",value:function(){if(null!=this._currentTransaction)throw new Error("Viewport: cannot start transaction; a transaction is currently active.");this._currentTransaction=new Yn}},{key:"endTransaction",value:function(){var t=this;null!=this._currentTransaction&&(this._currentTransaction.affectedElements.forEach((function(e){var n=t.getPosition(e);t._finaliseUpdate(e,n,!0)})),this.recomputeBounds(),this._currentTransaction=null)}},{key:"updateElements",value:function(t){var e=this;T(t,(function(t){return e.updateElement(t.id,t.x,t.y,t.width,t.height,t.rotation)}))}},{key:"updateElement",value:function(t,e,n,i,r,o,a){var s=G(this._elementMap,t,Vn);return s.dirty=null==e&&null==s.x||null==n&&null==s.y||null==i&&null==s.w||null==r&&null==s.h,null!=e&&(s.x=e),null!=n&&(s.y=n),null!=i&&(s.w=i),null!=r&&(s.h=r),null!=o&&(s.r=o||0),s.c.x=s.x+s.w/2,s.c.y=s.y+s.h/2,s.x2=s.x+s.w,s.y2=s.y+s.h,null==this._currentTransaction?this._finaliseUpdate(t,s,a):this._currentTransaction.affectedElements.add(t),s}},{key:"refreshElement",value:function(t,e){var n=this.instance.getManagedElements(),i=n[t]?n[t].el:null;if(null!=i){var r=this.getSize(i),o=this.getOffset(i);return this.updateElement(t,o.x,o.y,r.w,r.h,null,e)}return null}},{key:"getSize",value:function(t){return this.instance.getSize(t)}},{key:"getOffset",value:function(t){return this.instance.getOffset(t)}},{key:"registerElement",value:function(t,e){return this.updateElement(t,0,0,0,0,0,e)}},{key:"addElement",value:function(t,e,n,i,r,o){return this.updateElement(t,e,n,i,r,o)}},{key:"rotateElement",value:function(t,e){var n=G(this._elementMap,t,Vn);return n.r=e||0,this._finaliseUpdate(t,n),n}},{key:"getBoundsWidth",value:function(){return this._bounds.maxx-this._bounds.minx}},{key:"getBoundsHeight",value:function(){return this._bounds.maxy-this._bounds.miny}},{key:"getX",value:function(){return this._bounds.minx}},{key:"getY",value:function(){return this._bounds.miny}},{key:"setSize",value:function(t,e,n){if(this._elementMap.has(t))return this.updateElement(t,null,null,e,n,null)}},{key:"setPosition",value:function(t,e,n){if(this._elementMap.has(t))return this.updateElement(t,e,n,null,null,null)}},{key:"reset",value:function(){this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.clear(),this._transformedElementMap.clear(),this._recalculateBounds()}},{key:"remove",value:function(t){Gn(t,this._sortedElements.xmin),Gn(t,this._sortedElements.xmax),Gn(t,this._sortedElements.ymin),Gn(t,this._sortedElements.ymax),this._elementMap.delete(t),this._transformedElementMap.delete(t),this._recalculateBounds()}},{key:"getPosition",value:function(t){return this._elementMap.get(t)}},{key:"getElements",value:function(){return this._elementMap}},{key:"isEmpty",value:function(){return 0===this._elementMap.size}}]),n}();function zn(t,e){return e.theta-t.theta}function Jn(t,e){return(t.theta<0?-Math.PI-t.theta:Math.PI-t.theta)-(e.theta<0?-Math.PI-e.theta:Math.PI-e.theta)}var Wn=(wt(qn={},Xe,Jn),wt(qn,Ke,zn),wt(qn,Qe,zn),wt(qn,Ze,Jn),qn);function Hn(t){return!0===t.isContinuous}function Xn(t){return!0===t.isContinuous}function Zn(t){return t.locations.length>1}function Kn(t){return[t.currentLocation,t.locations[t.currentLocation]]}var Qn=function(){function t(e){var n=this;bt(this,t),this.instance=e,wt(this,"anchorLists",new Map),wt(this,"anchorLocations",new Map),e.bind(be,(function(t){t.sourceEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(t.sourceEndpoint),t.targetEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(t.targetEndpoint)})),e.bind(ye,(function(t){n._removeEndpointFromAnchorLists(t)}))}return Et(t,[{key:"getAnchorOrientation",value:function(t){var e=this.anchorLocations.get(t.id);return e?[e.ox,e.oy]:[0,0]}},{key:"_distance",value:function(t,e,n,i,r,o,a){var s=i.x+t.x*r.w,l=i.y+t.y*r.h,u=i.x+r.w/2,c=i.y+r.h/2;if(null!=o&&o.length>0){var d=this.instance._applyRotations([s,l,0,0],o);s=d.x,l=d.y}return Math.sqrt(Math.pow(e-s,2)+Math.pow(n-l,2))+Math.sqrt(Math.pow(u-s,2)+Math.pow(c-l,2))}},{key:"_anchorSelector",value:function(t,e,n,i,r,o,a){for(var s=n.x+i.w/2,l=n.y+i.h/2,u=-1,c=1/0,d=0;d<a.length;d++){var f=this._distance(a[d],s,l,t,e,r,o);f<c&&(u=d+0,c=f)}return[u,a[u]]}},{key:"_floatingAnchorCompute",value:function(t,e){var n=e.xy,i={curX:n.x+t.size.w/2,curY:n.y+t.size.h/2,x:0,y:0,ox:0,oy:0};return this._setComputedPosition(t,i)}},{key:"_setComputedPosition",value:function(t,e,n){return this.anchorLocations.set(t.id,e),t.computedPosition=e,n&&(t.timestamp=n),e}},{key:"_computeSingleLocation",value:function(t,e,n,i){var r,o=i.rotation,a={curX:e.x+t.x*n.w+t.offx,curY:e.y+t.y*n.h+t.offy,x:t.x,y:t.y,ox:0,oy:0};if(null!=o&&o.length>0){var s=[t.iox,t.ioy],l={x:a.curX,y:a.curY,cr:0,sr:0};T(o,(function(t){l=R(l,t.c,t.r);var e=[Math.round(s[0]*l.cr-s[1]*l.sr),Math.round(s[1]*l.cr+s[0]*l.sr)];s=e.slice()})),t.ox=s[0],t.oy=s[1],r={curX:l.x,curY:l.y,x:t.x,y:t.y,ox:s[0],oy:s[1]}}else t.ox=t.iox,t.oy=t.ioy,r=f({ox:t.iox,oy:t.ioy},a);return r}},{key:"_singleAnchorCompute",value:function(t,e){var n=e.xy,i=e.wh,r=e.timestamp,o=this.anchorLocations.get(t.id);if(null!=o&&r&&r===t.timestamp)return o;var a=It(Kn(t),2);a[0];var s=a[1];return o=this._computeSingleLocation(s,n,i,e),this._setComputedPosition(t,o,r)}},{key:"_defaultAnchorCompute",value:function(t,e){var n;if(1===t.locations.length)return this._singleAnchorCompute(t,e);var i=e.xy,r=e.wh,o=e.txy,a=e.twh,s=It(Kn(t),2),l=s[0],u=s[1];if(t.locked||null==o||null==a)n=this._computeSingleLocation(u,i,r,e);else{var c=It(this._anchorSelector(i,r,o,a,e.rotation,e.tRotation,t.locations),2),d=c[0],f=c[1];t.currentLocation=d,d!==l&&(t.cssClass=f.cls||t.cssClass,e.element._anchorLocationChanged(t)),n=this._computeSingleLocation(f,i,r,e)}return this._setComputedPosition(t,n,e.timestamp)}},{key:"_placeAnchors",value:function(t,e){var n=this,i=this.instance.viewport.getPosition(t),r=function(e,r,o,a,s,l){if(o.length>0)for(var u=o.sort(Wn[e]),c=function(t,e,n,i,r){for(var o=n?t.w:t.h,a=n?t.h:t.w,s=[],l=o/(e.length+1),u=0;u<e.length;u++){var c=(u+1)*l,d=i*a;r&&(c=o-c);var f=n?c:d,p=t.x+f,h=f/t.w,g=n?d:c,v=t.y+g,y=g/t.h;if(0!==t.r&&null!=t.r){var b=R({x:p,y:v},t.c,t.r);p=b.x,v=b.y}s.push({x:p,y:v,xLoc:h,yLoc:y,c:e[u].c})}return s}(i,u,a,s,e===Ke||e===Xe),d=0;d<c.length;d++){var f=c[d].c,p=f.endpoints[0].elementId===t?f.endpoints[0]:f.endpoints[1];n._setComputedPosition(p._anchor,{curX:c[d].x,curY:c[d].y,x:c[d].xLoc,y:c[d].yLoc,ox:l[0],oy:l[1]})}};r(Qe,0,e.bottom,!0,1,[0,1]),r(Xe,0,e.top,!0,0,[0,-1]),r(Ze,0,e.left,!1,0,[-1,0]),r(Ke,0,e.right,!1,1,[1,0])}},{key:"_updateAnchorList",value:function(t,e,n,i,r,o,a,s,l,u,c){var d,f=i.endpoints[a],p=f.id,h=[1,0][a],g={theta:e,order:n,c:i,b:r,elId:o,epId:p},v=t[l],y=f._continuousAnchorEdge?t[f._continuousAnchorEdge]:null;if(y){var b=x(y,(function(t){return t.epId===p}));if(-1!==b){y.splice(b,1);for(var m=0;m<y.length;m++)!0!==(d=y[m].c).placeholder&&u.add(d),c.add(y[m].c.endpoints[a]),c.add(y[m].c.endpoints[h])}}for(var E=0;E<v.length;E++)!0!==(d=v[E].c).placeholder&&u.add(d),c.add(v[E].c.endpoints[a]),c.add(v[E].c.endpoints[h]);var w=s?0:v.length;v.splice(w,0,g),f._continuousAnchorEdge=l}},{key:"_removeEndpointFromAnchorLists",value:function(t){var e=this.anchorLists.get(t.elementId),n=0;!function(t,e){if(t){var i=function(t){return t.epId===e};I(t.top,i),I(t.left,i),I(t.bottom,i),I(t.right,i),n+=t.top.length,n+=t.left.length,n+=t.bottom.length,n+=t.right.length}}(e,t.id),0===n&&this.anchorLists.delete(t.elementId),this.anchorLocations.delete(t._anchor.id)}},{key:"computeAnchorLocation",value:function(t,e){var n;return n=Hn(t)?this.anchorLocations.get(t.id)||{curX:0,curY:0,x:0,y:0,ox:0,oy:0}:Xn(t)?this._floatingAnchorCompute(t,e):this._defaultAnchorCompute(t,e),t.timestamp=e.timestamp,n}},{key:"computePath",value:function(t,e){var n=this.instance.viewport.getPosition(t.sourceId),i=this.instance.viewport.getPosition(t.targetId),r=t.endpoints[0],o=t.endpoints[1],a=this.getEndpointLocation(r,{xy:n,wh:n,element:r,timestamp:e,rotation:this.instance._getRotations(t.sourceId)}),s=this.getEndpointLocation(o,{xy:i,wh:i,element:o,timestamp:e,rotation:this.instance._getRotations(t.targetId)});t.connector.resetBounds(),t.connector.compute({sourcePos:a,targetPos:s,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1],strokeWidth:t.paintStyleInUse.strokeWidth,sourceInfo:n,targetInfo:i})}},{key:"getEndpointLocation",value:function(t,e){e=e||{};var n=t._anchor,i=this.anchorLocations.get(n.id);return(null==i||null!=e.timestamp&&n.timestamp!==e.timestamp)&&(i=this.computeAnchorLocation(n,e),this._setComputedPosition(n,i,e.timestamp)),i}},{key:"getEndpointOrientation",value:function(t){return t._anchor?this.getAnchorOrientation(t._anchor):[0,0]}},{key:"setAnchorOrientation",value:function(t,e){var n=this.anchorLocations.get(t.id);null!=n&&(n.ox=e[0],n.oy=e[1])}},{key:"isDynamicAnchor",value:function(t){return!!t._anchor&&(!Hn(t._anchor)&&t._anchor.locations.length>1)}},{key:"isFloating",value:function(t){return!!t._anchor&&Xn(t._anchor)}},{key:"prepareAnchor",value:function(t){return wn(t)}},{key:"redraw",value:function(t,e,n){var i=this,r=new Set,o=new Set,a=new Set;if(!this.instance._suspendDrawing){var s=this.instance.endpointsByElement[t]||[];e=e||D();for(var l,u,c={},d=0;d<s.length;d++)if(u=s[d],o.add(u),l=u._anchor,0===u.connections.length)Hn(l)&&(this.anchorLists.has(t)||this.anchorLists.set(t,{top:[],right:[],bottom:[],left:[]}),this._updateAnchorList(this.anchorLists.get(t),-Math.PI/2,0,{endpoints:[u,u],placeholder:!0},!1,t,0,!1,sn(l),r,o),a.add(t));else for(var f=0;f<u.connections.length;f++){var p=u.connections[f],h=p.sourceId,g=p.targetId,v=Hn(p.endpoints[0]._anchor),y=Hn(p.endpoints[1]._anchor);if(v||y){var b=[h,(p.endpoints[0]._anchor.faces||[]).join("-"),g,(p.endpoints[1]._anchor.faces||[]).join("-")].join("-"),m=c[b],E=p.sourceId===t?1:0;v&&!this.anchorLists.has(h)&&this.anchorLists.set(h,{top:[],right:[],bottom:[],left:[]}),y&&!this.anchorLists.has(g)&&this.anchorLists.set(g,{top:[],right:[],bottom:[],left:[]});var w=this.instance.viewport.getPosition(g),_=this.instance.viewport.getPosition(h);if(g===h&&(v||y))this._updateAnchorList(this.anchorLists.get(h),-Math.PI/2,0,p,!1,g,0,!1,Xe,r,o),this._updateAnchorList(this.anchorLists.get(g),-Math.PI/2,0,p,!1,h,1,!1,Xe,r,o);else{var O=this.instance._getRotations(h),T=this.instance._getRotations(g);m||(m=this._calculateOrientation(h,g,_,w,p.endpoints[0]._anchor,p.endpoints[1]._anchor,O,T),c[b]=m),v&&this._updateAnchorList(this.anchorLists.get(h),m.theta,0,p,!1,g,0,!1,m.a[0],r,o),y&&this._updateAnchorList(this.anchorLists.get(g),m.theta2,-1,p,!0,h,1,!0,m.a[1],r,o)}v&&a.add(h),y&&a.add(g),r.add(p),(v&&0===E||y&&1===E)&&o.add(p.endpoints[E])}else{var x=u.connections[f].endpoints[p.sourceId===t?1:0];if(Zn(x._anchor)){this.instance._paintEndpoint(x,{elementWithPrecedence:t,timestamp:e}),r.add(u.connections[f]);for(var A=0;A<x.connections.length;A++)x.connections[A]!==u.connections[f]&&r.add(x.connections[A])}else r.add(u.connections[f])}}a.forEach((function(t){i._placeAnchors(t,i.anchorLists.get(t))})),o.forEach((function(t){var n=i.instance.viewport.getPosition(t.elementId);i.instance._paintEndpoint(t,{timestamp:e,offset:n})})),r.forEach((function(t){i.instance._paintConnection(t,{timestamp:e})}))}return{c:r,e:o}}},{key:"reset",value:function(){this.anchorLocations.clear(),this.anchorLists.clear()}},{key:"setAnchor",value:function(t,e){null!=e&&(t._anchor=e)}},{key:"setConnectionAnchors",value:function(t,e){t.endpoints[0]._anchor=e[0],t.endpoints[1]._anchor=e[1]}},{key:"_calculateOrientation",value:function(t,e,n,i,r,o,a,s){var l=this;if(t===e)return{orientation:"identity",a:[Xe,Xe]};var u=Math.atan2(i.c.y-n.c.y,i.c.x-n.c.x),c=Math.atan2(n.c.y-i.c.y,n.c.x-i.c.x),d=[],f={};!function(t,e){for(var n=0;n<t.length;n++){var i;if(f[t[n]]=(wt(i={},Ze,{x:e[n][0].x,y:e[n][0].c.y}),wt(i,Ke,{x:e[n][0].x+e[n][0].w,y:e[n][0].c.y}),wt(i,Xe,{x:e[n][0].c.x,y:e[n][0].y}),wt(i,Qe,{x:e[n][0].c.x,y:e[n][0].y+e[n][0].h}),i),null!=e[n][1]&&e[n][1].length>0)for(var r in f[t[n]])f[t[n]][r]=l.instance._applyRotationsXY(f[t[n]][r],e[n][1])}}([Zt,Kt],[[n,a],[i,s]]);for(var p=[Xe,Ze,Ke,Qe],h=0;h<p.length;h++)for(var g=0;g<p.length;g++)d.push({source:p[h],target:p[g],dist:at(f.source[p[h]],f.target[p[g]])});d.sort((function(t,e){if(t.dist<e.dist)return-1;if(e.dist<t.dist)return 1;var n,i=(wt(n={},Ze,0),wt(n,Xe,1),wt(n,Ke,2),wt(n,Qe,3),n),r=i[t.source],o=i[e.source],a=i[t.target],s=i[e.target];return r<o?-1:o<r?1:a<s?-1:s<a?1:0}));for(var v=d[0].source,y=d[0].target,b=0;b<d.length&&(v=Hn(r)&&r.locked?r.currentFace:!r.isContinuous||un(r,d[b].source)?d[b].source:null,y=o.isContinuous&&o.locked?o.currentFace:!o.isContinuous||un(o,d[b].target)?d[b].target:null,null==v||null==y);b++);return r.isContinuous&&this.setCurrentFace(r,v),o.isContinuous&&this.setCurrentFace(o,y),{a:[v,y],theta:u,theta2:c}}},{key:"setCurrentFace",value:function(t,e,n){t.currentFace=e,n&&null!=t.lockedFace&&(t.lockedFace=t.currentFace)}},{key:"lock",value:function(t){t.locked=!0,Hn(t)&&(t.lockedFace=t.currentFace)}},{key:"unlock",value:function(t){t.locked=!1,Hn(t)&&(t.lockedFace=null)}},{key:"selectAnchorLocation",value:function(t,e){var n=x(t.locations,(function(t){return t.x===e.x&&t.y===e.y}));return-1!==n&&(t.currentLocation=n,!0)}},{key:"lockCurrentAxis",value:function(t){null!=t.currentFace&&(t.lockedAxis=t.currentFace===Ze||t.currentFace===Ke?tn:en)}},{key:"unlockCurrentAxis",value:function(t){t.lockedAxis=null}},{key:"anchorsEqual",value:function(t,e){if(!t||!e)return!1;var n=t.locations[t.currentLocation],i=e.locations[e.currentLocation];return n.x===i.x&&n.y===i.y&&n.offx===i.offx&&n.offy===i.offy&&n.ox===i.ox&&n.oy===i.oy}}]),t}(),ti=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];bt(this,t),this.selector=e,this.def=n,this.exclude=i,wt(this,"id",void 0),wt(this,"redrop",void 0),this.id=D(),this.redrop=n.def.redrop||ei}return Et(t,[{key:"setEnabled",value:function(t){this.def.enabled=t}},{key:"isEnabled",value:function(){return!1!==this.def.enabled}}]),t}(),ei="strict";function ni(t,e,n){var i=[],r=function(e){return h(e)?e:t.getId(e)};if(e)if("string"==typeof e){if("*"===e)return e;i.push(e)}else{var o;if(n)i=e;else if(null!=e.length)(o=i).push.apply(o,kt(kt(e).map(r)));else i.push(r(e))}return i}function ii(t,e,n){null!=e&&(e.connections.push(t),1===e.connections.length&&t.instance.addClass(t.source,t.instance.connectedClass)),null!=n&&(null!=e&&t.sourceId===t.targetId||(n.connections.push(t),1===n.connections.length&&t.instance.addClass(t.target,t.instance.connectedClass)))}function ri(t,e,n){if(null!=e){var i=e.connections.length;I(e.connections,(function(e){return t.id===e.id})),i>0&&0===e.connections.length&&t.instance.removeClass(t.source,t.instance.connectedClass)}if(null!=n){var r=n.connections.length;null!=e&&t.sourceId===t.targetId||I(n.connections,(function(e){return t.id===e.id})),r>0&&0===n.connections.length&&t.instance.removeClass(t.target,t.instance.connectedClass)}}var oi=function(t){_t(n,Q);var e=At(n);function n(t,i){var r;return bt(this,n),(r=e.call(this))._instanceIndex=t,wt(xt(r),"defaults",void 0),wt(xt(r),"_initialDefaults",{}),wt(xt(r),"isConnectionBeingDragged",!1),wt(xt(r),"currentlyDragging",!1),wt(xt(r),"hoverSuspended",!1),wt(xt(r),"_suspendDrawing",!1),wt(xt(r),"_suspendedAt",null),wt(xt(r),"connectorClass",ue),wt(xt(r),"connectorOutlineClass","jtk-connector-outline"),wt(xt(r),"connectedClass","jtk-connected"),wt(xt(r),"endpointClass",ce),wt(xt(r),"endpointConnectedClass","jtk-endpoint-connected"),wt(xt(r),"endpointFullClass","jtk-endpoint-full"),wt(xt(r),"endpointFloatingClass",de),wt(xt(r),"endpointDropAllowedClass","jtk-endpoint-drop-allowed"),wt(xt(r),"endpointDropForbiddenClass","jtk-endpoint-drop-forbidden"),wt(xt(r),"endpointAnchorClassPrefix","jtk-endpoint-anchor"),wt(xt(r),"overlayClass",he),wt(xt(r),"connections",[]),wt(xt(r),"endpointsByElement",{}),wt(xt(r),"endpointsByUUID",new Map),wt(xt(r),"sourceSelectors",[]),wt(xt(r),"targetSelectors",[]),wt(xt(r),"allowNestedGroups",void 0),wt(xt(r),"_curIdStamp",1),wt(xt(r),"viewport",new Un(xt(r))),wt(xt(r),"router",void 0),wt(xt(r),"groupManager",void 0),wt(xt(r),"_connectionTypes",new Map),wt(xt(r),"_endpointTypes",new Map),wt(xt(r),"_container",void 0),wt(xt(r),"_managedElements",{}),wt(xt(r),"DEFAULT_SCOPE",void 0),wt(xt(r),"_zoom",1),r.defaults={anchor:et.Bottom,anchors:[null,null],connectionsDetachable:!0,connectionOverlays:[],connector:Ut.type,container:null,endpoint:Lt.type,endpointOverlays:[],endpoints:[null,null],endpointStyle:{fill:"#456"},endpointStyles:[null,null],endpointHoverStyle:null,endpointHoverStyles:[null,null],hoverPaintStyle:null,listStyle:{},maxConnections:1,paintStyle:{strokeWidth:2,stroke:"#456"},reattachConnections:!1,scope:"jsplumb_defaultscope",allowNestedGroups:!0},i&&f(r.defaults,i),f(r._initialDefaults,r.defaults),null!=r._initialDefaults[Te]&&(r._initialDefaults[Te].strokeWidth=r._initialDefaults[Te].strokeWidth||2),r.DEFAULT_SCOPE=r.defaults.scope,r.allowNestedGroups=!1!==r._initialDefaults.allowNestedGroups,r.router=new Qn(xt(r)),r.groupManager=new Mn(xt(r)),r.setContainer(r._initialDefaults.container),r}return Et(n,[{key:"defaultScope",get:function(){return this.DEFAULT_SCOPE}},{key:"currentZoom",get:function(){return this._zoom}},{key:"areDefaultAnchorsSet",value:function(){return this.validAnchorsSpec(this.defaults.anchors)}},{key:"validAnchorsSpec",value:function(t){return null!=t&&null!=t[0]&&null!=t[1]}},{key:"getContainer",value:function(){return this._container}},{key:"setZoom",value:function(t,e){return this._zoom=t,this.fire(Ee,this._zoom),e&&this.repaintEverything(),!0}},{key:"_idstamp",value:function(){return""+this._curIdStamp++}},{key:"checkCondition",value:function(t,e){var n=this.getListener(t),i=!0;if(n&&n.length>0){var r=Array.prototype.slice.call(arguments,1);try{for(var o=0,a=n.length;o<a;o++)i=i&&n[o].apply(n[o],r)}catch(e){V("cannot check condition ["+t+"]"+e)}}return i}},{key:"getId",value:function(t,e){if(null==t)return null;var n=this.getAttribute(t,re);return n&&"undefined"!==n||(2===arguments.length&&void 0!==arguments[1]?n=e:(1===arguments.length||3===arguments.length&&!arguments[2])&&(n="jsplumb-"+this._instanceIndex+"-"+this._idstamp()),this.setAttribute(t,re,n)),n}},{key:"getConnections",value:function(t,e){t?t.constructor===String&&(t={scope:t}):t={};for(var n=ni(this,t.scope||this.defaultScope,!0),i=ni(this,t.source),r=ni(this,t.target),o=!e&&n.length>1?{}:[],a=function(t,i){if(!e&&n.length>1){var r=o[t];null==r&&(r=o[t]=[]),r.push(i)}else o.push(i)},s=0,l=this.connections.length;s<l;s++){var u=this.connections[s],c=u.proxies&&u.proxies[0]?u.proxies[0].originalEp.elementId:u.sourceId,f=u.proxies&&u.proxies[1]?u.proxies[1].originalEp.elementId:u.targetId;d(n,u.scope)&&d(i,c)&&d(r,f)&&a(u.scope,u)}return o}},{key:"select",value:function(t){return(t=t||{}).scope=t.scope||"*",new Ln(this,t.connections||this.getConnections(t,!0))}},{key:"selectEndpoints",value:function(t){(t=t||{}).scope=t.scope||yt;var e=!t.element&&!t.source&&!t.target,n=e?yt:ni(this,t.element),i=e?yt:ni(this,t.source),r=e?yt:ni(this,t.target),o=ni(this,t.scope,!0),a=[];for(var s in this.endpointsByElement){var l=d(n,s,!0),u=d(i,s,!0),c="*"!==i,f=d(r,s,!0),p="*"!==r;if(l||u||f)t:for(var h=0,g=this.endpointsByElement[s].length;h<g;h++){var v=this.endpointsByElement[s][h];if(d(o,v.scope,!0)){var y=c&&i.length>0&&!v.isSource,b=p&&r.length>0&&!v.isTarget;if(y||b)continue t;a.push(v)}}}return new Rn(this,a)}},{key:"setContainer",value:function(t){this._container=t,this.fire("container:change",this._container)}},{key:"_set",value:function(t,e,n){var i,r,o=[{el:"source",elId:"sourceId"},{el:"target",elId:"targetId"}][n],a=t[o.elId],s=t.endpoints[n],l={index:n,originalEndpoint:s,originalSourceId:0===n?a:t.sourceId,newSourceId:t.sourceId,originalTargetId:1===n?a:t.targetId,newTargetId:t.targetId,connection:t,newEndpoint:s};return e instanceof Nn?(i=e).addConnection(t):i=(r=this.getId(e))===t[o.elId]?null:t.makeEndpoint(0===n,e,r),null!=i&&(l.newEndpoint=i,s.detachFromConnection(t),t.endpoints[n]=i,t[o.el]=i.element,t[o.elId]=i.elementId,l[0===n?"newSourceId":"newTargetId"]=i.elementId,this.fireMoveEvent(l),this._paintConnection(t)),l}},{key:"setSource",value:function(t,e){ri(t,this._managedElements[t.sourceId]);var n=this._set(t,e,0);ii(t,this._managedElements[n.newSourceId])}},{key:"setTarget",value:function(t,e){ri(t,this._managedElements[t.targetId]);var n=this._set(t,e,1);ii(t,this._managedElements[n.newTargetId])}},{key:"setConnectionType",value:function(t,e,n){t.setType(e,n),this._paintConnection(t)}},{key:"isHoverSuspended",value:function(){return this.hoverSuspended}},{key:"setSuspendDrawing",value:function(t,e){var n=this._suspendDrawing;return this._suspendDrawing=t,t?this._suspendedAt=""+(new Date).getTime():(this._suspendedAt=null,this.viewport.recomputeBounds()),e&&this.repaintEverything(),n}},{key:"getSuspendedAt",value:function(){return this._suspendedAt}},{key:"batch",value:function(t,e){var n=!0===this._suspendDrawing;n||this.setSuspendDrawing(!0),t(),n||this.setSuspendDrawing(!1,!e)}},{key:"each",value:function(t,e){if(null!=t){if(null!=t.length)for(var n=0;n<t.length;n++)e(t[n]);else e(t);return this}}},{key:"updateOffset",value:function(t){var e=t.elId;return t.recalc?this.viewport.refreshElement(e):this.viewport.getPosition(e)}},{key:"deleteConnection",value:function(t,e){if(null!=t&&!0!==t.deleted&&((e=e||{}).force||w(!0,!1,[[t.endpoints[0],we,[t]],[t.endpoints[1],we,[t]],[t,we,[t]],[this,le,[_e,t]]]))){ri(t,this._managedElements[t.sourceId],this._managedElements[t.targetId]),this.fireDetachEvent(t,!t.pending&&!1!==e.fireEvent,e.originalEvent);var n=t.endpoints[0],i=t.endpoints[1];return n!==e.endpointToIgnore&&n.detachFromConnection(t,null,!0),i!==e.endpointToIgnore&&i.detachFromConnection(t,null,!0),I(this.connections,(function(e){return t.id===e.id})),t.destroy(),n!==e.endpointToIgnore&&n.deleteOnEmpty&&0===n.connections.length&&this.deleteEndpoint(n),i!==e.endpointToIgnore&&i.deleteOnEmpty&&0===i.connections.length&&this.deleteEndpoint(i),!0}return!1}},{key:"deleteEveryConnection",value:function(t){var e=this;t=t||{};var n=this.connections.length,i=0;return this.batch((function(){for(var r=0;r<n;r++)i+=e.deleteConnection(e.connections[0],t)?1:0})),i}},{key:"deleteConnectionsForElement",value:function(t,e){var n=this.getId(t),i=this._managedElements[n];if(i)for(var r=i.connections.length,o=0;o<r;o++)this.deleteConnection(i.connections[0],e);return this}},{key:"fireDetachEvent",value:function(t,e,n){var i=null!=t.id?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;e&&this.fire("connection:detach",i,n),this.fire(be,i,n)}},{key:"fireMoveEvent",value:function(t,e){this.fire(ve,t,e)}},{key:"manageAll",value:function(t,e){for(var n=h(t)?this.getSelector(this.getContainer(),t):t,i=0;i<n.length;i++)this.manage(n[i],null,e)}},{key:"manage",value:function(t,e,n){null==this.getAttribute(t,re)&&(e=e||this.getAttribute(t,"id")||D(),this.setAttribute(t,re,e));var i=this.getId(t);if(this._managedElements[i])n&&(this._managedElements[i].viewportElement=this.updateOffset({elId:i,timestamp:null,recalc:!0}));else{var r={el:t,endpoints:[],connections:[],rotation:0,data:{}};this._managedElements[i]=r,this._suspendDrawing?r.viewportElement=this.viewport.registerElement(i,!0):r.viewportElement=this.updateOffset({elId:i,recalc:!0}),this.fire("element:manage",{el:t})}return this._managedElements[i]}},{key:"getManagedData",value:function(t,e,n){if(this._managedElements[t]){var i=this._managedElements[t].data[e];return null!=i?i[n]:null}}},{key:"setManagedData",value:function(t,e,n,i){this._managedElements[t]&&(this._managedElements[t].data[e]=this._managedElements[t].data[e]||{},this._managedElements[t].data[e][n]=i)}},{key:"getManagedElement",value:function(t){return this._managedElements[t]?this._managedElements[t].el:null}},{key:"unmanage",value:function(t,e){var n=this;this.removeAllEndpoints(t,!0);var i=function(t){var i=n.getId(t);n.removeAttribute(t,re),delete n._managedElements[i],n.viewport.remove(i),n.fire("element:unmanage",{el:t,id:i}),t&&e&&n._removeElement(t)};this._getAssociatedElements(t).map(i),i(t)}},{key:"rotate",value:function(t,e,n){var i=this.getId(t);return this._managedElements[i]&&(this._managedElements[i].rotation=e,this.viewport.rotateElement(i,e),!0!==n)?this.revalidate(t):{c:new Set,e:new Set}}},{key:"_getRotation",value:function(t){var e=this._managedElements[t];return null!=e&&e.rotation||0}},{key:"_getRotations",value:function(t){var e=this,n=[],i=this._managedElements[t];return null!=i&&(n.push({r:i.viewportElement.r||0,c:i.viewportElement.c}),function t(i){if(null!=i.group){var r=e._managedElements[i.group];null!=r&&(n.push({r:r.viewportElement.r,c:r.viewportElement.c}),t(r))}}(i)),n}},{key:"_applyRotations",value:function(t,e){var n=t.slice(),i={x:n[0],y:n[1],cr:0,sr:0};return T(e,(function(t){i=R(i,t.c,t.r)})),i}},{key:"_applyRotationsXY",value:function(t,e){return T(e,(function(e){t=R(t,e.c,e.r)})),t}},{key:"_internal_newEndpoint",value:function(t){var e=f({},t),n=this.manage(e.element);e.elementId=this.getId(e.element),e.id="ep_"+this._idstamp();var i=new Nn(this,e);return function(t,e){null!=t&&t.endpoints.push(e)}(n,i),t.uuid&&this.endpointsByUUID.set(t.uuid,i),N(this.endpointsByElement,i.elementId,i),this._suspendDrawing||this._paintEndpoint(i,{timestamp:this._suspendedAt}),i}},{key:"_deriveEndpointAndAnchorSpec",value:function(t,e){for(var n=((e?"":"default ")+t).split(/[\s]/),i=null,r=null,o=null,a=null,s=0;s<n.length;s++){var l=this.getConnectionType(n[s]);l&&(l.endpoints&&(i=l.endpoints),l.endpoint&&(r=l.endpoint),l.anchors&&(a=l.anchors),l.anchor&&(o=l.anchor))}return{endpoints:i||[r,r],anchors:a||[o,o]}}},{key:"revalidate",value:function(t,e){var n=this.getId(t);return this.updateOffset({elId:n,recalc:!0,timestamp:e}),this.repaint(t)}},{key:"repaintEverything",value:function(){var t,e=D();for(t in this._managedElements)this.viewport.refreshElement(t,!0);for(t in this.viewport.recomputeBounds(),this._managedElements)this.repaint(this._managedElements[t].el,e,!0);return this}},{key:"setElementPosition",value:function(t,e,n){var i=this.getId(t);return this.viewport.setPosition(i,e,n),this.repaint(t)}},{key:"repaint",value:function(t,e,n){var i={c:new Set,e:new Set},r=function(t){t.c.forEach((function(t){return i.c.add(t)})),t.e.forEach((function(t){return i.e.add(t)}))};if(!this._suspendDrawing){var o=this.getId(t);if(null!=t){var a=this._getAssociatedElements(t);if(null==e&&(e=D()),!n)for(var s=0;s<a.length;s++)this.updateOffset({elId:this.getId(a[s]),recalc:!0,timestamp:e});if(r(this.router.redraw(o,e,null)),a.length>0)for(var l=0;l<a.length;l++)r(this.router.redraw(this.getId(a[l]),e,null))}}return i}},{key:"unregisterEndpoint",value:function(t){var e=t.getUuid();e&&this.endpointsByUUID.delete(e),function(t,e){null!=t&&I(t.endpoints,(function(t){return t===e}))}(this._managedElements[t.elementId],t);var n=this.endpointsByElement[t.elementId];null!=n&&(this.endpointsByElement[t.elementId]=n.filter((function(e){return e!==t}))),this.fire(ye,t)}},{key:"_maybePruneEndpoint",value:function(t){return!(!t.deleteOnEmpty||0!==t.connections.length)&&(this.deleteEndpoint(t),!0)}},{key:"deleteEndpoint",value:function(t){var e=this,n="string"==typeof t?this.endpointsByUUID.get(t):t;if(n){var i=n.proxiedBy,r=n.connections.slice();T(r,(function(t){n.detachFromConnection(t,null,!0)})),this.unregisterEndpoint(n),n.destroy(),T(r,(function(t){e.deleteConnection(t,{force:!0,endpointToIgnore:n})})),null!=i&&this.deleteEndpoint(i)}return this}},{key:"addEndpoint",value:function(t,e,n){var i=f({},n=n||{});f(i,e||{});var r=f({element:t},i);return this._internal_newEndpoint(r)}},{key:"addEndpoints",value:function(t,e,n){for(var i=[],r=0,o=e.length;r<o;r++)i.push(this.addEndpoint(t,e[r],n));return i}},{key:"reset",value:function(){var t=this;this.silently((function(){t.endpointsByElement={},t._managedElements={},t.endpointsByUUID.clear(),t.viewport.reset(),t.router.reset(),t.groupManager.reset(),t.connections.length=0}))}},{key:"destroy",value:function(){this.reset(),this.unbind(),this.sourceSelectors.length=0,this.targetSelectors.length=0,this._connectionTypes.clear(),this._endpointTypes.clear()}},{key:"getEndpoints",value:function(t){return this.endpointsByElement[this.getId(t)]||[]}},{key:"getEndpoint",value:function(t){return this.endpointsByUUID.get(t)}},{key:"setEndpointUuid",value:function(t,e){t.uuid&&this.endpointsByUUID.delete(t.uuid),t.uuid=e,this.endpointsByUUID.set(e,t)}},{key:"connect",value:function(t,e){try{var n=this._prepareConnectionParams(t,e),i=this._newConnection(n);return this._finaliseConnection(i,n),i}catch(t){return void V(t)}}},{key:"_prepareConnectionParams",value:function(t,e){var n=f({},t);e&&f(n,e);var i=n;if(i.source&&i.source.endpoint&&(i.sourceEndpoint=i.source),i.target&&i.target.endpoint&&(i.targetEndpoint=i.target),t.uuids&&(i.sourceEndpoint=this.getEndpoint(t.uuids[0]),i.targetEndpoint=this.getEndpoint(t.uuids[1])),null!=i.sourceEndpoint){if(i.sourceEndpoint.isFull())throw"Cannot establish connection: source endpoint is full";if(i.type||(i.type=i.sourceEndpoint.edgeType),i.sourceEndpoint.connectorOverlays){i.overlays=i.overlays||[];for(var r=0,o=i.sourceEndpoint.connectorOverlays.length;r<o;r++)i.overlays.push(i.sourceEndpoint.connectorOverlays[r])}i.sourceEndpoint.scope&&(i.scope=i.sourceEndpoint.scope)}else if(null==i.source)throw"Cannot establish connection: source does not exist";if(null!=i.targetEndpoint){if(i.targetEndpoint.isFull())throw"Cannot establish connection: target endpoint is full"}else if(null==i.target)throw"Cannot establish connection: target does not exist";if(i.sourceEndpoint&&i.targetEndpoint&&!function(t,e){for(var n=t.scope.split(/\s/),i=e.scope.split(/\s/),r=0;r<n.length;r++)for(var o=0;o<i.length;o++)if(i[o]===n[r])return!0;return!1}(i.sourceEndpoint,i.targetEndpoint))throw"Cannot establish connection: scopes do not match";return i}},{key:"_newConnection",value:function(t){t.id="con_"+this._idstamp();var e=new kn(this,t);return ii(e,this._managedElements[e.sourceId],this._managedElements[e.targetId]),this._paintConnection(e),e}},{key:"_finaliseConnection",value:function(t,e,n){e=e||{},t.suspendedEndpoint||this.connections.push(t),t.pending=null,t.endpoints[0].isTemporarySource=!1,this.repaint(t.source);var i={connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]};this.fire(ge,i,n),e.doNotFireConnectionEvent||!1===e.fireEvent||this.fire("connection",i,n)}},{key:"removeAllEndpoints",value:function(t,e){var n=this,i=function(t){var e,i,r=n.getId(t),o=n.endpointsByElement[r];if(o)for(e=0,i=o.length;e<i;e++)n.deleteEndpoint(o[e]);delete n.endpointsByElement[r]};return e&&this._getAssociatedElements(t).map(i),i(t),this}},{key:"_createSourceDefinition",value:function(t,e){var n=f({},e);f(n,t),n.edgeType=n.edgeType||ht;var i=this._deriveEndpointAndAnchorSpec(n.edgeType);n.endpoint=n.endpoint||i.endpoints[0],n.anchor=n.anchor||i.anchors[0];var r=n.maxConnections||-1;return{def:f({},n),uniqueEndpoint:n.uniqueEndpoint,maxConnections:r,enabled:!0,endpoint:null}}},{key:"addSourceSelector",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._createSourceDefinition(e),r=new ti(t,i,n);return this.sourceSelectors.push(r),r}},{key:"removeSourceSelector",value:function(t){I(this.sourceSelectors,(function(e){return e===t}))}},{key:"removeTargetSelector",value:function(t){I(this.targetSelectors,(function(e){return e===t}))}},{key:"addTargetSelector",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._createTargetDefinition(e),r=new ti(t,i,n);return this.targetSelectors.push(r),r}},{key:"_createTargetDefinition",value:function(t,e){var n=f({},e);f(n,t),n.edgeType=n.edgeType||ht;var i=n.maxConnections||-1;return{def:f({},n),uniqueEndpoint:n.uniqueEndpoint,maxConnections:i,enabled:!0,endpoint:null}}},{key:"show",value:function(t,e){return this._setVisible(t,Qt,e)}},{key:"hide",value:function(t,e){return this._setVisible(t,te,e)}},{key:"_setVisible",value:function(t,e,n){var i=e===Qt,r=null;n&&(r=function(t){t.setVisible(i,!0,!0)});var o=this.getId(t);return this._operation(t,(function(t){if(i&&n){var e=t.sourceId===o?1:0;t.endpoints[e].isVisible()&&t.setVisible(!0)}else t.setVisible(i)}),r),this}},{key:"toggleVisible",value:function(t,e){var n=null;e&&(n=function(t){var e=t.isVisible();t.setVisible(!e)}),this._operation(t,(function(t){var e=t.isVisible();t.setVisible(!e)}),n)}},{key:"_operation",value:function(t,e,n){var i=this.getId(t),r=this.endpointsByElement[i];if(r&&r.length)for(var o=0,a=r.length;o<a;o++){for(var s=0,l=r[o].connections.length;s<l;s++){if(e(r[o].connections[s]))return}n&&n(r[o])}}},{key:"registerConnectionType",value:function(t,e){if(this._connectionTypes.set(t,f({},e)),e.overlays){for(var n={},i=0;i<e.overlays.length;i++){var r=xe(e.overlays[i]);n[r.options.id]=r}this._connectionTypes.get(t).overlays=n}}},{key:"registerConnectionTypes",value:function(t){for(var e in t)this.registerConnectionType(e,t[e])}},{key:"registerEndpointType",value:function(t,e){if(this._endpointTypes.set(t,f({},e)),e.overlays){for(var n={},i=0;i<e.overlays.length;i++){var r=xe(e.overlays[i]);n[r.options.id]=r}this._endpointTypes.get(t).overlays=n}}},{key:"registerEndpointTypes",value:function(t){for(var e in t)this.registerEndpointType(e,t[e])}},{key:"getType",value:function(t,e){return"connection"===e?this.getConnectionType(t):this.getEndpointType(t)}},{key:"getConnectionType",value:function(t){return this._connectionTypes.get(t)}},{key:"getEndpointType",value:function(t){return this._endpointTypes.get(t)}},{key:"importDefaults",value:function(t){for(var e in t)this.defaults[e]=t[e];return null!=this.defaults[Te]&&(this.defaults[Te].strokeWidth=this.defaults[Te].strokeWidth||2),t.container&&this.setContainer(t.container),this}},{key:"restoreDefaults",value:function(){return this.defaults=f({},this._initialDefaults),this}},{key:"getManagedElements",value:function(){return this._managedElements}},{key:"proxyConnection",value:function(t,e,n,i,r){var o,a=null!=t.proxies[e],s=a?t.proxies[e].originalEp.elementId:t.endpoints[e].elementId,l=a?t.proxies[e].originalEp:t.endpoints[e],u=this.getId(n);t.proxies[e]?t.proxies[e].ep.elementId===u?o=t.proxies[e].ep:(t.proxies[e].ep.detachFromConnection(t,e),o=this._internal_newEndpoint({element:n,endpoint:i(t,e),anchor:r(t,e),parameters:{isProxyEndpoint:!0}})):o=this._internal_newEndpoint({element:n,endpoint:i(t,e),anchor:r(t,e),parameters:{isProxyEndpoint:!0}}),o.deleteOnEmpty=!0,t.proxies[e]={ep:o,originalEp:l},this.sourceOrTargetChanged(s,u,t,n,e),l.detachFromConnection(t,null,!0),o.connections=[t],t.endpoints[e]=o,l.proxiedBy=o,l.setVisible(!1),t.setVisible(!0),this.revalidate(n)}},{key:"unproxyConnection",value:function(t,e){if(null!=t.proxies&&null!=t.proxies[e]){var n=t.proxies[e].originalEp.element,i=t.proxies[e].originalEp.elementId,r=t.proxies[e].ep.elementId;t.endpoints[e]=t.proxies[e].originalEp,delete t.proxies[e].originalEp.proxiedBy,this.sourceOrTargetChanged(r,i,t,n,e),t.proxies[e].ep.detachFromConnection(t,null),t.proxies[e].originalEp.addConnection(t),t.isVisible()&&t.proxies[e].originalEp.setVisible(!0),t.proxies[e]=null,-1===x(t.proxies,(function(t){return null!=t}))&&(t.proxies.length=0)}}},{key:"sourceOrTargetChanged",value:function(t,e,n,i,r){t!==e&&(0===r?(n.sourceId=e,n.source=i):1===r&&(n.targetId=e,n.target=i),ri(n,this._managedElements[t]),ii(n,this._managedElements[e]))}},{key:"getGroup",value:function(t){return this.groupManager.getGroup(t)}},{key:"getGroupFor",value:function(t){return this.groupManager.getGroupFor(t)}},{key:"addGroup",value:function(t){return this.groupManager.addGroup(t)}},{key:"addToGroup",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return(e=this.groupManager).addToGroup.apply(e,[t,!1].concat(i))}},{key:"collapseGroup",value:function(t){this.groupManager.collapseGroup(t)}},{key:"expandGroup",value:function(t){this.groupManager.expandGroup(t)}},{key:"toggleGroup",value:function(t){this.groupManager.toggleGroup(t)}},{key:"removeGroup",value:function(t,e,n,i){return this.groupManager.removeGroup(t,e,n,i)}},{key:"removeAllGroups",value:function(t,e){this.groupManager.removeAllGroups(t,e,!1)}},{key:"removeFromGroup",value:function(t,e,n){this.groupManager.removeFromGroup(t,n,e),this._appendElement(e,this.getContainer()),this.updateOffset({recalc:!0,elId:this.getId(e)})}},{key:"_paintEndpoint",value:function(t,e){var n=(e=e||{}).timestamp,i=!(!1===e.recalc);if(!n||t.timestamp!==n){var r=this.viewport.getPosition(t.elementId),o=e.offset?{x:e.offset.x,y:e.offset.y}:{x:r.x,y:r.y};if(null!=o){var a=e.anchorLoc;if(null==a){var s={xy:o,wh:r,element:t,timestamp:n};if(i&&this.router.isDynamicAnchor(t)&&t.connections.length>0){var l=function(t){var n=0;if(null!=e.elementWithPrecedence)for(var i=0;i<t.connections.length;i++)if(t.connections[i].sourceId===e.elementWithPrecedence||t.connections[i].targetId===e.elementWithPrecedence){n=i;break}return t.connections[n]}(t),u=l.endpoints[0]===t?1:0,c=0===u?l.sourceId:l.targetId,d=this.viewport.getPosition(c);s.index=0===u?1:0,s.connection=l,s.txy=d,s.twh=d,s.tElement=l.endpoints[u],s.tRotation=this._getRotations(c)}else t.connections.length>0&&(s.connection=t.connections[0]);s.rotation=this._getRotations(t.elementId),a=this.router.computeAnchorLocation(t._anchor,s)}for(var f in t.endpoint.compute(a,this.router.getEndpointOrientation(t),t.paintStyleInUse),this.renderEndpoint(t,t.paintStyleInUse),t.timestamp=n,t.overlays)if(t.overlays.hasOwnProperty(f)){var p=t.overlays[f];p.isVisible()&&(t.overlayPlacements[f]=this.drawOverlay(p,t.endpoint,t.paintStyleInUse,t.getAbsoluteOverlayPosition(p)),this._paintOverlay(p,t.overlayPlacements[f],{xmin:0,ymin:0}))}}}}},{key:"_paintConnection",value:function(t,e){if(!this._suspendDrawing&&!1!==t.visible){var n=(e=e||{}).timestamp;if(null!=n&&n===t.lastPaintedAt)return;if(null==n||n!==t.lastPaintedAt){this.router.computePath(t,n);var i={xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0};for(var r in t.overlays)if(t.overlays.hasOwnProperty(r)){var o=t.overlays[r];o.isVisible()&&(t.overlayPlacements[r]=this.drawOverlay(o,t.connector,t.paintStyleInUse,t.getAbsoluteOverlayPosition(o)),i.xmin=Math.min(i.xmin,t.overlayPlacements[r].xmin),i.xmax=Math.max(i.xmax,t.overlayPlacements[r].xmax),i.ymin=Math.min(i.ymin,t.overlayPlacements[r].ymin),i.ymax=Math.max(i.ymax,t.overlayPlacements[r].ymax))}var a=parseFloat(""+t.paintStyleInUse.strokeWidth||"1")/2,s=parseFloat(""+t.paintStyleInUse.strokeWidth||"0"),l={xmin:Math.min(t.connector.bounds.xmin-(a+s),i.xmin),ymin:Math.min(t.connector.bounds.ymin-(a+s),i.ymin),xmax:Math.max(t.connector.bounds.xmax+(a+s),i.xmax),ymax:Math.max(t.connector.bounds.ymax+(a+s),i.ymax)};for(var u in this.paintConnector(t.connector,t.paintStyleInUse,l),t.overlays)if(t.overlays.hasOwnProperty(u)){var c=t.overlays[u];c.isVisible()&&this._paintOverlay(c,t.overlayPlacements[u],l)}}t.lastPaintedAt=n}}},{key:"_refreshEndpoint",value:function(t){t._anchor.isFloating||(t.connections.length>0?this.addEndpointClass(t,this.endpointConnectedClass):this.removeEndpointClass(t,this.endpointConnectedClass),t.isFull()?this.addEndpointClass(t,this.endpointFullClass):this.removeEndpointClass(t,this.endpointFullClass))}},{key:"_makeConnector",value:function(t,e,n){return Jt(t,e,n)}},{key:"addOverlay",value:function(t,e,n){if(t.addOverlay(e),!n){var i=t instanceof Nn?t.element:t.source;this.revalidate(i)}}},{key:"removeOverlay",value:function(t,e){t.removeOverlay(e);var n=t instanceof Nn?t.element:t.source;this.revalidate(n)}},{key:"setOutlineColor",value:function(t,e){t.paintStyleInUse.outlineStroke=e,this._paintConnection(t)}},{key:"setOutlineWidth",value:function(t,e){t.paintStyleInUse.outlineWidth=e,this._paintConnection(t)}},{key:"setColor",value:function(t,e){t.paintStyleInUse.stroke=e,this._paintConnection(t)}},{key:"setLineWidth",value:function(t,e){t.paintStyleInUse.strokeWidth=e,this._paintConnection(t)}},{key:"setLineStyle",value:function(t,e){null!=e.lineWidth&&(t.paintStyleInUse.strokeWidth=e.lineWidth),null!=e.outlineWidth&&(t.paintStyleInUse.outlineWidth=e.outlineWidth),null!=e.color&&(t.paintStyleInUse.stroke=e.color),null!=e.outlineColor&&(t.paintStyleInUse.outlineStroke=e.outlineColor),this._paintConnection(t)}},{key:"getPathData",value:function(t){for(var e="",n=0;n<t.segments.length;n++)e+=t.segments[n].getPath(0===n),e+=" ";return e}}]),n}(),ai=1e-10;function si(t){var e=Math.floor(t),n=Math.ceil(t);return t-e<ai?e:n-t<ai?n:t}var li=function(t){_t(n,ft);var e=At(n);function n(t){var i;bt(this,n),wt(xt(i=e.call(this,t)),"type",n.segmentType),wt(xt(i),"cx",void 0),wt(xt(i),"cy",void 0),wt(xt(i),"radius",void 0),wt(xt(i),"anticlockwise",void 0),wt(xt(i),"startAngle",void 0),wt(xt(i),"endAngle",void 0),wt(xt(i),"sweep",void 0),wt(xt(i),"length",void 0),wt(xt(i),"circumference",void 0),wt(xt(i),"frac",void 0),i.cx=t.cx,i.cy=t.cy,i.radius=t.r,i.anticlockwise=t.ac,t.startAngle&&t.endAngle?(i.startAngle=t.startAngle,i.endAngle=t.endAngle,i.x1=i.cx+i.radius*Math.cos(i.startAngle),i.y1=i.cy+i.radius*Math.sin(i.startAngle),i.x2=i.cx+i.radius*Math.cos(i.endAngle),i.y2=i.cy+i.radius*Math.sin(i.endAngle)):(i.startAngle=i._calcAngle(i.x1,i.y1),i.endAngle=i._calcAngle(i.x2,i.y2)),i.endAngle<0&&(i.endAngle+=rt),i.startAngle<0&&(i.startAngle+=rt);var r=i.endAngle<i.startAngle?i.endAngle+rt:i.endAngle;return i.sweep=Math.abs(r-i.startAngle),i.anticlockwise&&(i.sweep=rt-i.sweep),i.circumference=2*Math.PI*i.radius,i.frac=i.sweep/rt,i.length=i.circumference*i.frac,i.extents={xmin:i.cx-i.radius,xmax:i.cx+i.radius,ymin:i.cy-i.radius,ymax:i.cy+i.radius},i}return Et(n,[{key:"_calcAngle",value:function(t,e){return n={x:this.cx,y:this.cy},r=ot(n,i={x:t,y:e}),o=Math.atan(r),4!=(a=st(n,i))&&3!=a||(o+=Math.PI),o<0&&(o+=2*Math.PI),o;var n,i,r,o,a}},{key:"_calcAngleForLocation",value:function(t,e){if(t.anticlockwise){var n=t.startAngle<t.endAngle?t.startAngle+rt:t.startAngle;return n-Math.abs(n-t.endAngle)*e}var i=t.endAngle<t.startAngle?t.endAngle+rt:t.endAngle,r=Math.abs(i-t.startAngle);return t.startAngle+r*e}},{key:"getPath",value:function(t){var e=this.sweep>Math.PI?1:0,n=this.anticlockwise?0:1;return(t?"M"+this.x1+" "+this.y1+" ":"")+"A "+this.radius+" "+this.radius+" 0 "+e+","+n+" "+this.x2+" "+this.y2}},{key:"getLength",value:function(){return this.length}},{key:"pointOnPath",value:function(t,e){if(0===t)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1===t)return{x:this.x2,y:this.y2,theta:this.endAngle};e&&(t/=length);var n=this._calcAngleForLocation(this,t),i=this.cx+this.radius*Math.cos(n),r=this.cy+this.radius*Math.sin(n);return{x:si(i),y:si(r),theta:n}}},{key:"gradientAtPoint",value:function(t,e){var n=this.pointOnPath(t,e),i=-1/ot({x:this.cx,y:this.cy},n);return this.anticlockwise||i!==1/0&&i!==-1/0||(i*=-1),i}},{key:"pointAlongPathFrom",value:function(t,e,n){var i=this.pointOnPath(t,n),r=e/this.circumference*2*Math.PI,o=this.anticlockwise?-1:1,a=i.theta+o*r;return{x:this.cx+this.radius*Math.cos(a),y:this.cy+this.radius*Math.sin(a)}}}]),n}();wt(li,"segmentType","Arc");var ui=function(t){_t(n,Ae);var e=At(n);function n(t,i,r){var o;return bt(this,n),(o=e.call(this,t,i,r)).instance=t,o.component=i,wt(xt(o),"width",void 0),wt(xt(o),"length",void 0),wt(xt(o),"foldback",void 0),wt(xt(o),"direction",void 0),wt(xt(o),"location",.5),wt(xt(o),"paintStyle",void 0),wt(xt(o),"type",n.type),wt(xt(o),"cachedDimensions",void 0),r=r||{},o.width=r.width||20,o.length=r.length||20,o.direction=(r.direction||1)<0?-1:1,o.foldback=r.foldback||.623,o.paintStyle=r.paintStyle||{strokeWidth:1},o.location=null==r.location?o.location:Array.isArray(r.location)?r.location[0]:r.location,o}return Et(n,[{key:"draw",value:function(t,e,n){if(t instanceof Gt){var i,r,o,a=t;if(this.location>1||this.location<0){var s=this.location<0?1:0;r=ut(i=a.pointAlongPathFrom(s,this.location,!1),a.pointAlongPathFrom(s,this.location-this.direction*this.length/2,!1),this.length)}else if(1===this.location){if(r=ut(i=a.pointOnPath(this.location),a.pointAlongPathFrom(this.location,-this.length),this.length),-1===this.direction){var l=r;r=i,i=l}}else if(0===this.location){if(i=ut(r=a.pointOnPath(this.location),a.pointAlongPathFrom(this.location,this.length),this.length),-1===this.direction){var u=r;r=i,i=u}}else r=ut(i=a.pointAlongPathFrom(this.location,this.direction*this.length/2),a.pointOnPath(this.location),this.length);var c={hxy:i,tail:o=function(t,e,n){var i=ot(t,e),r=Math.atan(-1/i),o=n/2*Math.sin(r),a=n/2*Math.cos(r);return[{x:e.x+a,y:e.y+o},{x:e.x-a,y:e.y-o}]}(i,r,this.width),cxy:ut(i,r,this.foldback*this.length)},d=this.paintStyle.stroke||e.stroke,f=this.paintStyle.fill||e.stroke;return{component:t,d:c,"stroke-width":this.paintStyle.strokeWidth||e.strokeWidth,stroke:d,fill:f,xmin:Math.min(i.x,o[0].x,o[1].x),xmax:Math.max(i.x,o[0].x,o[1].x),ymin:Math.min(i.y,o[0].y,o[1].y),ymax:Math.max(i.y,o[0].y,o[1].y)}}}},{key:"updateFrom",value:function(t){}}]),n}();function ci(t){return t.type===ui.type}wt(ui,"type","Arrow"),Ie.register(ui.type,ui);var di=function(t){_t(n,ui);var e=At(n);function n(t,i,r){var o;return bt(this,n),(o=e.call(this,t,i,r)).instance=t,wt(xt(o),"type",n.type),o.foldback=1,o}return n}();function fi(t){return t.type===di.type}wt(di,"type","PlainArrow"),Ie.register("PlainArrow",di);var pi=function(t){_t(n,ui);var e=At(n);function n(t,i,r){var o;return bt(this,n),(o=e.call(this,t,i,r)).instance=t,wt(xt(o),"type",n.type),o.length=o.length/2,o.foldback=2,o}return n}();function hi(t){return t.type===pi.type}wt(pi,"type","Diamond"),Ie.register(pi.type,pi);var gi,vi=function(t){_t(n,Ae);var e=At(n);function n(t,i,r){var o;return bt(this,n),(o=e.call(this,t,i,r)).instance=t,o.component=i,wt(xt(o),"create",void 0),wt(xt(o),"type",n.type),o.create=r.create,o}return Et(n,[{key:"updateFrom",value:function(t){}}]),n}();function yi(t){return t.type===vi.type}function bi(t){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bi(t)}function mi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ei(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function wi(t,e,n){return e&&Ei(t.prototype,e),n&&Ei(t,n),t}function _i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xi(t,e)}function Ti(t){return Ti=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ti(t)}function xi(t,e){return xi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},xi(t,e)}function Ai(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Si(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ti(t);if(e){var r=Ti(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?Ai(t):e}(this,n)}}function Ii(t,e,n){return Ii="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ti(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}},Ii(t,e,n||t)}function ki(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}(t,e)||Ni(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pi(t){return function(t){if(Array.isArray(t))return Ci(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ni(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ni(t,e){if(t){if("string"==typeof t)return Ci(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ci(t,e):void 0}}function Ci(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function ji(t,e,n){for(var i=(n=n||t.parentNode).querySelectorAll(e),r=0;r<i.length;r++)if(i[r]===t)return!0;return!1}function Mi(t,e){t.stopPropagation?t.stopPropagation():t.returnValue=!1,!e&&t.preventDefault&&t.preventDefault()}function Di(t,e,n,i){if(i&&ji(t,e,n))return t;for(t=t.parentNode;null!=t&&t!==n;){if(ji(t,e))return t;t=t.parentNode}}function Ri(t){return t.srcElement||t.target}function Li(t){return null!=t.className?void 0===t.className.baseVal?t.className:t.className.baseVal:""}function Yi(t,e,n){var i=null==e?[]:Array.isArray(e)?e:e.split(/\s+/),r=null==n?[]:Array.isArray(n)?n:n.split(/\s+/),o=Li(t).split(/\s+/),a=function(t,e){for(var n=0;n<e.length;n++)if(t)-1===o.indexOf(e[n])&&o.push(e[n]);else{var i=o.indexOf(e[n]);-1!==i&&o.splice(i,1)}};a(!0,i),a(!1,r),function(t,e,n){e=L(e),void 0!==t.className.baseVal?t.className.baseVal=e:t.className=e;try{var i=t.classList;if(null!=i){for(;i.length>0;)i.remove(i.item(0));for(var r=0;r<n.length;r++)n[r]&&i.add(n[r])}}catch(t){V("WARN: cannot set class list",t)}}(t,o.join(" "),o)}function Vi(t){return!h(t)&&!Array.isArray(t)&&null!=t.length&&null==t.documentElement&&null==t.nodeType}function Bi(t,e){var n=function(t,e){null!=t&&null!=e&&e.length>0&&(t.classList?T(L(e).split(/\s+/),(function(e){t.classList.add(e)})):Yi(t,e))};Vi(t)?T(t,(function(t){return n(t,e)})):n(t,e)}function $i(t,e){var n=function(t,e){null!=t&&null!=e&&e.length>0&&(t.classList?L(e).split(/\s+/).forEach((function(e){t.classList.remove(e)})):Yi(t,null,e))};Vi(t)?T(t,(function(t){return n(t,e)})):n(t,e)}function Fi(t,e,n,i){return Gi(null,t,e,n,i)}function Gi(t,e,n,i,r){var o,a=null==t?document.createElement(e):document.createElementNS(t,e);for(o in n=n||{})a.style[o]=n[o];for(o in i&&(a.className=i),r=r||{})a.setAttribute(o,""+r[o]);return a}function qi(t){var e=t.getBoundingClientRect(),n=document.body,i=document.documentElement,r=window.pageYOffset||i.scrollTop||n.scrollTop,o=window.pageXOffset||i.scrollLeft||n.scrollLeft,a=i.clientTop||n.clientTop||0,s=i.clientLeft||n.clientLeft||0,l=e.top+r-a,u=e.left+o-s;return{x:Math.round(u),y:Math.round(l)}}function Ui(t,e){var n=e.getContainer().getBoundingClientRect(),i=t.getBoundingClientRect(),r=e.currentZoom;return{x:(i.left-n.left)/r,y:(i.top-n.top)/r}}function zi(t,e){var n=t.getBoundingClientRect(),i=e.currentZoom;return{w:n.width/i,h:n.height/i}}function Ji(t){return t instanceof SVGElement?gi.SVG:gi.HTML}wt(vi,"type","Custom"),Ie.register(vi.type,vi),Dt.registerHandler(Yt),Dt.registerHandler(Ft),Dt.registerHandler(Bt),Wt(Ut.type,Ut),function(t){t.SVG="SVG",t.HTML="HTML"}(gi||(gi={}));var Wi={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},Hi="stroke-dasharray",Xi="dashstyle",Zi="fill",Ki="stroke",Qi="stroke-width",tr="strokeWidth",er="svg",nr="path",ir={svg:"http://www.w3.org/2000/svg"};function rr(t,e){for(var n in e)t.setAttribute(n,""+e[n])}function or(t,e){return(e=e||{}).version="1.1",e.xmlns=ir.svg,Gi(ir.svg,t,null,null,e)}function ar(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"}function sr(t,e,n){if(e.setAttribute(Zi,n.fill?n.fill:te),e.setAttribute(Ki,n.stroke?n.stroke:te),n.strokeWidth&&e.setAttribute(Qi,n.strokeWidth),n[Xi]&&n[tr]&&!n[Hi]){var i=-1===n[Xi].indexOf(",")?" ":",",r=n[Xi].split(i),o="";T(r,(function(t){o+=Math.floor(t*n.strokeWidth)+i})),e.setAttribute(Hi,o)}else n[Hi]&&e.setAttribute(Hi,n[Hi]);for(var a in Wi)n[a]&&e.setAttribute(Wi[a],n[a])}function lr(t,e,n){t.childNodes.length>n?t.insertBefore(e,t.childNodes[n]):t.appendChild(e)}function ur(t,e,n){var i=[t,e];return n&&i.push(n),i.join(":")}var cr="data-jtk-container",dr="data-jtk-enabled",fr="data-jtk-scope",pr="endpoint",hr="element",gr="connection",vr="click",yr="contextmenu",br="dblclick",mr="dbltap",Er="mousedown",wr="mouseenter",_r="mouseexit",Or="mousemove",Tr="mouseup",xr="mouseout",Ar="mouseover",Sr="tap",Ir="drag:stop",kr="drag:start",Pr="revert",Nr="connection:drag",Cr=ur(hr,vr),jr=ur(hr,br),Mr=ur(hr,mr),Dr=ur(hr,xr),Rr=ur(hr,Ar),Lr=ur(hr,Or),Yr=ur(hr,Tr),Vr=ur(hr,Er),Br=ur(hr,yr),$r=ur(hr,Sr),Fr=ur(pr,vr),Gr=ur(pr,br);ur(pr,mr);var qr=ur(pr,xr),Ur=ur(pr,Ar),zr=ur(pr,Tr),Jr=ur(pr,Er);ur(pr,Sr);var Wr,Hr,Xr=ur(gr,vr),Zr=ur(gr,br),Kr=ur(gr,mr),Qr=ur(gr,xr),to=ur(gr,Ar),eo=ur(gr,Tr),no=ur(gr,Er),io=ur(gr,yr),ro=ur(gr,Sr),oo="position",ao=Ht(ue),so=Ht(ce),lo=Xt(ie),uo=Xt("data-jtk-group-content"),co=Ht(he);function fo(t,e,n,i,r,o,a){return function(){var t=[];return t.push.apply(t,arguments),t.item=function(t){return this[t]},t}(function(t,e,n,i,r,o,a){return new Touch({target:t,identifier:D(),pageX:e,pageY:n,screenX:i,screenY:r,clientX:o||i,clientY:a||r})}(t,e,n,i,r,o,a))}function po(t,e,n){for(var i=(n=n||t.parentNode).querySelectorAll(e),r=0;r<i.length;r++)if(i[r]===t)return!0;return!1}function ho(t){return t.srcElement||t.target}function go(t,e,n,i){if(i){var r=t.composedPath?t.composedPath():t.path;if(void 0!==r&&r.indexOf)return{path:r,end:r.indexOf(n)};var o={path:[],end:-1};return function t(e){o.path.push(e),e===n?o.end=o.path.length-1:null!=e.parentNode&&t(e.parentNode)}(e),o}return{path:[e],end:1}}var vo=1;function yo(){return"ontouchstart"in document.documentElement||null!=navigator.maxTouchPoints&&navigator.maxTouchPoints>0}function bo(){return"onmousedown"in document.documentElement}var mo=(_i(Wr={},Er,"touchstart"),_i(Wr,Tr,"touchend"),_i(Wr,Or,"touchmove"),Wr),Eo="page",wo="screen",_o="client";function Oo(t,e){if(null==t)return{x:0,y:0};var n=function(t,e){return t.item?t.item(e):t[e]}(xo(t),0);return{x:n[e+"X"],y:n[e+"Y"]}}function To(t){return Oo(t,Eo)}function xo(t){return t.touches&&t.touches.length>0?t.touches:t.changedTouches&&t.changedTouches.length>0?t.changedTouches:t.targetTouches&&t.targetTouches.length>0?t.targetTouches:[t]}function Ao(t,e,n,i,r){if(ko(t,e,n),i.__tauid=n.__tauid,t.addEventListener)t.addEventListener(e,n,!1,r);else if(t.attachEvent){var o=e+n.__tauid;t["e"+o]=n,t[o]=function(){t["e"+o]&&t["e"+o](window.event)},t.attachEvent("on"+e,t[o])}}function So(t,e,n){var i=this;null!=n&&Io(t,(function(r){if(function(t,e,n){if(t.__ta&&t.__ta[e]&&delete t.__ta[e][n.__tauid],n.__taExtra){for(var i=0;i<n.__taExtra.length;i++)So(t,n.__taExtra[i][0],n.__taExtra[i][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()}(r,e,n),null!=n.__tauid)if(r.removeEventListener)r.removeEventListener(e,n,!1),yo()&&mo[e]&&r.removeEventListener(mo[e],n,!1);else if(i.detachEvent){var o=e+n.__tauid;r[o]&&r.detachEvent("on"+e,r[o]),r[o]=null,r["e"+o]=null}n.__taTouchProxy&&So(t,n.__taTouchProxy[1],n.__taTouchProxy[0])}))}function Io(t,e){if(null!=t)for(var n="string"==typeof t?document.querySelectorAll(t):null!=t.length?t:[t],i=0;i<n.length;i++)e(n[i])}function ko(t,e,n){var i=vo++;return t.__ta=t.__ta||{},t.__ta[e]=t.__ta[e]||{},t.__ta[e][i]=n,n.__tauid=i,i}var Po=/:not\(([^)]+)\)/;function No(t,e,n,i){if(null==t)return n;var r=t.split(","),o=[],a=[];T(r,(function(t){var e=t.match(Po);null!=e?a.push(e[1]):o.push(t)})),a.length>0&&0===o.length&&o.push(yt);var s=function i(r){i.__tauid=n.__tauid;var s=ho(r),l=!1,u=s,c=go(r,s,e,null!=t);if(-1!=c.end)for(var d=0;!l&&d<c.end;d++){u=c.path[d];for(var f=0;f<a.length;f++)if(po(u,a[f],e))return;for(var p=0;!l&&p<o.length;p++)if(po(u,o[p],e)){n.apply(u,[r,u]),l=!0;break}}};return function(t,e,n){t.__taExtra=t.__taExtra||[],t.__taExtra.push([e,n])}(n,i,s),s}var Co=function(t,e,n,i,r){if(yo()&&mo[e]){var o=No(i,t,n,mo[e]);Ao(t,mo[e],o,n,r)}"focus"===e&&null==t.getAttribute(ae)&&t.setAttribute(ae,"1"),Ao(t,e,No(i,t,n,e),n,r)},jo=(_i(Hr={},Sr,{touches:1,taps:1}),_i(Hr,mr,{touches:1,taps:2}),_i(Hr,yr,{touches:2,taps:1}),Hr);function Mo(t,e,n,i){for(var r in n.__tamee[t])n.__tamee[t].hasOwnProperty(r)&&n.__tamee[t][r].apply(i,[e])}var Do=function(){function t(){mi(this,t)}return wi(t,null,[{key:"generate",value:function(t,e){return function(n,i,r,o){if(i==yr&&bo())Co(n,i,r,o);else{if(null==n.__taTapHandler){var a=n.__taTapHandler={tap:[],dbltap:[],down:!1,taps:0,downSelectors:[]},s=function(i){for(var r=ho(i),s=go(i,r,n,null!=o),l=!1,d=0;d<s.end;d++){if(l)return;r=s.path[d];for(var f=0;f<a.downSelectors.length;f++)if(null==a.downSelectors[f]||po(r,a.downSelectors[f],n)){a.down=!0,setTimeout(u,t),setTimeout(c,e),l=!0;break}}},l=function(t){if(a.down){var e,i,r=ho(t);a.taps++;var o=function(t){return xo(t).length}(t);for(var s in jo)if(jo.hasOwnProperty(s)){var l=jo[s];if(l.touches===o&&(1===l.taps||l.taps===a.taps))for(var u=0;u<a[s].length;u++){i=go(t,r,n,null!=a[s][u][1]);for(var c=0;c<i.end;c++)if(e=i.path[c],null==a[s][u][1]||po(e,a[s][u][1],n)){a[s][u][0].apply(e,[t,e]);break}}}}},u=function(){a.down=!1},c=function(){a.taps=0};n.__taTapHandler.downHandler=s,n.__taTapHandler.upHandler=l,Co(n,Er,s),Co(n,Tr,l)}n.__taTapHandler.downSelectors.push(o),n.__taTapHandler[i].push([r,o]),r.__taUnstore=function(){null!=n.__taTapHandler&&(I(n.__taTapHandler.downSelectors,(function(t){return t===o})),function(t,e){var n,i=0;for(i=0,n=t.length;i<n&&t[i][0]!==e;i++);i<t.length&&t.splice(i,1)}(n.__taTapHandler[i],r),0===n.__taTapHandler.downSelectors.length&&(So(n,Er,n.__taTapHandler.downHandler),So(n,Tr,n.__taTapHandler.upHandler),delete n.__taTapHandler))}}}}}]),t}(),Ro=function(){function t(){mi(this,t)}return wi(t,null,[{key:"generate",value:function(){var t=[];return function(e,n,i,r){if(!e.__tamee){e.__tamee={over:!1,mouseenter:[],mouseexit:[]};var o=function(n){var i=ho(n);(null==r&&i==e&&!e.__tamee.over||po(i,r,e)&&(null==i.__tamee||!i.__tamee.over))&&(Mo(wr,n,e,i),i.__tamee=i.__tamee||{},i.__tamee.over=!0,t.push(i))},a=function(n){for(var i=ho(n),r=0;r<t.length;r++)i!=t[r]||po(n.relatedTarget||n.toElement,"*",i)||(i.__tamee.over=!1,t.splice(r,1),Mo(_r,n,e,i))};Ao(e,Ar,No(r,e,o,Ar),o),Ao(e,xr,No(r,e,a,xr),a)}i.__taUnstore=function(){delete e.__tamee[n][i.__tauid]},ko(e,n,i),e.__tamee[n][i.__tauid]=i}}}]),t}(),Lo=function(){function t(e){mi(this,t),_i(this,"clickThreshold",void 0),_i(this,"dblClickThreshold",void 0),_i(this,"tapHandler",void 0),_i(this,"mouseEnterExitHandler",void 0),e=e||{},this.clickThreshold=e.clickThreshold||250,this.dblClickThreshold=e.dblClickThreshold||450,this.mouseEnterExitHandler=Ro.generate(),this.tapHandler=Do.generate(this.clickThreshold,this.dblClickThreshold)}return wi(t,[{key:"_doBind",value:function(t,e,n,i,r){if(null!=n){var o=t;e===Sr||e===mr||e===yr?this.tapHandler(o,e,n,i,r):e===wr||e==_r?this.mouseEnterExitHandler(o,e,n,i,r):Co(o,e,n,i,r)}}},{key:"on",value:function(t,e,n,i,r){var o=null==i?null:n,a=null==i?n:i;return this._doBind(t,e,a,o,r),this}},{key:"off",value:function(t,e,n){return So(t,e,n),this}},{key:"trigger",value:function(t,e,n,i,r){var o=bo()&&("undefined"==typeof MouseEvent||null==n||n.constructor===MouseEvent),a=yo()&&!bo()&&mo[e]?mo[e]:e,s=!(yo()&&!bo()&&mo[e]),l=To(n),u=function(t){return Oo(t,wo)}(n),c=function(t){return Oo(t,_o)}(n);return Io(t,(function(t){var d;n=n||{screenX:u.x,screenY:u.y,clientX:c.x,clientY:c.y};var f,p={TouchEvent:function(e){var n=fo(t,l.x,l.y,u.x,u.y,c.x,c.y);(e.initTouchEvent||e.initEvent)(a,!0,!0,window,null,u.x,u.y,c.x,c.y,!1,!1,!1,!1,n,n,n,1,0)},MouseEvents:function(e){e.initMouseEvent(a,!0,!0,window,null==r?1:r,u.x,u.y,c.x,c.y,!1,!1,!1,!1,1,t)}},h=!s&&!o&&yo()&&mo[e]?"TouchEvent":"MouseEvents";d=document.createEvent(h),p[h](d),f=d,i&&(f.payload=i),t.dispatchEvent(d)})),this}}]),t}();function Yo(t,e,n){if(ji(e,n,t))return e;for(var i=e.parentNode;null!=i&&i!==t;){if(ji(i,n,t))return i;i=i.parentNode}}function Vo(t,e,n){var i=e.parentNode,r=t.getSize(i),o=t.getSize(e),a=n.x,s=a+o.w,l=n.y,u=l+o.h;return s>0&&a<r.w&&u>0&&l<r.h}var Bo,$o="start",Fo="beforeStart",Go="drag",qo="stop",Uo="katavorio-draggable",zo=function(){return!0},Jo=function(){return!1},Wo="katavorio-delegated-draggable",Ho="katavorio-drag-no-select",Xo="katavorio-ghost-proxy",Zo="katavorio-clone-drag";!function(t){t.absolutePosition="absolutePosition",t.transform="transform",t.xyAttributes="xyAttributes"}(Bo||(Bo={}));var Ko=new Map;Ko.set(Bo.absolutePosition,(function(t,e){t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px")})),Ko.set(Bo.xyAttributes,(function(t,e){t.setAttribute("x","".concat(e.x)),t.setAttribute("y","".concat(e.y))}));var Qo=new Map;Qo.set(Bo.absolutePosition,(function(t){return{x:t.offsetLeft,y:t.offsetTop}})),Qo.set(Bo.xyAttributes,(function(t){return{x:parseFloat(t.getAttribute("x")),y:parseFloat(t.getAttribute("y"))}}));var ta=new Map;ta.set(Bo.absolutePosition,(function(t,e){t.style.width="".concat(e.w,"px"),t.style.height="".concat(e.h,"px")})),ta.set(Bo.xyAttributes,(function(t,e){t.setAttribute("width","".concat(e.w)),t.setAttribute("height","".concat(e.h))}));var ea=new Map;ea.set(Bo.absolutePosition,(function(t){return{w:t.offsetWidth,h:t.offsetHeight}})),ea.set(Bo.xyAttributes,(function(t){return{w:parseFloat(t.getAttribute("width")),h:parseFloat(t.getAttribute("height"))}}));var na,ia=[qo,$o,Go,"drop","over","out",Fo],ra=function(){},oa=function(t,e){if(null!=t){t=h(t)||null!=t.tagName||null==t.length?[t]:t;for(var n=0;n<t.length;n++)e.apply(t[n],[t[n]])}},aa=function(){function t(e,n){mi(this,t),this.el=e,this.manager=n,_i(this,"_class",void 0),_i(this,"uuid",D()),_i(this,"enabled",!0),_i(this,"scopes",[]),_i(this,"eventManager",void 0),this.eventManager=n.eventManager}return wi(t,[{key:"setEnabled",value:function(t){this.enabled=t}},{key:"isEnabled",value:function(){return this.enabled}},{key:"toggleEnabled",value:function(){this.enabled=!this.enabled}},{key:"addScope",value:function(t){var e={};for(var n in oa(this.scopes,(function(t){e[t]=!0})),oa(t?t.split(/\s+/):[],(function(t){e[t]=!0})),this.scopes.length=0,e)this.scopes.push(n)}},{key:"removeScope",value:function(t){var e={};for(var n in oa(this.scopes,(function(t){e[t]=!0})),oa(t?t.split(/\s+/):[],(function(t){delete e[t]})),this.scopes.length=0,e)this.scopes.push(n)}},{key:"toggleScope",value:function(t){var e={};for(var n in oa(this.scopes,(function(t){e[t]=!0})),oa(t?t.split(/\s+/):[],(function(t){e[t]?delete e[t]:e[t]=!0})),this.scopes.length=0,e)this.scopes.push(n)}}]),t}();!function(t){t.notNegative="notNegative",t.parent="parent",t.parentEnclosed="parentEnclosed"}(na||(na={}));var sa=function(t){Oi(n,aa);var e=Si(n);function n(t,i,r){var o;if(mi(this,n),_i(Ai(o=e.call(this,t,r)),"_class",void 0),_i(Ai(o),"rightButtonCanDrag",void 0),_i(Ai(o),"consumeStartEvent",void 0),_i(Ai(o),"clone",void 0),_i(Ai(o),"scroll",void 0),_i(Ai(o),"trackScroll",void 0),_i(Ai(o),"_downAt",void 0),_i(Ai(o),"_posAtDown",void 0),_i(Ai(o),"_pagePosAtDown",void 0),_i(Ai(o),"_pageDelta",{x:0,y:0}),_i(Ai(o),"_moving",void 0),_i(Ai(o),"_lastPosition",void 0),_i(Ai(o),"_lastScrollValues",{x:0,y:0}),_i(Ai(o),"_initialScroll",{x:0,y:0}),_i(Ai(o),"_size",void 0),_i(Ai(o),"_currentParentPosition",void 0),_i(Ai(o),"_ghostParentPosition",void 0),_i(Ai(o),"_dragEl",void 0),_i(Ai(o),"_multipleDrop",void 0),_i(Ai(o),"_ghostProxyOffsets",void 0),_i(Ai(o),"_ghostDx",void 0),_i(Ai(o),"_ghostDy",void 0),_i(Ai(o),"_isConstrained",!1),_i(Ai(o),"_ghostProxyParent",void 0),_i(Ai(o),"_useGhostProxy",void 0),_i(Ai(o),"_ghostProxyFunction",void 0),_i(Ai(o),"_activeSelectorParams",void 0),_i(Ai(o),"_availableSelectors",[]),_i(Ai(o),"_canDrag",void 0),_i(Ai(o),"_consumeFilteredEvents",void 0),_i(Ai(o),"_parent",void 0),_i(Ai(o),"_ignoreZoom",void 0),_i(Ai(o),"_filters",{}),_i(Ai(o),"_constrainRect",void 0),_i(Ai(o),"_elementToDrag",void 0),_i(Ai(o),"downListener",void 0),_i(Ai(o),"moveListener",void 0),_i(Ai(o),"upListener",void 0),_i(Ai(o),"scrollTracker",void 0),_i(Ai(o),"listeners",{start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]}),o._class=o.manager.css.draggable,Bi(o.el,o._class),o.downListener=o._downListener.bind(Ai(o)),o.upListener=o._upListener.bind(Ai(o)),o.moveListener=o._moveListener.bind(Ai(o)),o.rightButtonCanDrag=!0===i.rightButtonCanDrag,o.consumeStartEvent=!1!==i.consumeStartEvent,o._dragEl=o.el,o.clone=!0===i.clone,o.scroll=!0===i.scroll,o.trackScroll=!1!==i.trackScroll,o._multipleDrop=!1!==i.multipleDrop,o._canDrag=i.canDrag||zo,o._consumeFilteredEvents=i.consumeFilteredEvents,o._parent=i.parent,o._ignoreZoom=!0===i.ignoreZoom,o._ghostProxyParent=i.ghostProxyParent,o.trackScroll&&(o.scrollTracker=o._trackScroll.bind(Ai(o)),document.addEventListener("scroll",o.scrollTracker)),!0===i.ghostProxy?o._useGhostProxy=zo:i.ghostProxy&&"function"==typeof i.ghostProxy?o._useGhostProxy=i.ghostProxy:o._useGhostProxy=function(t,e){return!(!o._activeSelectorParams||!o._activeSelectorParams.useGhostProxy)&&o._activeSelectorParams.useGhostProxy(t,e)},i.makeGhostProxy?o._ghostProxyFunction=i.makeGhostProxy:o._ghostProxyFunction=function(t){return o._activeSelectorParams&&o._activeSelectorParams.makeGhostProxy?o._activeSelectorParams.makeGhostProxy(t):t.cloneNode(!0)},i.selector){var a=o.el.getAttribute(Uo);null==a&&(a=""+(new Date).getTime(),o.el.setAttribute("katavorio-draggable",a)),o._availableSelectors.push(i)}return o.eventManager.on(o.el,Er,o.downListener),o}return wi(n,[{key:"_trackScroll",value:function(t){if(this._moving){var e={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},n=e.x-this._lastScrollValues.x,i=e.y-this._lastScrollValues.y,r={x:n+this._lastPosition.x,y:i+this._lastPosition.y},o=r.x-this._downAt.x,a=r.y-this._downAt.y,s=this._ignoreZoom?1:this.manager.getZoom();this._dragEl&&this._dragEl.parentNode&&(o+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,a+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),o/=s,a/=s,this.moveBy(o,a,t),this._lastPosition=r,this._lastScrollValues=e}}},{key:"on",value:function(t,e){this.listeners[t]&&this.listeners[t].push(e)}},{key:"off",value:function(t,e){if(this.listeners[t]){for(var n=[],i=0;i<this.listeners[t].length;i++)this.listeners[t][i]!==e&&n.push(this.listeners[t][i]);this.listeners[t]=n}}},{key:"_upListener",value:function(t){this._downAt&&(this._downAt=null,this.eventManager.off(document,Or,this.moveListener),this.eventManager.off(document,Tr,this.upListener),$i(document.body,Ho),this.unmark(t),this.stop(t),this._moving=!1,this.clone?(this._dragEl&&this._dragEl.parentNode&&this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=null):this._activeSelectorParams&&this._activeSelectorParams.revertFunction&&!0===this._activeSelectorParams.revertFunction(this._dragEl,this.manager.getPosition(this._dragEl))&&(this.manager.setPosition(this._dragEl,this._posAtDown),this._dispatch(Pr,this._dragEl)))}},{key:"_downListener",value:function(t){if(!t.defaultPrevented&&((this.rightButtonCanDrag||3!==t.which&&2!==t.button)&&this.isEnabled()&&this._canDrag())){var e=this._testFilter(t)&&function(t,e,n){return!ji(t.srcElement||t.target,n.getInputFilterSelector(),e)}(t,this.el,this.manager);if(e){this._activeSelectorParams=null,this._elementToDrag=null,0===this._availableSelectors.length&&console.log("JSPLUMB: no available drag selectors");var n=t.target||t.srcElement,i=function(t,e,n){for(var i=null,r=e.getAttribute("katavorio-draggable"),o=null!=r?"[katavorio-draggable='"+r+"'] ":"",a=0;a<t.length;a++)if(null!=(i=Yo(e,n,o+t[a].selector))){if(t[a].filter){var s=ji(n,t[a].filter,i);if(!0===t[a].filterExclude&&!s||s)return null}return[t[a],i]}return null}(this._availableSelectors,this.el,n);if(null!=i&&(this._activeSelectorParams=i[0],this._elementToDrag=i[1]),null==this._activeSelectorParams||null==this._elementToDrag)return;var r=this._activeSelectorParams.dragInit?this._activeSelectorParams.dragInit(this._elementToDrag,t):null;if(null!=r&&(this._elementToDrag=r),this.clone)if(this._dragEl=this._elementToDrag.cloneNode(!0),Bi(this._dragEl,Zo),this._dragEl.setAttribute("id",null),this._dragEl.style.position="absolute",null!=this._parent){var o=this.manager.getPosition(this.el);this._dragEl.style.left=o.x+"px",this._dragEl.style.top=o.y+"px",this._parent.appendChild(this._dragEl)}else{var a=qi(this._elementToDrag);this._dragEl.style.left=a.x+"px",this._dragEl.style.top=a.y+"px",document.body.appendChild(this._dragEl)}else this._dragEl=this._elementToDrag;this.consumeStartEvent&&Mi(t),this._downAt=To(t),this._dragEl&&this._dragEl.parentNode&&(this._initialScroll={x:this._dragEl.parentNode.scrollLeft,y:this._dragEl.parentNode.scrollTop}),this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=qi(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),this.eventManager.on(document,Or,this.moveListener),this.eventManager.on(document,Tr,this.upListener),Bi(document.body,Ho),this._dispatch(Fo,{el:this.el,pos:this._posAtDown,e:t,drag:this,size:this._size})}else this._consumeFilteredEvents&&Mi(t)}}},{key:"_moveListener",value:function(t){if(this._downAt){if(!this._moving){var e=this._dispatch($o,{el:this.el,pos:this._posAtDown,e:t,drag:this,size:this._size});if(!1!==e){if(!this._downAt)return;this.mark(e),this._moving=!0}else this.abort()}if(this._downAt){var n=To(t),i=n.x-this._downAt.x,r=n.y-this._downAt.y,o=this._ignoreZoom?1:this.manager.getZoom();this._lastPosition={x:n.x,y:n.y},this._lastScrollValues={x:document.documentElement.scrollLeft,y:document.documentElement.scrollTop},this._dragEl&&this._dragEl.parentNode&&(i+=this._dragEl.parentNode.scrollLeft-this._initialScroll.x,r+=this._dragEl.parentNode.scrollTop-this._initialScroll.y),i/=o,r/=o,this.moveBy(i,r,t)}}}},{key:"getDragDelta",value:function(){return null!=this._posAtDown&&null!=this._downAt?{x:this._downAt.x-this._posAtDown.x,y:this._downAt.y-this._posAtDown.y}:{x:0,y:0}}},{key:"mark",value:function(t){var e;this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=qi(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),Bi(this._dragEl,this.manager.css.drag),this._constrainRect={w:(e=this._dragEl).parentNode.offsetWidth+e.parentNode.scrollLeft,h:e.parentNode.offsetHeight+e.parentNode.scrollTop},this._ghostDx=0,this._ghostDy=0}},{key:"unmark",value:function(t){this._isConstrained&&this._useGhostProxy(this._elementToDrag,this._dragEl)?(this._ghostProxyOffsets={x:this._dragEl.offsetLeft-this._ghostDx,y:this._dragEl.offsetTop-this._ghostDy},this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag):this._ghostProxyOffsets=null,$i(this._dragEl,this.manager.css.drag),this._isConstrained=!1}},{key:"moveBy",value:function(t,e,n){var i=this.toGrid({x:this._posAtDown.x+t,y:this._posAtDown.y+e}),r=this._doConstrain(i,this._dragEl,this._constrainRect,this._size,n);if(null!=r){if(this._useGhostProxy(this.el,this._dragEl))if(i.x!==r.x||i.y!==r.y){if(!this._isConstrained){var o=this._ghostProxyFunction(this._elementToDrag);Bi(o,Xo),this._ghostProxyParent?(this._ghostProxyParent.appendChild(o),this._currentParentPosition=qi(this._elementToDrag.parentNode),this._ghostParentPosition=qi(this._ghostProxyParent),this._ghostDx=this._currentParentPosition.x-this._ghostParentPosition.x,this._ghostDy=this._currentParentPosition.y-this._ghostParentPosition.y):this._elementToDrag.parentNode.appendChild(o),this._dragEl=o,this._isConstrained=!0}r=i}else this._isConstrained&&(this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag,this._isConstrained=!1,this._currentParentPosition=null,this._ghostParentPosition=null,this._ghostDx=0,this._ghostDy=0);this.manager.setPosition(this._dragEl,{x:r.x+this._ghostDx,y:r.y+this._ghostDy}),this._dispatch(Go,{el:this.el,pos:r,e:n,drag:this,size:this._size,originalPos:this._posAtDown})}}},{key:"abort",value:function(){null!=this._downAt&&this._upListener()}},{key:"getDragElement",value:function(t){return t?this._elementToDrag||this.el:this._dragEl||this.el}},{key:"stop",value:function(t,e){if(e||this._moving){var n=[],i=this.manager.getPosition(this._dragEl);n.push([this._dragEl,i,this,this._size]),this._dispatch(qo,{el:this._dragEl,pos:this._ghostProxyOffsets||i,finalPos:i,e:t,drag:this,selection:n,size:this._size,originalPos:{x:this._posAtDown.x,y:this._posAtDown.y}})}else this._moving||this._activeSelectorParams.dragAbort&&this._activeSelectorParams.dragAbort(this._elementToDrag)}},{key:"_dispatch",value:function(t,e){var n=null;if(this._activeSelectorParams&&this._activeSelectorParams[t])n=this._activeSelectorParams[t](e);else if(this.listeners[t])for(var i=0;i<this.listeners[t].length;i++)try{var r=this.listeners[t][i](e);null!=r&&(n=r)}catch(t){}return n}},{key:"resolveGrid",value:function(){var t={grid:null,thresholdX:5,thresholdY:5};return null!=this._activeSelectorParams&&null!=this._activeSelectorParams.grid&&(t.grid=this._activeSelectorParams.grid,null!=this._activeSelectorParams.snapThreshold&&(t.thresholdX=this._activeSelectorParams.snapThreshold,t.thresholdY=this._activeSelectorParams.snapThreshold)),t}},{key:"toGrid",value:function(t){var e=this.resolveGrid(),n=e.grid,i=e.thresholdX,r=e.thresholdY;return null==n?t:function(t,e,n,i){n=null==n?null==e.thresholdX?e.w/2:e.thresholdX:n,i=null==i?null==e.thresholdY?e.h/2:e.thresholdY:i;var r=Math.floor(t.x/e.w),o=e.w*r,a=o+e.w,s=Math.abs(t.x-o)<=n?o:Math.abs(a-t.x)<=n?a:t.x,l=Math.floor(t.y/e.h),u=e.h*l,c=u+e.h;return{x:s,y:Math.abs(t.y-u)<=i?u:Math.abs(c-t.y)<=i?c:t.y}}(t,n,n?n.w/2:i,n?n.h/2:r)}},{key:"setUseGhostProxy",value:function(t){this._useGhostProxy=t?zo:Jo}},{key:"_doConstrain",value:function(t,e,n,i,r){return null!=this._activeSelectorParams&&this._activeSelectorParams.constrainFunction&&"function"==typeof this._activeSelectorParams.constrainFunction?this._activeSelectorParams.constrainFunction(t,e,n,i,r):t}},{key:"_testFilter",value:function(t){for(var e in this._filters){var n=this._filters[e],i=n[0](t);if(n[1]&&(i=!i),!i)return!1}return!0}},{key:"addFilter",value:function(t,e){var n,i=this;if(t){var r="function"==typeof(n=t)?(n._katavorioId=D(),n._katavorioId):n;this._filters[r]=[function(e){var n,r=e.srcElement||e.target;return h(t)?n=ji(r,t,i.el):"function"==typeof t&&(n=t(e,i.el)),n},!1!==e]}}},{key:"removeFilter",value:function(t){var e="function"==typeof t?t._katavorioId:t;delete this._filters[e]}},{key:"clearAllFilters",value:function(){this._filters={}}},{key:"addSelector",value:function(t,e){t.selector&&(e?this._availableSelectors.unshift(t):this._availableSelectors.push(t))}},{key:"destroy",value:function(){this.eventManager.off(this.el,Er,this.downListener),this.eventManager.off(document,Or,this.moveListener),this.eventManager.off(document,Tr,this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null,null!=this.scrollTracker&&document.removeEventListener("scroll",this.scrollTracker)}}]),n}(),la=["input","textarea","select","button","option"].join(","),ua=function(){function t(e){mi(this,t),_i(this,"eventManager",void 0),_i(this,"zoom",1),_i(this,"css",{}),_i(this,"inputFilterSelector",void 0),_i(this,"positioningStrategy",void 0),_i(this,"_positionSetter",void 0),_i(this,"_positionGetter",void 0),_i(this,"_sizeSetter",void 0),_i(this,"_sizeGetter",void 0),e=e||{},this.inputFilterSelector=e.inputFilterSelector||la,this.eventManager=new Lo,this.zoom=e.zoom||1,this.positioningStrategy=e.positioningStrategy||Bo.absolutePosition,this._positionGetter=Qo.get(this.positioningStrategy),this._positionSetter=Ko.get(this.positioningStrategy),this._sizeGetter=ea.get(this.positioningStrategy),this._sizeSetter=ta.get(this.positioningStrategy);var n=e.css||{};f(this.css,n)}return wi(t,[{key:"getPosition",value:function(t){return this._positionGetter(t)}},{key:"setPosition",value:function(t,e){this._positionSetter(t,e)}},{key:"getSize",value:function(t){return this._sizeGetter(t)}},{key:"getZoom",value:function(){return this.zoom}},{key:"setZoom",value:function(t){this.zoom=t}},{key:"_prepareParams",value:function(t){t=t||{};var e,n={events:{}};for(e in t)n[e]=t[e];for(e=0;e<ia.length;e++)n.events[ia[e]]=t[ia[e]]||ra;return n}},{key:"getInputFilterSelector",value:function(){return this.inputFilterSelector}},{key:"setInputFilterSelector",value:function(t){return this.inputFilterSelector=t,this}},{key:"draggable",value:function(t,e){if(null==t._katavorioDrag){var n=this._prepareParams(e),i=new sa(t,n,this);return Bi(t,Wo),t._katavorioDrag=i,i}return t._katavorioDrag}},{key:"destroyDraggable",value:function(t){t._katavorioDrag&&(t._katavorioDrag.destroy(),delete t._katavorioDrag)}}]),t}(),ca="jtk-drag-selected",da=function(){function t(e){mi(this,t),this.instance=e,_i(this,"_dragSelection",[]),_i(this,"_dragSizes",new Map),_i(this,"_dragElements",new Map),_i(this,"_dragElementStartPositions",new Map),_i(this,"_dragElementPositions",new Map),_i(this,"__activeSet",void 0)}return wi(t,[{key:"_activeSet",get:function(){return null==this.__activeSet?this._dragSelection:this.__activeSet}},{key:"length",get:function(){return this._dragSelection.length}},{key:"filterActiveSet",value:function(t){var e=this;this.__activeSet=[],T(this._dragSelection,(function(n){t(n)&&e.__activeSet.push(n)}))}},{key:"clear",value:function(){var t=this;this.reset(),T(this._dragSelection,(function(e){return t.instance.removeClass(e.jel,ca)})),this._dragSelection.length=0}},{key:"reset",value:function(){this._dragElementStartPositions.clear(),this._dragElementPositions.clear(),this._dragSizes.clear(),this._dragElements.clear(),this.__activeSet=null}},{key:"initialisePositions",value:function(){var t=this;T(this._activeSet,(function(e){var n=t.instance.viewport.getPosition(e.id),i={x:parseInt(""+e.jel.offsetLeft,10),y:parseInt(""+e.jel.offsetTop,10)};t._dragElementStartPositions.set(e.id,i),t._dragElementPositions.set(e.id,i),t._dragSizes.set(e.id,{w:n.w,h:n.h})}))}},{key:"updatePositions",value:function(t,e,n){var i=this,r=t.x-e.x,o=t.y-e.y;T(this._activeSet,(function(t){var e=i._dragElementStartPositions.get(t.id);if(e){var a=e.x+r,s=e.y+o,l=i._dragSizes.get(t.id),u={x:a,y:s,w:l.w,h:l.h};if(t.jel._jsPlumbParentGroup&&t.jel._jsPlumbParentGroup.constrain){var c={w:t.jel.parentNode.offsetWidth+t.jel.parentNode.scrollLeft,h:t.jel.parentNode.offsetHeight+t.jel.parentNode.scrollTop};u.x=Math.max(u.x,0),u.y=Math.max(u.y,0),u.x=Math.min(u.x,c.w-l.w),u.y=Math.min(u.y,c.h-l.h)}i._dragElementPositions.set(t.id,{x:a,y:s}),t.jel.style.left=u.x+"px",t.jel.style.top=u.y+"px",n(t.jel,t.id,l,u)}}))}},{key:"each",value:function(t){var e=this;T(this._activeSet,(function(n){var i=e._dragSizes.get(n.id),r=e._dragElementPositions.get(n.id),o=e._dragElementStartPositions.get(n.id);t(n.jel,n.id,r,i,o)}))}},{key:"add",value:function(t,e){var n=t;e=e||this.instance.getId(n),-1===x(this._dragSelection,(function(t){return t.id===e}))&&(this.instance.addClass(t,ca),this._dragSelection.push({id:e,jel:n}))}},{key:"remove",value:function(t){var e=this,n=t;this._dragSelection=this._dragSelection.filter((function(t){var i=t.jel!==n;return i||e.instance.removeClass(t.jel,ca),i}))}},{key:"toggle",value:function(t){var e=t;-1!==x(this._dragSelection,(function(t){return t.jel===e}))?this.remove(e):this.add(t)}}]),t}(),fa="jtk-drag-active",pa="jtk-drag-hover",ha=function(){function t(e,n,i){var r=this;mi(this,t),this.instance=e,this.dragSelection=n,_i(this,"collicat",void 0),_i(this,"drag",void 0),_i(this,"_draggables",{}),_i(this,"_dlist",[]),_i(this,"_elementsWithEndpoints",{}),_i(this,"_draggablesForElements",{}),_i(this,"handlers",[]),_i(this,"_trackScroll",void 0),_i(this,"_filtersToAdd",[]),this.collicat=new ua({zoom:this.instance.currentZoom,css:{noSelect:this.instance.dragSelectClass,delegatedDraggable:"jtk-delegated-draggable",draggable:"jtk-draggable",drag:"jtk-drag",selected:ca,active:fa,hover:pa,ghostProxy:"jtk-ghost-proxy"}}),this.instance.bind(Ee,(function(t){r.collicat.setZoom(t)})),i=i||{},this._trackScroll=!1!==i.trackScroll}return wi(t,[{key:"addHandler",value:function(t,e){var n=this,i=f({selector:t.selector},e||{});i.start=F(i.start,(function(e){return t.onStart(e)}),!1),i.drag=F(i.drag,(function(e){return t.onDrag(e)})),i.stop=F(i.stop,(function(e){return t.onStop(e)}));var r=(t.onBeforeStart||function(t){}).bind(t);if(i.beforeStart=F(i.beforeStart,(function(t){return r(t)})),i.dragInit=function(e,n){return t.onDragInit(e,n)},i.dragAbort=function(e){return t.onDragAbort(e)},t.useGhostProxy&&(i.useGhostProxy=t.useGhostProxy,i.makeGhostProxy=t.makeGhostProxy),null==i.constrainFunction&&null!=i.containment)switch(i.containment){case na.notNegative:i.constrainFunction=function(t,e,n,i){return{x:Math.max(0,Math.min(t.x)),y:Math.max(0,Math.min(t.y))}};break;case na.parent:var o=i.containmentPadding||5;i.constrainFunction=function(t,e,n,i){return{x:t.x<0?0:t.x>n.w-o?n.w-o:t.x,y:t.y<0?0:t.y>n.h-o?n.h-o:t.y}};break;case na.parentEnclosed:i.constrainFunction=function(t,e,n,i){return{x:t.x<0?0:t.x+i.w>n.w?n.w-i.w:t.x,y:t.y<0?0:t.y+i.h>n.h?n.h-i.h:t.y}}}null==this.drag?(i.trackScroll=this._trackScroll,this.drag=this.collicat.draggable(this.instance.getContainer(),i),T(this._filtersToAdd,(function(t){return n.drag.addFilter(t[0],t[1])})),this.drag.on(Pr,(function(t){n.instance.revalidate(t)}))):this.drag.addSelector(i),this.handlers.push({handler:t,options:i}),t.init(this.drag)}},{key:"addSelector",value:function(t,e){this.drag&&this.drag.addSelector(t,e)}},{key:"addFilter",value:function(t,e){null==this.drag?this._filtersToAdd.push([t,!0===e]):this.drag.addFilter(t,e)}},{key:"removeFilter",value:function(t){null!=this.drag&&this.drag.removeFilter(t)}},{key:"setFilters",value:function(t){var e=this;T(t,(function(t){e.drag.addFilter(t[0],t[1])}))}},{key:"reset",value:function(){var t=[];if(T(this.handlers,(function(t){t.handler.reset()})),this.handlers.length=0,null!=this.drag){var e=this.drag._filters;for(var n in e)t.push([n,e[n][1]]);this.collicat.destroyDraggable(this.instance.getContainer())}return delete this.drag,t}},{key:"setOption",value:function(t,e){var n=A(this.handlers,(function(e){return e.handler===t}));null!=n&&f(n.options,e||{})}}]),t}();var ga=function(){function t(e,n){mi(this,t),this.instance=e,this._dragSelection=n,_i(this,"selector","> "+Oe+":not("+Ht(he)+")"),_i(this,"_dragOffset",null),_i(this,"_groupLocations",[]),_i(this,"_intersectingGroups",[]),_i(this,"_currentDragParentGroup",null),_i(this,"_dragGroupByElementIdMap",{}),_i(this,"_dragGroupMap",{}),_i(this,"_currentDragGroup",null),_i(this,"_currentDragGroupOffsets",new Map),_i(this,"_currentDragGroupSizes",new Map),_i(this,"_currentDragGroupOriginalPositions",new Map),_i(this,"_dragPayload",null),_i(this,"drag",void 0),_i(this,"originalPosition",void 0)}return wi(t,[{key:"onDragInit",value:function(t){return null}},{key:"onDragAbort",value:function(t){return null}},{key:"getDropGroup",value:function(){var t=null;if(this._intersectingGroups.length>0){var e=this._intersectingGroups[0].groupLoc.group,n=this._intersectingGroups[0].intersectingElement,i=n._jsPlumbParentGroup;i!==e&&(null!=i&&i.overrideDrop(n,e)||(t=this._intersectingGroups[0]))}return t}},{key:"onStop",value:function(t){var e,n=this,i=t.drag.getDragElement(),r=this.getDropGroup(),o=[];function a(t,e,n,i,a){var s=n.x,l=n.y;if(t._jsPlumbParentGroup&&t._jsPlumbParentGroup.constrain){var u={w:t.parentNode.offsetWidth+t.parentNode.scrollLeft,h:t.parentNode.offsetHeight+t.parentNode.scrollTop};s=Math.max(s,0),l=Math.max(l,0),s=Math.min(s,u.w-i.w),l=Math.min(l,u.h-i.h),n.x=s,n.y=l}o.push({el:t,id:e,pos:n,originalPos:a,originalGroup:t._jsPlumbParentGroup,redrawResult:null,reverted:!1,dropGroup:null==r?void 0:r.groupLoc.group})}if(o.push({el:i,id:this.instance.getId(i),pos:t.finalPos,originalGroup:i._jsPlumbParentGroup,redrawResult:null,originalPos:t.originalPos,reverted:!1,dropGroup:null!=r?r.groupLoc.group:null}),this._dragSelection.each((function(e,n,i,r,o){e!==t.el&&a(e,n,{x:i.x,y:i.y},r,o)})),null===(e=this._currentDragGroup)||void 0===e||e.members.forEach((function(e){if(e.el!==t.el){var i=n._currentDragGroupOffsets.get(e.elId),r=n._currentDragGroupSizes.get(e.elId),o={x:t.finalPos.x+i[0].x,y:t.finalPos.y+i[0].y};a(e.el,e.elId,o,r,n._currentDragGroupOriginalPositions.get(e.elId))}})),T(o,(function(t){var e=null!=t.originalGroup,i=e&&Vo(n.instance,t.el,t.pos),o={x:0,y:0};if(e&&!i){if(null==r){var a=n._pruneOrOrphan(t,!0,!0);null!=a.pos?t.pos=a.pos.pos:!a.pruned&&t.originalGroup.revert&&(t.pos=t.originalPos,t.reverted=!0)}}else e&&i&&(o=n._computeOffsetByParentGroup(t.originalGroup));null==r||i?t.dropGroup=null:n.instance.groupManager.addToGroup(r.groupLoc.group,!1,t.el),t.reverted&&n.instance.setPosition(t.el,t.pos),t.redrawResult=n.instance.setElementPosition(t.el,t.pos.x+o.x,t.pos.y+o.y),n.instance.removeClass(t.el,"jtk-dragged"),n.instance.select({source:t.el}).removeClass(n.instance.elementDraggingClass+" "+n.instance.sourceElementDraggingClass,!0),n.instance.select({target:t.el}).removeClass(n.instance.elementDraggingClass+" "+n.instance.targetElementDraggingClass,!0)})),null!=o[0].originalGroup){var s=i._jsPlumbParentGroup;if(s!==o[0].originalGroup){var l=t.drag.getDragElement(!0);if(o[0].originalGroup.ghost){var u=this.instance.getPosition(this.instance.getGroupContentArea(s)),c=this.instance.getPosition(this.instance.getGroupContentArea(o[0].originalGroup)),d={x:c.x+t.pos.x-u.x,y:c.y+t.pos.y-u.y};l.style.left=d.x+"px",l.style.top=d.y+"px",this.instance.revalidate(l)}}}this.instance.fire(Ir,{elements:o,e:t.e,el:i,payload:this._dragPayload}),this._cleanup()}},{key:"_cleanup",value:function(){var t=this;T(this._groupLocations,(function(e){t.instance.removeClass(e.el,fa),t.instance.removeClass(e.el,pa)})),this._currentDragParentGroup=null,this._groupLocations.length=0,this.instance.hoverSuspended=!1,this._dragOffset=null,this._dragSelection.reset(),this._dragPayload=null,this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroupOriginalPositions.clear(),this._currentDragGroup=null}},{key:"reset",value:function(){}},{key:"init",value:function(t){this.drag=t}},{key:"onDrag",value:function(t){var e=this,n=t.drag.getDragElement(),i=this.instance.getId(n),r=t.pos,o=this.instance.viewport.getPosition(i),a={x:r.x,y:r.y};this._intersectingGroups.length=0,null!=this._dragOffset&&(a.x+=this._dragOffset.x,a.y+=this._dragOffset.y);var s=function(n,i,r){if(r){var o=new Set;T(e._groupLocations,(function(n){!o.has(n.group.id)&&lt(i,n.r)?(n.group!==e._currentDragParentGroup&&e.instance.addClass(n.el,pa),e._intersectingGroups.push({groupLoc:n,intersectingElement:t.drag.getDragElement(!0),d:0}),T(e.instance.groupManager.getAncestors(n.group),(function(t){return o.add(t.id)}))):e.instance.removeClass(n.el,pa)}))}e.instance.setElementPosition(n,i.x,i.y),e.instance.fire("drag:move",{el:n,e:t.e,pos:{x:i.x,y:i.y},originalPosition:e.originalPosition,payload:e._dragPayload})},l={x:a.x,y:a.y,w:o.w,h:o.h};s(n,l,!0),this._dragSelection.updatePositions(r,this.originalPosition,(function(t,e,n,i){s(t,i,!1)})),this._currentDragGroupOffsets.forEach((function(t,n){var i=e._currentDragGroupSizes.get(n),r={x:l.x+t[0].x,y:l.y+t[0].y,w:i.w,h:i.h};t[1].style.left=r.x+"px",t[1].style.top=r.y+"px",s(t[1],r,!1)}))}},{key:"_computeOffsetByParentGroup",value:function(t){var e=this.instance.getPosition(t.el),n=t.contentArea;if(n!==t.el){var i=this.instance.getPosition(n);e.x+=i.x,e.y+=i.y}if(t.el._jsPlumbParentGroup){var r=this._computeOffsetByParentGroup(t.el._jsPlumbParentGroup);e.x+=r.x,e.y+=r.y}return e}},{key:"onStart",value:function(t){var e=this,n=t.drag.getDragElement(),i=this.instance.getPosition(n);this.originalPosition={x:t.pos.x,y:t.pos.y},n._jsPlumbParentGroup&&(this._dragOffset=this._computeOffsetByParentGroup(n._jsPlumbParentGroup),this._currentDragParentGroup=n._jsPlumbParentGroup);var r=!0,o=n.getAttribute(oe);if((!1===this.instance.elementsDraggable||null!=o&&o!==vt)&&(r=!1),r){this._groupLocations.length=0,this._intersectingGroups.length=0,this.instance.hoverSuspended=!0;var a=t.drag.getDragElement(!0),s=a.querySelectorAll(Oe),l=function(t){for(var e=[],n=t._jsPlumbParentGroup;null!=n;)e.push(n.el),n=n.group;return e}(a),u=[];Array.prototype.push.apply(u,s),Array.prototype.push.apply(u,l),this._dragSelection.filterActiveSet((function(t){return-1===u.indexOf(t.jel)})),this._dragSelection.initialisePositions();var c=function(n,i,r){if(!n._isJsPlumbGroup||e.instance.allowNestedGroups){var o=!n._jsPlumbParentGroup,a=o||!0!==n._jsPlumbParentGroup.dropOverride,s=!o&&(n._jsPlumbParentGroup.ghost||!0!==n._jsPlumbParentGroup.constrain);(o||a&&s)&&(T(e.instance.groupManager.getGroups(),(function(t){var i=n._jsPlumbGroup;if(!1!==t.droppable&&!1!==t.enabled&&n._jsPlumbGroup!==t&&!e.instance.groupManager.isDescendant(t,i)){var r=t.el,o=e.instance.getId(r),a=e.instance.viewport.getPosition(o),s={el:r,r:{x:a.x,y:a.y,w:a.w,h:a.h},group:t};e._groupLocations.push(s),t!==e._currentDragParentGroup&&e.instance.addClass(r,fa)}})),e._groupLocations.sort((function(t,n){return e.instance.groupManager.isDescendant(t.group,n.group)?-1:e.instance.groupManager.isAncestor(n.group,t.group)?1:0})))}return e.instance.select({source:n}).addClass(e.instance.elementDraggingClass+" "+e.instance.sourceElementDraggingClass,!0),e.instance.select({target:n}).addClass(e.instance.elementDraggingClass+" "+e.instance.targetElementDraggingClass,!0),e.instance.fire(kr,{el:n,e:t.e,originalPosition:e.originalPosition,pos:e.originalPosition,dragGroup:i,dragGroupMemberSpec:r})},d=this.instance.getId(n);this._currentDragGroup=this._dragGroupByElementIdMap[d],this._currentDragGroup&&!function(t,e){var n=S(t.members,(function(t){return t.el===e}));return null!==n&&!0===n.active}(this._currentDragGroup,n)&&(this._currentDragGroup=null);var f=c(n);if(!1===f)return this._cleanup(),!1;this._dragPayload=f,null!=this._currentDragGroup&&(this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroup.members.forEach((function(t){var n=e.instance.viewport.getPosition(t.elId);e._currentDragGroupOffsets.set(t.elId,[{x:n.x-i.x,y:n.y-i.y},t.el]),e._currentDragGroupSizes.set(t.elId,n),e._currentDragGroupOriginalPositions.set(t.elId,{x:n.x,y:n.y}),c(t.el,e._currentDragGroup,t)})))}return r}},{key:"addToDragGroup",value:function(t){var e=this,n=function(t,e){return h(e)?{id:e,active:!0}:{id:e.id,active:e.active}}(this.instance,t),i=this._dragGroupMap[n.id];null==i&&(i={id:n.id,members:new Set},this._dragGroupMap[n.id]=i);for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];this.removeFromDragGroup.apply(this,o),T(o,(function(t){var r=e.instance.getId(t);i.members.add({elId:r,el:t,active:n.active}),e._dragGroupByElementIdMap[r]=i}))}},{key:"removeFromDragGroup",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];T(n,(function(e){var n=t.instance.getId(e),i=t._dragGroupByElementIdMap[n];if(null!=i){var r=new Set;i.members.forEach((function(t){t.el!==e&&r.add(t)})),i.members=r,delete t._dragGroupByElementIdMap[n]}}))}},{key:"setDragGroupState",value:function(t){for(var e=this,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];T(i.map((function(t){return e.instance.getId(t)})),(function(n){var i=e._dragGroupByElementIdMap[n];if(null!=i){var r=S(i.members,(function(t){return t.elId===n}));null!=r&&(r.active=t)}}))}},{key:"clearDragGroup",value:function(t){var e=this,n=this._dragGroupMap[t];null!=n&&(n.members.forEach((function(t){delete e._dragGroupByElementIdMap[t.elId]})),n.members.clear())}},{key:"_pruneOrOrphan",value:function(t,e,n){var i=t.el,r={pruned:!1,pos:null};if(n||!Vo(this.instance,i,t.pos)){var o=i._jsPlumbParentGroup;o.prune?(i._isJsPlumbGroup?this.instance.removeGroup(i._jsPlumbGroup):o.remove(t.el,!0),r.pruned=!0):o.orphan&&(r.pos=this.instance.groupManager.orphan(t.el,e),i._isJsPlumbGroup?o.removeGroup(i._jsPlumbGroup):o.remove(t.el))}return r}}]),t}();function va(t,e,n,i,r,o){var a=function(t,e,n){return new nn(t,e,n)}(o,i,r),s={paintStyle:t.getPaintStyle(),preparedAnchor:a,element:i,scope:t.scope,cssClass:[de,t.cssClass].join(" ")};null!=e&&(q(e,Rt)?s.existingEndpoint=e:s.endpoint=e);var l=o._internal_newEndpoint(s);return o._paintEndpoint(l,{}),l}function ya(t,e,n,i,r){for(var o=t.target||t.srcElement,a=!1,s=i.getSelector(e,n),l=0;l<s.length;l++)if(s[l]===o){a=!0;break}return r?!a:a}var ba=Ht(fa,pa),ma="sourceSelectorEndpoint",Ea=function(){function t(e){mi(this,t),this.instance=e,_i(this,"jpc",void 0),_i(this,"existingJpc",void 0),_i(this,"_originalAnchorSpec",void 0),_i(this,"ep",void 0),_i(this,"endpointRepresentation",void 0),_i(this,"canvasElement",void 0),_i(this,"_activeDefinition",void 0),_i(this,"placeholderInfo",{id:null,element:null}),_i(this,"floatingIndex",void 0),_i(this,"floatingId",void 0),_i(this,"floatingElement",void 0),_i(this,"floatingEndpoint",void 0),_i(this,"floatingAnchor",void 0),_i(this,"_stopped",void 0),_i(this,"inPlaceCopy",void 0),_i(this,"endpointDropTargets",[]),_i(this,"currentDropTarget",null),_i(this,"payload",void 0),_i(this,"floatingConnections",{}),_i(this,"_forceReattach",void 0),_i(this,"_forceDetach",void 0),_i(this,"mousedownHandler",void 0),_i(this,"mouseupHandler",void 0),_i(this,"selector",Ht(ce));var n=e.getContainer();this.mousedownHandler=this._mousedownHandler.bind(this),this.mouseupHandler=this._mouseupHandler.bind(this),e.on(n,Er,Oe,this.mousedownHandler),e.on(n,Tr,[Oe,Ht(ce)].join(","),this.mouseupHandler)}return wi(t,[{key:"_resolveDragParent",value:function(t,e){var n=this.instance.getContainer(),i=Di(e,Oe,n,!0);if(null!=t.parentSelector){var r=Di(e,t.parentSelector,n,!0);return null!=r&&(i=Di(r.parentNode,Oe,n,!1)),r||i}return i}},{key:"_mousedownHandler",value:function(t){var e,n;if(3!==t.which&&2!==t.button){var i=t.target||t.srcElement;if((null==(n=this._getSourceDefinition(t))||null!=(e=this._resolveDragParent(n.def.def,i))&&e.getAttribute(dr)!==vt)&&n){var r,o=t.currentTarget;if(i.getAttribute(dr)!==vt){if(Mi(t),this._activeDefinition=n,null!=(r=n.def.def).canAcceptNewConnection&&!r.canAcceptNewConnection(e,t))return!1;var a=ka(t,e,this.instance.currentZoom),s={element:e};if(f(s,r),s.isTemporarySource=!0,r.scope)s.scope=r.scope;else{var l=i.getAttribute(fr);null!=l&&(s.scope=l)}if(null!=(s=E(s,r.parameterExtractor?r.parameterExtractor(e,i,t):{})).maxConnections&&s.maxConnections>=0)if(this.instance.select({source:e}).length>=s.maxConnections)return Mi(t),r.onMaxConnections&&r.onMaxConnections({element:e,maxConnections:s.maxConnections},t),t.stopImmediatePropagation&&t.stopImmediatePropagation(),!1;if(r.anchorPositionFinder){var u=r.anchorPositionFinder(e,a,r,t);null!=u&&(s.anchor=u)}this._originalAnchorSpec=s.anchor||(this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors[0]:this.instance.defaults.anchor);var c=this.instance.router.prepareAnchor(this._originalAnchorSpec),d=[a.x,a.y,0,0];if(c.locations.length>0)d[2]=c.locations[0].ox,d[3]=c.locations[0].oy;else if(c.isContinuous){var p=a.x<.5?a.x:1-a.x,h=a.y<.5?a.y:1-a.y;d[2]=p<h?a.x<.5?-1:1:0,d[3]=h<p?a.y<.5?-1:1:0}s.anchor=d,s.deleteOnEmpty=!0,this.ep=this.instance._internal_newEndpoint(s);var g={};if(r.extract){for(var v in r.extract){var y=i.getAttribute(v);y&&(g[r.extract[v]]=y)}this.ep.mergeParameters(g)}if(s.uniqueEndpoint){var b=this.ep.elementId,m=this.instance.getManagedData(b,ma,n.id);null==m?(this.instance.setManagedData(b,ma,n.id,this.ep),this.ep.deleteOnEmpty=!1):this.ep.finalEndpoint=m}o._jsPlumbOrphanedEndpoints=o._jsPlumbOrphanedEndpoints||[],o._jsPlumbOrphanedEndpoints.push(this.ep),this.instance.trigger(this.ep.endpoint.canvas,Er,t,g)}}}}},{key:"_mouseupHandler",value:function(t){var e=t.currentTarget||t.srcElement;e._jsPlumbOrphanedEndpoints&&(!function(t,e){t=null==t.length||"string"==typeof t?[t]:t;for(var n=0;n<t.length;n++)e(t[n])}(e._jsPlumbOrphanedEndpoints,this.instance._maybePruneEndpoint.bind(this.instance)),e._jsPlumbOrphanedEndpoints.length=0),this._activeDefinition=null}},{key:"onDragInit",value:function(t){var e=Ui(t,this.instance),n=zi(t,this.instance);return this._makeDraggablePlaceholder(e,n),this.placeholderInfo.element.jtk=t.jtk,this.placeholderInfo.element}},{key:"onDragAbort",value:function(t){this._cleanupDraggablePlaceholder()}},{key:"_makeDraggablePlaceholder",value:function(t,e){this.placeholderInfo=this.placeholderInfo||{};var n=Fi("div",{position:"absolute"});this.instance._appendElementToContainer(n);var i=this.instance.getId(n);return this.instance.setPosition(n,t),n.style.width=e.w+"px",n.style.height=e.h+"px",this.instance.manage(n),this.placeholderInfo.id=i,this.placeholderInfo.element=n,n}},{key:"_cleanupDraggablePlaceholder",value:function(){this.placeholderInfo.element&&(this.instance.unmanage(this.placeholderInfo.element,!0),delete this.placeholderInfo.element,delete this.placeholderInfo.id)}},{key:"reset",value:function(){var t=this.instance.getContainer();this.instance.off(t,Tr,this.mouseupHandler),this.instance.off(t,Er,this.mousedownHandler)}},{key:"init",value:function(t){}},{key:"startNewConnectionDrag",value:function(t,e){this.jpc=this.instance._newConnection({sourceEndpoint:this.ep,targetEndpoint:this.floatingEndpoint,source:this.ep.element,target:this.placeholderInfo.element,paintStyle:this.ep.connectorStyle,hoverPaintStyle:this.ep.connectorHoverStyle,connector:this.ep.connector,overlays:this.ep.connectorOverlays,type:this.ep.edgeType,cssClass:this.ep.connectorClass,hoverClass:this.ep.connectorHoverClass,scope:t,data:e}),this.jpc.pending=!0,this.jpc.addClass(this.instance.draggingClass),this.ep.addClass(this.instance.draggingClass),this.instance.fire(Nr,this.jpc)}},{key:"startExistingConnectionDrag",value:function(){this.existingJpc=!0,this.instance.setHover(this.jpc,!1);var t=this.jpc.endpoints[0].id===this.ep.id?0:1;this.ep.detachFromConnection(this.jpc,null,!0),this.floatingEndpoint.addConnection(this.jpc),this.instance.fire(Nr,this.jpc),this.instance.sourceOrTargetChanged(this.jpc.endpoints[t].elementId,this.placeholderInfo.id,this.jpc,this.placeholderInfo.element,t),this.jpc.suspendedEndpoint=this.jpc.endpoints[t],this.jpc.suspendedElement=this.jpc.endpoints[t].element,this.jpc.suspendedElementId=this.jpc.endpoints[t].elementId,this.jpc.suspendedElementType=0===t?Zt:Kt,this.instance.setHover(this.jpc.suspendedEndpoint,!1),this.floatingEndpoint.referenceEndpoint=this.jpc.suspendedEndpoint,this.floatingEndpoint.mergeParameters(this.jpc.suspendedEndpoint.parameters),this.jpc.endpoints[t]=this.floatingEndpoint,this.jpc.addClass(this.instance.draggingClass),this.floatingId=this.placeholderInfo.id,this.floatingIndex=t,this.instance._refreshEndpoint(this.ep)}},{key:"_shouldStartDrag",value:function(){var t=!0;this.ep.enabled||(t=!1),null!=this.jpc||this.ep.isSource||this.ep.isTemporarySource||(t=!1),!this.ep.isSource||!this.ep.isFull()||null!=this.jpc&&this.ep.dragAllowedWhenFull||(t=!1),null==this.jpc||this.jpc.isDetachable(this.ep)||(this.ep.isFull()?t=!1:this.jpc=null);var e={},n=this.instance.checkCondition(null==this.jpc?"beforeDrag":"beforeStartDetach",{endpoint:this.ep,source:this.ep.element,sourceId:this.ep.elementId,connection:this.jpc});return!1===n?t=!1:"object"===bi(n)?f(e=n,this.payload||{}):e=this.payload||{},[t,e]}},{key:"_createFloatingEndpoint",value:function(t){var e=this.ep.endpoint;null!=this.ep.edgeType&&(e=this.instance._deriveEndpointAndAnchorSpec(this.ep.edgeType).endpoints[1]);this.floatingEndpoint=va(this.ep,e,0,this.placeholderInfo.element,this.placeholderInfo.id,this.instance),this.floatingAnchor=this.floatingEndpoint._anchor,this.floatingEndpoint.deleteOnEmpty=!0,this.floatingElement=this.floatingEndpoint.endpoint.canvas,this.floatingId=this.instance.getId(this.floatingElement)}},{key:"_populateTargets",value:function(t,e){var n,i,r,o=this,a=this.jpc&&this.jpc.endpoints[0]===this.ep;if(T(this.instance.getContainer().querySelectorAll([".",ce,"[",se,this.ep.scope,"]:not(.",de,")"].join("")),(function(e){if(!(null==o.jpc&&e===t||e===o.floatingElement||null==o.jpc&&e.jtk.endpoint.isFull())&&(a&&e.jtk.endpoint.isSource||!a&&e.jtk.endpoint.isTarget)){var i=Ui(e,o.instance),r=zi(e,o.instance);n={x:i.x,y:i.y,w:r.w,h:r.h},o.endpointDropTargets.push({el:e,targetEl:e,r:n,endpoint:e.jtk.endpoint,def:null}),o.instance.addClass(e,fa)}})),a){var s=A(this.instance.sourceSelectors,(function(t){return t.isEnabled()&&(null==t.def.def.scope||t.def.def.scope===o.ep.scope)}));if(null!=s)T(this._findTargetZones(s),(function(t){if(t.getAttribute(dr)!==vt){var e=t.getAttribute(fr);if(null!=e&&e!==o.ep.scope)return;var n={r:null,el:t};n.targetEl=Di(t,Oe,o.instance.getContainer(),!0);var i=Ui(n.el,o.instance),r=zi(n.el,o.instance);n.r={x:i.x,y:i.y,w:r.w,h:r.h},null!=s.def.def.rank&&(n.rank=s.def.def.rank),n.def=s.def,o.endpointDropTargets.push(n),o.instance.addClass(n.targetEl,fa)}}))}else{var l=(i=this.instance.targetSelectors,r=function(t,e){var n=[];if(t)for(var i=0;i<t.length;i++)e(t[i])&&n.push(i);return n}(i,(function(t){return t.isEnabled()})),r.map((function(t){return i[t]})));l.forEach((function(t){T(o._findTargetZones(t),(function(n){if(n.getAttribute(dr)!==vt){var i=n.getAttribute(fr);if(null!=i&&i!==o.ep.scope)return;var r={r:null,el:n};if(null!=t.def.def.parentSelector&&(r.targetEl=Di(n,t.def.def.parentSelector,o.instance.getContainer(),!0)),null==r.targetEl&&(r.targetEl=Di(n,Oe,o.instance.getContainer(),!0)),(!1===t.def.def.allowLoopback||o._activeDefinition&&!1===o._activeDefinition.def.def.allowLoopback)&&r.targetEl===o.ep.element)return;if(null!=t.def.def.canAcceptNewConnection&&!t.def.def.canAcceptNewConnection(r.targetEl,e))return;var a=t.def.def.maxConnections;if(null!=a&&-1!==a&&o.instance.select({target:r.targetEl}).length>=a)return;var s=Ui(n,o.instance),l=zi(n,o.instance);r.r={x:s.x,y:s.y,w:l.w,h:l.h},r.def=t.def,null!=t.def.def.rank&&(r.rank=t.def.def.rank),o.endpointDropTargets.push(r),o.instance.addClass(r.targetEl,fa)}}))}))}this.endpointDropTargets.sort((function(t,e){if(t.targetEl._isJsPlumbGroup&&!e.targetEl._isJsPlumbGroup)return 1;if(!t.targetEl._isJsPlumbGroup&&e.targetEl._isJsPlumbGroup)return-1;if(t.targetEl._isJsPlumbGroup&&e.targetEl._isJsPlumbGroup){if(o.instance.groupManager.isAncestor(t.targetEl._jsPlumbGroup,e.targetEl._jsPlumbGroup))return-1;if(o.instance.groupManager.isAncestor(e.targetEl._jsPlumbGroup,t.targetEl._jsPlumbGroup))return 1}else{if(null==t.rank||null==e.rank)return 0;if(t.rank>e.rank)return-1;if(t.rank<e.rank)return 1}}))}},{key:"_findTargetZones",value:function(t){var e;if("any"===t.redrop){var n=this.instance.targetSelectors.map((function(t){return t.selector}));n.push.apply(n,Pi(this.instance.sourceSelectors.map((function(t){return t.selector})))),n.push(Oe),e=n.join(",")}else if(t.redrop===ei)e=t.selector;else if("anySource"===t.redrop)e=this.instance.sourceSelectors.map((function(t){return t.selector})).join(",");else if("anyTarget"===t.redrop)e=this.instance.targetSelectors.map((function(t){return t.selector})).join(",");else if("anySourceOrTarget"===t.redrop){var i=this.instance.targetSelectors.map((function(t){return t.selector}));i.push.apply(i,Pi(this.instance.sourceSelectors.map((function(t){return t.selector})))),e=i.join(",")}return this.instance.getContainer().querySelectorAll(e)}},{key:"onStart",value:function(t){this.endpointDropTargets.length=0,this.currentDropTarget=null,this._stopped=!1;var e=t.drag.getDragElement();if(this.ep=e.jtk.endpoint,!this.ep)return!1;this.endpointRepresentation=this.ep.endpoint,this.canvasElement=this.endpointRepresentation.canvas,this.jpc=this.ep.connectorSelector();var n=ki(this._shouldStartDrag(),2),i=n[0],r=n[1];if(!1===i)return this._stopped=!0,!1;this.instance.setHover(this.ep,!1),this.instance.isConnectionBeingDragged=!0,this.jpc&&!this.ep.isFull()&&this.ep.isSource&&(this.jpc=null),this._createFloatingEndpoint(this.canvasElement),this._populateTargets(this.canvasElement,t.e),null==this.jpc?this.startNewConnectionDrag(this.ep.scope,r):this.startExistingConnectionDrag(),this._registerFloatingConnection(this.placeholderInfo,this.jpc),this.instance.currentlyDragging=!0}},{key:"onBeforeStart",value:function(t){this.payload=t.e.payload||{}}},{key:"onDrag",value:function(t){if(this._stopped)return!0;if(this.placeholderInfo.element){var e=zi(this.floatingElement,this.instance);this.instance.setElementPosition(this.placeholderInfo.element,t.pos.x,t.pos.y);for(var n,i,r={x:t.pos.x,y:t.pos.y,w:e.w,h:e.h},o=0;o<this.endpointDropTargets.length;o++)if(lt(r,this.endpointDropTargets[o].r)){n=this.endpointDropTargets[o];break}if(n!==this.currentDropTarget&&null!=this.currentDropTarget&&(i=this._getFloatingAnchorIndex(),this.instance.removeClass(this.currentDropTarget.el,pa),this.currentDropTarget.endpoint&&(this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.out()),null!=n)if(this.instance.addClass(n.el,pa),i=this._getFloatingAnchorIndex(),null!=n.endpoint)if(n.endpoint.isSource&&0===i||n.endpoint.isTarget&&0!==i||this.jpc.suspendedEndpoint&&n.endpoint.referenceEndpoint&&n.endpoint.referenceEndpoint.id===this.jpc.suspendedEndpoint.id)this.instance.checkCondition("checkDropAllowed",{sourceEndpoint:this.jpc.endpoints[i],targetEndpoint:n.endpoint.endpoint,connection:this.jpc})?(n.endpoint.endpoint.addClass(this.instance.endpointDropAllowedClass),n.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)):(n.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),n.endpoint.endpoint.addClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.over(n.endpoint),this.instance._paintConnection(this.jpc);else n=null;this.currentDropTarget=n}}},{key:"_maybeCleanup",value:function(t){t._mtNew&&0===t.connections.length?this.instance.deleteEndpoint(t):delete t._mtNew}},{key:"_reattachOrDiscard",value:function(t){var e=null!=this.jpc.suspendedEndpoint,n=this._getFloatingAnchorIndex();return e&&this._shouldReattach()?(0===n?(this.jpc.source=this.jpc.suspendedElement,this.jpc.sourceId=this.jpc.suspendedElementId):(this.jpc.target=this.jpc.suspendedElement,this.jpc.targetId=this.jpc.suspendedElementId),this._doForceReattach(n),!0):(this._discard(n,t),!1)}},{key:"onStop",value:function(t){var e=this,n=t.e;this.instance.isConnectionBeingDragged=!1,this.instance.currentlyDragging=!1;var i=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.join(" ")}(pa,fa);if(T(this.instance.getContainer().querySelectorAll(ba),(function(t){e.instance.removeClass(t,i)})),this.jpc&&null!=this.jpc.endpoints){var r,o=null!=this.jpc.suspendedEndpoint,a=this._getFloatingAnchorIndex(),s=this.jpc.suspendedEndpoint;if(null!=this.currentDropTarget)if(null==(r=this._getDropEndpoint(t,this.jpc)))this._reattachOrDiscard(t.e);else if(s&&s.id===r.id)this._doForceReattach(a);else if(r.enabled)if(r.isFull())r.fire(me,{endpoint:this,connection:this.jpc,maxConnections:this.instance.defaults.maxConnections},n),this._reattachOrDiscard(t.e);else{0===a?(this.jpc.source=r.element,this.jpc.sourceId=r.elementId):(this.jpc.target=r.element,this.jpc.targetId=r.elementId);var l=!0;o&&this.jpc.suspendedEndpoint.id!==r.id&&(this.jpc.isDetachAllowed(this.jpc)&&this.jpc.endpoints[a].isDetachAllowed(this.jpc)&&this.jpc.suspendedEndpoint.isDetachAllowed(this.jpc)&&this.instance.checkCondition("beforeDetach",this.jpc)||(l=!1)),(l=l&&r.isDropAllowed(this.jpc.sourceId,this.jpc.targetId,this.jpc.scope,this.jpc,r))?this._drop(r,a,n,l):this._reattachOrDiscard(t.e)}else this._reattachOrDiscard(t.e);else this._reattachOrDiscard(t.e);this.instance._refreshEndpoint(this.ep),this.ep.removeClass(this.instance.draggingClass),this._cleanupDraggablePlaceholder(),this.jpc.removeClass(this.instance.draggingClass),delete this.jpc.suspendedEndpoint,delete this.jpc.suspendedElement,delete this.jpc.suspendedElementType,delete this.jpc.suspendedElementId,delete this.jpc.suspendedIndex,delete this.floatingId,delete this.floatingIndex,delete this.floatingElement,delete this.floatingEndpoint,delete this.floatingAnchor,delete this.jpc.pending,null!=r&&this._maybeCleanup(r)}}},{key:"_getSourceDefinition",value:function(t){for(var e,n=this.instance.getContainer(),i=0;i<this.instance.sourceSelectors.length;i++){if((e=this.instance.sourceSelectors[i]).isEnabled())if(!1!==ya(t,n,e.selector,this.instance,e.exclude))return e}}},{key:"_getDropEndpoint",value:function(t,e){var n;if(null==this.currentDropTarget.endpoint){var i=this.currentDropTarget.def,r=t.e.target||t.e.srcElement;if(null==i)return null;var o=this.currentDropTarget.targetEl,a=ka(t.e,o,this.instance.currentZoom),s=this.instance._deriveEndpointAndAnchorSpec(e.getType().join(" "),!0),l=s.endpoints?f(t,{endpoint:i.def.endpoint||s.endpoints[1],cssClass:i.def.cssClass||"",source:!0===i.def.source,target:!0===i.def.target}):t,u=this.instance.validAnchorsSpec(s.anchors)?s.anchors:this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors:null,c=i.def.anchor,d=i.def.anchorPositionFinder?i.def.anchorPositionFinder(o,a,i.def,t.e):null,p=null!=d?d:null!=c?c:null!=u&&null!=u[1]?u[1]:null;if(null!=p&&(l=f(l,{anchor:p})),null!=i.def.portId&&(l.portId=i.def.portId),(l=E(l,i.def.parameterExtractor?i.def.parameterExtractor(this.currentDropTarget.el,r,t.e):{})).element=o,(n=this.instance._internal_newEndpoint(l))._mtNew=!0,n.deleteOnEmpty=!0,i.def.parameters&&n.mergeParameters(i.def.parameters),i.def.extract){var h={};for(var g in i.def.extract){var v=this.currentDropTarget.el.getAttribute(g);v&&(h[i.def.extract[g]]=v)}n.mergeParameters(h)}}else n=this.currentDropTarget.endpoint;return n&&(n.removeClass(this.instance.endpointDropAllowedClass),n.removeClass(this.instance.endpointDropForbiddenClass)),n}},{key:"_doForceReattach",value:function(t){this.floatingEndpoint.detachFromConnection(this.jpc,null,!0),this.jpc.endpoints[t]=this.jpc.suspendedEndpoint,this.instance.setHover(this.jpc,!1),this.jpc._forceDetach=!0,this.jpc.suspendedEndpoint.addConnection(this.jpc),this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.suspendedEndpoint.elementId,this.jpc,this.jpc.suspendedEndpoint.element,t),this.instance.deleteEndpoint(this.floatingEndpoint),this.instance.repaint(this.jpc.source),delete this.jpc._forceDetach}},{key:"_shouldReattach",value:function(){if(this.jpc.isReattach()||this.jpc._forceReattach)return!0;var t=this.jpc.suspendedEndpoint,e=this.jpc.suspendedElementType==Zt?1:0,n=this.jpc.endpoints[e];return!w(!0,!1,[[t,we,[this.jpc]],[n,we,[this.jpc]],[this.jpc,we,[this.jpc]],[this.instance,le,[_e,this.jpc]]])}},{key:"_discard",value:function(t,e){this.jpc.pending?this.instance.fire("connection:abort",this.jpc,e):(0===t?(this.jpc.source=this.jpc.suspendedEndpoint.element,this.jpc.sourceId=this.jpc.suspendedEndpoint.elementId):(this.jpc.target=this.jpc.suspendedEndpoint.element,this.jpc.targetId=this.jpc.suspendedEndpoint.elementId),this.jpc.endpoints[t]=this.jpc.suspendedEndpoint),this.floatingEndpoint&&this.floatingEndpoint.detachFromConnection(this.jpc),this.instance.deleteConnection(this.jpc,{originalEvent:e,force:!0})}},{key:"_drop",value:function(t,e,n,i){if(this.jpc.endpoints[e].detachFromConnection(this.jpc),this.jpc.suspendedEndpoint&&this.jpc.suspendedEndpoint.detachFromConnection(this.jpc),this.jpc.endpoints[e]=t,t.addConnection(this.jpc),this.jpc.suspendedEndpoint){var r=this.jpc.suspendedEndpoint.elementId;this.instance.fireMoveEvent({index:e,originalSourceId:0===e?r:this.jpc.sourceId,newSourceId:0===e?t.elementId:this.jpc.sourceId,originalTargetId:1===e?r:this.jpc.targetId,newTargetId:1===e?t.elementId:this.jpc.targetId,originalEndpoint:this.jpc.suspendedEndpoint,connection:this.jpc,newEndpoint:t},n)}(1===e?this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.targetId,this.jpc,this.jpc.target,1):this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.sourceId,this.jpc,this.jpc.source,0),this.jpc.endpoints[0].finalEndpoint)&&(this.jpc.endpoints[0].detachFromConnection(this.jpc),this.jpc.endpoints[0]=this.jpc.endpoints[0].finalEndpoint,this.jpc.endpoints[0].addConnection(this.jpc));v(i)&&this.jpc.mergeData(i),this._originalAnchorSpec&&(this.jpc.endpoints[0].setAnchor(this._originalAnchorSpec),this._originalAnchorSpec=null),this.instance._finaliseConnection(this.jpc,null,n),this.instance.setHover(this.jpc,!1),this.instance.revalidate(this.jpc.endpoints[0].element)}},{key:"_registerFloatingConnection",value:function(t,e){this.floatingConnections[t.id]=e}},{key:"_getFloatingAnchorIndex",value:function(){return null==this.floatingIndex?1:this.floatingIndex}}]),t}(),wa=function(t){Oi(n,ga);var e=Si(n);function n(t,i){var r;return mi(this,n),(r=e.call(this,t,i)).instance=t,r.dragSelection=i,_i(Ai(r),"selector",[">",lo,Oe].join(" ")),_i(Ai(r),"doRevalidate",void 0),r.doRevalidate=r._revalidate.bind(Ai(r)),r}return wi(n,[{key:"reset",value:function(){this.drag.off(Pr,this.doRevalidate)}},{key:"_revalidate",value:function(t){this.instance.revalidate(t)}},{key:"init",value:function(t){this.drag=t,t.on(Pr,this.doRevalidate)}},{key:"useGhostProxy",value:function(t,e){var n=e._jsPlumbParentGroup;return null!=n&&!0===n.ghost}},{key:"makeGhostProxy",value:function(t){var e=t,n=e.cloneNode(!0);return n._jsPlumbParentGroup=e._jsPlumbParentGroup,n}}]),n}(),_a=function(){function t(e,n){mi(this,t),this.instance=e,this.overlay=n,_i(this,"htmlElementOverlay",void 0),this.htmlElementOverlay=n}return wi(t,null,[{key:"getElement",value:function(t,e,n){if(null==t.canvas){if(n&&e){t.canvas=n(e);var i=t.instance.overlayClass+" "+(t.cssClass?t.cssClass:"");t.instance.addClass(t.canvas,i)}else t.canvas=Fi("div",{},t.instance.overlayClass+" "+(t.cssClass?t.cssClass:""));for(var r in t.instance.setAttribute(t.canvas,"jtk-overlay-id",t.id),t.attributes)t.instance.setAttribute(t.canvas,r,t.attributes[r]);t.canvas.style.position=ee,t.instance._appendElement(t.canvas,t.instance.getContainer()),t.instance.getId(t.canvas);var o="translate(-50%, -50%)";t.canvas.style.webkitTransform=o,t.canvas.style.mozTransform=o,t.canvas.style.msTransform=o,t.canvas.style.oTransform=o,t.canvas.style.transform=o,t.isVisible()||(t.canvas.style.display=te),t.canvas.jtk={overlay:t}}return t.canvas}},{key:"destroy",value:function(t){t.canvas&&t.canvas.parentNode&&t.canvas.parentNode.removeChild(t.canvas),delete t.canvas,delete t.cachedDimensions}},{key:"_getDimensions",value:function(t,e){return(null==t.cachedDimensions||e)&&(t.cachedDimensions={w:1,h:1}),t.cachedDimensions}}]),t}();function Oa(t){if(null==t.path){var e=f({"jtk-overlay-id":t.id},t.attributes);t.path=or(nr,e);var n=t.instance.overlayClass+" "+(t.cssClass?t.cssClass:"");t.instance.addClass(t.path,n),t.path.jtk={overlay:t}}var i=t.path.parentNode;if(null==i){if(t.component instanceof kn){var r=t.component.connector;i=null!=r?r.canvas:null}else if(t.component instanceof Nn){var o=t.component.endpoint;i=null!=o?o.canvas:o}null!=i&&lr(i,t.path,1)}return t.path}!function(t){Oi(n,Ae);var e=Si(n);function n(){var t;mi(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _i(Ai(t=e.call.apply(e,[this].concat(r))),"path",void 0),t}}();var Ta=function(){function t(){mi(this,t)}return wi(t,null,[{key:"paint",value:function(t,e,n,i){if(null!=n){var r=[t.x,t.y],o=[t.w,t.h];if(null!=i&&(i.xmin<0&&(r[0]+=i.xmin),i.ymin<0&&(r[1]+=i.ymin),o[0]=i.xmax+(i.xmin<0?-i.xmin:0),o[1]=i.ymax+(i.ymin<0?-i.ymin:0)),isFinite(o[0])&&isFinite(o[1])){var a={width:""+(o[0]||0),height:""+(o[1]||0)};e.containerType===gi.HTML?rr(t.canvas,f(a,{style:ar([r[0],r[1]])})):rr(t.canvas,f(a,{x:r[0],y:r[1]}))}}}}]),t}();function xa(t,e,n,i){!function(t,e){if(null!=e.canvas)return e.canvas;var n=or(er,{style:"",width:"0",height:"0","pointer-events":te,position:ee});e.canvas=n,t._appendElement(e.canvas,t.getContainer()),null!=e.cssClass&&t.addClass(n,e.cssClass),t.addClass(n,t.connectorClass),n.jtk=n.jtk||{},n.jtk.connector=e}(t,e),Ta.paint(e,t,n,i);var r=[0,0];if(i.xmin<0&&(r[0]=-i.xmin),i.ymin<0&&(r[1]=-i.ymin),e.segments.length>0){var o={d:t.getPathData(e),transform:"translate("+r[0]+","+r[1]+")","pointer-events":"visibleStroke"},a=null;if(n.outlineStroke){var s=n.outlineWidth||1,l=n.strokeWidth+2*s;(a=f({},n)).stroke=n.outlineStroke,a.strokeWidth=l,null==e.bgPath?(e.bgPath=or(nr,o),t.addClass(e.bgPath,t.connectorOutlineClass),lr(e.canvas,e.bgPath,0)):rr(e.bgPath,o),sr(e.canvas,e.bgPath,a)}var u=e;null==u.path?(u.path=or(nr,o),lr(u.canvas,u.path,n.outlineStroke?1:0)):(u.path.parentNode!==u.canvas&&lr(u.canvas,u.path,n.outlineStroke?1:0),rr(e.path,o)),sr(e.canvas,e.path,n)}}var Aa=function(){function t(){mi(this,t)}return wi(t,null,[{key:"getEndpointElement",value:function(t){if(null!=t.canvas)return t.canvas;var e=or(er,{style:"",width:"0",height:"0","pointer-events":"all",position:ee});t.canvas=e;var n=t.classes.join(" ");t.instance.addClass(e,n);for(var i=t.endpoint.scope.split(/\s/),r=0;r<i.length;r++)t.instance.setAttribute(e,se+i[r],gt);return t.instance._appendElementToContainer(e),null!=t.cssClass&&t.instance.addClass(e,t.cssClass),t.instance.addClass(e,t.instance.endpointClass),e.jtk=e.jtk||{},e.jtk.endpoint=t.endpoint,e.style.display=!1!==t.endpoint.visible?Qt:te,e}},{key:"paint",value:function(t,e,n){if(!0!==t.endpoint.deleted){this.getEndpointElement(t),Ta.paint(t,t.instance,n);var i=f({},n);i.outlineStroke&&(i.stroke=i.outlineStroke),null==t.node?(t.node=e.makeNode(t,i),t.canvas.appendChild(t.node)):null!=e.updateNode&&e.updateNode(t,t.node),sr(t.canvas,t.node,i)}}}]),t}(),Sa={};function Ia(t,e){Sa[t]=e}function ka(t,e,n){var i=e,r=bi(e.getBoundingClientRect)!==pt?e.getBoundingClientRect():{left:0,top:0,width:0,height:0},o=document.body,a=document.documentElement,s=window.pageYOffset||a.scrollTop||o.scrollTop,l=window.pageXOffset||a.scrollLeft||o.scrollLeft,u=a.clientTop||o.clientTop||0,c=a.clientLeft||o.clientLeft||0,d=r.top+s-u+0*n,f=r.left+l-c+0*n,p=To(t),h=r.width||i.offsetWidth*n,g=r.height||i.offsetHeight*n;return{x:(p.x-f)/h,y:(p.y-d)/g}}function Pa(t){return ci(t)||hi(t)||fi(t)}function Na(t,e){t.canvas&&(t.canvas.style.display=e?"block":"none")}function Ca(t){t.canvas&&t.canvas.parentNode.removeChild(t.canvas),delete t.canvas}function ja(t){return t.canvas}function Ma(t){return _a.getElement(t)}function Da(t){return _a.getElement(t,t.component,(function(e){var n=t.create(e);return t.instance.addClass(n,t.instance.overlayClass),n}))}function Ra(t,e,n,i){var r=t.x,o=t.y;return e._jsPlumbParentGroup&&e._jsPlumbParentGroup.constrain&&(r=Math.max(t.x,0),o=Math.max(t.y,0),r=Math.min(r,n.w-i.w),o=Math.min(o,n.h-i.h)),{x:r,y:o}}var La=function(t){Oi(n,oi);var e=Si(n);function n(t,i){var r;if(mi(this,n),(r=e.call(this,t,i))._instanceIndex=t,_i(Ai(r),"containerType",null),_i(Ai(r),"dragSelection",void 0),_i(Ai(r),"dragManager",void 0),_i(Ai(r),"_connectorClick",void 0),_i(Ai(r),"_connectorDblClick",void 0),_i(Ai(r),"_connectorTap",void 0),_i(Ai(r),"_connectorDblTap",void 0),_i(Ai(r),"_endpointClick",void 0),_i(Ai(r),"_endpointDblClick",void 0),_i(Ai(r),"_overlayClick",void 0),_i(Ai(r),"_overlayDblClick",void 0),_i(Ai(r),"_overlayTap",void 0),_i(Ai(r),"_overlayDblTap",void 0),_i(Ai(r),"_connectorMouseover",void 0),_i(Ai(r),"_connectorMouseout",void 0),_i(Ai(r),"_endpointMouseover",void 0),_i(Ai(r),"_endpointMouseout",void 0),_i(Ai(r),"_connectorContextmenu",void 0),_i(Ai(r),"_connectorMousedown",void 0),_i(Ai(r),"_connectorMouseup",void 0),_i(Ai(r),"_endpointMousedown",void 0),_i(Ai(r),"_endpointMouseup",void 0),_i(Ai(r),"_overlayMouseover",void 0),_i(Ai(r),"_overlayMouseout",void 0),_i(Ai(r),"_elementClick",void 0),_i(Ai(r),"_elementTap",void 0),_i(Ai(r),"_elementDblTap",void 0),_i(Ai(r),"_elementMouseenter",void 0),_i(Ai(r),"_elementMouseexit",void 0),_i(Ai(r),"_elementMousemove",void 0),_i(Ai(r),"_elementMouseup",void 0),_i(Ai(r),"_elementMousedown",void 0),_i(Ai(r),"_elementContextmenu",void 0),_i(Ai(r),"_resizeObserver",void 0),_i(Ai(r),"eventManager",void 0),_i(Ai(r),"draggingClass","jtk-dragging"),_i(Ai(r),"elementDraggingClass","jtk-element-dragging"),_i(Ai(r),"hoverClass","jtk-hover"),_i(Ai(r),"sourceElementDraggingClass","jtk-source-element-dragging"),_i(Ai(r),"targetElementDraggingClass","jtk-target-element-dragging"),_i(Ai(r),"hoverSourceClass","jtk-source-hover"),_i(Ai(r),"hoverTargetClass","jtk-target-hover"),_i(Ai(r),"dragSelectClass","jtk-drag-select"),_i(Ai(r),"managedElementsSelector",void 0),_i(Ai(r),"elementsDraggable",void 0),_i(Ai(r),"elementDragHandler",void 0),_i(Ai(r),"groupDragOptions",void 0),_i(Ai(r),"elementDragOptions",void 0),_i(Ai(r),"svg",{node:function(t,e){return or(t,e)},attr:function(t,e){return rr(t,e)},pos:function(t){return ar(t)}}),i=i||{},r.containerType=Ji(r.getContainer()),r.elementsDraggable=i&&!1!==i.elementsDraggable,r.managedElementsSelector=i&&i.managedElementsSelector||Oe,r.eventManager=new Lo,r.dragSelection=new da(Ai(r)),r.dragManager=new ha(Ai(r),r.dragSelection),r.dragManager.addHandler(new Ea(Ai(r))),r.groupDragOptions={constrainFunction:Ra},r.dragManager.addHandler(new wa(Ai(r),r.dragSelection),r.groupDragOptions),r.elementDragHandler=new ga(Ai(r),r.dragSelection),r.elementDragOptions=i&&i.dragOptions||{},r.dragManager.addHandler(r.elementDragHandler,r.elementDragOptions),i&&i.dragOptions&&i.dragOptions.filter&&r.dragManager.addFilter(i.dragOptions.filter),r._createEventListeners(),r._attachEventDelegates(),!1!==i.resizeObserver)try{r._resizeObserver=new ResizeObserver((function(t){var e=t.filter((function(t){var e=r.getAttribute(t.target,re);if(null!=e){var n=r.viewport._elementMap.get(e);return!!n&&(n.w!==t.contentRect.width||n.h!==t.contentRect.height)}return!1}));e.forEach((function(t){return r.revalidate(t.target)}))}))}catch(t){V("WARN: ResizeObserver could not be attached.")}return r}return wi(n,[{key:"fireOverlayMethod",value:function(t,e,n){var i=ur(t.component instanceof kn?gr:pr,e);n._jsPlumbOverlay=t,t.fire(e,{e:n,overlay:t}),this.fire(i,t.component,n)}},{key:"addDragFilter",value:function(t,e){this.dragManager.addFilter(t,e)}},{key:"removeDragFilter",value:function(t){this.dragManager.removeFilter(t)}},{key:"setDragGrid",value:function(t){this.dragManager.setOption(this.elementDragHandler,{grid:t})}},{key:"setDragConstrainFunction",value:function(t){this.dragManager.setOption(this.elementDragHandler,{constrainFunction:t})}},{key:"_removeElement",value:function(t){t.parentNode&&t.parentNode.removeChild(t)}},{key:"_appendElement",value:function(t,e){e&&e.appendChild(t)}},{key:"_appendElementToGroup",value:function(t,e){this.getGroupContentArea(t).appendChild(e)}},{key:"_appendElementToContainer",value:function(t){this._appendElement(t,this.getContainer())}},{key:"_getAssociatedElements",value:function(t){var e=[];if(3!==t.nodeType&&8!==t.nodeType){var n=t.querySelectorAll(Oe);Array.prototype.push.apply(e,n)}return e.filter((function(t){return 3!==t.nodeType&&8!==t.nodeType}))}},{key:"shouldFireEvent",value:function(t,e,n){return!0}},{key:"getClass",value:function(t){return function(t){return Li(t)}(t)}},{key:"addClass",value:function(t,e){Bi(t,e)}},{key:"hasClass",value:function(t,e){return function(t,e){return t.classList?t.classList.contains(e):-1!==Li(t).indexOf(e)}(t,e)}},{key:"removeClass",value:function(t,e){$i(t,e)}},{key:"toggleClass",value:function(t,e){!function(t,e){var n=this,i=function(t,e){null!=t&&null!=e&&e.length>0&&(t.classList?t.classList.toggle(e):n.hasClass(t,e)?n.removeClass(t,e):n.addClass(t,e))};Vi(t)?T(t,(function(t){return i(t,e)})):i(t,e)}(t,e)}},{key:"setAttribute",value:function(t,e,n){t.setAttribute(e,n)}},{key:"getAttribute",value:function(t,e){return t.getAttribute(e)}},{key:"setAttributes",value:function(t,e){for(var n in e)t.setAttribute(n,e[n])}},{key:"removeAttribute",value:function(t,e){t.removeAttribute&&t.removeAttribute(e)}},{key:"on",value:function(t,e,n,i){var r=this,o=function(t){null==i?r.eventManager.on(t,e,n):r.eventManager.on(t,e,n,i)};return Vi(t)?T(t,(function(t){return o(t)})):o(t),this}},{key:"off",value:function(t,e,n){var i=this;return Vi(t)?T(t,(function(t){return i.eventManager.off(t,e,n)})):this.eventManager.off(t,e,n),this}},{key:"trigger",value:function(t,e,n,i,r){this.eventManager.trigger(t,e,n,i,r)}},{key:"getOffsetRelativeToRoot",value:function(t){return qi(t)}},{key:"getOffset",value:function(t){for(var e,n=t,i=this.getContainer(),r=this.getPosition(n),o=t!==i&&n.offsetParent!==i?n.offsetParent:null;null!=o;)r.x+=o.offsetLeft,r.y+=o.offsetTop,null!=(e=o)&&e!==document.body&&(e.scrollTop>0||e.scrollLeft>0)&&(r.x-=e.scrollLeft,r.y-=e.scrollTop),o=o.offsetParent===i?null:o.offsetParent;if(null!=i&&(i.scrollTop>0||i.scrollLeft>0)){var a=null!=n.offsetParent?this.getStyle(n.offsetParent,oo):"static",s=this.getStyle(n,oo);s!==ee&&s!==ne&&a!==ee&&a!==ne&&(r.x-=i.scrollLeft,r.y-=i.scrollTop)}return r}},{key:"getSize",value:function(t){var e=t;return null!=e.offsetWidth?function(t){return{w:t.offsetWidth,h:t.offsetHeight}}(t):e.width&&e.width.baseVal?function(t){try{return{w:parseFloat(t.width.baseVal.value),h:parseFloat(t.height.baseVal.value)}}catch(t){return{w:0,h:0}}}(e):void 0}},{key:"getPosition",value:function(t){var e=t;return null!=e.offsetLeft?{x:parseFloat(e.offsetLeft),y:parseFloat(e.offsetTop)}:e.x&&e.x.baseVal?function(t){try{return{x:parseFloat(t.x.baseVal.value),y:parseFloat(t.y.baseVal.value)}}catch(t){return{x:0,y:0}}}(e):void 0}},{key:"getStyle",value:function(t,e){return bi(window.getComputedStyle)!==pt?getComputedStyle(t,null).getPropertyValue(e):t.currentStyle[e]}},{key:"getGroupContentArea",value:function(t){var e=this.getSelector(t.el,uo);return e&&e.length>0?e[0]:t.el}},{key:"getSelector",value:function(t,e){var n=null;if(1===arguments.length){if(!h(t)){var i=document.createDocumentFragment();return i.appendChild(t),k(i.childNodes)}n=k(document.querySelectorAll(t))}else n=k(t.querySelectorAll(e));return n}},{key:"setPosition",value:function(t,e){var n=t;n.style.left=e.x+"px",n.style.top=e.y+"px"}},{key:"setDraggable",value:function(t,e){e?this.removeAttribute(t,oe):this.setAttribute(t,oe,gt)}},{key:"isDraggable",value:function(t){var e=this.getAttribute(t,oe);return null==e||e===vt}},{key:"toggleDraggable",value:function(t){var e=this.isDraggable(t);return this.setDraggable(t,!e),!e}},{key:"_createEventListeners",value:function(){var t=function(t,e){if(!e.defaultPrevented&&null==e._jsPlumbOverlay){var n=Di(Ri(e),ao,this.getContainer(),!0);this.fire(t,n.jtk.connector.connection,e)}};this._connectorClick=t.bind(this,Xr),this._connectorDblClick=t.bind(this,Zr),this._connectorTap=t.bind(this,ro),this._connectorDblTap=t.bind(this,Kr);var e=function(t,e){var n=Ri(e).parentNode;if(n.jtk&&n.jtk.connector){var i=n.jtk.connector,r=i.connection;this.setConnectorHover(i,t),t?(this.addClass(r.source,this.hoverSourceClass),this.addClass(r.target,this.hoverTargetClass)):(this.removeClass(r.source,this.hoverSourceClass),this.removeClass(r.target,this.hoverTargetClass)),this.fire(t?to:Qr,n.jtk.connector.connection,e)}};this._connectorMouseover=e.bind(this,!0),this._connectorMouseout=e.bind(this,!1);var n=function(t,e){var n=Ri(e).parentNode;n.jtk&&n.jtk.connector&&this.fire(t?eo:no,n.jtk.connector.connection,e)};this._connectorMouseup=n.bind(this,!0),this._connectorMousedown=n.bind(this,!1),this._connectorContextmenu=function(t){var e=Ri(t).parentNode;e.jtk&&e.jtk.connector&&this.fire(io,e.jtk.connector.connection,t)}.bind(this);var i=function(t,e,n){e.defaultPrevented||null!=e._jsPlumbOverlay||this.fire(t,n.jtk.endpoint,e)};this._endpointClick=i.bind(this,Fr),this._endpointDblClick=i.bind(this,Gr);var r=function(t,e){var n=Ri(e);n.jtk&&n.jtk.endpoint&&(this.setEndpointHover(n.jtk.endpoint,t),this.fire(t?Ur:qr,n.jtk.endpoint,e))};this._endpointMouseover=r.bind(this,!0),this._endpointMouseout=r.bind(this,!1);var o=function(t,e){var n=Ri(e);n.jtk&&n.jtk.endpoint&&this.fire(t?zr:Jr,n.jtk.endpoint,e)};this._endpointMouseup=o.bind(this,!0),this._endpointMousedown=o.bind(this,!1);var a=function(t,e){var n=Di(Ri(e),co,this.getContainer(),!0).jtk.overlay;n&&this.fireOverlayMethod(n,t,e)}.bind(this);this._overlayClick=a.bind(this,vr),this._overlayDblClick=a.bind(this,br),this._overlayTap=a.bind(this,Sr),this._overlayDblTap=a.bind(this,mr);var s=function(t,e){var n=Di(Ri(e),co,this.getContainer(),!0).jtk.overlay;n&&this.setOverlayHover(n,t)};this._overlayMouseover=s.bind(this,!0),this._overlayMouseout=s.bind(this,!1);this._elementClick=function(t,e,n){e.defaultPrevented||this.fire(1===e.detail?Cr:jr,n,e)}.bind(this,Cr);this._elementTap=function(t,e,n){e.defaultPrevented||this.fire($r,n,e)}.bind(this,$r);this._elementDblTap=function(t,e,n){e.defaultPrevented||this.fire(Mr,n,e)}.bind(this,Mr);var l=function(t,e){this.fire(t?Rr:Dr,Ri(e),e)};this._elementMouseenter=l.bind(this,!0),this._elementMouseexit=l.bind(this,!1),this._elementMousemove=function(t){this.fire(Lr,Ri(t),t)}.bind(this),this._elementMouseup=function(t){this.fire(Yr,Ri(t),t)}.bind(this),this._elementMousedown=function(t){this.fire(Vr,Ri(t),t)}.bind(this),this._elementContextmenu=function(t){this.fire(Br,Ri(t),t)}.bind(this)}},{key:"_attachEventDelegates",value:function(){var t=this.getContainer();this.eventManager.on(t,vr,co,this._overlayClick),this.eventManager.on(t,br,co,this._overlayDblClick),this.eventManager.on(t,Sr,co,this._overlayTap),this.eventManager.on(t,mr,co,this._overlayDblTap),this.eventManager.on(t,vr,ao,this._connectorClick),this.eventManager.on(t,br,ao,this._connectorDblClick),this.eventManager.on(t,Sr,ao,this._connectorTap),this.eventManager.on(t,mr,ao,this._connectorDblTap),this.eventManager.on(t,vr,so,this._endpointClick),this.eventManager.on(t,br,so,this._endpointDblClick),this.eventManager.on(t,vr,this.managedElementsSelector,this._elementClick),this.eventManager.on(t,Sr,this.managedElementsSelector,this._elementTap),this.eventManager.on(t,mr,this.managedElementsSelector,this._elementDblTap),this.eventManager.on(t,Ar,ao,this._connectorMouseover),this.eventManager.on(t,xr,ao,this._connectorMouseout),this.eventManager.on(t,yr,ao,this._connectorContextmenu),this.eventManager.on(t,Tr,ao,this._connectorMouseup),this.eventManager.on(t,Er,ao,this._connectorMousedown),this.eventManager.on(t,Ar,so,this._endpointMouseover),this.eventManager.on(t,xr,so,this._endpointMouseout),this.eventManager.on(t,Tr,so,this._endpointMouseup),this.eventManager.on(t,Er,so,this._endpointMousedown),this.eventManager.on(t,Ar,co,this._overlayMouseover),this.eventManager.on(t,xr,co,this._overlayMouseout),this.eventManager.on(t,Ar,Oe,this._elementMouseenter),this.eventManager.on(t,xr,Oe,this._elementMouseexit),this.eventManager.on(t,Or,Oe,this._elementMousemove),this.eventManager.on(t,Tr,Oe,this._elementMouseup),this.eventManager.on(t,Er,Oe,this._elementMousedown),this.eventManager.on(t,yr,Oe,this._elementContextmenu)}},{key:"_detachEventDelegates",value:function(){var t=this.getContainer();t&&(this.eventManager.off(t,vr,this._connectorClick),this.eventManager.off(t,br,this._connectorDblClick),this.eventManager.off(t,Sr,this._connectorTap),this.eventManager.off(t,mr,this._connectorDblTap),this.eventManager.off(t,vr,this._endpointClick),this.eventManager.off(t,br,this._endpointDblClick),this.eventManager.off(t,vr,this._overlayClick),this.eventManager.off(t,br,this._overlayDblClick),this.eventManager.off(t,Sr,this._overlayTap),this.eventManager.off(t,mr,this._overlayDblTap),this.eventManager.off(t,vr,this._elementClick),this.eventManager.off(t,Sr,this._elementTap),this.eventManager.off(t,mr,this._elementDblTap),this.eventManager.off(t,Ar,this._connectorMouseover),this.eventManager.off(t,xr,this._connectorMouseout),this.eventManager.off(t,yr,this._connectorContextmenu),this.eventManager.off(t,Tr,this._connectorMouseup),this.eventManager.off(t,Er,this._connectorMousedown),this.eventManager.off(t,Ar,this._endpointMouseover),this.eventManager.off(t,xr,this._endpointMouseout),this.eventManager.off(t,Tr,this._endpointMouseup),this.eventManager.off(t,Er,this._endpointMousedown),this.eventManager.off(t,Ar,this._overlayMouseover),this.eventManager.off(t,xr,this._overlayMouseout),this.eventManager.off(t,wr,this._elementMouseenter),this.eventManager.off(t,_r,this._elementMouseexit),this.eventManager.off(t,Or,this._elementMousemove),this.eventManager.off(t,Tr,this._elementMouseup),this.eventManager.off(t,Er,this._elementMousedown),this.eventManager.off(t,yr,this._elementContextmenu))}},{key:"setContainer",value:function(t){var e,i=this;if(t===document||t===document.body)throw new Error("Cannot set document or document.body as container element");this._detachEventDelegates(),null!=this.dragManager&&(e=this.dragManager.reset()),this.setAttribute(t,cr,D().replace("-",""));var r=this.getContainer();null!=r&&(r.removeAttribute(cr),T(k(r.childNodes).filter((function(t){return null!=t&&(i.hasClass(t,ue)||i.hasClass(t,ce)||i.hasClass(t,he)||t.getAttribute&&null!=t.getAttribute(re))})),(function(e){t.appendChild(e)})));Ii(Ti(n.prototype),"setContainer",this).call(this,t),this.containerType=Ji(t),null!=this.eventManager&&this._attachEventDelegates(),null!=this.dragManager&&(this.dragManager.addHandler(new Ea(this)),this.dragManager.addHandler(new wa(this,this.dragSelection),this.groupDragOptions),this.elementDragHandler=new ga(this,this.dragSelection),this.dragManager.addHandler(this.elementDragHandler,this.elementDragOptions),null!=e&&this.dragManager.setFilters(e))}},{key:"reset",value:function(){Ii(Ti(n.prototype),"reset",this).call(this),this._resizeObserver&&this._resizeObserver.disconnect(),T(this.getContainer().querySelectorAll([Oe,so,ao,co].join(",")),(function(t){return t.parentNode&&t.parentNode.removeChild(t)}))}},{key:"destroy",value:function(){this._detachEventDelegates(),null!=this.dragManager&&this.dragManager.reset(),this.clearDragSelection(),Ii(Ti(n.prototype),"destroy",this).call(this)}},{key:"unmanage",value:function(t,e){null!=this._resizeObserver&&this._resizeObserver.unobserve(t),this.removeFromDragSelection(t),Ii(Ti(n.prototype),"unmanage",this).call(this,t,e)}},{key:"addToDragSelection",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];T(n,(function(e){return t.dragSelection.add(e)}))}},{key:"clearDragSelection",value:function(){this.dragSelection.clear()}},{key:"removeFromDragSelection",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];T(n,(function(e){return t.dragSelection.remove(e)}))}},{key:"toggleDragSelection",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];T(n,(function(e){return t.dragSelection.toggle(e)}))}},{key:"addToDragGroup",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(e=this.elementDragHandler).addToDragGroup.apply(e,[t].concat(i))}},{key:"removeFromDragGroup",value:function(){var t;(t=this.elementDragHandler).removeFromDragGroup.apply(t,arguments)}},{key:"setDragGroupState",value:function(t){for(var e,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(e=this.elementDragHandler).setDragGroupState.apply(e,[t].concat(i))}},{key:"clearDragGroup",value:function(t){this.elementDragHandler.clearDragGroup(t)}},{key:"consume",value:function(t,e){Mi(t,e)}},{key:"rotate",value:function(t,e,i){var r=this.getId(t);return this._managedElements[r]?(this._managedElements[r].el.style.transform="rotate("+e+"deg)",this._managedElements[r].el.style.transformOrigin="center center",Ii(Ti(n.prototype),"rotate",this).call(this,t,e,i)):{c:new Set,e:new Set}}},{key:"addOverlayClass",value:function(t,e){if(Pe(t))t.instance.addClass(Ma(t),e);else if(Pa(t))t.instance.addClass(Oa(t),e);else{if(!yi(t))throw"Could not add class to overlay of type ["+t.type+"]";t.instance.addClass(Da(t),e)}}},{key:"removeOverlayClass",value:function(t,e){if(Pe(t))t.instance.removeClass(Ma(t),e);else if(Pa(t))t.instance.removeClass(Oa(t),e);else{if(!yi(t))throw"Could not remove class from overlay of type ["+t.type+"]";t.instance.removeClass(Da(t),e)}}},{key:"_paintOverlay",value:function(t,e,n){if(Pe(t)){Ma(t);var i=t.component.getXY();t.canvas.style.left=i.x+e.d.minx+"px",t.canvas.style.top=i.y+e.d.miny+"px"}else if(Pa(t)){!function(t,e,n,i){Oa(t);var r=[0,0];i.xmin<0&&(r[0]=-i.xmin),i.ymin<0&&(r[1]=-i.ymin);var o={d:e,stroke:n.stroke?n.stroke:null,fill:n.fill?n.fill:null,transform:"translate("+r[0]+","+r[1]+")","pointer-events":"visibleStroke"};rr(t.path,o)}(t,isNaN(e.d.cxy.x)||isNaN(e.d.cxy.y)?"M 0 0":"M"+e.d.hxy.x+","+e.d.hxy.y+" L"+e.d.tail[0].x+","+e.d.tail[0].y+" L"+e.d.cxy.x+","+e.d.cxy.y+" L"+e.d.tail[1].x+","+e.d.tail[1].y+" Z",e,n)}else{if(!yi(t))throw"Could not paint overlay of type ["+t.type+"]";Da(t);var r=t.component.getXY();t.canvas.style.left=r.x+e.d.minx+"px",t.canvas.style.top=r.y+e.d.miny+"px"}}},{key:"setOverlayVisible",value:function(t,e){var n=e?"block":"none";function i(t){null!=t&&(t.style.display=n)}Pe(t)?i(Ma(t)):yi(t)?i(Da(t)):Pa(t)&&i(t.path)}},{key:"reattachOverlay",value:function(t,e){Pe(t)?t.instance._appendElement(Ma(t),this.getContainer()):yi(t)?t.instance._appendElement(Da(t),this.getContainer()):Pa(t)&&this._appendElement(Oa(t),e.connector.canvas)}},{key:"setOverlayHover",value:function(t,e){var n;Pe(t)?n=Ma(t):yi(t)?n=Da(t):Pa(t)&&(n=Oa(t)),null!=n&&(null!=this.hoverClass&&(e?this.addClass(n,this.hoverClass):this.removeClass(n,this.hoverClass)),this.setHover(t.component,e))}},{key:"destroyOverlay",value:function(t){if(Pe(t)){var e=Ma(t);e.parentNode.removeChild(e),delete t.canvas,delete t.cachedDimensions}else if(ci(t)||hi(t)||fi(t))!function(t,e){var n=t;null!=n.path&&null!=n.path.parentNode&&n.path.parentNode.removeChild(n.path),null!=n.bgPath&&null!=n.bgPath.parentNode&&n.bgPath.parentNode.removeChild(n.bgPath),delete n.path,delete n.bgPath}(t);else if(yi(t)){var n=Da(t);n.parentNode.removeChild(n),delete t.canvas,delete t.cachedDimensions}}},{key:"drawOverlay",value:function(t,e,n,i){if(Pe(t)||yi(t)){var r=_a._getDimensions(t);if(null!=r&&null!=r.w&&null!=r.h){var o={x:0,y:0};if(i)o={x:i.x,y:i.y};else if(e instanceof Rt){var a=Array.isArray(t.location)?t.location:[t.location,t.location];o={x:a[0]*e.w,y:a[1]*e.h}}else{var s=t.location,l=!1;(h(t.location)||t.location<0||t.location>1)&&(s=parseInt(""+t.location,10),l=!0),o=e.pointOnPath(s,l)}var u=o.x-r.w/2,c=o.y-r.h/2;return{component:t,d:{minx:u,miny:c,td:r,cxy:o},xmin:u,xmax:u+r.w,ymin:c,ymax:c+r.h}}return{xmin:0,xmax:0,ymin:0,ymax:0}}if(ci(t)||hi(t)||fi(t))return t.draw(e,n,i);throw"Could not draw overlay of type ["+t.type+"]"}},{key:"updateLabel",value:function(t){if(b(t.label)){var e=t.label(this);Ma(t).innerText=null!=e?e:""}else null==t.labelText&&(t.labelText=t.label,null!=t.labelText?Ma(t).innerText=t.labelText:Ma(t).innerText="")}},{key:"setHover",value:function(t,e){t._hover=e,t instanceof Nn&&null!=t.endpoint?this.setEndpointHover(t,e,-1):t instanceof kn&&null!=t.connector&&this.setConnectorHover(t.connector,e)}},{key:"paintConnector",value:function(t,e,n){xa(this,t,e,n)}},{key:"setConnectorHover",value:function(t,e,n){if(!1===e||!this.currentlyDragging&&!this.isHoverSuspended()){var i=t.canvas;null!=i&&(null!=t.hoverClass&&(e?this.addClass(i,t.hoverClass):this.removeClass(i,t.hoverClass)),e?this.addClass(i,this.hoverClass):this.removeClass(i,this.hoverClass)),null!=t.connection.hoverPaintStyle&&(t.connection.paintStyleInUse=e?t.connection.hoverPaintStyle:t.connection.paintStyle,this._suspendDrawing||this._paintConnection(t.connection)),t.connection.endpoints[0]!==n&&this.setEndpointHover(t.connection.endpoints[0],e,0,!0),t.connection.endpoints[1]!==n&&this.setEndpointHover(t.connection.endpoints[1],e,1,!0)}}},{key:"destroyConnector",value:function(t){null!=t.connector&&Ca(t.connector)}},{key:"addConnectorClass",value:function(t,e){t.canvas&&this.addClass(t.canvas,e)}},{key:"removeConnectorClass",value:function(t,e){t.canvas&&this.removeClass(t.canvas,e)}},{key:"getConnectorClass",value:function(t){return t.canvas?t.canvas.className.baseVal:""}},{key:"setConnectorVisible",value:function(t,e){Na(t,e)}},{key:"applyConnectorType",value:function(t,e){if(t.canvas&&e.cssClass){var n=Array.isArray(e.cssClass)?e.cssClass:[e.cssClass];this.addClass(t.canvas,n.join(" "))}}},{key:"addEndpointClass",value:function(t,e){var n=ja(t.endpoint);null!=n&&this.addClass(n,e)}},{key:"applyEndpointType",value:function(t,e){if(e.cssClass){var n=ja(t.endpoint);if(n){var i=Array.isArray(e.cssClass)?e.cssClass:[e.cssClass];this.addClass(n,i.join(" "))}}}},{key:"destroyEndpoint",value:function(t){var e=this.endpointAnchorClassPrefix+(t.currentAnchorClass?"-"+t.currentAnchorClass:"");this.removeClass(t.element,e),Ca(t.endpoint)}},{key:"renderEndpoint",value:function(t,e){var n=Sa[t.endpoint.type];null!=n?Aa.paint(t.endpoint,n,e):V("jsPlumb: no endpoint renderer found for type ["+t.endpoint.type+"]")}},{key:"removeEndpointClass",value:function(t,e){var n=ja(t.endpoint);null!=n&&this.removeClass(n,e)}},{key:"getEndpointClass",value:function(t){var e=ja(t.endpoint);return null!=e?e.className:""}},{key:"setEndpointHover",value:function(t,e,n,i){if(null!=t&&(!1===e||!this.currentlyDragging&&!this.isHoverSuspended())){var r=ja(t.endpoint);if(null!=r&&(null!=t.hoverClass&&(e?this.addClass(r,t.hoverClass):this.removeClass(r,t.hoverClass)),0===n||1===n)){var o=0===n?this.hoverSourceClass:this.hoverTargetClass;e?this.addClass(r,o):this.removeClass(r,o)}if(null!=t.hoverPaintStyle&&(t.paintStyleInUse=e?t.hoverPaintStyle:t.paintStyle,this._suspendDrawing||this.renderEndpoint(t,t.paintStyleInUse)),!i)for(var a=0;a<t.connections.length;a++)this.setConnectorHover(t.connections[a].connector,e,t)}}},{key:"setEndpointVisible",value:function(t,e){Na(t.endpoint,e)}},{key:"setGroupVisible",value:function(t,e){for(var n=t.el.querySelectorAll(Oe),i=0;i<n.length;i++)e?this.show(n[i],!0):this.hide(n[i],!0)}},{key:"deleteConnection",value:function(t,e){return null!=t&&!0!==t.deleted&&(!0!==t.endpoints[0].deleted&&this.setEndpointHover(t.endpoints[0],!1,0,!0),!0!==t.endpoints[1].deleted&&this.setEndpointHover(t.endpoints[1],!1,1,!0),Ii(Ti(n.prototype),"deleteConnection",this).call(this,t,e))}},{key:"addSourceSelector",value:function(t,e,i){return this.addDragFilter(t),Ii(Ti(n.prototype),"addSourceSelector",this).call(this,t,e,i)}},{key:"removeSourceSelector",value:function(t){this.removeDragFilter(t.selector),Ii(Ti(n.prototype),"removeSourceSelector",this).call(this,t)}},{key:"manage",value:function(t,e,i){if(this.containerType===gi.SVG&&Ji(t)!==gi.SVG)throw new Error("ERROR: cannot manage non-svg element when container is an SVG element.");var r=Ii(Ti(n.prototype),"manage",this).call(this,t,e,i);return null!=r&&null!=this._resizeObserver&&this._resizeObserver.observe(r.el),r}}]),n}(),Ya={width:10,height:0,fill:"transparent",stroke:"transparent"};Ia(Lt.type,{makeNode:function(t,e){return or("circle",{cx:t.w/2,cy:t.h/2,r:t.radius})},updateNode:function(t,e){rr(e,{cx:""+t.w/2,cy:""+t.h/2,r:""+t.radius})}}),Ia(Vt.type,{makeNode:function(t,e){return or("rect",Ya)},updateNode:function(t,e){rr(e,Ya)}}),Ia($t.type,{makeNode:function(t,e){return or("rect",{width:t.w,height:t.h})},updateNode:function(t,e){rr(e,{width:t.w,height:t.h})}});var Va=0;function Ba(t){return new La(function(){var t=Va+1;return Va++,t}(),t)}function $a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ga(t,e,n){return e&&Fa(t.prototype,e),n&&Fa(t,n),t}function qa(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ua(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ja(t,e)}function za(t){return za=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},za(t)}function Ja(t,e){return Ja=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Ja(t,e)}function Wa(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ha(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=za(t);if(e){var r=za(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?Wa(t):e}(this,n)}}var Xa=function(t){Ua(n,Gt);var e=Ha(n);function n(t,i){var r;return $a(this,n),(r=e.call(this,t,i)).connection=t,qa(Wa(r),"showLoopback",void 0),qa(Wa(r),"curviness",void 0),qa(Wa(r),"margin",void 0),qa(Wa(r),"proximityLimit",void 0),qa(Wa(r),"orientation",void 0),qa(Wa(r),"loopbackRadius",void 0),qa(Wa(r),"clockwise",void 0),qa(Wa(r),"isLoopbackCurrently",void 0),qa(Wa(r),"geometry",null),i=i||{},r.showLoopback=!1!==i.showLoopback,r.curviness=i.curviness||10,r.margin=i.margin||5,r.proximityLimit=i.proximityLimit||80,r.clockwise=i.orientation&&"clockwise"===i.orientation,r.loopbackRadius=i.loopbackRadius||25,r.isLoopbackCurrently=!1,r}return Ga(n,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(t,e){var n=e.sourcePos,i=e.targetPos,r=Math.abs(n.curX-i.curX),o=Math.abs(n.curY-i.curY);if(this.showLoopback&&e.sourceEndpoint.elementId===e.targetEndpoint.elementId){this.isLoopbackCurrently=!0;var a=e.sourcePos.curX,s=e.sourcePos.curY-this.margin,l=a,u=s-this.loopbackRadius,c=l-this.loopbackRadius,d=u-this.loopbackRadius;r=2*this.loopbackRadius,o=2*this.loopbackRadius,t.points[0]=c,t.points[1]=d,t.points[2]=r,t.points[3]=o,this._addSegment(li,{loopback:!0,x1:a-c+4,y1:s-d,startAngle:0,endAngle:2*Math.PI,r:this.loopbackRadius,ac:!this.clockwise,x2:a-c-4,y2:s-d,cx:l-c,cy:u-d})}else this.isLoopbackCurrently=!1,this._computeBezier(t,e,n,i,r,o)}},{key:"exportGeometry",value:function(){return null==this.geometry?null:{controlPoints:[f({},this.geometry.controlPoints[0]),f({},this.geometry.controlPoints[1])],source:f({},this.geometry.source),target:f({},this.geometry.target)}}},{key:"transformGeometry",value:function(t,e,n){return{controlPoints:[{x:t.controlPoints[0].x+e,y:t.controlPoints[0].y+n},{x:t.controlPoints[1].x+e,y:t.controlPoints[1].y+n}],source:this.transformAnchorPlacement(t.source,e,n),target:this.transformAnchorPlacement(t.target,e,n)}}},{key:"importGeometry",value:function(t){return null!=t&&(null==t.controlPoints||2!=t.controlPoints.length?(V("jsPlumb Bezier: cannot import geometry; controlPoints missing or does not have length 2"),this.setGeometry(null,!0),!1):null==t.controlPoints[0].x||null==t.controlPoints[0].y||null==t.controlPoints[1].x||null==t.controlPoints[1].y?(V("jsPlumb Bezier: cannot import geometry; controlPoints malformed"),this.setGeometry(null,!0),!1):null==t.source||null==t.source.curX||null==t.source.curY?(V("jsPlumb Bezier: cannot import geometry; source missing or malformed"),this.setGeometry(null,!0),!1):null==t.target||null==t.target.curX||null==t.target.curY?(V("jsPlumb Bezier: cannot import geometry; target missing or malformed"),this.setGeometry(null,!0),!1):(this.setGeometry(t,!1),!0))}}]),n}(),Za={subtract:function(t,e){return{x:t.x-e.x,y:t.y-e.y}},dotProduct:function(t,e){return t.x*e.x+t.y*e.y},square:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},scale:function(t,e){return{x:t.x*e,y:t.y*e}}},Ka=64,Qa=Math.pow(2,-Ka-1);function ts(t,e){for(var n,i=[],r=function(t,e){for(var n=e.length-1,i=2*n-1,r=[],o=[],a=[],s=[],l=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],u=0;u<=n;u++)r[u]=Za.subtract(e[u],t);for(var c=0;c<=n-1;c++)o[c]=Za.subtract(e[c+1],e[c]),o[c]=Za.scale(o[c],3);for(var d=0;d<=n-1;d++)for(var f=0;f<=n;f++)a[d]||(a[d]=[]),a[d][f]=Za.dotProduct(o[d],r[f]);for(var p=0;p<=i;p++)s[p]||(s[p]=[]),s[p].y=0,s[p].x=parseFloat(""+p)/i;for(var h=n,g=n-1,v=0;v<=h+g;v++)for(var y=Math.max(0,v-g),b=Math.min(v,h),m=y;m<=b;m++){var E=v-m;s[m+E].y+=a[E][m]*l[E][m]}return s}(t,e),o=e.length-1,a=es(r,2*o-1,i,0),s=Za.subtract(t,e[0]),l=Za.square(s),u=0,c=0;c<a;c++)s=Za.subtract(t,ns(e,o,i[c],null,null)),(n=Za.square(s))<l&&(l=n,u=i[c]);return s=Za.subtract(t,e[o]),(n=Za.square(s))<l&&(l=n,u=1),{location:u,distance:l}}function es(t,e,n,i){var r,o,a=[],s=[],l=[],u=[];switch(function(t,e){var n,i,r=0;n=i=B(t[0].y);for(var o=1;o<=e;o++)(n=B(t[o].y))!=i&&r++,i=n;return r}(t,e)){case 0:return 0;case 1:if(i>=Ka)return n[0]=(t[0].x+t[e].x)/2,1;if(function(t,e){var n,i,r,o,a,s,l,u,c,d,f,p,h;a=t[0].y-t[e].y,s=t[e].x-t[0].x,l=t[0].x*t[e].y-t[e].x*t[0].y,p=h=0;for(var g=1;g<e;g++){var v=a*t[g].x+s*t[g].y+l;v>p?p=v:v<h&&(h=v)}return n=((c=1)*(l-p)-(f=s)*(d=0))*(1/((u=0)*f-a*c)),i=(c*(l-h)-(f=s)*d)*(1/(u*f-a*c)),r=Math.min(n,i),o=Math.max(n,i),o-r<Qa?1:0}(t,e))return n[0]=function(t,e){var n=1,i=0,r=t[e].x-t[0].x,o=t[e].y-t[0].y,a=t[0].x-0,s=t[0].y-0;return 0+n*(1/(r*i-o*n)*(r*s-o*a))}(t,e),1}ns(t,e,.5,a,s),r=es(a,e,l,i+1),o=es(s,e,u,i+1);for(var c=0;c<r;c++)n[c]=l[c];for(var d=0;d<o;d++)n[d+r]=u[d];return r+o}function ns(t,e,n,i,r){for(var o=[[]],a=0;a<=e;a++)o[0][a]=t[a];for(var s=1;s<=e;s++)for(var l=0;l<=e-s;l++)o[s]||(o[s]=[]),o[s][l]||(o[s][l]={}),o[s][l].x=(1-n)*o[s-1][l].x+n*o[s-1][l+1].x,o[s][l].y=(1-n)*o[s-1][l].y+n*o[s-1][l+1].y;if(null!=i)for(var u=0;u<=e;u++)i[u]=o[u][0];if(null!=r)for(var c=0;c<=e;c++)r[c]=o[e-c][c];return o[e][0]}function is(t,e){var n={x:0,y:0};if(0===t)return e[0];var i=e.length-1;if(1===t)return e[i];var r=e,o=1-t;if(0===i)return e[0];if(1===i)return{x:o*r[0].x+t*r[1].x,y:o*r[0].y+t*r[1].y};if(4>i){var a,s,l,u=o*o,c=t*t,d=0;return 2===i?(r=[r[0],r[1],r[2],n],a=u,s=o*t*2,l=c):3===i&&(a=u*o,s=u*t*3,l=o*c*3,d=t*c),{x:a*r[0].x+s*r[1].x+l*r[2].x+d*r[3].x,y:a*r[0].y+s*r[1].y+l*r[2].y+d*r[3].y}}return n}function rs(t){var e=0;if(!ls(t))for(var n=function(t,e){var n=[];t--;for(var i=0;i<=t;i++)n.push(is(i/t,e));return n}(16,t),i=0;i<15;i++){e+=ss(n[i],n[i+1])}return e}var os=new Map;function as(t,e){for(var n=function(t){var e=os.get(t);if(!e){var n=function(t){return function(e){return t}},i=function(t){return function(e){for(var n=1,i=0;i<t.length;i++)n*=t[i](e);return n}};(e=[]).push((function(e){return Math.pow(e,t)}));for(var r=1;r<t;r++){for(var o=[n(t)],a=0;a<t-r;a++)o.push((function(t){return t}));for(var s=0;s<r;s++)o.push((function(t){return 1-t}));e.push(i(o))}e.push((function(e){return Math.pow(1-e,t)})),os.set(t,e)}return e}(t.length-1),i=0,r=0,o=0;o<t.length;o++)i+=t[o].x*n[o](e),r+=t[o].y*n[o](e);return{x:i,y:r}}function ss(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function ls(t){return t[0].x===t[1].x&&t[0].y===t[1].y}function us(t,e,n){if(ls(t))return{point:t[0],location:e};for(var i=as(t,e),r=0,o=e,a=n>0?1:-1,s=null;r<Math.abs(n);)r+=ss(s=as(t,o+=.005*a),i),i=s;return{point:s,location:o}}function cs(t,e,n,i,r){var o=i-e,a=t-n,s=t*(e-i)+e*(n-t),l=function(t){return[ds(t,"x"),ds(t,"y")]}(r),u=[o*l[0][0]+a*l[1][0],o*l[0][1]+a*l[1][1],o*l[0][2]+a*l[1][2],o*l[0][3]+a*l[1][3]+s],c=fs.apply(null,u),d=[];if(null!=c)for(var f=0;f<3;f++){var p=c[f],h=Math.pow(p,2),g=Math.pow(p,3),v={x:l[0][0]*g+l[0][1]*h+l[0][2]*p+l[0][3],y:l[1][0]*g+l[1][1]*h+l[1][2]*p+l[1][3]},y=void 0;y=n-t!=0?(v[0]-t)/(n-t):(v[1]-e)/(i-e),p>=0&&p<=1&&y>=0&&y<=1&&d.push(v)}return d}function ds(t,e){return[-t[0][e]+3*t[1][e]+-3*t[2][e]+t[3][e],3*t[0][e]-6*t[1][e]+3*t[2][e],-3*t[0][e]+3*t[1][e],t[0][e]]}function fs(t,e,n,i){var r,o,a=e/t,s=n/t,l=i/t,u=(3*s-Math.pow(a,2))/9,c=(9*a*s-27*l-2*Math.pow(a,3))/54,d=Math.pow(u,3)+Math.pow(c,2),f=[0,0,0];if(d>=0)r=B(c+Math.sqrt(d))*Math.pow(Math.abs(c+Math.sqrt(d)),1/3),o=B(c-Math.sqrt(d))*Math.pow(Math.abs(c-Math.sqrt(d)),1/3),f[0]=-a/3+(r+o),f[1]=-a/3-(r+o)/2,f[2]=-a/3-(r+o)/2,0!==Math.abs(Math.sqrt(3)*(r-o)/2)&&(f[1]=-1,f[2]=-1);else{var p=Math.acos(c/Math.sqrt(-Math.pow(u,3)));f[0]=2*Math.sqrt(-u)*Math.cos(p/3)-a/3,f[1]=2*Math.sqrt(-u)*Math.cos((p+2*Math.PI)/3)-a/3,f[2]=2*Math.sqrt(-u)*Math.cos((p+4*Math.PI)/3)-a/3}for(var h=0;h<3;h++)(f[h]<0||f[h]>1)&&(f[h]=-1);return f}var ps=function(t){Ua(n,ft);var e=Ha(n);function n(t){var i;return $a(this,n),qa(Wa(i=e.call(this,t)),"curve",void 0),qa(Wa(i),"cp1x",void 0),qa(Wa(i),"cp1y",void 0),qa(Wa(i),"cp2x",void 0),qa(Wa(i),"cp2y",void 0),qa(Wa(i),"length",0),qa(Wa(i),"type",n.segmentType),i.cp1x=t.cp1x,i.cp1y=t.cp1y,i.cp2x=t.cp2x,i.cp2y=t.cp2y,i.x1=t.x1,i.x2=t.x2,i.y1=t.y1,i.y2=t.y2,i.curve=[{x:i.x1,y:i.y1},{x:i.cp1x,y:i.cp1y},{x:i.cp2x,y:i.cp2y},{x:i.x2,y:i.y2}],i.extents={xmin:Math.min(i.x1,i.x2,i.cp1x,i.cp2x),ymin:Math.min(i.y1,i.y2,i.cp1y,i.cp2y),xmax:Math.max(i.x1,i.x2,i.cp1x,i.cp2x),ymax:Math.max(i.y1,i.y2,i.cp1y,i.cp2y)},i}return Ga(n,[{key:"getPath",value:function(t){return(t?"M "+this.x2+" "+this.y2+" ":"")+"C "+this.cp2x+" "+this.cp2y+" "+this.cp1x+" "+this.cp1y+" "+this.x1+" "+this.y1}},{key:"pointOnPath",value:function(t,e){return t=n._translateLocation(this.curve,t,e),as(this.curve,t)}},{key:"gradientAtPoint",value:function(t,e){return t=n._translateLocation(this.curve,t,e),function(t,e){var n=as(t,e),i=as(t.slice(0,t.length-1),e),r=i.y-n.y,o=i.x-n.x;return 0===r?1/0:Math.atan(r/o)}(this.curve,t)}},{key:"pointAlongPathFrom",value:function(t,e,i){return t=n._translateLocation(this.curve,t,i),function(t,e,n){return us(t,e,n).point}(this.curve,t,e)}},{key:"getLength",value:function(){return null!=this.length&&0!==this.length||(this.length=rs(this.curve)),this.length}},{key:"findClosestPointOnPath",value:function(t,e){var n,i,r,o=(n={x:t,y:e},i=this.curve,r=ts(n,i),{point:ns(i,i.length-1,r.location,null,null),location:r.location});return{d:Math.sqrt(Math.pow(o.point.x-t,2)+Math.pow(o.point.y-e,2)),x:o.point.x,y:o.point.y,l:1-o.location,s:this,x1:null,y1:null,x2:null,y2:null}}},{key:"lineIntersection",value:function(t,e,n,i){return cs(t,e,n,i,this.curve)}}],[{key:"_translateLocation",value:function(t,e,n){return n&&(e=function(t,e,n){return us(t,e,n).location}(t,e>0?0:1,e)),e}}]),n}();qa(ps,"segmentType","Bezier");var hs=function(t){Ua(n,Xa);var e=Ha(n);function n(t,i){var r;return $a(this,n),(r=e.call(this,t,i)).connection=t,qa(Wa(r),"type",n.type),qa(Wa(r),"majorAnchor",void 0),qa(Wa(r),"minorAnchor",void 0),i=i||{},r.majorAnchor=i.curviness||150,r.minorAnchor=10,r}return Ga(n,[{key:"getCurviness",value:function(){return this.majorAnchor}},{key:"_findControlPoint",value:function(t,e,n,i,r){var o={x:0,y:0};return i[0]!==r[0]||i[1]===r[1]?(0===r[0]?o.x=n.curX<e.curX?t.x+this.minorAnchor:t.x-this.minorAnchor:o.x=t.x+this.majorAnchor*r[0],0===r[1]?o.y=n.curY<e.curY?t.y+this.minorAnchor:t.y-this.minorAnchor:o.y=t.y+this.majorAnchor*i[1]):(0===i[0]?o.x=e.curX<n.curX?t.x+this.minorAnchor:t.x-this.minorAnchor:o.x=t.x-this.majorAnchor*i[0],0===i[1]?o.y=e.curY<n.curY?t.y+this.minorAnchor:t.y-this.minorAnchor:o.y=t.y+this.majorAnchor*r[1]),o}},{key:"_computeBezier",value:function(t,e,n,i,r,o){var a,s,l=n.curX<i.curX?r:0,u=n.curY<i.curY?o:0,c=n.curX<i.curX?0:r,d=n.curY<i.curY?0:o;!0!==this.edited?(a=this._findControlPoint({x:l,y:u},n,i,t.so,t.to),s=this._findControlPoint({x:c,y:d},i,n,t.to,t.so)):(a=this.geometry.controlPoints[0],s=this.geometry.controlPoints[1]),this.geometry={controlPoints:[a,s],source:e.sourcePos,target:e.targetPos},this._addSegment(ps,{x1:l,y1:u,x2:c,y2:d,cp1x:a.x,cp1y:a.y,cp2x:s.x,cp2y:s.y})}}]),n}();qa(hs,"type","Bezier");var gs=function(t){Ua(n,Xa);var e=Ha(n);function n(t,i){var r;return $a(this,n),(r=e.call(this,t,i)).connection=t,qa(Wa(r),"type",n.type),qa(Wa(r),"_controlPoint",void 0),r.curviness=i.curviness||10,r.margin=i.margin||5,r.proximityLimit=i.proximityLimit||80,r.clockwise=i.orientation&&"clockwise"===i.orientation,r}return Ga(n,[{key:"_computeBezier",value:function(t,e,n,i,r,o){var a,s,l,u,c,d,f,p,h=n.curX<i.curX?0:r,g=n.curY<i.curY?0:o,v=n.curX<i.curX?r:0,y=n.curY<i.curY?o:0;if(0===n.x&&(h-=this.margin),1===n.x&&(h+=this.margin),0===n.y&&(g-=this.margin),1===n.y&&(g+=this.margin),0===i.x&&(v-=this.margin),1===i.x&&(v+=this.margin),0===i.y&&(y-=this.margin),1===i.y&&(y+=this.margin),!0!==this.edited){var b=(h+v)/2,m=(g+y)/2,E=(s=g,u=y,(a=h)<=(l=v)&&u<=s?1:a<=l&&s<=u?2:l<=a&&u>=s?3:4),w=Math.sqrt(Math.pow(v-h,2)+Math.pow(y-g,2));this._controlPoint=function(t,e,n,i,r,o,a,s,l){return s<=l?{x:t,y:e}:1===n?i.curY<=0&&r.curY>=1?{x:t+(i.x<.5?-1*o:o),y:e}:i.curX>=1&&r.curX<=0?{x:t,y:e+(i.y<.5?-1*a:a)}:{x:t+-1*o,y:e+-1*a}:2===n?i.curY>=1&&r.curY<=0?{x:t+(i.x<.5?-1*o:o),y:e}:i.curX>=1&&r.curX<=0?{x:t,y:e+(i.y<.5?-1*a:a)}:{x:t+o,y:e+-1*a}:3===n?i.curY>=1&&r.curY<=0?{x:t+(i.x<.5?-1*o:o),y:e}:i.curX<=0&&r.curX>=1?{x:t,y:e+(i.y<.5?-1*a:a)}:{x:t+-1*o,y:e+-1*a}:4===n?i.curY<=0&&r.curY>=1?{x:t+(i.x<.5?-1*o:o),y:e}:i.curX<=0&&r.curX>=1?{x:t,y:e+(i.y<.5?-1*a:a)}:{x:t+o,y:e+-1*a}:void 0}(b,m,E,e.sourcePos,e.targetPos,this.curviness,this.curviness,w,this.proximityLimit)}else this._controlPoint=this.geometry.controlPoints[0];c=this._controlPoint.x,d=this._controlPoint.x,f=this._controlPoint.y,p=this._controlPoint.y,this.geometry={controlPoints:[this._controlPoint,this._controlPoint],source:e.sourcePos,target:e.targetPos},this._addSegment(ps,{x1:v,y1:y,x2:h,y2:g,cp1x:c,cp1y:f,cp2x:d,cp2y:p})}}]),n}();function vs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ys(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bs(t){return bs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},bs(t)}function ms(t,e){return ms=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ms(t,e)}function Es(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ws(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=bs(t);if(e){var r=bs(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?Es(t):e}(this,n)}}function _s(t){return t<0?-1:0===t?0:1}function Os(t){return[_s(t[2]-t[0]),_s(t[3]-t[1])]}function Ts(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))}function xs(t){var e=[];return e.push.apply(e,t),e}qa(gs,"type","StateMachine"),Wt(hs.type,hs),Wt(gs.type,gs);var As=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ms(t,e)}(o,Gt);var e,n,i,r=ws(o);function o(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=r.call(this,t,e)).connection=t,ys(Es(n),"type",o.type),ys(Es(n),"internalSegments",[]),ys(Es(n),"midpoint",void 0),ys(Es(n),"alwaysRespectStubs",void 0),ys(Es(n),"cornerRadius",void 0),ys(Es(n),"lastx",void 0),ys(Es(n),"lasty",void 0),ys(Es(n),"lastOrientation",void 0),ys(Es(n),"loopbackRadius",void 0),ys(Es(n),"isLoopbackCurrently",void 0),n.midpoint=null==e.midpoint||isNaN(e.midpoint)?.5:e.midpoint,n.cornerRadius=null!=e.cornerRadius?e.cornerRadius:0,n.alwaysRespectStubs=!0===e.alwaysRespectStubs,n.lastx=null,n.lasty=null,n.lastOrientation=null,n.loopbackRadius=e.loopbackRadius||25,n.isLoopbackCurrently=!1,n}return e=o,n=[{key:"getDefaultStubs",value:function(){return[30,30]}},{key:"addASegment",value:function(t,e,n){if(this.lastx!==t||this.lasty!==e){var i=null==this.lastx?n.sx:this.lastx,r=null==this.lasty?n.sy:this.lasty,o=i===t?"v":"h";this.lastx=t,this.lasty=e,this.internalSegments.push([i,r,t,e,o])}}},{key:"writeSegments",value:function(t){for(var e,n,i,r=null,o=0;o<this.internalSegments.length-1;o++){if(r=r||xs(this.internalSegments[o]),e=xs(this.internalSegments[o+1]),n=Os(r),i=Os(e),this.cornerRadius>0&&r[4]!==e[4]){var a=Math.min(Ts(r),Ts(e)),s=Math.min(this.cornerRadius,a/2);r[2]-=n[0]*s,r[3]-=n[1]*s,e[0]+=i[0]*s,e[1]+=i[1]*s;var l=n[1]===i[0]&&1===i[0]||n[1]===i[0]&&0===i[0]&&n[0]!==i[1]||n[1]===i[0]&&-1===i[0],u=(e[1]>r[3]?1:-1)==(e[0]>r[2]?1:-1),c=u&&l||!u&&!l?e[0]:r[2],d=u&&l||!u&&!l?r[3]:e[1];this._addSegment(qt,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]}),this._addSegment(li,{r:s,x1:r[2],y1:r[3],x2:e[0],y2:e[1],cx:c,cy:d,ac:l})}else this._addSegment(qt,{x1:r[0],y1:r[1],x2:r[2],y2:r[3]});r=e}null!=e&&this._addSegment(qt,{x1:e[0],y1:e[1],x2:e[2],y2:e[3]})}},{key:"_compute",value:function(t,e){var n=this;this.internalSegments.length=0,this.lastx=null,this.lasty=null,this.lastOrientation=null;var i=function(e){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},r={perpendicular:i,orthogonal:i,opposite:function(e){var i=t,r="x"===e?0:1,o={x:function(){return 1===i.so[r]&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||-1===i.so[r]&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return 1===i.so[r]&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||-1===i.so[r]&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}};return!n.alwaysRespectStubs&&o[e]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[e]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}},o=r[t.anchorOrientation](t.sourceAxis),a="x"===t.sourceAxis?0:1,s="x"===t.sourceAxis?1:0,l=o[a],u=o[s],c=o[a+2],d=o[s+2];this.addASegment(o[0],o[1],t);var f=t.startStubX+(t.endStubX-t.startStubX)*this.midpoint,p=t.startStubY+(t.endStubY-t.startStubY)*this.midpoint,h={x:[0,1],y:[1,0]},g={perpendicular:function(e,n,i,r,o){var a=t,s={x:[[a.startStubX,a.endStubX],null,[a.endStubX,a.startStubX]],y:[[a.startStubY,a.endStubY],null,[a.endStubY,a.startStubY]]},l={x:[[f,a.startStubY],[f,a.endStubY]],y:[[a.startStubX,p],[a.endStubX,p]]},u={x:[[a.endStubX,a.startStubY]],y:[[a.startStubX,a.endStubY]]},c={x:[[a.startStubX,a.endStubY],[a.endStubX,a.endStubY]],y:[[a.endStubX,a.startStubY],[a.endStubX,a.endStubY]]},d={x:[[a.startStubX,p],[a.endStubX,p],[a.endStubX,a.endStubY]],y:[[f,a.startStubY],[f,a.endStubY],[a.endStubX,a.endStubY]]},g={x:[a.startStubY,a.endStubY],y:[a.startStubX,a.endStubX]},v=h[e][0],y=h[e][1],b=a.so[v]+1,m=a.to[y]+1,E=-1===a.to[y]&&g[e][1]<g[e][0]||1===a.to[y]&&g[e][1]>g[e][0],w=s[e][b][0],_=s[e][b][1],O={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[e][b][m];return a.segment===O[3]||a.segment===O[2]&&E?l[e]:a.segment===O[2]&&_<w?u[e]:a.segment===O[2]&&_>=w||a.segment===O[1]&&!E?d[e]:a.segment===O[0]||a.segment===O[1]&&E?c[e]:void 0},orthogonal:function(e,n,i,r,o){var a=t,s={x:-1===a.so[0]?Math.min(n,r):Math.max(n,r),y:-1===a.so[1]?Math.min(n,r):Math.max(n,r)}[e];return{x:[[s,i],[s,o],[r,o]],y:[[i,s],[o,s],[o,r]]}[e]},opposite:function(i,r,o,s,l){var u=t,c={x:"y",y:"x"}[i],d={x:"h",y:"w"}[i],h=u["is"+i.toUpperCase()+"GreaterThanStubTimes2"];if(e.sourceEndpoint.elementId===e.targetEndpoint.elementId){var g=o+(1-e.sourceEndpoint._anchor.computedPosition[c])*e.sourceInfo[d]+n.maxStub;return{x:[[r,g],[s,g]],y:[[g,r],[g,s]]}[i]}return!h||1===u.so[a]&&r>s||-1===u.so[a]&&r<s?{x:[[r,p],[s,p]],y:[[f,r],[f,s]]}[i]:1===u.so[a]&&r<s||-1===u.so[a]&&r>s?{x:[[f,u.sy],[f,u.ty]],y:[[u.sx,p],[u.tx,p]]}[i]:void 0}},v=g[t.anchorOrientation](t.sourceAxis,l,u,c,d);if(v)for(var y=0;y<v.length;y++)this.addASegment(v[y][0],v[y][1],t);this.addASegment(o[2],o[3],t),this.addASegment(t.tx,t.ty,t),this.writeSegments(t)}},{key:"transformGeometry",value:function(t,e,n){return t}}],n&&vs(e.prototype,n),i&&vs(e,i),o}();ys(As,"type","Flowchart"),Wt(As.type,As);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function Ss(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Is={};({get exports(){return Is},set exports(t){Is=t}}).exports=function(){var t={};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(t){return!(!t||!t.Window)&&t instanceof t.Window};var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.getWindow=function(e){return(0,t.default)(e)?e:(e.ownerDocument||e).defaultView||i.window},e.init=r,e.window=e.realWindow=void 0;var n=void 0;e.realWindow=n;var i=void 0;function r(t){e.realWindow=n=t;var r=t.document.createTextNode("");r.ownerDocument!==t.document&&"function"==typeof t.wrap&&t.wrap(r)===r&&(t=t.wrap(t)),e.window=i=t}e.window=i,"undefined"!=typeof window&&window&&r(window);var o={};function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=function(t){return!!t&&"object"===a(t)},l=function(t){return"function"==typeof t},u={window:function(n){return n===e.window||(0,t.default)(n)},docFrag:function(t){return s(t)&&11===t.nodeType},object:s,func:l,number:function(t){return"number"==typeof t},bool:function(t){return"boolean"==typeof t},string:function(t){return"string"==typeof t},element:function(t){if(!t||"object"!==a(t))return!1;var n=e.getWindow(t)||e.window;return/object|function/.test("undefined"==typeof Element?"undefined":a(Element))?t instanceof Element||t instanceof n.Element:1===t.nodeType&&"string"==typeof t.nodeName},plainObject:function(t){return s(t)&&!!t.constructor&&/function Object\b/.test(t.constructor.toString())},array:function(t){return s(t)&&void 0!==t.length&&l(t.splice)}};o.default=u;var c={};function d(t){var e=t.interaction;if("drag"===e.prepared.name){var n=e.prepared.axis;"x"===n?(e.coords.cur.page.y=e.coords.start.page.y,e.coords.cur.client.y=e.coords.start.client.y,e.coords.velocity.client.y=0,e.coords.velocity.page.y=0):"y"===n&&(e.coords.cur.page.x=e.coords.start.page.x,e.coords.cur.client.x=e.coords.start.client.x,e.coords.velocity.client.x=0,e.coords.velocity.page.x=0)}}function f(t){var e=t.iEvent,n=t.interaction;if("drag"===n.prepared.name){var i=n.prepared.axis;if("x"===i||"y"===i){var r="x"===i?"y":"x";e.page[r]=n.coords.start.page[r],e.client[r]=n.coords.start.client[r],e.delta[r]=0}}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var p={id:"actions/drag",install:function(t){var e=t.actions,n=t.Interactable,i=t.defaults;n.prototype.draggable=p.draggable,e.map.drag=p,e.methodDict.drag="draggable",i.actions.drag=p.defaults},listeners:{"interactions:before-action-move":d,"interactions:action-resume":d,"interactions:action-move":f,"auto-start:check":function(t){var e=t.interaction,n=t.interactable,i=t.buttons,r=n.options.drag;if(r&&r.enabled&&(!e.pointerIsDown||!/mouse|pointer/.test(e.pointerType)||0!=(i&n.options.drag.mouseButtons)))return t.action={name:"drag",axis:"start"===r.lockAxis?r.startAxis:r.lockAxis},!1}},draggable:function(t){return o.default.object(t)?(this.options.drag.enabled=!1!==t.enabled,this.setPerAction("drag",t),this.setOnEvents("drag",t),/^(xy|x|y|start)$/.test(t.lockAxis)&&(this.options.drag.lockAxis=t.lockAxis),/^(xy|x|y)$/.test(t.startAxis)&&(this.options.drag.startAxis=t.startAxis),this):o.default.bool(t)?(this.options.drag.enabled=t,this):this.options.drag},beforeMove:d,move:f,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"}},h=p;c.default=h;var g={};Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var v={init:function(t){var e=t;v.document=e.document,v.DocumentFragment=e.DocumentFragment||y,v.SVGElement=e.SVGElement||y,v.SVGSVGElement=e.SVGSVGElement||y,v.SVGElementInstance=e.SVGElementInstance||y,v.Element=e.Element||y,v.HTMLElement=e.HTMLElement||v.Element,v.Event=e.Event,v.Touch=e.Touch||y,v.PointerEvent=e.PointerEvent||e.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function y(){}var b=v;g.default=b;var m={};Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var E={init:function(t){var e=g.default.Element,n=t.navigator||{};E.supportsTouch="ontouchstart"in t||o.default.func(t.DocumentTouch)&&g.default.document instanceof t.DocumentTouch,E.supportsPointerEvent=!1!==n.pointerEnabled&&!!g.default.PointerEvent,E.isIOS=/iP(hone|od|ad)/.test(n.platform),E.isIOS7=/iP(hone|od|ad)/.test(n.platform)&&/OS 7[^\d]/.test(n.appVersion),E.isIe9=/MSIE 9/.test(n.userAgent),E.isOperaMobile="Opera"===n.appName&&E.supportsTouch&&/Presto/.test(n.userAgent),E.prefixedMatchesSelector="matches"in e.prototype?"matches":"webkitMatchesSelector"in e.prototype?"webkitMatchesSelector":"mozMatchesSelector"in e.prototype?"mozMatchesSelector":"oMatchesSelector"in e.prototype?"oMatchesSelector":"msMatchesSelector",E.pEventTypes=E.supportsPointerEvent?g.default.PointerEvent===t.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,E.wheelEvent=g.default.document&&"onmousewheel"in g.default.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},w=E;m.default=w;var _={};function O(t){var e=t.parentNode;if(o.default.docFrag(e)){for(;(e=e.host)&&o.default.docFrag(e););return e}return e}function T(t,n){return e.window!==e.realWindow&&(n=n.replace(/\/deep\//g," ")),t[m.default.prefixedMatchesSelector](n)}Object.defineProperty(_,"__esModule",{value:!0}),_.closest=function(t,e){for(;o.default.element(t);){if(T(t,e))return t;t=O(t)}return null},_.getActualElement=function(t){return t.correspondingUseElement||t},_.getElementClientRect=I,_.getElementRect=function(t){var n=I(t);if(!m.default.isIOS7&&n){var i=S(e.getWindow(t));n.left+=i.x,n.right+=i.x,n.top+=i.y,n.bottom+=i.y}return n},_.getPath=function(t){for(var e=[];t;)e.push(t),t=O(t);return e},_.getScrollXY=S,_.indexOfDeepestElement=function(t){for(var n,i=[],r=0;r<t.length;r++){var o=t[r],a=t[n];if(o&&r!==n)if(a){var s=x(o),l=x(a);if(s!==o.ownerDocument)if(l!==o.ownerDocument)if(s!==l){i=i.length?i:A(a);var u=void 0;if(a instanceof g.default.HTMLElement&&o instanceof g.default.SVGElement&&!(o instanceof g.default.SVGSVGElement)){if(o===l)continue;u=o.ownerSVGElement}else u=o;for(var c=A(u,a.ownerDocument),d=0;c[d]&&c[d]===i[d];)d++;var f=[c[d-1],c[d],i[d]];if(f[0])for(var p=f[0].lastChild;p;){if(p===f[1]){n=r,i=c;break}if(p===f[2])break;p=p.previousSibling}}else h=o,v=a,(parseInt(e.getWindow(h).getComputedStyle(h).zIndex,10)||0)>=(parseInt(e.getWindow(v).getComputedStyle(v).zIndex,10)||0)&&(n=r);else n=r}else n=r}var h,v;return n},_.matchesSelector=T,_.matchesUpTo=function(t,e,n){for(;o.default.element(t);){if(T(t,e))return!0;if((t=O(t))===n)return T(t,e)}return!1},_.nodeContains=function(t,e){if(t.contains)return t.contains(e);for(;e;){if(e===t)return!0;e=e.parentNode}return!1},_.parentNode=O,_.trySelector=function(t){return!!o.default.string(t)&&(g.default.document.querySelector(t),!0)};var x=function(t){return t.parentNode||t.host};function A(t,e){for(var n,i=[],r=t;(n=x(r))&&r!==e&&n!==r.ownerDocument;)i.unshift(r),r=n;return i}function S(t){return{x:(t=t||e.window).scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop}}function I(t){var e=t instanceof g.default.SVGElement?t.getBoundingClientRect():t.getClientRects()[0];return e&&{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top}}var k={};Object.defineProperty(k,"__esModule",{value:!0}),k.default=function(t,e){for(var n in e)t[n]=e[n];return t};var P={};function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function C(t,e,n){return"parent"===t?(0,_.parentNode)(n):"self"===t?e.getRect(n):(0,_.closest)(n,t)}Object.defineProperty(P,"__esModule",{value:!0}),P.addEdges=function(t,e,n){t.left&&(e.left+=n.x),t.right&&(e.right+=n.x),t.top&&(e.top+=n.y),t.bottom&&(e.bottom+=n.y),e.width=e.right-e.left,e.height=e.bottom-e.top},P.getStringOptionResult=C,P.rectToXY=function(t){return t&&{x:"x"in t?t.x:t.left,y:"y"in t?t.y:t.top}},P.resolveRectLike=function(t,e,n,i){var r,a=t;return o.default.string(a)?a=C(a,e,n):o.default.func(a)&&(a=a.apply(void 0,function(t){if(Array.isArray(t))return N(t)}(r=i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return N(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),o.default.element(a)&&(a=(0,_.getElementRect)(a)),a},P.tlbrToXywh=function(t){return!t||"x"in t&&"y"in t||((t=(0,k.default)({},t)).x=t.left||0,t.y=t.top||0,t.width=t.width||(t.right||0)-t.x,t.height=t.height||(t.bottom||0)-t.y),t},P.xywhToTlbr=function(t){return!t||"left"in t&&"top"in t||((t=(0,k.default)({},t)).left=t.x||0,t.top=t.y||0,t.right=t.right||t.left+t.width,t.bottom=t.bottom||t.top+t.height),t};var j={};Object.defineProperty(j,"__esModule",{value:!0}),j.default=function(t,e,n){var i=t.options[n],r=i&&i.origin||t.options.origin,o=(0,P.resolveRectLike)(r,t,e,[t&&e]);return(0,P.rectToXY)(o)||{x:0,y:0}};var M={};function D(t){return t.trim().split(/ +/)}Object.defineProperty(M,"__esModule",{value:!0}),M.default=function t(e,n,i){if(i=i||{},o.default.string(e)&&-1!==e.search(" ")&&(e=D(e)),o.default.array(e))return e.reduce((function(e,r){return(0,k.default)(e,t(r,n,i))}),i);if(o.default.object(e)&&(n=e,e=""),o.default.func(n))i[e]=i[e]||[],i[e].push(n);else if(o.default.array(n))for(var r=0;r<n.length;r++){var a;a=n[r],t(e,a,i)}else if(o.default.object(n))for(var s in n){var l=D(s).map((function(t){return"".concat(e).concat(t)}));t(l,n[s],i)}return i};var R={};Object.defineProperty(R,"__esModule",{value:!0}),R.default=void 0,R.default=function(t,e){return Math.sqrt(t*t+e*e)};var L={};Object.defineProperty(L,"__esModule",{value:!0}),L.default=function(t,e){t.__set||(t.__set={});var n=function(n){"function"!=typeof t[n]&&"__set"!==n&&Object.defineProperty(t,n,{get:function(){return n in t.__set?t.__set[n]:t.__set[n]=e[n]},set:function(e){t.__set[n]=e},configurable:!0})};for(var i in e)n(i);return t};var Y={};function V(t){return t instanceof g.default.Event||t instanceof g.default.Touch}function B(t,e,n){return t=t||"page",(n=n||{}).x=e[t+"X"],n.y=e[t+"Y"],n}function $(t,e){return e=e||{x:0,y:0},m.default.isOperaMobile&&V(t)?(B("screen",t,e),e.x+=window.scrollX,e.y+=window.scrollY):B("page",t,e),e}function F(t,e){return e=e||{},m.default.isOperaMobile&&V(t)?B("screen",t,e):B("client",t,e),e}function G(t){var e=[];return o.default.array(t)?(e[0]=t[0],e[1]=t[1]):"touchend"===t.type?1===t.touches.length?(e[0]=t.touches[0],e[1]=t.changedTouches[0]):0===t.touches.length&&(e[0]=t.changedTouches[0],e[1]=t.changedTouches[1]):(e[0]=t.touches[0],e[1]=t.touches[1]),e}function q(t){for(var e={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},n=0;n<t.length;n++){var i=t[n];for(var r in e)e[r]+=i[r]}for(var o in e)e[o]/=t.length;return e}Object.defineProperty(Y,"__esModule",{value:!0}),Y.coordsToEvent=function(t){return{coords:t,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}},Y.copyCoords=function(t,e){t.page=t.page||{},t.page.x=e.page.x,t.page.y=e.page.y,t.client=t.client||{},t.client.x=e.client.x,t.client.y=e.client.y,t.timeStamp=e.timeStamp},Y.getClientXY=F,Y.getEventTargets=function(t){var e=o.default.func(t.composedPath)?t.composedPath():t.path;return[_.getActualElement(e?e[0]:t.target),_.getActualElement(t.currentTarget)]},Y.getPageXY=$,Y.getPointerId=function(t){return o.default.number(t.pointerId)?t.pointerId:t.identifier},Y.getPointerType=function(t){return o.default.string(t.pointerType)?t.pointerType:o.default.number(t.pointerType)?[void 0,void 0,"touch","pen","mouse"][t.pointerType]:/touch/.test(t.type||"")||t instanceof g.default.Touch?"touch":"mouse"},Y.getTouchPair=G,Y.getXY=B,Y.isNativePointer=V,Y.newCoords=function(){return{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},Y.pointerAverage=q,Object.defineProperty(Y,"pointerExtend",{enumerable:!0,get:function(){return L.default}}),Y.setCoordDeltas=function(t,e,n){t.page.x=n.page.x-e.page.x,t.page.y=n.page.y-e.page.y,t.client.x=n.client.x-e.client.x,t.client.y=n.client.y-e.client.y,t.timeStamp=n.timeStamp-e.timeStamp},Y.setCoordVelocity=function(t,e){var n=Math.max(e.timeStamp/1e3,.001);t.page.x=e.page.x/n,t.page.y=e.page.y/n,t.client.x=e.client.x/n,t.client.y=e.client.y/n,t.timeStamp=n},Y.setCoords=function(t,e,n){var i=e.length>1?q(e):e[0];$(i,t.page),F(i,t.client),t.timeStamp=n},Y.setZeroCoords=function(t){t.page.x=0,t.page.y=0,t.client.x=0,t.client.y=0},Y.touchAngle=function(t,e){var n=e+"X",i=e+"Y",r=G(t),o=r[1][n]-r[0][n],a=r[1][i]-r[0][i];return 180*Math.atan2(a,o)/Math.PI},Y.touchBBox=function(t){if(!t.length)return null;var e=G(t),n=Math.min(e[0].pageX,e[1].pageX),i=Math.min(e[0].pageY,e[1].pageY),r=Math.max(e[0].pageX,e[1].pageX),o=Math.max(e[0].pageY,e[1].pageY);return{x:n,y:i,left:n,top:i,right:r,bottom:o,width:r-n,height:o-i}},Y.touchDistance=function(t,e){var n=e+"X",i=e+"Y",r=G(t),o=r[0][n]-r[1][n],a=r[0][i]-r[1][i];return(0,R.default)(o,a)};var U={};function z(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function J(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(U,"__esModule",{value:!0}),U.BaseEvent=void 0;var W=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),J(this,"immediatePropagationStopped",!1),J(this,"propagationStopped",!1),this._interaction=e}var e,n;return e=t,(n=[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}])&&z(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();U.BaseEvent=W,Object.defineProperty(W.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var H={};Object.defineProperty(H,"__esModule",{value:!0}),H.remove=H.merge=H.from=H.findIndex=H.find=H.contains=void 0,H.contains=function(t,e){return-1!==t.indexOf(e)},H.remove=function(t,e){return t.splice(t.indexOf(e),1)};var X=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];t.push(i)}return t};H.merge=X,H.from=function(t){return X([],t)};var Z=function(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1};H.findIndex=Z,H.find=function(t,e){return t[Z(t,e)]};var K={};function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function tt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function et(t,e){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},et(t,e)}function nt(t,e){if(e&&("object"===Q(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return it(t)}function it(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rt(t){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rt(t)}function ot(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(K,"__esModule",{value:!0}),K.DropEvent=void 0;var at=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&et(t,e)}(a,t);var e,n,i,r,o=(i=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=rt(i);if(r){var n=rt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return nt(this,t)});function a(t,e,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),ot(it(i=o.call(this,e._interaction)),"dropzone",void 0),ot(it(i),"dragEvent",void 0),ot(it(i),"relatedTarget",void 0),ot(it(i),"draggable",void 0),ot(it(i),"propagationStopped",!1),ot(it(i),"immediatePropagationStopped",!1);var r="dragleave"===n?t.prev:t.cur,s=r.element,l=r.dropzone;return i.type=n,i.target=s,i.currentTarget=s,i.dropzone=l,i.dragEvent=e,i.relatedTarget=e.target,i.draggable=e.interactable,i.timeStamp=e.timeStamp,i}return e=a,(n=[{key:"reject",value:function(){var t=this,e=this._interaction.dropState;if("dropactivate"===this.type||this.dropzone&&e.cur.dropzone===this.dropzone&&e.cur.element===this.target)if(e.prev.dropzone=this.dropzone,e.prev.element=this.target,e.rejected=!0,e.events.enter=null,this.stopImmediatePropagation(),"dropactivate"===this.type){var n=e.activeDrops,i=H.findIndex(n,(function(e){var n=e.dropzone,i=e.element;return n===t.dropzone&&i===t.target}));e.activeDrops.splice(i,1);var r=new a(e,this.dragEvent,"dropdeactivate");r.dropzone=this.dropzone,r.target=this.target,this.dropzone.fire(r)}else this.dropzone.fire(new a(e,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}])&&tt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(U.BaseEvent);K.DropEvent=at;var st={};function lt(t,e){for(var n=0;n<t.slice().length;n++){var i=t.slice()[n],r=i.dropzone,o=i.element;e.dropzone=r,e.target=o,r.fire(e),e.propagationStopped=e.immediatePropagationStopped=!1}}function ut(t,e){for(var n=function(t,e){for(var n=t.interactables,i=[],r=0;r<n.list.length;r++){var a=n.list[r];if(a.options.drop.enabled){var s=a.options.drop.accept;if(!(o.default.element(s)&&s!==e||o.default.string(s)&&!_.matchesSelector(e,s)||o.default.func(s)&&!s({dropzone:a,draggableElement:e})))for(var l=o.default.string(a.target)?a._context.querySelectorAll(a.target):o.default.array(a.target)?a.target:[a.target],u=0;u<l.length;u++){var c=l[u];c!==e&&i.push({dropzone:a,element:c,rect:a.getRect(c)})}}}return i}(t,e),i=0;i<n.length;i++){var r=n[i];r.rect=r.dropzone.getRect(r.element)}return n}function ct(t,e,n){for(var i=t.dropState,r=t.interactable,o=t.element,a=[],s=0;s<i.activeDrops.length;s++){var l=i.activeDrops[s],u=l.dropzone,c=l.element,d=l.rect;a.push(u.dropCheck(e,n,r,o,c,d)?c:null)}var f=_.indexOfDeepestElement(a);return i.activeDrops[f]||null}function dt(t,e,n){var i=t.dropState,r={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return"dragstart"===n.type&&(r.activate=new K.DropEvent(i,n,"dropactivate"),r.activate.target=null,r.activate.dropzone=null),"dragend"===n.type&&(r.deactivate=new K.DropEvent(i,n,"dropdeactivate"),r.deactivate.target=null,r.deactivate.dropzone=null),i.rejected||(i.cur.element!==i.prev.element&&(i.prev.dropzone&&(r.leave=new K.DropEvent(i,n,"dragleave"),n.dragLeave=r.leave.target=i.prev.element,n.prevDropzone=r.leave.dropzone=i.prev.dropzone),i.cur.dropzone&&(r.enter=new K.DropEvent(i,n,"dragenter"),n.dragEnter=i.cur.element,n.dropzone=i.cur.dropzone)),"dragend"===n.type&&i.cur.dropzone&&(r.drop=new K.DropEvent(i,n,"drop"),n.dropzone=i.cur.dropzone,n.relatedTarget=i.cur.element),"dragmove"===n.type&&i.cur.dropzone&&(r.move=new K.DropEvent(i,n,"dropmove"),r.move.dragmove=n,n.dropzone=i.cur.dropzone)),r}function ft(t,e){var n=t.dropState,i=n.activeDrops,r=n.cur,o=n.prev;e.leave&&o.dropzone.fire(e.leave),e.enter&&r.dropzone.fire(e.enter),e.move&&r.dropzone.fire(e.move),e.drop&&r.dropzone.fire(e.drop),e.deactivate&&lt(i,e.deactivate),n.prev.dropzone=r.dropzone,n.prev.element=r.element}function pt(t,e){var n=t.interaction,i=t.iEvent,r=t.event;if("dragmove"===i.type||"dragend"===i.type){var o=n.dropState;e.dynamicDrop&&(o.activeDrops=ut(e,n.element));var a=i,s=ct(n,a,r);o.rejected=o.rejected&&!!s&&s.dropzone===o.cur.dropzone&&s.element===o.cur.element,o.cur.dropzone=s&&s.dropzone,o.cur.element=s&&s.element,o.events=dt(n,0,a)}}Object.defineProperty(st,"__esModule",{value:!0}),st.default=void 0;var ht={id:"actions/drop",install:function(t){var e=t.actions,n=t.interactStatic,i=t.Interactable,r=t.defaults;t.usePlugin(c.default),i.prototype.dropzone=function(t){return function(t,e){if(o.default.object(e)){if(t.options.drop.enabled=!1!==e.enabled,e.listeners){var n=(0,M.default)(e.listeners),i=Object.keys(n).reduce((function(t,e){return t[/^(enter|leave)/.test(e)?"drag".concat(e):/^(activate|deactivate|move)/.test(e)?"drop".concat(e):e]=n[e],t}),{});t.off(t.options.drop.listeners),t.on(i),t.options.drop.listeners=i}return o.default.func(e.ondrop)&&t.on("drop",e.ondrop),o.default.func(e.ondropactivate)&&t.on("dropactivate",e.ondropactivate),o.default.func(e.ondropdeactivate)&&t.on("dropdeactivate",e.ondropdeactivate),o.default.func(e.ondragenter)&&t.on("dragenter",e.ondragenter),o.default.func(e.ondragleave)&&t.on("dragleave",e.ondragleave),o.default.func(e.ondropmove)&&t.on("dropmove",e.ondropmove),/^(pointer|center)$/.test(e.overlap)?t.options.drop.overlap=e.overlap:o.default.number(e.overlap)&&(t.options.drop.overlap=Math.max(Math.min(1,e.overlap),0)),"accept"in e&&(t.options.drop.accept=e.accept),"checker"in e&&(t.options.drop.checker=e.checker),t}return o.default.bool(e)?(t.options.drop.enabled=e,t):t.options.drop}(this,t)},i.prototype.dropCheck=function(t,e,n,i,r,a){return function(t,e,n,i,r,a,s){var l=!1;if(!(s=s||t.getRect(a)))return!!t.options.drop.checker&&t.options.drop.checker(e,n,l,t,a,i,r);var u=t.options.drop.overlap;if("pointer"===u){var c=(0,j.default)(i,r,"drag"),d=Y.getPageXY(e);d.x+=c.x,d.y+=c.y;var f=d.x>s.left&&d.x<s.right,p=d.y>s.top&&d.y<s.bottom;l=f&&p}var h=i.getRect(r);if(h&&"center"===u){var g=h.left+h.width/2,v=h.top+h.height/2;l=g>=s.left&&g<=s.right&&v>=s.top&&v<=s.bottom}return h&&o.default.number(u)&&(l=Math.max(0,Math.min(s.right,h.right)-Math.max(s.left,h.left))*Math.max(0,Math.min(s.bottom,h.bottom)-Math.max(s.top,h.top))/(h.width*h.height)>=u),t.options.drop.checker&&(l=t.options.drop.checker(e,n,l,t,a,i,r)),l}(this,t,e,n,i,r,a)},n.dynamicDrop=function(e){return o.default.bool(e)?(t.dynamicDrop=e,n):t.dynamicDrop},(0,k.default)(e.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),e.methodDict.drop="dropzone",t.dynamicDrop=!1,r.actions.drop=ht.defaults},listeners:{"interactions:before-action-start":function(t){var e=t.interaction;"drag"===e.prepared.name&&(e.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(t,e){var n=t.interaction,i=(t.event,t.iEvent);if("drag"===n.prepared.name){var r=n.dropState;r.activeDrops=null,r.events=null,r.activeDrops=ut(e,n.element),r.events=dt(n,0,i),r.events.activate&&(lt(r.activeDrops,r.events.activate),e.fire("actions/drop:start",{interaction:n,dragEvent:i}))}},"interactions:action-move":pt,"interactions:after-action-move":function(t,e){var n=t.interaction,i=t.iEvent;"drag"===n.prepared.name&&(ft(n,n.dropState.events),e.fire("actions/drop:move",{interaction:n,dragEvent:i}),n.dropState.events={})},"interactions:action-end":function(t,e){if("drag"===t.interaction.prepared.name){var n=t.interaction,i=t.iEvent;pt(t,e),ft(n,n.dropState.events),e.fire("actions/drop:end",{interaction:n,dragEvent:i})}},"interactions:stop":function(t){var e=t.interaction;if("drag"===e.prepared.name){var n=e.dropState;n&&(n.activeDrops=null,n.events=null,n.cur.dropzone=null,n.cur.element=null,n.prev.dropzone=null,n.prev.element=null,n.rejected=!1)}}},getActiveDrops:ut,getDrop:ct,getDropEvents:dt,fireDropEvents:ft,defaults:{enabled:!1,accept:null,overlap:"pointer"}},gt=ht;st.default=gt;var vt={};function yt(t){var e=t.interaction,n=t.iEvent,i=t.phase;if("gesture"===e.prepared.name){var r=e.pointers.map((function(t){return t.pointer})),a="start"===i,s="end"===i,l=e.interactable.options.deltaSource;if(n.touches=[r[0],r[1]],a)n.distance=Y.touchDistance(r,l),n.box=Y.touchBBox(r),n.scale=1,n.ds=0,n.angle=Y.touchAngle(r,l),n.da=0,e.gesture.startDistance=n.distance,e.gesture.startAngle=n.angle;else if(s){var u=e.prevEvent;n.distance=u.distance,n.box=u.box,n.scale=u.scale,n.ds=0,n.angle=u.angle,n.da=0}else n.distance=Y.touchDistance(r,l),n.box=Y.touchBBox(r),n.scale=n.distance/e.gesture.startDistance,n.angle=Y.touchAngle(r,l),n.ds=n.scale-e.gesture.scale,n.da=n.angle-e.gesture.angle;e.gesture.distance=n.distance,e.gesture.angle=n.angle,o.default.number(n.scale)&&n.scale!==1/0&&!isNaN(n.scale)&&(e.gesture.scale=n.scale)}}Object.defineProperty(vt,"__esModule",{value:!0}),vt.default=void 0;var bt={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(t){var e=t.actions,n=t.Interactable,i=t.defaults;n.prototype.gesturable=function(t){return o.default.object(t)?(this.options.gesture.enabled=!1!==t.enabled,this.setPerAction("gesture",t),this.setOnEvents("gesture",t),this):o.default.bool(t)?(this.options.gesture.enabled=t,this):this.options.gesture},e.map.gesture=bt,e.methodDict.gesture="gesturable",i.actions.gesture=bt.defaults},listeners:{"interactions:action-start":yt,"interactions:action-move":yt,"interactions:action-end":yt,"interactions:new":function(t){t.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(t){if(!(t.interaction.pointers.length<2)){var e=t.interactable.options.gesture;if(e&&e.enabled)return t.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""}},mt=bt;vt.default=mt;var Et={};function wt(t,e,n,i,r,a,s){if(!e)return!1;if(!0===e){var l=o.default.number(a.width)?a.width:a.right-a.left,u=o.default.number(a.height)?a.height:a.bottom-a.top;if(s=Math.min(s,Math.abs(("left"===t||"right"===t?l:u)/2)),l<0&&("left"===t?t="right":"right"===t&&(t="left")),u<0&&("top"===t?t="bottom":"bottom"===t&&(t="top")),"left"===t){var c=l>=0?a.left:a.right;return n.x<c+s}if("top"===t){var d=u>=0?a.top:a.bottom;return n.y<d+s}if("right"===t)return n.x>(l>=0?a.right:a.left)-s;if("bottom"===t)return n.y>(u>=0?a.bottom:a.top)-s}return!!o.default.element(i)&&(o.default.element(e)?e===i:_.matchesUpTo(i,e,r))}function _t(t){var e=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.resizeAxes){var i=e;n.interactable.options.resize.square?("y"===n.resizeAxes?i.delta.x=i.delta.y:i.delta.y=i.delta.x,i.axes="xy"):(i.axes=n.resizeAxes,"x"===n.resizeAxes?i.delta.y=0:"y"===n.resizeAxes&&(i.delta.x=0))}}Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=void 0;var Ot={id:"actions/resize",before:["actions/drag"],install:function(t){var e=t.actions,n=t.browser,i=t.Interactable,r=t.defaults;Ot.cursors=function(t){return t.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(n),Ot.defaultMargin=n.supportsTouch||n.supportsPointerEvent?20:10,i.prototype.resizable=function(e){return function(t,e,n){return o.default.object(e)?(t.options.resize.enabled=!1!==e.enabled,t.setPerAction("resize",e),t.setOnEvents("resize",e),o.default.string(e.axis)&&/^x$|^y$|^xy$/.test(e.axis)?t.options.resize.axis=e.axis:null===e.axis&&(t.options.resize.axis=n.defaults.actions.resize.axis),o.default.bool(e.preserveAspectRatio)?t.options.resize.preserveAspectRatio=e.preserveAspectRatio:o.default.bool(e.square)&&(t.options.resize.square=e.square),t):o.default.bool(e)?(t.options.resize.enabled=e,t):t.options.resize}(this,e,t)},e.map.resize=Ot,e.methodDict.resize="resizable",r.actions.resize=Ot.defaults},listeners:{"interactions:new":function(t){t.interaction.resizeAxes="xy"},"interactions:action-start":function(t){!function(t){var e=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var i=e,r=n.rect;n._rects={start:(0,k.default)({},r),corrected:(0,k.default)({},r),previous:(0,k.default)({},r),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},i.edges=n.prepared.edges,i.rect=n._rects.corrected,i.deltaRect=n._rects.delta}}(t),_t(t)},"interactions:action-move":function(t){!function(t){var e=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var i=e,r=n.interactable.options.resize.invert,o="reposition"===r||"negate"===r,a=n.rect,s=n._rects,l=s.start,u=s.corrected,c=s.delta,d=s.previous;if((0,k.default)(d,u),o){if((0,k.default)(u,a),"reposition"===r){if(u.top>u.bottom){var f=u.top;u.top=u.bottom,u.bottom=f}if(u.left>u.right){var p=u.left;u.left=u.right,u.right=p}}}else u.top=Math.min(a.top,l.bottom),u.bottom=Math.max(a.bottom,l.top),u.left=Math.min(a.left,l.right),u.right=Math.max(a.right,l.left);for(var h in u.width=u.right-u.left,u.height=u.bottom-u.top,u)c[h]=u[h]-d[h];i.edges=n.prepared.edges,i.rect=u,i.deltaRect=c}}(t),_t(t)},"interactions:action-end":function(t){var e=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var i=e;i.edges=n.prepared.edges,i.rect=n._rects.corrected,i.deltaRect=n._rects.delta}},"auto-start:check":function(t){var e=t.interaction,n=t.interactable,i=t.element,r=t.rect,a=t.buttons;if(r){var s=(0,k.default)({},e.coords.cur.page),l=n.options.resize;if(l&&l.enabled&&(!e.pointerIsDown||!/mouse|pointer/.test(e.pointerType)||0!=(a&l.mouseButtons))){if(o.default.object(l.edges)){var u={left:!1,right:!1,top:!1,bottom:!1};for(var c in u)u[c]=wt(c,l.edges[c],s,e._latestPointer.eventTarget,i,r,l.margin||Ot.defaultMargin);u.left=u.left&&!u.right,u.top=u.top&&!u.bottom,(u.left||u.right||u.top||u.bottom)&&(t.action={name:"resize",edges:u})}else{var d="y"!==l.axis&&s.x>r.right-Ot.defaultMargin,f="x"!==l.axis&&s.y>r.bottom-Ot.defaultMargin;(d||f)&&(t.action={name:"resize",axes:(d?"x":"")+(f?"y":"")})}return!t.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(t){var e=t.edges,n=t.axis,i=t.name,r=Ot.cursors,o=null;if(n)o=r[i+n];else if(e){for(var a="",s=["top","bottom","left","right"],l=0;l<s.length;l++){var u=s[l];e[u]&&(a+=u)}o=r[a]}return o},defaultMargin:null},Tt=Ot;Et.default=Tt;var xt={};Object.defineProperty(xt,"__esModule",{value:!0}),xt.default=void 0;var At={id:"actions",install:function(t){t.usePlugin(vt.default),t.usePlugin(Et.default),t.usePlugin(c.default),t.usePlugin(st.default)}};xt.default=At;var St={};Object.defineProperty(St,"__esModule",{value:!0}),St.default=void 0;var It,kt,Pt=0,Nt={request:function(t){return It(t)},cancel:function(t){return kt(t)},init:function(t){if(It=t.requestAnimationFrame,kt=t.cancelAnimationFrame,!It)for(var e=["ms","moz","webkit","o"],n=0;n<e.length;n++){var i=e[n];It=t["".concat(i,"RequestAnimationFrame")],kt=t["".concat(i,"CancelAnimationFrame")]||t["".concat(i,"CancelRequestAnimationFrame")]}It=It&&It.bind(t),kt=kt&&kt.bind(t),It||(It=function(e){var n=Date.now(),i=Math.max(0,16-(n-Pt)),r=t.setTimeout((function(){e(n+i)}),i);return Pt=n+i,r},kt=function(t){return clearTimeout(t)})}};St.default=Nt;var Ct={};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.default=void 0,Ct.getContainer=Mt,Ct.getScroll=Dt,Ct.getScrollSize=function(t){return o.default.window(t)&&(t=window.document.body),{x:t.scrollWidth,y:t.scrollHeight}},Ct.getScrollSizeDelta=function(t,e){var n=t.interaction,i=t.element,r=n&&n.interactable.options[n.prepared.name].autoScroll;if(!r||!r.enabled)return e(),{x:0,y:0};var o=Mt(r.container,n.interactable,i),a=Dt(o);e();var s=Dt(o);return{x:s.x-a.x,y:s.y-a.y}};var jt={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(t){jt.isScrolling=!0,St.default.cancel(jt.i),t.autoScroll=jt,jt.interaction=t,jt.prevTime=jt.now(),jt.i=St.default.request(jt.scroll)},stop:function(){jt.isScrolling=!1,jt.interaction&&(jt.interaction.autoScroll=null),St.default.cancel(jt.i)},scroll:function(){var t=jt.interaction,e=t.interactable,n=t.element,i=t.prepared.name,r=e.options[i].autoScroll,a=Mt(r.container,e,n),s=jt.now(),l=(s-jt.prevTime)/1e3,u=r.speed*l;if(u>=1){var c={x:jt.x*u,y:jt.y*u};if(c.x||c.y){var d=Dt(a);o.default.window(a)?a.scrollBy(c.x,c.y):a&&(a.scrollLeft+=c.x,a.scrollTop+=c.y);var f=Dt(a),p={x:f.x-d.x,y:f.y-d.y};(p.x||p.y)&&e.fire({type:"autoscroll",target:n,interactable:e,delta:p,interaction:t,container:a})}jt.prevTime=s}jt.isScrolling&&(St.default.cancel(jt.i),jt.i=St.default.request(jt.scroll))},check:function(t,e){var n;return null==(n=t.options[e].autoScroll)?void 0:n.enabled},onInteractionMove:function(t){var e=t.interaction,n=t.pointer;if(e.interacting()&&jt.check(e.interactable,e.prepared.name))if(e.simulation)jt.x=jt.y=0;else{var i,r,a,s,l=e.interactable,u=e.element,c=e.prepared.name,d=l.options[c].autoScroll,f=Mt(d.container,l,u);if(o.default.window(f))s=n.clientX<jt.margin,i=n.clientY<jt.margin,r=n.clientX>f.innerWidth-jt.margin,a=n.clientY>f.innerHeight-jt.margin;else{var p=_.getElementClientRect(f);s=n.clientX<p.left+jt.margin,i=n.clientY<p.top+jt.margin,r=n.clientX>p.right-jt.margin,a=n.clientY>p.bottom-jt.margin}jt.x=r?1:s?-1:0,jt.y=a?1:i?-1:0,jt.isScrolling||(jt.margin=d.margin,jt.speed=d.speed,jt.start(e))}}};function Mt(t,n,i){return(o.default.string(t)?(0,P.getStringOptionResult)(t,n,i):t)||(0,e.getWindow)(i)}function Dt(t){return o.default.window(t)&&(t=window.document.body),{x:t.scrollLeft,y:t.scrollTop}}var Rt={id:"auto-scroll",install:function(t){var e=t.defaults,n=t.actions;t.autoScroll=jt,jt.now=function(){return t.now()},n.phaselessTypes.autoscroll=!0,e.perAction.autoScroll=jt.defaults},listeners:{"interactions:new":function(t){t.interaction.autoScroll=null},"interactions:destroy":function(t){t.interaction.autoScroll=null,jt.stop(),jt.interaction&&(jt.interaction=null)},"interactions:stop":jt.stop,"interactions:action-move":function(t){return jt.onInteractionMove(t)}}},Lt=Rt;Ct.default=Lt;var Yt={};Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.copyAction=function(t,e){return t.name=e.name,t.axis=e.axis,t.edges=e.edges,t},Yt.sign=void 0,Yt.warnOnce=function(t,n){var i=!1;return function(){return i||(e.window.console.warn(n),i=!0),t.apply(this,arguments)}},Yt.sign=function(t){return t>=0?1:-1};var Vt={};function Bt(t){return o.default.bool(t)?(this.options.styleCursor=t,this):null===t?(delete this.options.styleCursor,this):this.options.styleCursor}function $t(t){return o.default.func(t)?(this.options.actionChecker=t,this):null===t?(delete this.options.actionChecker,this):this.options.actionChecker}Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.default=void 0;var Ft={id:"auto-start/interactableMethods",install:function(t){var e=t.Interactable;e.prototype.getAction=function(e,n,i,r){var o=function(t,e,n,i,r){var o=t.getRect(i),a={action:null,interactable:t,interaction:n,element:i,rect:o,buttons:e.buttons||{0:1,1:4,3:8,4:16}[e.button]};return r.fire("auto-start:check",a),a.action}(this,n,i,r,t);return this.options.actionChecker?this.options.actionChecker(e,n,o,this,r,i):o},e.prototype.ignoreFrom=(0,Yt.warnOnce)((function(t){return this._backCompatOption("ignoreFrom",t)}),"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),e.prototype.allowFrom=(0,Yt.warnOnce)((function(t){return this._backCompatOption("allowFrom",t)}),"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),e.prototype.actionChecker=$t,e.prototype.styleCursor=Bt}};Vt.default=Ft;var Gt={};function qt(t,e,n,i,r){return e.testIgnoreAllow(e.options[t.name],n,i)&&e.options[t.name].enabled&&Wt(e,n,t,r)?t:null}function Ut(t,e,n,i,r,o,a){for(var s=0,l=i.length;s<l;s++){var u=i[s],c=r[s],d=u.getAction(e,n,t,c);if(d){var f=qt(d,u,c,o,a);if(f)return{action:f,interactable:u,element:c}}}return{action:null,interactable:null,element:null}}function zt(t,e,n,i,r){var a=[],s=[],l=i;function u(t){a.push(t),s.push(l)}for(;o.default.element(l);){a=[],s=[],r.interactables.forEachMatch(l,u);var c=Ut(t,e,n,a,s,i,r);if(c.action&&!c.interactable.options[c.action.name].manualStart)return c;l=_.parentNode(l)}return{action:null,interactable:null,element:null}}function Jt(t,e,n){var i=e.action,r=e.interactable,o=e.element;i=i||{name:null},t.interactable=r,t.element=o,(0,Yt.copyAction)(t.prepared,i),t.rect=r&&i.name?r.getRect(o):null,Zt(t,n),n.fire("autoStart:prepared",{interaction:t})}function Wt(t,e,n,i){var r=t.options,o=r[n.name].max,a=r[n.name].maxPerElement,s=i.autoStart.maxInteractions,l=0,u=0,c=0;if(!(o&&a&&s))return!1;for(var d=0;d<i.interactions.list.length;d++){var f=i.interactions.list[d],p=f.prepared.name;if(f.interacting()){if(++l>=s)return!1;if(f.interactable===t){if((u+=p===n.name?1:0)>=o)return!1;if(f.element===e&&(c++,p===n.name&&c>=a))return!1}}}return s>0}function Ht(t,e){return o.default.number(t)?(e.autoStart.maxInteractions=t,this):e.autoStart.maxInteractions}function Xt(t,e,n){var i=n.autoStart.cursorElement;i&&i!==t&&(i.style.cursor=""),t.ownerDocument.documentElement.style.cursor=e,t.style.cursor=e,n.autoStart.cursorElement=e?t:null}function Zt(t,e){var n=t.interactable,i=t.element,r=t.prepared;if("mouse"===t.pointerType&&n&&n.options.styleCursor){var a="";if(r.name){var s=n.options[r.name].cursorChecker;a=o.default.func(s)?s(r,n,i,t._interacting):e.actions.map[r.name].getCursor(r)}Xt(t.element,a||"",e)}else e.autoStart.cursorElement&&Xt(e.autoStart.cursorElement,"",e)}Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.default=void 0;var Kt={id:"auto-start/base",before:["actions"],install:function(t){var e=t.interactStatic,n=t.defaults;t.usePlugin(Vt.default),n.base.actionChecker=null,n.base.styleCursor=!0,(0,k.default)(n.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),e.maxInteractions=function(e){return Ht(e,t)},t.autoStart={maxInteractions:1/0,withinInteractionLimit:Wt,cursorElement:null}},listeners:{"interactions:down":function(t,e){var n=t.interaction,i=t.pointer,r=t.event,o=t.eventTarget;n.interacting()||Jt(n,zt(n,i,r,o,e),e)},"interactions:move":function(t,e){!function(t,e){var n=t.interaction,i=t.pointer,r=t.event,o=t.eventTarget;"mouse"!==n.pointerType||n.pointerIsDown||n.interacting()||Jt(n,zt(n,i,r,o,e),e)}(t,e),function(t,e){var n=t.interaction;if(n.pointerIsDown&&!n.interacting()&&n.pointerWasMoved&&n.prepared.name){e.fire("autoStart:before-start",t);var i=n.interactable,r=n.prepared.name;r&&i&&(i.options[r].manualStart||!Wt(i,n.element,n.prepared,e)?n.stop():(n.start(n.prepared,i,n.element),Zt(n,e)))}}(t,e)},"interactions:stop":function(t,e){var n=t.interaction,i=n.interactable;i&&i.options.styleCursor&&Xt(n.element,"",e)}},maxInteractions:Ht,withinInteractionLimit:Wt,validateAction:qt},Qt=Kt;Gt.default=Qt;var te={};Object.defineProperty(te,"__esModule",{value:!0}),te.default=void 0;var ee={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(t,e){var n=t.interaction,i=t.eventTarget,r=t.dx,a=t.dy;if("drag"===n.prepared.name){var s=Math.abs(r),l=Math.abs(a),u=n.interactable.options.drag,c=u.startAxis,d=s>l?"x":s<l?"y":"xy";if(n.prepared.axis="start"===u.lockAxis?d[0]:u.lockAxis,"xy"!==d&&"xy"!==c&&c!==d){n.prepared.name=null;for(var f=i,p=function(t){if(t!==n.interactable){var r=n.interactable.options.drag;if(!r.manualStart&&t.testIgnoreAllow(r,f,i)){var o=t.getAction(n.downPointer,n.downEvent,n,f);if(o&&"drag"===o.name&&function(t,e){if(!e)return!1;var n=e.options.drag.startAxis;return"xy"===t||"xy"===n||n===t}(d,t)&&Gt.default.validateAction(o,t,f,i,e))return t}}};o.default.element(f);){var h=e.interactables.forEachMatch(f,p);if(h){n.prepared.name="drag",n.interactable=h,n.element=f;break}f=(0,_.parentNode)(f)}}}}}};te.default=ee;var ne={};function ie(t){var e=t.prepared&&t.prepared.name;if(!e)return null;var n=t.interactable.options;return n[e].hold||n[e].delay}Object.defineProperty(ne,"__esModule",{value:!0}),ne.default=void 0;var re={id:"auto-start/hold",install:function(t){var e=t.defaults;t.usePlugin(Gt.default),e.perAction.hold=0,e.perAction.delay=0},listeners:{"interactions:new":function(t){t.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(t){var e=t.interaction,n=ie(e);n>0&&(e.autoStartHoldTimer=setTimeout((function(){e.start(e.prepared,e.interactable,e.element)}),n))},"interactions:move":function(t){var e=t.interaction,n=t.duplicate;e.autoStartHoldTimer&&e.pointerWasMoved&&!n&&(clearTimeout(e.autoStartHoldTimer),e.autoStartHoldTimer=null)},"autoStart:before-start":function(t){var e=t.interaction;ie(e)>0&&(e.prepared.name=null)}},getHoldDuration:ie},oe=re;ne.default=oe;var ae={};Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var se={id:"auto-start",install:function(t){t.usePlugin(Gt.default),t.usePlugin(ne.default),t.usePlugin(te.default)}};ae.default=se;var le={};function ue(t){return/^(always|never|auto)$/.test(t)?(this.options.preventDefault=t,this):o.default.bool(t)?(this.options.preventDefault=t?"always":"never",this):this.options.preventDefault}function ce(t){var e=t.interaction,n=t.event;e.interactable&&e.interactable.checkAndPreventDefault(n)}function de(t){var n=t.Interactable;n.prototype.preventDefault=ue,n.prototype.checkAndPreventDefault=function(n){return function(t,n,i){var r=t.options.preventDefault;if("never"!==r)if("always"!==r){if(n.events.supportsPassive&&/^touch(start|move)$/.test(i.type)){var a=(0,e.getWindow)(i.target).document,s=n.getDocOptions(a);if(!s||!s.events||!1!==s.events.passive)return}/^(mouse|pointer|touch)*(down|start)/i.test(i.type)||o.default.element(i.target)&&(0,_.matchesSelector)(i.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||i.preventDefault()}else i.preventDefault()}(this,t,n)},t.interactions.docEvents.push({type:"dragstart",listener:function(e){for(var n=0;n<t.interactions.list.length;n++){var i=t.interactions.list[n];if(i.element&&(i.element===e.target||(0,_.nodeContains)(i.element,e.target)))return void i.interactable.checkAndPreventDefault(e)}}})}Object.defineProperty(le,"__esModule",{value:!0}),le.default=void 0,le.install=de;var fe={id:"core/interactablePreventDefault",install:de,listeners:["down","move","up","cancel"].reduce((function(t,e){return t["interactions:".concat(e)]=ce,t}),{})};le.default=fe;var pe={};Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0,pe.default={};var he,ge={};Object.defineProperty(ge,"__esModule",{value:!0}),ge.default=void 0,function(t){t.touchAction="touchAction",t.boxSizing="boxSizing",t.noListeners="noListeners"}(he||(he={})),he.touchAction,he.boxSizing,he.noListeners;var ve={id:"dev-tools",install:function(){}};ge.default=ve;var ye={};Object.defineProperty(ye,"__esModule",{value:!0}),ye.default=function t(e){var n={};for(var i in e){var r=e[i];o.default.plainObject(r)?n[i]=t(r):o.default.array(r)?n[i]=H.from(r):n[i]=r}return n};var be={};function me(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ee(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ee(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function we(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(be,"__esModule",{value:!0}),be.default=void 0,be.getRectOffset=xe;var Oe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_e(this,"states",[]),_e(this,"startOffset",{left:0,right:0,top:0,bottom:0}),_e(this,"startDelta",void 0),_e(this,"result",void 0),_e(this,"endResult",void 0),_e(this,"edges",void 0),_e(this,"interaction",void 0),this.interaction=e,this.result=Te()}var e,n;return e=t,(n=[{key:"start",value:function(t,e){var n=t.phase,i=this.interaction,r=function(t){var e=t.interactable.options[t.prepared.name],n=e.modifiers;return n&&n.length?n:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map((function(t){var n=e[t];return n&&n.enabled&&{options:n,methods:n._methods}})).filter((function(t){return!!t}))}(i);this.prepareStates(r),this.edges=(0,k.default)({},i.edges),this.startOffset=xe(i.rect,e),this.startDelta={x:0,y:0};var o=this.fillArg({phase:n,pageCoords:e,preEnd:!1});return this.result=Te(),this.startAll(o),this.result=this.setAll(o)}},{key:"fillArg",value:function(t){var e=this.interaction;return t.interaction=e,t.interactable=e.interactable,t.element=e.element,t.rect=t.rect||e.rect,t.edges=this.edges,t.startOffset=this.startOffset,t}},{key:"startAll",value:function(t){for(var e=0;e<this.states.length;e++){var n=this.states[e];n.methods.start&&(t.state=n,n.methods.start(t))}}},{key:"setAll",value:function(t){var e=t.phase,n=t.preEnd,i=t.skipModifiers,r=t.rect;t.coords=(0,k.default)({},t.pageCoords),t.rect=(0,k.default)({},r);for(var o=i?this.states.slice(i):this.states,a=Te(t.coords,t.rect),s=0;s<o.length;s++){var l,u=o[s],c=u.options,d=(0,k.default)({},t.coords),f=null;null!=(l=u.methods)&&l.set&&this.shouldDo(c,n,e)&&(t.state=u,f=u.methods.set(t),P.addEdges(this.interaction.edges,t.rect,{x:t.coords.x-d.x,y:t.coords.y-d.y})),a.eventProps.push(f)}a.delta.x=t.coords.x-t.pageCoords.x,a.delta.y=t.coords.y-t.pageCoords.y,a.rectDelta.left=t.rect.left-r.left,a.rectDelta.right=t.rect.right-r.right,a.rectDelta.top=t.rect.top-r.top,a.rectDelta.bottom=t.rect.bottom-r.bottom;var p=this.result.coords,h=this.result.rect;if(p&&h){var g=a.rect.left!==h.left||a.rect.right!==h.right||a.rect.top!==h.top||a.rect.bottom!==h.bottom;a.changed=g||p.x!==a.coords.x||p.y!==a.coords.y}return a}},{key:"applyToInteraction",value:function(t){var e=this.interaction,n=t.phase,i=e.coords.cur,r=e.coords.start,o=this.result,a=this.startDelta,s=o.delta;"start"===n&&(0,k.default)(this.startDelta,o.delta);for(var l=0;l<[[r,a],[i,s]].length;l++){var u=me([[r,a],[i,s]][l],2),c=u[0],d=u[1];c.page.x+=d.x,c.page.y+=d.y,c.client.x+=d.x,c.client.y+=d.y}var f=this.result.rectDelta,p=t.rect||e.rect;p.left+=f.left,p.right+=f.right,p.top+=f.top,p.bottom+=f.bottom,p.width=p.right-p.left,p.height=p.bottom-p.top}},{key:"setAndApply",value:function(t){var e=this.interaction,n=t.phase,i=t.preEnd,r=t.skipModifiers,o=this.setAll(this.fillArg({preEnd:i,phase:n,pageCoords:t.modifiedCoords||e.coords.cur.page}));if(this.result=o,!o.changed&&(!r||r<this.states.length)&&e.interacting())return!1;if(t.modifiedCoords){var a=e.coords.cur.page,s={x:t.modifiedCoords.x-a.x,y:t.modifiedCoords.y-a.y};o.coords.x+=s.x,o.coords.y+=s.y,o.delta.x+=s.x,o.delta.y+=s.y}this.applyToInteraction(t)}},{key:"beforeEnd",value:function(t){var e=t.interaction,n=t.event,i=this.states;if(i&&i.length){for(var r=!1,o=0;o<i.length;o++){var a=i[o];t.state=a;var s=a.options,l=a.methods,u=l.beforeEnd&&l.beforeEnd(t);if(u)return this.endResult=u,!1;r=r||!r&&this.shouldDo(s,!0,t.phase,!0)}r&&e.move({event:n,preEnd:!0})}}},{key:"stop",value:function(t){var e=t.interaction;if(this.states&&this.states.length){var n=(0,k.default)({states:this.states,interactable:e.interactable,element:e.element,rect:null},t);this.fillArg(n);for(var i=0;i<this.states.length;i++){var r=this.states[i];n.state=r,r.methods.stop&&r.methods.stop(n)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(t){this.states=[];for(var e=0;e<t.length;e++){var n=t[e],i=n.options,r=n.methods,o=n.name;this.states.push({options:i,methods:r,index:e,name:o})}return this.states}},{key:"restoreInteractionCoords",value:function(t){var e=t.interaction,n=e.coords,i=e.rect,r=e.modification;if(r.result){for(var o=r.startDelta,a=r.result,s=a.delta,l=a.rectDelta,u=[[n.start,o],[n.cur,s]],c=0;c<u.length;c++){var d=me(u[c],2),f=d[0],p=d[1];f.page.x-=p.x,f.page.y-=p.y,f.client.x-=p.x,f.client.y-=p.y}i.left-=l.left,i.right-=l.right,i.top-=l.top,i.bottom-=l.bottom}}},{key:"shouldDo",value:function(t,e,n,i){return!(!t||!1===t.enabled||i&&!t.endOnly||t.endOnly&&!e||"start"===n&&!t.setStart)}},{key:"copyFrom",value:function(t){this.startOffset=t.startOffset,this.startDelta=t.startDelta,this.edges=t.edges,this.states=t.states.map((function(t){return(0,ye.default)(t)})),this.result=Te((0,k.default)({},t.result.coords),(0,k.default)({},t.result.rect))}},{key:"destroy",value:function(){for(var t in this)this[t]=null}}])&&we(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Te(t,e){return{rect:e,coords:t,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function xe(t,e){return t?{left:e.x-t.left,top:e.y-t.top,right:t.right-e.x,bottom:t.bottom-e.y}:{left:0,top:0,right:0,bottom:0}}be.default=Oe;var Ae={};function Se(t){var e=t.iEvent,n=t.interaction.modification.result;n&&(e.modifiers=n.eventProps)}Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.addEventModifiers=Se,Ae.default=void 0,Ae.makeModifier=function(t,e){var n=t.defaults,i={start:t.start,set:t.set,beforeEnd:t.beforeEnd,stop:t.stop},r=function(t){var r=t||{};for(var o in r.enabled=!1!==r.enabled,n)o in r||(r[o]=n[o]);var a={options:r,methods:i,name:e,enable:function(){return r.enabled=!0,a},disable:function(){return r.enabled=!1,a}};return a};return e&&"string"==typeof e&&(r._defaults=n,r._methods=i),r};var Ie={id:"modifiers/base",before:["actions"],install:function(t){t.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(t){var e=t.interaction;e.modification=new be.default(e)},"interactions:before-action-start":function(t){var e=t.interaction.modification;e.start(t,t.interaction.coords.start.page),t.interaction.edges=e.edges,e.applyToInteraction(t)},"interactions:before-action-move":function(t){return t.interaction.modification.setAndApply(t)},"interactions:before-action-end":function(t){return t.interaction.modification.beforeEnd(t)},"interactions:action-start":Se,"interactions:action-move":Se,"interactions:action-end":Se,"interactions:after-action-start":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:after-action-move":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:stop":function(t){return t.interaction.modification.stop(t)}}},ke=Ie;Ae.default=ke;var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.defaults=void 0,Pe.defaults={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}};var Ne={};function Ce(t){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(t)}function je(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Me(t,e){return Me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Me(t,e)}function De(t,e){if(e&&("object"===Ce(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Re(t)}function Re(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Le(t){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Le(t)}function Ye(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.InteractEvent=void 0;var Ve=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Me(t,e)}(a,t);var e,n,i,r,o=(i=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Le(i);if(r){var n=Le(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return De(this,t)});function a(t,e,n,i,r,s,l){var u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Ye(Re(u=o.call(this,t)),"relatedTarget",null),Ye(Re(u),"screenX",void 0),Ye(Re(u),"screenY",void 0),Ye(Re(u),"button",void 0),Ye(Re(u),"buttons",void 0),Ye(Re(u),"ctrlKey",void 0),Ye(Re(u),"shiftKey",void 0),Ye(Re(u),"altKey",void 0),Ye(Re(u),"metaKey",void 0),Ye(Re(u),"page",void 0),Ye(Re(u),"client",void 0),Ye(Re(u),"delta",void 0),Ye(Re(u),"rect",void 0),Ye(Re(u),"x0",void 0),Ye(Re(u),"y0",void 0),Ye(Re(u),"t0",void 0),Ye(Re(u),"dt",void 0),Ye(Re(u),"duration",void 0),Ye(Re(u),"clientX0",void 0),Ye(Re(u),"clientY0",void 0),Ye(Re(u),"velocity",void 0),Ye(Re(u),"speed",void 0),Ye(Re(u),"swipe",void 0),Ye(Re(u),"axes",void 0),Ye(Re(u),"preEnd",void 0),r=r||t.element;var c=t.interactable,d=(c&&c.options||Pe.defaults).deltaSource,f=(0,j.default)(c,r,n),p="start"===i,h="end"===i,g=p?Re(u):t.prevEvent,v=p?t.coords.start:h?{page:g.page,client:g.client,timeStamp:t.coords.cur.timeStamp}:t.coords.cur;return u.page=(0,k.default)({},v.page),u.client=(0,k.default)({},v.client),u.rect=(0,k.default)({},t.rect),u.timeStamp=v.timeStamp,h||(u.page.x-=f.x,u.page.y-=f.y,u.client.x-=f.x,u.client.y-=f.y),u.ctrlKey=e.ctrlKey,u.altKey=e.altKey,u.shiftKey=e.shiftKey,u.metaKey=e.metaKey,u.button=e.button,u.buttons=e.buttons,u.target=r,u.currentTarget=r,u.preEnd=s,u.type=l||n+(i||""),u.interactable=c,u.t0=p?t.pointers[t.pointers.length-1].downTime:g.t0,u.x0=t.coords.start.page.x-f.x,u.y0=t.coords.start.page.y-f.y,u.clientX0=t.coords.start.client.x-f.x,u.clientY0=t.coords.start.client.y-f.y,u.delta=p||h?{x:0,y:0}:{x:u[d].x-g[d].x,y:u[d].y-g[d].y},u.dt=t.coords.delta.timeStamp,u.duration=u.timeStamp-u.t0,u.velocity=(0,k.default)({},t.coords.velocity[d]),u.speed=(0,R.default)(u.velocity.x,u.velocity.y),u.swipe=h||"inertiastart"===i?u.getSwipe():null,u}return e=a,(n=[{key:"getSwipe",value:function(){var t=this._interaction;if(t.prevEvent.speed<600||this.timeStamp-t.prevEvent.timeStamp>150)return null;var e=180*Math.atan2(t.prevEvent.velocityY,t.prevEvent.velocityX)/Math.PI;e<0&&(e+=360);var n=112.5<=e&&e<247.5,i=202.5<=e&&e<337.5;return{up:i,down:!i&&22.5<=e&&e<157.5,left:n,right:!n&&(292.5<=e||e<67.5),angle:e,speed:t.prevEvent.speed,velocity:{x:t.prevEvent.velocityX,y:t.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&je(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(U.BaseEvent);Ne.InteractEvent=Ve,Object.defineProperties(Ve.prototype,{pageX:{get:function(){return this.page.x},set:function(t){this.page.x=t}},pageY:{get:function(){return this.page.y},set:function(t){this.page.y=t}},clientX:{get:function(){return this.client.x},set:function(t){this.client.x=t}},clientY:{get:function(){return this.client.y},set:function(t){this.client.y=t}},dx:{get:function(){return this.delta.x},set:function(t){this.delta.x=t}},dy:{get:function(){return this.delta.y},set:function(t){this.delta.y=t}},velocityX:{get:function(){return this.velocity.x},set:function(t){this.velocity.x=t}},velocityY:{get:function(){return this.velocity.y},set:function(t){this.velocity.y=t}}});var Be={};function $e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Fe(t,e,n){return e&&$e(t.prototype,e),n&&$e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ge(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Be,"__esModule",{value:!0}),Be.PointerInfo=void 0;var qe=Fe((function t(e,n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ge(this,"id",void 0),Ge(this,"pointer",void 0),Ge(this,"event",void 0),Ge(this,"downTime",void 0),Ge(this,"downTarget",void 0),this.id=e,this.pointer=n,this.event=i,this.downTime=r,this.downTarget=o}));Be.PointerInfo=qe;var Ue,ze,Je={};function We(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function He(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Je,"__esModule",{value:!0}),Je.Interaction=void 0,Object.defineProperty(Je,"PointerInfo",{enumerable:!0,get:function(){return Be.PointerInfo}}),Je.default=Je._ProxyValues=Je._ProxyMethods=void 0,Je._ProxyValues=Ue,function(t){t.interactable="",t.element="",t.prepared="",t.pointerIsDown="",t.pointerWasMoved="",t._proxy=""}(Ue||(Je._ProxyValues=Ue={})),Je._ProxyMethods=ze,function(t){t.start="",t.move="",t.end="",t.stop="",t.interacting=""}(ze||(Je._ProxyMethods=ze={}));var Xe=0,Ze=function(){function t(e){var n=this,i=e.pointerType,r=e.scopeFire;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),He(this,"interactable",null),He(this,"element",null),He(this,"rect",null),He(this,"_rects",void 0),He(this,"edges",null),He(this,"_scopeFire",void 0),He(this,"prepared",{name:null,axis:null,edges:null}),He(this,"pointerType",void 0),He(this,"pointers",[]),He(this,"downEvent",null),He(this,"downPointer",{}),He(this,"_latestPointer",{pointer:null,event:null,eventTarget:null}),He(this,"prevEvent",null),He(this,"pointerIsDown",!1),He(this,"pointerWasMoved",!1),He(this,"_interacting",!1),He(this,"_ending",!1),He(this,"_stopped",!0),He(this,"_proxy",null),He(this,"simulation",null),He(this,"doMove",(0,Yt.warnOnce)((function(t){this.move(t)}),"The interaction.doMove() method has been renamed to interaction.move()")),He(this,"coords",{start:Y.newCoords(),prev:Y.newCoords(),cur:Y.newCoords(),delta:Y.newCoords(),velocity:Y.newCoords()}),He(this,"_id",Xe++),this._scopeFire=r,this.pointerType=i;var o=this;this._proxy={};var a=function(t){Object.defineProperty(n._proxy,t,{get:function(){return o[t]}})};for(var s in Ue)a(s);var l=function(t){Object.defineProperty(n._proxy,t,{value:function(){return o[t].apply(o,arguments)}})};for(var u in ze)l(u);this._scopeFire("interactions:new",{interaction:this})}var e,n;return e=t,n=[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(t,e,n){var i=this.updatePointer(t,e,n,!0),r=this.pointers[i];this._scopeFire("interactions:down",{pointer:t,event:e,eventTarget:n,pointerIndex:i,pointerInfo:r,type:"down",interaction:this})}},{key:"start",value:function(t,e,n){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<("gesture"===t.name?2:1)||!e.options[t.name].enabled)&&((0,Yt.copyAction)(this.prepared,t),this.interactable=e,this.element=n,this.rect=e.getRect(n),this.edges=this.prepared.edges?(0,k.default)({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(t,e,n){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(t,e,n,!1);var i,r,o=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(i=this.coords.cur.client.x-this.coords.start.client.x,r=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=(0,R.default)(i,r)>this.pointerMoveTolerance);var a=this.getPointerIndex(t),s={pointer:t,pointerIndex:a,pointerInfo:this.pointers[a],event:e,type:"move",eventTarget:n,dx:i,dy:r,duplicate:o,interaction:this};o||Y.setCoordVelocity(this.coords.velocity,this.coords.delta),this._scopeFire("interactions:move",s),o||this.simulation||(this.interacting()&&(s.type=null,this.move(s)),this.pointerWasMoved&&Y.copyCoords(this.coords.prev,this.coords.cur))}},{key:"move",value:function(t){t&&t.event||Y.setZeroCoords(this.coords.delta),(t=(0,k.default)({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},t||{})).phase="move",this._doPhase(t)}},{key:"pointerUp",value:function(t,e,n,i){var r=this.getPointerIndex(t);-1===r&&(r=this.updatePointer(t,e,n,!1));var o=/cancel$/i.test(e.type)?"cancel":"up";this._scopeFire("interactions:".concat(o),{pointer:t,pointerIndex:r,pointerInfo:this.pointers[r],event:e,eventTarget:n,type:o,curEventTarget:i,interaction:this}),this.simulation||this.end(e),this.removePointer(t,e)}},{key:"documentBlur",value:function(t){this.end(t),this._scopeFire("interactions:blur",{event:t,type:"blur",interaction:this})}},{key:"end",value:function(t){var e;this._ending=!0,t=t||this._latestPointer.event,this.interacting()&&(e=this._doPhase({event:t,interaction:this,phase:"end"})),this._ending=!1,!0===e&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(t){var e=Y.getPointerId(t);return"mouse"===this.pointerType||"pen"===this.pointerType?this.pointers.length-1:H.findIndex(this.pointers,(function(t){return t.id===e}))}},{key:"getPointerInfo",value:function(t){return this.pointers[this.getPointerIndex(t)]}},{key:"updatePointer",value:function(t,e,n,i){var r=Y.getPointerId(t),o=this.getPointerIndex(t),a=this.pointers[o];return i=!1!==i&&(i||/(down|start)$/i.test(e.type)),a?a.pointer=t:(a=new Be.PointerInfo(r,t,e,null,null),o=this.pointers.length,this.pointers.push(a)),Y.setCoords(this.coords.cur,this.pointers.map((function(t){return t.pointer})),this._now()),Y.setCoordDeltas(this.coords.delta,this.coords.prev,this.coords.cur),i&&(this.pointerIsDown=!0,a.downTime=this.coords.cur.timeStamp,a.downTarget=n,Y.pointerExtend(this.downPointer,t),this.interacting()||(Y.copyCoords(this.coords.start,this.coords.cur),Y.copyCoords(this.coords.prev,this.coords.cur),this.downEvent=e,this.pointerWasMoved=!1)),this._updateLatestPointer(t,e,n),this._scopeFire("interactions:update-pointer",{pointer:t,event:e,eventTarget:n,down:i,pointerInfo:a,pointerIndex:o,interaction:this}),o}},{key:"removePointer",value:function(t,e){var n=this.getPointerIndex(t);if(-1!==n){var i=this.pointers[n];this._scopeFire("interactions:remove-pointer",{pointer:t,event:e,eventTarget:null,pointerIndex:n,pointerInfo:i,interaction:this}),this.pointers.splice(n,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(t,e,n){this._latestPointer.pointer=t,this._latestPointer.event=e,this._latestPointer.eventTarget=n}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(t,e,n,i){return new Ne.InteractEvent(this,t,this.prepared.name,e,this.element,n,i)}},{key:"_fireEvent",value:function(t){var e;null==(e=this.interactable)||e.fire(t),(!this.prevEvent||t.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=t)}},{key:"_doPhase",value:function(t){var e=t.event,n=t.phase,i=t.preEnd,r=t.type,o=this.rect;if(o&&"move"===n&&(P.addEdges(this.edges,o,this.coords.delta[this.interactable.options.deltaSource]),o.width=o.right-o.left,o.height=o.bottom-o.top),!1===this._scopeFire("interactions:before-action-".concat(n),t))return!1;var a=t.iEvent=this._createPreparedEvent(e,n,i,r);return this._scopeFire("interactions:action-".concat(n),t),"start"===n&&(this.prevEvent=a),this._fireEvent(a),this._scopeFire("interactions:after-action-".concat(n),t),!0}},{key:"_now",value:function(){return Date.now()}}],n&&We(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();Je.Interaction=Ze;var Ke=Ze;Je.default=Ke;var Qe={};function tn(t){t.pointerIsDown&&(on(t.coords.cur,t.offset.total),t.offset.pending.x=0,t.offset.pending.y=0)}function en(t){nn(t.interaction)}function nn(t){if(!function(t){return!(!t.offset.pending.x&&!t.offset.pending.y)}(t))return!1;var e=t.offset.pending;return on(t.coords.cur,e),on(t.coords.delta,e),P.addEdges(t.edges,t.rect,e),e.x=0,e.y=0,!0}function rn(t){var e=t.x,n=t.y;this.offset.pending.x+=e,this.offset.pending.y+=n,this.offset.total.x+=e,this.offset.total.y+=n}function on(t,e){var n=t.page,i=t.client,r=e.x,o=e.y;n.x+=r,n.y+=o,i.x+=r,i.y+=o}Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.addTotal=tn,Qe.applyPending=nn,Qe.default=void 0,Je._ProxyMethods.offsetBy="";var an={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(t){t.Interaction.prototype.offsetBy=rn},listeners:{"interactions:new":function(t){t.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(t){return tn(t.interaction)},"interactions:before-action-start":en,"interactions:before-action-move":en,"interactions:before-action-end":function(t){var e=t.interaction;if(nn(e))return e.move({offset:!0}),e.end(),!1},"interactions:stop":function(t){var e=t.interaction;e.offset.total.x=0,e.offset.total.y=0,e.offset.pending.x=0,e.offset.pending.y=0}}},sn=an;Qe.default=sn;var ln={};function un(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function cn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(ln,"__esModule",{value:!0}),ln.default=ln.InertiaState=void 0;var dn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),cn(this,"active",!1),cn(this,"isModified",!1),cn(this,"smoothEnd",!1),cn(this,"allowResume",!1),cn(this,"modification",void 0),cn(this,"modifierCount",0),cn(this,"modifierArg",void 0),cn(this,"startCoords",void 0),cn(this,"t0",0),cn(this,"v0",0),cn(this,"te",0),cn(this,"targetOffset",void 0),cn(this,"modifiedOffset",void 0),cn(this,"currentOffset",void 0),cn(this,"lambda_v0",0),cn(this,"one_ve_v0",0),cn(this,"timeout",void 0),cn(this,"interaction",void 0),this.interaction=e}var e,n;return e=t,(n=[{key:"start",value:function(t){var e=this.interaction,n=fn(e);if(!n||!n.enabled)return!1;var i=e.coords.velocity.client,r=(0,R.default)(i.x,i.y),o=this.modification||(this.modification=new be.default(e));if(o.copyFrom(e.modification),this.t0=e._now(),this.allowResume=n.allowResume,this.v0=r,this.currentOffset={x:0,y:0},this.startCoords=e.coords.cur.page,this.modifierArg=o.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-e.coords.cur.timeStamp<50&&r>n.minSpeed&&r>n.endSpeed)this.startInertia();else{if(o.result=o.setAll(this.modifierArg),!o.result.changed)return!1;this.startSmoothEnd()}return e.modification.result.rect=null,e.offsetBy(this.targetOffset),e._doPhase({interaction:e,event:t,phase:"inertiastart"}),e.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),e.modification.result.rect=null,this.active=!0,e.simulation=this,!0}},{key:"startInertia",value:function(){var t=this,e=this.interaction.coords.velocity.client,n=fn(this.interaction),i=n.resistance,r=-Math.log(n.endSpeed/this.v0)/i;this.targetOffset={x:(e.x-r)/i,y:(e.y-r)/i},this.te=r,this.lambda_v0=i/this.v0,this.one_ve_v0=1-n.endSpeed/this.v0;var o=this.modification,a=this.modifierArg;a.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},o.result=o.setAll(a),o.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+o.result.delta.x,y:this.targetOffset.y+o.result.delta.y}),this.onNextFrame((function(){return t.inertiaTick()}))}},{key:"startSmoothEnd",value:function(){var t=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame((function(){return t.smoothEndTick()}))}},{key:"onNextFrame",value:function(t){var e=this;this.timeout=St.default.request((function(){e.active&&t()}))}},{key:"inertiaTick",value:function(){var t,e,n,i,r,o=this,a=this.interaction,s=fn(a).resistance,l=(a._now()-this.t0)/1e3;if(l<this.te){var u,c=1-(Math.exp(-s*l)-this.lambda_v0)/this.one_ve_v0;this.isModified?(t=this.targetOffset.x,e=this.targetOffset.y,n=this.modifiedOffset.x,i=this.modifiedOffset.y,u={x:hn(r=c,0,t,n),y:hn(r,0,e,i)}):u={x:this.targetOffset.x*c,y:this.targetOffset.y*c};var d={x:u.x-this.currentOffset.x,y:u.y-this.currentOffset.y};this.currentOffset.x+=d.x,this.currentOffset.y+=d.y,a.offsetBy(d),a.move(),this.onNextFrame((function(){return o.inertiaTick()}))}else a.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var t=this,e=this.interaction,n=e._now()-this.t0,i=fn(e).smoothEndDuration;if(n<i){var r={x:gn(n,0,this.targetOffset.x,i),y:gn(n,0,this.targetOffset.y,i)},o={x:r.x-this.currentOffset.x,y:r.y-this.currentOffset.y};this.currentOffset.x+=o.x,this.currentOffset.y+=o.y,e.offsetBy(o),e.move({skipModifiers:this.modifierCount}),this.onNextFrame((function(){return t.smoothEndTick()}))}else e.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(t){var e=t.pointer,n=t.event,i=t.eventTarget,r=this.interaction;r.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),r.updatePointer(e,n,i,!0),r._doPhase({interaction:r,event:n,phase:"resume"}),(0,Y.copyCoords)(r.coords.prev,r.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,St.default.cancel(this.timeout)}}])&&un(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fn(t){var e=t.interactable,n=t.prepared;return e&&e.options&&n.name&&e.options[n.name].inertia}ln.InertiaState=dn;var pn={id:"inertia",before:["modifiers","actions"],install:function(t){var e=t.defaults;t.usePlugin(Qe.default),t.usePlugin(Ae.default),t.actions.phases.inertiastart=!0,t.actions.phases.resume=!0,e.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(t){var e=t.interaction;e.inertia=new dn(e)},"interactions:before-action-end":function(t){var e=t.interaction,n=t.event;return(!e._interacting||e.simulation||!e.inertia.start(n))&&null},"interactions:down":function(t){var e=t.interaction,n=t.eventTarget,i=e.inertia;if(i.active)for(var r=n;o.default.element(r);){if(r===e.element){i.resume(t);break}r=_.parentNode(r)}},"interactions:stop":function(t){var e=t.interaction.inertia;e.active&&e.stop()},"interactions:before-action-resume":function(t){var e=t.interaction.modification;e.stop(t),e.start(t,t.interaction.coords.cur.page),e.applyToInteraction(t)},"interactions:before-action-inertiastart":function(t){return t.interaction.modification.setAndApply(t)},"interactions:action-resume":Ae.addEventModifiers,"interactions:action-inertiastart":Ae.addEventModifiers,"interactions:after-action-inertiastart":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:after-action-resume":function(t){return t.interaction.modification.restoreInteractionCoords(t)}}};function hn(t,e,n,i){var r=1-t;return r*r*e+2*r*t*n+t*t*i}function gn(t,e,n,i){return-n*(t/=i)*(t-2)+e}var vn=pn;ln.default=vn;var yn={};function bn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function En(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(t.immediatePropagationStopped)break;i(t)}}Object.defineProperty(yn,"__esModule",{value:!0}),yn.Eventable=void 0;var wn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),mn(this,"options",void 0),mn(this,"types",{}),mn(this,"propagationStopped",!1),mn(this,"immediatePropagationStopped",!1),mn(this,"global",void 0),this.options=(0,k.default)({},e||{})}var e,n;return e=t,(n=[{key:"fire",value:function(t){var e,n=this.global;(e=this.types[t.type])&&En(t,e),!t.propagationStopped&&n&&(e=n[t.type])&&En(t,e)}},{key:"on",value:function(t,e){var n=(0,M.default)(t,e);for(t in n)this.types[t]=H.merge(this.types[t]||[],n[t])}},{key:"off",value:function(t,e){var n=(0,M.default)(t,e);for(t in n){var i=this.types[t];if(i&&i.length)for(var r=0;r<n[t].length;r++){var o=n[t][r],a=i.indexOf(o);-1!==a&&i.splice(a,1)}}}},{key:"getRect",value:function(t){return null}}])&&bn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();yn.Eventable=wn;var _n={};Object.defineProperty(_n,"__esModule",{value:!0}),_n.default=function(t,e){if(e.phaselessTypes[t])return!0;for(var n in e.map)if(0===t.indexOf(n)&&t.substr(n.length)in e.phases)return!0;return!1};var On={};Object.defineProperty(On,"__esModule",{value:!0}),On.createInteractStatic=function(t){var e=function e(n,i){var r=t.interactables.get(n,i);return r||((r=t.interactables.new(n,i)).events.global=e.globalEvents),r};return e.getPointerAverage=Y.pointerAverage,e.getTouchBBox=Y.touchBBox,e.getTouchDistance=Y.touchDistance,e.getTouchAngle=Y.touchAngle,e.getElementRect=_.getElementRect,e.getElementClientRect=_.getElementClientRect,e.matchesSelector=_.matchesSelector,e.closest=_.closest,e.globalEvents={},e.version="1.10.17",e.scope=t,e.use=function(t,e){return this.scope.usePlugin(t,e),this},e.isSet=function(t,e){return!!this.scope.interactables.get(t,e&&e.context)},e.on=(0,Yt.warnOnce)((function(t,e,n){if(o.default.string(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),o.default.array(t)){for(var i=0;i<t.length;i++){var r=t[i];this.on(r,e,n)}return this}if(o.default.object(t)){for(var a in t)this.on(a,t[a],e);return this}return(0,_n.default)(t,this.scope.actions)?this.globalEvents[t]?this.globalEvents[t].push(e):this.globalEvents[t]=[e]:this.scope.events.add(this.scope.document,t,e,{options:n}),this}),"The interact.on() method is being deprecated"),e.off=(0,Yt.warnOnce)((function(t,e,n){if(o.default.string(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),o.default.array(t)){for(var i=0;i<t.length;i++){var r=t[i];this.off(r,e,n)}return this}if(o.default.object(t)){for(var a in t)this.off(a,t[a],e);return this}var s;return(0,_n.default)(t,this.scope.actions)?t in this.globalEvents&&-1!==(s=this.globalEvents[t].indexOf(e))&&this.globalEvents[t].splice(s,1):this.scope.events.remove(this.scope.document,t,e,n),this}),"The interact.off() method is being deprecated"),e.debug=function(){return this.scope},e.supportsTouch=function(){return m.default.supportsTouch},e.supportsPointerEvent=function(){return m.default.supportsPointerEvent},e.stop=function(){for(var t=0;t<this.scope.interactions.list.length;t++)this.scope.interactions.list[t].stop();return this},e.pointerMoveTolerance=function(t){return o.default.number(t)?(this.scope.interactions.pointerMoveTolerance=t,this):this.scope.interactions.pointerMoveTolerance},e.addDocument=function(t,e){this.scope.addDocument(t,e)},e.removeDocument=function(t){this.scope.removeDocument(t)},e};var Tn={};function xn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function An(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.Interactable=void 0;var Sn=function(){function t(n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),An(this,"options",void 0),An(this,"_actions",void 0),An(this,"target",void 0),An(this,"events",new yn.Eventable),An(this,"_context",void 0),An(this,"_win",void 0),An(this,"_doc",void 0),An(this,"_scopeEvents",void 0),An(this,"_rectChecker",void 0),this._actions=i.actions,this.target=n,this._context=i.context||r,this._win=(0,e.getWindow)((0,_.trySelector)(n)?this._context:n),this._doc=this._win.document,this._scopeEvents=o,this.set(i)}var n,i;return n=t,(i=[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(t,e){return o.default.func(e.onstart)&&this.on("".concat(t,"start"),e.onstart),o.default.func(e.onmove)&&this.on("".concat(t,"move"),e.onmove),o.default.func(e.onend)&&this.on("".concat(t,"end"),e.onend),o.default.func(e.oninertiastart)&&this.on("".concat(t,"inertiastart"),e.oninertiastart),this}},{key:"updatePerActionListeners",value:function(t,e,n){(o.default.array(e)||o.default.object(e))&&this.off(t,e),(o.default.array(n)||o.default.object(n))&&this.on(t,n)}},{key:"setPerAction",value:function(t,e){var n=this._defaults;for(var i in e){var r=i,a=this.options[t],s=e[r];"listeners"===r&&this.updatePerActionListeners(t,a.listeners,s),o.default.array(s)?a[r]=H.from(s):o.default.plainObject(s)?(a[r]=(0,k.default)(a[r]||{},(0,ye.default)(s)),o.default.object(n.perAction[r])&&"enabled"in n.perAction[r]&&(a[r].enabled=!1!==s.enabled)):o.default.bool(s)&&o.default.object(n.perAction[r])?a[r].enabled=s:a[r]=s}}},{key:"getRect",value:function(t){return t=t||(o.default.element(this.target)?this.target:null),o.default.string(this.target)&&(t=t||this._context.querySelector(this.target)),(0,_.getElementRect)(t)}},{key:"rectChecker",value:function(t){var e=this;return o.default.func(t)?(this._rectChecker=t,this.getRect=function(t){var n=(0,k.default)({},e._rectChecker(t));return"width"in n||(n.width=n.right-n.left,n.height=n.bottom-n.top),n},this):null===t?(delete this.getRect,delete this._rectChecker,this):this.getRect}},{key:"_backCompatOption",value:function(t,e){if((0,_.trySelector)(e)||o.default.object(e)){for(var n in this.options[t]=e,this._actions.map)this.options[n][t]=e;return this}return this.options[t]}},{key:"origin",value:function(t){return this._backCompatOption("origin",t)}},{key:"deltaSource",value:function(t){return"page"===t||"client"===t?(this.options.deltaSource=t,this):this.options.deltaSource}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(t){return this._context===t.ownerDocument||(0,_.nodeContains)(this._context,t)}},{key:"testIgnoreAllow",value:function(t,e,n){return!this.testIgnore(t.ignoreFrom,e,n)&&this.testAllow(t.allowFrom,e,n)}},{key:"testAllow",value:function(t,e,n){return!t||!!o.default.element(n)&&(o.default.string(t)?(0,_.matchesUpTo)(n,t,e):!!o.default.element(t)&&(0,_.nodeContains)(t,n))}},{key:"testIgnore",value:function(t,e,n){return!(!t||!o.default.element(n))&&(o.default.string(t)?(0,_.matchesUpTo)(n,t,e):!!o.default.element(t)&&(0,_.nodeContains)(t,n))}},{key:"fire",value:function(t){return this.events.fire(t),this}},{key:"_onOff",value:function(t,e,n,i){o.default.object(e)&&!o.default.array(e)&&(i=n,n=null);var r="on"===t?"add":"remove",a=(0,M.default)(e,n);for(var s in a){"wheel"===s&&(s=m.default.wheelEvent);for(var l=0;l<a[s].length;l++){var u=a[s][l];(0,_n.default)(s,this._actions)?this.events[t](s,u):o.default.string(this.target)?this._scopeEvents["".concat(r,"Delegate")](this.target,this._context,s,u,i):this._scopeEvents[r](this.target,s,u,i)}}return this}},{key:"on",value:function(t,e,n){return this._onOff("on",t,e,n)}},{key:"off",value:function(t,e,n){return this._onOff("off",t,e,n)}},{key:"set",value:function(t){var e=this._defaults;for(var n in o.default.object(t)||(t={}),this.options=(0,ye.default)(e.base),this._actions.methodDict){var i=n,r=this._actions.methodDict[i];this.options[i]={},this.setPerAction(i,(0,k.default)((0,k.default)({},e.perAction),e.actions[i])),this[r](t[i])}for(var a in t)o.default.func(this[a])&&this[a](t[a]);return this}},{key:"unset",value:function(){if(o.default.string(this.target))for(var t in this._scopeEvents.delegatedEvents)for(var e=this._scopeEvents.delegatedEvents[t],n=e.length-1;n>=0;n--){var i=e[n],r=i.selector,a=i.context,s=i.listeners;r===this.target&&a===this._context&&e.splice(n,1);for(var l=s.length-1;l>=0;l--)this._scopeEvents.removeDelegate(this.target,this._context,t,s[l][0],s[l][1])}else this._scopeEvents.remove(this.target,"all")}}])&&xn(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),t}();Tn.Interactable=Sn;var In={};function kn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Pn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(In,"__esModule",{value:!0}),In.InteractableSet=void 0;var Nn=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Pn(this,"list",[]),Pn(this,"selectorMap",{}),Pn(this,"scope",void 0),this.scope=e,e.addListeners({"interactable:unset":function(t){var e=t.interactable,i=e.target,r=e._context,a=o.default.string(i)?n.selectorMap[i]:i[n.scope.id],s=H.findIndex(a,(function(t){return t.context===r}));a[s]&&(a[s].context=null,a[s].interactable=null),a.splice(s,1)}})}var e,n;return e=t,(n=[{key:"new",value:function(t,e){e=(0,k.default)(e||{},{actions:this.scope.actions});var n=new this.scope.Interactable(t,e,this.scope.document,this.scope.events),i={context:n._context,interactable:n};return this.scope.addDocument(n._doc),this.list.push(n),o.default.string(t)?(this.selectorMap[t]||(this.selectorMap[t]=[]),this.selectorMap[t].push(i)):(n.target[this.scope.id]||Object.defineProperty(t,this.scope.id,{value:[],configurable:!0}),t[this.scope.id].push(i)),this.scope.fire("interactable:new",{target:t,options:e,interactable:n,win:this.scope._win}),n}},{key:"get",value:function(t,e){var n=e&&e.context||this.scope.document,i=o.default.string(t),r=i?this.selectorMap[t]:t[this.scope.id];if(!r)return null;var a=H.find(r,(function(e){return e.context===n&&(i||e.interactable.inContext(t))}));return a&&a.interactable}},{key:"forEachMatch",value:function(t,e){for(var n=0;n<this.list.length;n++){var i=this.list[n],r=void 0;if((o.default.string(i.target)?o.default.element(t)&&_.matchesSelector(t,i.target):t===i.target)&&i.inContext(t)&&(r=e(i)),void 0!==r)return r}}}])&&kn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();In.InteractableSet=Nn;var Cn={};function jn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Mn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Rn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.default=void 0;var Ln=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Mn(this,"currentTarget",void 0),Mn(this,"originalEvent",void 0),Mn(this,"type",void 0),this.originalEvent=e,(0,L.default)(this,e)}var e,n;return e=t,(n=[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}])&&jn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Yn(t){if(!o.default.object(t))return{capture:!!t,passive:!1};var e=(0,k.default)({},t);return e.capture=!!t.capture,e.passive=!!t.passive,e}var Vn={id:"events",install:function(t){var e,n=[],i={},r=[],a={add:s,remove:l,addDelegate:function(t,e,n,o,a){var l=Yn(a);if(!i[n]){i[n]=[];for(var d=0;d<r.length;d++){var f=r[d];s(f,n,u),s(f,n,c,!0)}}var p=i[n],h=H.find(p,(function(n){return n.selector===t&&n.context===e}));h||(h={selector:t,context:e,listeners:[]},p.push(h)),h.listeners.push([o,l])},removeDelegate:function(t,e,n,r,o){var a,s=Yn(o),d=i[n],f=!1;if(d)for(a=d.length-1;a>=0;a--){var p=d[a];if(p.selector===t&&p.context===e){for(var h=p.listeners,g=h.length-1;g>=0;g--){var v=Dn(h[g],2),y=v[0],b=v[1],m=b.capture,E=b.passive;if(y===r&&m===s.capture&&E===s.passive){h.splice(g,1),h.length||(d.splice(a,1),l(e,n,u),l(e,n,c,!0)),f=!0;break}}if(f)break}}},delegateListener:u,delegateUseCapture:c,delegatedEvents:i,documents:r,targets:n,supportsOptions:!1,supportsPassive:!1};function s(t,e,i,r){var o=Yn(r),s=H.find(n,(function(e){return e.eventTarget===t}));s||(s={eventTarget:t,events:{}},n.push(s)),s.events[e]||(s.events[e]=[]),t.addEventListener&&!H.contains(s.events[e],i)&&(t.addEventListener(e,i,a.supportsOptions?o:o.capture),s.events[e].push(i))}function l(t,e,i,r){var o=Yn(r),s=H.findIndex(n,(function(e){return e.eventTarget===t})),u=n[s];if(u&&u.events)if("all"!==e){var c=!1,d=u.events[e];if(d){if("all"===i){for(var f=d.length-1;f>=0;f--)l(t,e,d[f],o);return}for(var p=0;p<d.length;p++)if(d[p]===i){t.removeEventListener(e,i,a.supportsOptions?o:o.capture),d.splice(p,1),0===d.length&&(delete u.events[e],c=!0);break}}c&&!Object.keys(u.events).length&&n.splice(s,1)}else for(e in u.events)u.events.hasOwnProperty(e)&&l(t,e,"all")}function u(t,e){for(var n=Yn(e),r=new Ln(t),a=i[t.type],s=Dn(Y.getEventTargets(t),1)[0],l=s;o.default.element(l);){for(var u=0;u<a.length;u++){var c=a[u],d=c.selector,f=c.context;if(_.matchesSelector(l,d)&&_.nodeContains(f,s)&&_.nodeContains(f,l)){var p=c.listeners;r.currentTarget=l;for(var h=0;h<p.length;h++){var g=Dn(p[h],2),v=g[0],y=g[1],b=y.capture,m=y.passive;b===n.capture&&m===n.passive&&v(r)}}}l=_.parentNode(l)}}function c(t){return u(t,!0)}return null==(e=t.document)||e.createElement("div").addEventListener("test",null,{get capture(){return a.supportsOptions=!0},get passive(){return a.supportsPassive=!0}}),t.events=a,a}};Cn.default=Vn;var Bn={};Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.default=void 0;var $n={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(t){for(var e=0;e<$n.methodOrder.length;e++){var n;n=$n.methodOrder[e];var i=$n[n](t);if(i)return i}return null},simulationResume:function(t){var e=t.pointerType,n=t.eventType,i=t.eventTarget,r=t.scope;if(!/down|start/i.test(n))return null;for(var o=0;o<r.interactions.list.length;o++){var a=r.interactions.list[o],s=i;if(a.simulation&&a.simulation.allowResume&&a.pointerType===e)for(;s;){if(s===a.element)return a;s=_.parentNode(s)}}return null},mouseOrPen:function(t){var e,n=t.pointerId,i=t.pointerType,r=t.eventType,o=t.scope;if("mouse"!==i&&"pen"!==i)return null;for(var a=0;a<o.interactions.list.length;a++){var s=o.interactions.list[a];if(s.pointerType===i){if(s.simulation&&!Fn(s,n))continue;if(s.interacting())return s;e||(e=s)}}if(e)return e;for(var l=0;l<o.interactions.list.length;l++){var u=o.interactions.list[l];if(!(u.pointerType!==i||/down/i.test(r)&&u.simulation))return u}return null},hasPointer:function(t){for(var e=t.pointerId,n=t.scope,i=0;i<n.interactions.list.length;i++){var r=n.interactions.list[i];if(Fn(r,e))return r}return null},idle:function(t){for(var e=t.pointerType,n=t.scope,i=0;i<n.interactions.list.length;i++){var r=n.interactions.list[i];if(1===r.pointers.length){var o=r.interactable;if(o&&(!o.options.gesture||!o.options.gesture.enabled))continue}else if(r.pointers.length>=2)continue;if(!r.interacting()&&e===r.pointerType)return r}return null}};function Fn(t,e){return t.pointers.some((function(t){return t.id===e}))}var Gn=$n;Bn.default=Gn;var qn={};function Un(t){return Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Un(t)}function zn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Jn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Wn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xn(t,e){return Xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xn(t,e)}function Zn(t,e){if(e&&("object"===Un(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Kn(t){return Kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Kn(t)}Object.defineProperty(qn,"__esModule",{value:!0}),qn.default=void 0;var Qn=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function ti(t,e){return function(n){var i=e.interactions.list,r=Y.getPointerType(n),o=zn(Y.getEventTargets(n),2),a=o[0],s=o[1],l=[];if(/^touch/.test(n.type)){e.prevTouchTime=e.now();for(var u=0;u<n.changedTouches.length;u++){var c=n.changedTouches[u],d={pointer:c,pointerId:Y.getPointerId(c),pointerType:r,eventType:n.type,eventTarget:a,curEventTarget:s,scope:e},f=ei(d);l.push([d.pointer,d.eventTarget,d.curEventTarget,f])}}else{var p=!1;if(!m.default.supportsPointerEvent&&/mouse/.test(n.type)){for(var h=0;h<i.length&&!p;h++)p="mouse"!==i[h].pointerType&&i[h].pointerIsDown;p=p||e.now()-e.prevTouchTime<500||0===n.timeStamp}if(!p){var g={pointer:n,pointerId:Y.getPointerId(n),pointerType:r,eventType:n.type,curEventTarget:s,eventTarget:a,scope:e},v=ei(g);l.push([g.pointer,g.eventTarget,g.curEventTarget,v])}}for(var y=0;y<l.length;y++){var b=zn(l[y],4),E=b[0],w=b[1],_=b[2];b[3][t](E,n,w,_)}}}function ei(t){var e=t.pointerType,n=t.scope,i={interaction:Bn.default.search(t),searchDetails:t};return n.fire("interactions:find",i),i.interaction||n.interactions.new({pointerType:e})}function ni(t,e){var n=t.doc,i=t.scope,r=t.options,o=i.interactions.docEvents,a=i.events,s=a[e];for(var l in i.browser.isIOS&&!r.events&&(r.events={passive:!1}),a.delegatedEvents)s(n,l,a.delegateListener),s(n,l,a.delegateUseCapture,!0);for(var u=r&&r.events,c=0;c<o.length;c++){var d=o[c];s(n,d.type,d.listener,u)}}var ii={id:"core/interactions",install:function(t){for(var e={},n=0;n<Qn.length;n++){var i=Qn[n];e[i]=ti(i,t)}var r,o=m.default.pEventTypes;function a(){for(var e=0;e<t.interactions.list.length;e++){var n=t.interactions.list[e];if(n.pointerIsDown&&"touch"===n.pointerType&&!n._interacting)for(var i=function(){var e=n.pointers[r];t.documents.some((function(t){var n=t.doc;return(0,_.nodeContains)(n,e.downTarget)}))||n.removePointer(e.pointer,e.event)},r=0;r<n.pointers.length;r++)i()}}(r=g.default.PointerEvent?[{type:o.down,listener:a},{type:o.down,listener:e.pointerDown},{type:o.move,listener:e.pointerMove},{type:o.up,listener:e.pointerUp},{type:o.cancel,listener:e.pointerUp}]:[{type:"mousedown",listener:e.pointerDown},{type:"mousemove",listener:e.pointerMove},{type:"mouseup",listener:e.pointerUp},{type:"touchstart",listener:a},{type:"touchstart",listener:e.pointerDown},{type:"touchmove",listener:e.pointerMove},{type:"touchend",listener:e.pointerUp},{type:"touchcancel",listener:e.pointerUp}]).push({type:"blur",listener:function(e){for(var n=0;n<t.interactions.list.length;n++)t.interactions.list[n].documentBlur(e)}}),t.prevTouchTime=0,t.Interaction=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xn(t,e)}(s,e);var n,i,r,o,a=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Kn(r);if(o){var n=Kn(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Zn(this,t)});function s(){return Wn(this,s),a.apply(this,arguments)}return n=s,(i=[{key:"pointerMoveTolerance",get:function(){return t.interactions.pointerMoveTolerance},set:function(e){t.interactions.pointerMoveTolerance=e}},{key:"_now",value:function(){return t.now()}}])&&Hn(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),s}(Je.default),t.interactions={list:[],new:function(e){e.scopeFire=function(e,n){return t.fire(e,n)};var n=new t.Interaction(e);return t.interactions.list.push(n),n},listeners:e,docEvents:r,pointerMoveTolerance:1},t.usePlugin(le.default)},listeners:{"scope:add-document":function(t){return ni(t,"add")},"scope:remove-document":function(t){return ni(t,"remove")},"interactable:unset":function(t,e){for(var n=t.interactable,i=e.interactions.list.length-1;i>=0;i--){var r=e.interactions.list[i];r.interactable===n&&(r.stop(),e.fire("interactions:destroy",{interaction:r}),r.destroy(),e.interactions.list.length>2&&e.interactions.list.splice(i,1))}}},onDocSignal:ni,doOnInteractions:ti,methodNames:Qn},ri=ii;qn.default=ri;var oi={};function ai(t){return ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ai(t)}function si(){return si="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=li(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},si.apply(this,arguments)}function li(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=di(t)););return t}function ui(t,e){return ui=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ui(t,e)}function ci(t,e){if(e&&("object"===ai(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function di(t){return di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},di(t)}function fi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function hi(t,e,n){return e&&pi(t.prototype,e),n&&pi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(oi,"__esModule",{value:!0}),oi.Scope=void 0,oi.initScope=yi;var vi=function(){function t(){var e=this;fi(this,t),gi(this,"id","__interact_scope_".concat(Math.floor(100*Math.random()))),gi(this,"isInitialized",!1),gi(this,"listenerMaps",[]),gi(this,"browser",m.default),gi(this,"defaults",(0,ye.default)(Pe.defaults)),gi(this,"Eventable",yn.Eventable),gi(this,"actions",{map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}}),gi(this,"interactStatic",(0,On.createInteractStatic)(this)),gi(this,"InteractEvent",Ne.InteractEvent),gi(this,"Interactable",void 0),gi(this,"interactables",new In.InteractableSet(this)),gi(this,"_win",void 0),gi(this,"document",void 0),gi(this,"window",void 0),gi(this,"documents",[]),gi(this,"_plugins",{list:[],map:{}}),gi(this,"onWindowUnload",(function(t){return e.removeDocument(t.target)}));var n=this;this.Interactable=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ui(t,e)}(o,t);var e,i,r=(e=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=di(e);if(i){var r=di(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return ci(this,t)});function o(){return fi(this,o),r.apply(this,arguments)}return hi(o,[{key:"_defaults",get:function(){return n.defaults}},{key:"set",value:function(t){return si(di(o.prototype),"set",this).call(this,t),n.fire("interactable:set",{options:t,interactable:this}),this}},{key:"unset",value:function(){si(di(o.prototype),"unset",this).call(this);var t=n.interactables.list.indexOf(this);t<0||(si(di(o.prototype),"unset",this).call(this),n.interactables.list.splice(t,1),n.fire("interactable:unset",{interactable:this}))}}]),o}(Tn.Interactable)}return hi(t,[{key:"addListeners",value:function(t,e){this.listenerMaps.push({id:e,map:t})}},{key:"fire",value:function(t,e){for(var n=0;n<this.listenerMaps.length;n++){var i=this.listenerMaps[n].map[t];if(i&&!1===i(e,this,t))return!1}}},{key:"init",value:function(t){return this.isInitialized?this:yi(this,t)}},{key:"pluginIsInstalled",value:function(t){return this._plugins.map[t.id]||-1!==this._plugins.list.indexOf(t)}},{key:"usePlugin",value:function(t,e){if(!this.isInitialized)return this;if(this.pluginIsInstalled(t))return this;if(t.id&&(this._plugins.map[t.id]=t),this._plugins.list.push(t),t.install&&t.install(this,e),t.listeners&&t.before){for(var n=0,i=this.listenerMaps.length,r=t.before.reduce((function(t,e){return t[e]=!0,t[bi(e)]=!0,t}),{});n<i;n++){var o=this.listenerMaps[n].id;if(r[o]||r[bi(o)])break}this.listenerMaps.splice(n,0,{id:t.id,map:t.listeners})}else t.listeners&&this.listenerMaps.push({id:t.id,map:t.listeners});return this}},{key:"addDocument",value:function(t,n){if(-1!==this.getDocIndex(t))return!1;var i=e.getWindow(t);n=n?(0,k.default)({},n):{},this.documents.push({doc:t,options:n}),this.events.documents.push(t),t!==this.document&&this.events.add(i,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:t,window:i,scope:this,options:n})}},{key:"removeDocument",value:function(t){var n=this.getDocIndex(t),i=e.getWindow(t),r=this.documents[n].options;this.events.remove(i,"unload",this.onWindowUnload),this.documents.splice(n,1),this.events.documents.splice(n,1),this.fire("scope:remove-document",{doc:t,window:i,scope:this,options:r})}},{key:"getDocIndex",value:function(t){for(var e=0;e<this.documents.length;e++)if(this.documents[e].doc===t)return e;return-1}},{key:"getDocOptions",value:function(t){var e=this.getDocIndex(t);return-1===e?null:this.documents[e].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),t}();function yi(t,n){return t.isInitialized=!0,o.default.window(n)&&e.init(n),g.default.init(n),m.default.init(n),St.default.init(n),t.window=n,t.document=n.document,t.usePlugin(qn.default),t.usePlugin(Cn.default),t}function bi(t){return t&&t.replace(/\/.*$/,"")}oi.Scope=vi;var mi={};Object.defineProperty(mi,"__esModule",{value:!0}),mi.default=void 0;var Ei=new oi.Scope,wi=Ei.interactStatic;mi.default=wi;var _i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0;Ei.init(_i);var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.default=void 0,Oi.default=function(){};var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.default=void 0,Ti.default=function(){};var xi={};function Ai(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Si(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Si(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Si(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(xi,"__esModule",{value:!0}),xi.default=void 0,xi.default=function(t){var e=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter((function(e){var n=Ai(e,2),i=n[0],r=n[1];return i in t||r in t})),n=function(n,i){for(var r=t.range,o=t.limits,a=void 0===o?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:o,s=t.offset,l=void 0===s?{x:0,y:0}:s,u={range:r,grid:t,x:null,y:null},c=0;c<e.length;c++){var d=Ai(e[c],2),f=d[0],p=d[1],h=Math.round((n-l.x)/t[f]),g=Math.round((i-l.y)/t[p]);u[f]=Math.max(a.left,Math.min(a.right,h*t[f]+l.x)),u[p]=Math.max(a.top,Math.min(a.bottom,g*t[p]+l.y))}return u};return n.grid=t,n.coordFields=e,n};var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0}),Object.defineProperty(Ii,"edgeTarget",{enumerable:!0,get:function(){return Oi.default}}),Object.defineProperty(Ii,"elements",{enumerable:!0,get:function(){return Ti.default}}),Object.defineProperty(Ii,"grid",{enumerable:!0,get:function(){return xi.default}});var ki={};Object.defineProperty(ki,"__esModule",{value:!0}),ki.default=void 0;var Pi={id:"snappers",install:function(t){var e=t.interactStatic;e.snappers=(0,k.default)(e.snappers||{},Ii),e.createSnapGrid=e.snappers.grid}},Ni=Pi;ki.default=Ni;var Ci={};function ji(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Mi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ji(Object(n),!0).forEach((function(e){Di(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ji(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Di(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.default=Ci.aspectRatio=void 0;var Ri={start:function(t){var e=t.state,n=t.rect,i=t.edges,r=t.pageCoords,o=e.options.ratio,a=e.options,s=a.equalDelta,l=a.modifiers;"preserve"===o&&(o=n.width/n.height),e.startCoords=(0,k.default)({},r),e.startRect=(0,k.default)({},n),e.ratio=o,e.equalDelta=s;var u=e.linkedEdges={top:i.top||i.left&&!i.bottom,left:i.left||i.top&&!i.right,bottom:i.bottom||i.right&&!i.top,right:i.right||i.bottom&&!i.left};if(e.xIsPrimaryAxis=!(!i.left&&!i.right),e.equalDelta){var c=(u.left?1:-1)*(u.top?1:-1);e.edgeSign={x:c,y:c}}else e.edgeSign={x:u.left?-1:1,y:u.top?-1:1};if((0,k.default)(t.edges,u),l&&l.length){var d=new be.default(t.interaction);d.copyFrom(t.interaction.modification),d.prepareStates(l),e.subModification=d,d.startAll(Mi({},t))}},set:function(t){var e=t.state,n=t.rect,i=t.coords,r=(0,k.default)({},i),o=e.equalDelta?Li:Yi;if(o(e,e.xIsPrimaryAxis,i,n),!e.subModification)return null;var a=(0,k.default)({},n);(0,P.addEdges)(e.linkedEdges,a,{x:i.x-r.x,y:i.y-r.y});var s=e.subModification.setAll(Mi(Mi({},t),{},{rect:a,edges:e.linkedEdges,pageCoords:i,prevCoords:i,prevRect:a})),l=s.delta;return s.changed&&(o(e,Math.abs(l.x)>Math.abs(l.y),s.coords,s.rect),(0,k.default)(i,s.coords)),s.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function Li(t,e,n){var i=t.startCoords,r=t.edgeSign;e?n.y=i.y+(n.x-i.x)*r.y:n.x=i.x+(n.y-i.y)*r.x}function Yi(t,e,n,i){var r=t.startRect,o=t.startCoords,a=t.ratio,s=t.edgeSign;if(e){var l=i.width/a;n.y=o.y+(l-r.height)*s.y}else{var u=i.height*a;n.x=o.x+(u-r.width)*s.x}}Ci.aspectRatio=Ri;var Vi=(0,Ae.makeModifier)(Ri,"aspectRatio");Ci.default=Vi;var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.default=void 0;var $i=function(){};$i._defaults={};var Fi=$i;Bi.default=Fi;var Gi={};Object.defineProperty(Gi,"__esModule",{value:!0}),Object.defineProperty(Gi,"default",{enumerable:!0,get:function(){return Bi.default}});var qi={};function Ui(t,e,n){return o.default.func(t)?P.resolveRectLike(t,e.interactable,e.element,[n.x,n.y,e]):P.resolveRectLike(t,e.interactable,e.element)}Object.defineProperty(qi,"__esModule",{value:!0}),qi.default=void 0,qi.getRestrictionRect=Ui,qi.restrict=void 0;var zi={start:function(t){var e=t.rect,n=t.startOffset,i=t.state,r=t.interaction,o=t.pageCoords,a=i.options,s=a.elementRect,l=(0,k.default)({left:0,top:0,right:0,bottom:0},a.offset||{});if(e&&s){var u=Ui(a.restriction,r,o);if(u){var c=u.right-u.left-e.width,d=u.bottom-u.top-e.height;c<0&&(l.left+=c,l.right+=c),d<0&&(l.top+=d,l.bottom+=d)}l.left+=n.left-e.width*s.left,l.top+=n.top-e.height*s.top,l.right+=n.right-e.width*(1-s.right),l.bottom+=n.bottom-e.height*(1-s.bottom)}i.offset=l},set:function(t){var e=t.coords,n=t.interaction,i=t.state,r=i.options,o=i.offset,a=Ui(r.restriction,n,e);if(a){var s=P.xywhToTlbr(a);e.x=Math.max(Math.min(s.right-o.right,e.x),s.left+o.left),e.y=Math.max(Math.min(s.bottom-o.bottom,e.y),s.top+o.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}};qi.restrict=zi;var Ji=(0,Ae.makeModifier)(zi,"restrict");qi.default=Ji;var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0}),Wi.restrictEdges=Wi.default=void 0;var Hi={top:1/0,left:1/0,bottom:-1/0,right:-1/0},Xi={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function Zi(t,e){for(var n=["top","left","bottom","right"],i=0;i<n.length;i++){var r=n[i];r in t||(t[r]=e[r])}return t}var Ki={noInner:Hi,noOuter:Xi,start:function(t){var e,n=t.interaction,i=t.startOffset,r=t.state,o=r.options;if(o){var a=(0,qi.getRestrictionRect)(o.offset,n,n.coords.start.page);e=P.rectToXY(a)}e=e||{x:0,y:0},r.offset={top:e.y+i.top,left:e.x+i.left,bottom:e.y-i.bottom,right:e.x-i.right}},set:function(t){var e=t.coords,n=t.edges,i=t.interaction,r=t.state,o=r.offset,a=r.options;if(n){var s=(0,k.default)({},e),l=(0,qi.getRestrictionRect)(a.inner,i,s)||{},u=(0,qi.getRestrictionRect)(a.outer,i,s)||{};Zi(l,Hi),Zi(u,Xi),n.top?e.y=Math.min(Math.max(u.top+o.top,s.y),l.top+o.top):n.bottom&&(e.y=Math.max(Math.min(u.bottom+o.bottom,s.y),l.bottom+o.bottom)),n.left?e.x=Math.min(Math.max(u.left+o.left,s.x),l.left+o.left):n.right&&(e.x=Math.max(Math.min(u.right+o.right,s.x),l.right+o.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}};Wi.restrictEdges=Ki;var Qi=(0,Ae.makeModifier)(Ki,"restrictEdges");Wi.default=Qi;var tr={};Object.defineProperty(tr,"__esModule",{value:!0}),tr.restrictRect=tr.default=void 0;var er=(0,k.default)({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(t){}},qi.restrict.defaults),nr={start:qi.restrict.start,set:qi.restrict.set,defaults:er};tr.restrictRect=nr;var ir=(0,Ae.makeModifier)(nr,"restrictRect");tr.default=ir;var rr={};Object.defineProperty(rr,"__esModule",{value:!0}),rr.restrictSize=rr.default=void 0;var or={width:-1/0,height:-1/0},ar={width:1/0,height:1/0},sr={start:function(t){return Wi.restrictEdges.start(t)},set:function(t){var e=t.interaction,n=t.state,i=t.rect,r=t.edges,o=n.options;if(r){var a=P.tlbrToXywh((0,qi.getRestrictionRect)(o.min,e,t.coords))||or,s=P.tlbrToXywh((0,qi.getRestrictionRect)(o.max,e,t.coords))||ar;n.options={endOnly:o.endOnly,inner:(0,k.default)({},Wi.restrictEdges.noInner),outer:(0,k.default)({},Wi.restrictEdges.noOuter)},r.top?(n.options.inner.top=i.bottom-a.height,n.options.outer.top=i.bottom-s.height):r.bottom&&(n.options.inner.bottom=i.top+a.height,n.options.outer.bottom=i.top+s.height),r.left?(n.options.inner.left=i.right-a.width,n.options.outer.left=i.right-s.width):r.right&&(n.options.inner.right=i.left+a.width,n.options.outer.right=i.left+s.width),Wi.restrictEdges.set(t),n.options=o}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}};rr.restrictSize=sr;var lr=(0,Ae.makeModifier)(sr,"restrictSize");rr.default=lr;var ur={};Object.defineProperty(ur,"__esModule",{value:!0}),Object.defineProperty(ur,"default",{enumerable:!0,get:function(){return Bi.default}});var cr={};Object.defineProperty(cr,"__esModule",{value:!0}),cr.snap=cr.default=void 0;var dr={start:function(t){var e,n=t.interaction,i=t.interactable,r=t.element,o=t.rect,a=t.state,s=t.startOffset,l=a.options,u=l.offsetWithOrigin?function(t){var e=t.interaction.element;return(0,P.rectToXY)((0,P.resolveRectLike)(t.state.options.origin,null,null,[e]))||(0,j.default)(t.interactable,e,t.interaction.prepared.name)}(t):{x:0,y:0};if("startCoords"===l.offset)e={x:n.coords.start.page.x,y:n.coords.start.page.y};else{var c=(0,P.resolveRectLike)(l.offset,i,r,[n]);(e=(0,P.rectToXY)(c)||{x:0,y:0}).x+=u.x,e.y+=u.y}var d=l.relativePoints;a.offsets=o&&d&&d.length?d.map((function(t,n){return{index:n,relativePoint:t,x:s.left-o.width*t.x+e.x,y:s.top-o.height*t.y+e.y}})):[{index:0,relativePoint:null,x:e.x,y:e.y}]},set:function(t){var e=t.interaction,n=t.coords,i=t.state,r=i.options,a=i.offsets,s=(0,j.default)(e.interactable,e.element,e.prepared.name),l=(0,k.default)({},n),u=[];r.offsetWithOrigin||(l.x-=s.x,l.y-=s.y);for(var c=0;c<a.length;c++)for(var d=a[c],f=l.x-d.x,p=l.y-d.y,h=0,g=r.targets.length;h<g;h++){var v,y=r.targets[h];(v=o.default.func(y)?y(f,p,e._proxy,d,h):y)&&u.push({x:(o.default.number(v.x)?v.x:f)+d.x,y:(o.default.number(v.y)?v.y:p)+d.y,range:o.default.number(v.range)?v.range:r.range,source:y,index:h,offset:d})}for(var b={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},m=0;m<u.length;m++){var E=u[m],w=E.range,_=E.x-l.x,O=E.y-l.y,T=(0,R.default)(_,O),x=T<=w;w===1/0&&b.inRange&&b.range!==1/0&&(x=!1),b.target&&!(x?b.inRange&&w!==1/0?T/w<b.distance/b.range:w===1/0&&b.range!==1/0||T<b.distance:!b.inRange&&T<b.distance)||(b.target=E,b.distance=T,b.range=w,b.inRange=x,b.delta.x=_,b.delta.y=O)}return b.inRange&&(n.x=b.target.x,n.y=b.target.y),i.closest=b,b},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}};cr.snap=dr;var fr=(0,Ae.makeModifier)(dr,"snap");cr.default=fr;var pr={};function hr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(pr,"__esModule",{value:!0}),pr.snapSize=pr.default=void 0;var gr={start:function(t){var e=t.state,n=t.edges,i=e.options;if(!n)return null;t.state={options:{targets:null,relativePoints:[{x:n.left?0:1,y:n.top?0:1}],offset:i.offset||"self",origin:{x:0,y:0},range:i.range}},e.targetFields=e.targetFields||[["width","height"],["x","y"]],cr.snap.start(t),e.offsets=t.state.offsets,t.state=e},set:function(t){var e,n,i=t.interaction,r=t.state,a=t.coords,s=r.options,l=r.offsets,u={x:a.x-l[0].x,y:a.y-l[0].y};r.options=(0,k.default)({},s),r.options.targets=[];for(var c=0;c<(s.targets||[]).length;c++){var d=(s.targets||[])[c],f=void 0;if(f=o.default.func(d)?d(u.x,u.y,i):d){for(var p=0;p<r.targetFields.length;p++){var h=(n=2,function(t){if(Array.isArray(t))return t}(e=r.targetFields[p])||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,n)||function(t,e){if(t){if("string"==typeof t)return hr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hr(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=h[0],v=h[1];if(g in f||v in f){f.x=f[g],f.y=f[v];break}}r.options.targets.push(f)}}var y=cr.snap.set(t);return r.options=s,y},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}};pr.snapSize=gr;var vr=(0,Ae.makeModifier)(gr,"snapSize");pr.default=vr;var yr={};Object.defineProperty(yr,"__esModule",{value:!0}),yr.snapEdges=yr.default=void 0;var br={start:function(t){var e=t.edges;return e?(t.state.targetFields=t.state.targetFields||[[e.left?"left":"right",e.top?"top":"bottom"]],pr.snapSize.start(t)):null},set:pr.snapSize.set,defaults:(0,k.default)((0,ye.default)(pr.snapSize.defaults),{targets:null,range:null,offset:{x:0,y:0}})};yr.snapEdges=br;var mr=(0,Ae.makeModifier)(br,"snapEdges");yr.default=mr;var Er={};Object.defineProperty(Er,"__esModule",{value:!0}),Object.defineProperty(Er,"default",{enumerable:!0,get:function(){return Bi.default}});var wr={};Object.defineProperty(wr,"__esModule",{value:!0}),Object.defineProperty(wr,"default",{enumerable:!0,get:function(){return Bi.default}});var _r={};Object.defineProperty(_r,"__esModule",{value:!0}),_r.default=void 0;var Or={aspectRatio:Ci.default,restrictEdges:Wi.default,restrict:qi.default,restrictRect:tr.default,restrictSize:rr.default,snapEdges:yr.default,snap:cr.default,snapSize:pr.default,spring:Er.default,avoid:Gi.default,transform:wr.default,rubberband:ur.default};_r.default=Or;var Tr={};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.default=void 0;var xr={id:"modifiers",install:function(t){var e=t.interactStatic;for(var n in t.usePlugin(Ae.default),t.usePlugin(ki.default),e.modifiers=_r.default,_r.default){var i=_r.default[n],r=i._defaults,o=i._methods;r._methods=o,t.defaults.perAction[n]=r}}},Ar=xr;Tr.default=Ar;var Sr={};function Ir(t){return Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ir(t)}function kr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Pr(t,e){return Pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pr(t,e)}function Nr(t,e){if(e&&("object"===Ir(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Cr(t)}function Cr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jr(t){return jr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jr(t)}Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.default=Sr.PointerEvent=void 0;var Mr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pr(t,e)}(a,t);var e,n,i,r,o=(i=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=jr(i);if(r){var n=jr(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Nr(this,t)});function a(t,e,n,i,r,s){var l;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),l=o.call(this,r),Y.pointerExtend(Cr(l),n),n!==e&&Y.pointerExtend(Cr(l),e),l.timeStamp=s,l.originalEvent=n,l.type=t,l.pointerId=Y.getPointerId(e),l.pointerType=Y.getPointerType(e),l.target=i,l.currentTarget=null,"tap"===t){var u=r.getPointerIndex(e);l.dt=l.timeStamp-r.pointers[u].downTime;var c=l.timeStamp-r.tapTime;l.double=!!r.prevTap&&"doubletap"!==r.prevTap.type&&r.prevTap.target===l.target&&c<500}else"doubletap"===t&&(l.dt=e.timeStamp-r.tapTime,l.double=!0);return l}return e=a,(n=[{key:"_subtractOrigin",value:function(t){var e=t.x,n=t.y;return this.pageX-=e,this.pageY-=n,this.clientX-=e,this.clientY-=n,this}},{key:"_addOrigin",value:function(t){var e=t.x,n=t.y;return this.pageX+=e,this.pageY+=n,this.clientX+=e,this.clientY+=n,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}])&&kr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(U.BaseEvent);Sr.PointerEvent=Sr.default=Mr;var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.default=void 0;var Rr={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(t){t.pointerEvents=Rr,t.defaults.actions.pointerEvents=Rr.defaults,(0,k.default)(t.actions.phaselessTypes,Rr.types)},listeners:{"interactions:new":function(t){var e=t.interaction;e.prevTap=null,e.tapTime=0},"interactions:update-pointer":function(t){var e=t.down,n=t.pointerInfo;!e&&n.hold||(n.hold={duration:1/0,timeout:null})},"interactions:move":function(t,e){var n=t.interaction,i=t.pointer,r=t.event,o=t.eventTarget;t.duplicate||n.pointerIsDown&&!n.pointerWasMoved||(n.pointerIsDown&&Vr(t),Lr({interaction:n,pointer:i,event:r,eventTarget:o,type:"move"},e))},"interactions:down":function(t,e){!function(t,e){for(var n=t.interaction,i=t.pointer,r=t.event,o=t.eventTarget,a=t.pointerIndex,s=n.pointers[a].hold,l=_.getPath(o),u={interaction:n,pointer:i,event:r,eventTarget:o,type:"hold",targets:[],path:l,node:null},c=0;c<l.length;c++){var d=l[c];u.node=d,e.fire("pointerEvents:collect-targets",u)}if(u.targets.length){for(var f=1/0,p=0;p<u.targets.length;p++){var h=u.targets[p].eventable.options.holdDuration;h<f&&(f=h)}s.duration=f,s.timeout=setTimeout((function(){Lr({interaction:n,eventTarget:o,pointer:i,event:r,type:"hold"},e)}),f)}}(t,e),Lr(t,e)},"interactions:up":function(t,e){Vr(t),Lr(t,e),function(t,e){var n=t.interaction,i=t.pointer,r=t.event,o=t.eventTarget;n.pointerWasMoved||Lr({interaction:n,eventTarget:o,pointer:i,event:r,type:"tap"},e)}(t,e)},"interactions:cancel":function(t,e){Vr(t),Lr(t,e)}},PointerEvent:Sr.PointerEvent,fire:Lr,collectEventTargets:Yr,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function Lr(t,e){var n=t.interaction,i=t.pointer,r=t.event,o=t.eventTarget,a=t.type,s=t.targets,l=void 0===s?Yr(t,e):s,u=new Sr.PointerEvent(a,i,r,o,n,e.now());e.fire("pointerEvents:new",{pointerEvent:u});for(var c={interaction:n,pointer:i,event:r,eventTarget:o,targets:l,type:a,pointerEvent:u},d=0;d<l.length;d++){var f=l[d];for(var p in f.props||{})u[p]=f.props[p];var h=(0,j.default)(f.eventable,f.node);if(u._subtractOrigin(h),u.eventable=f.eventable,u.currentTarget=f.node,f.eventable.fire(u),u._addOrigin(h),u.immediatePropagationStopped||u.propagationStopped&&d+1<l.length&&l[d+1].node!==u.currentTarget)break}if(e.fire("pointerEvents:fired",c),"tap"===a){var g=u.double?Lr({interaction:n,pointer:i,event:r,eventTarget:o,type:"doubletap"},e):u;n.prevTap=g,n.tapTime=g.timeStamp}return u}function Yr(t,e){var n=t.interaction,i=t.pointer,r=t.event,o=t.eventTarget,a=t.type,s=n.getPointerIndex(i),l=n.pointers[s];if("tap"===a&&(n.pointerWasMoved||!l||l.downTarget!==o))return[];for(var u=_.getPath(o),c={interaction:n,pointer:i,event:r,eventTarget:o,type:a,path:u,targets:[],node:null},d=0;d<u.length;d++){var f=u[d];c.node=f,e.fire("pointerEvents:collect-targets",c)}return"hold"===a&&(c.targets=c.targets.filter((function(t){var e;return t.eventable.options.holdDuration===(null==(e=n.pointers[s])?void 0:e.hold.duration)}))),c.targets}function Vr(t){var e=t.interaction,n=t.pointerIndex,i=e.pointers[n].hold;i&&i.timeout&&(clearTimeout(i.timeout),i.timeout=null)}var Br=Rr;Dr.default=Br;var $r={};function Fr(t){var e=t.interaction;e.holdIntervalHandle&&(clearInterval(e.holdIntervalHandle),e.holdIntervalHandle=null)}Object.defineProperty($r,"__esModule",{value:!0}),$r.default=void 0;var Gr={id:"pointer-events/holdRepeat",install:function(t){t.usePlugin(Dr.default);var e=t.pointerEvents;e.defaults.holdRepeatInterval=0,e.types.holdrepeat=t.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce((function(t,e){return t["pointerEvents:".concat(e)]=Fr,t}),{"pointerEvents:new":function(t){var e=t.pointerEvent;"hold"===e.type&&(e.count=(e.count||0)+1)},"pointerEvents:fired":function(t,e){var n=t.interaction,i=t.pointerEvent,r=t.eventTarget,o=t.targets;if("hold"===i.type&&o.length){var a=o[0].eventable.options.holdRepeatInterval;a<=0||(n.holdIntervalHandle=setTimeout((function(){e.pointerEvents.fire({interaction:n,eventTarget:r,type:"hold",pointer:i,event:i},e)}),a))}}})},qr=Gr;$r.default=qr;var Ur={};function zr(t){return(0,k.default)(this.events.options,t),this}Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.default=void 0;var Jr={id:"pointer-events/interactableTargets",install:function(t){var e=t.Interactable;e.prototype.pointerEvents=zr;var n=e.prototype._backCompatOption;e.prototype._backCompatOption=function(t,e){var i=n.call(this,t,e);return i===this&&(this.events.options[t]=e),i}},listeners:{"pointerEvents:collect-targets":function(t,e){var n=t.targets,i=t.node,r=t.type,o=t.eventTarget;e.interactables.forEachMatch(i,(function(t){var e=t.events,a=e.options;e.types[r]&&e.types[r].length&&t.testIgnoreAllow(a,i,o)&&n.push({node:i,eventable:e,props:{interactable:t}})}))},"interactable:new":function(t){var e=t.interactable;e.events.getRect=function(t){return e.getRect(t)}},"interactable:set":function(t,e){var n=t.interactable,i=t.options;(0,k.default)(n.events.options,e.pointerEvents.defaults),(0,k.default)(n.events.options,i.pointerEvents||{})}}},Wr=Jr;Ur.default=Wr;var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.default=void 0;var Xr={id:"pointer-events",install:function(t){t.usePlugin(Dr),t.usePlugin($r.default),t.usePlugin(Ur.default)}},Zr=Xr;Hr.default=Zr;var Kr={};function Qr(t){var e=t.Interactable;t.actions.phases.reflow=!0,e.prototype.reflow=function(e){return function(t,e,n){for(var i=o.default.string(t.target)?H.from(t._context.querySelectorAll(t.target)):[t.target],r=n.window.Promise,a=r?[]:null,s=function(){var o=i[l],s=t.getRect(o);if(!s)return"break";var u=H.find(n.interactions.list,(function(n){return n.interacting()&&n.interactable===t&&n.element===o&&n.prepared.name===e.name})),c=void 0;if(u)u.move(),a&&(c=u._reflowPromise||new r((function(t){u._reflowResolve=t})));else{var d=(0,P.tlbrToXywh)(s),f={page:{x:d.x,y:d.y},client:{x:d.x,y:d.y},timeStamp:n.now()},p=Y.coordsToEvent(f);c=function(t,e,n,i,r){var o=t.interactions.new({pointerType:"reflow"}),a={interaction:o,event:r,pointer:r,eventTarget:n,phase:"reflow"};o.interactable=e,o.element=n,o.prevEvent=r,o.updatePointer(r,r,n,!0),Y.setZeroCoords(o.coords.delta),(0,Yt.copyAction)(o.prepared,i),o._doPhase(a);var s=t.window.Promise,l=s?new s((function(t){o._reflowResolve=t})):void 0;return o._reflowPromise=l,o.start(i,e,n),o._interacting?(o.move(a),o.end(r)):(o.stop(),o._reflowResolve()),o.removePointer(r,r),l}(n,t,o,e,p)}a&&a.push(c)},l=0;l<i.length&&"break"!==s();l++);return a&&r.all(a).then((function(){return t}))}(this,e,t)}}Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.default=void 0,Kr.install=Qr;var to={id:"reflow",install:Qr,listeners:{"interactions:stop":function(t,e){var n=t.interaction;"reflow"===n.pointerType&&(n._reflowResolve&&n._reflowResolve(),H.remove(e.interactions.list,n))}}},eo=to;Kr.default=eo;var no={exports:{}};function io(t){return io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},io(t)}Object.defineProperty(no.exports,"__esModule",{value:!0}),no.exports.default=void 0,mi.default.use(le.default),mi.default.use(Qe.default),mi.default.use(Hr.default),mi.default.use(ln.default),mi.default.use(Tr.default),mi.default.use(ae.default),mi.default.use(xt.default),mi.default.use(Ct.default),mi.default.use(Kr.default);var ro=mi.default;if(no.exports.default=ro,"object"===io(no)&&no)try{no.exports=mi.default}catch(t){}mi.default.default=mi.default,xt.default,Ct.default,ae.default,le.default,ge.default,ln.default,mi.default,Tr.default,Qe.default,Hr.default,Kr.default,no=no.exports;var oo={exports:{}};function ao(t){return ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ao(t)}Object.defineProperty(oo.exports,"__esModule",{value:!0}),oo.exports.default=void 0;var so=no.default;if(oo.exports.default=so,"object"===ao(oo)&&oo)try{oo.exports=no.default}catch(t){}return no.default.default=no.default,oo.exports}();var ks=Ss(Is),Ps="object"==typeof global&&global&&global.Object===Object&&global,Ns="object"==typeof self&&self&&self.Object===Object&&self,Cs=Ps||Ns||Function("return this")(),js=Cs.Symbol,Ms=Object.prototype,Ds=Ms.hasOwnProperty,Rs=Ms.toString,Ls=js?js.toStringTag:void 0;var Ys=Object.prototype.toString;var Vs="[object Null]",Bs="[object Undefined]",$s=js?js.toStringTag:void 0;function Fs(t){return null==t?void 0===t?Bs:Vs:$s&&$s in Object(t)?function(t){var e=Ds.call(t,Ls),n=t[Ls];try{t[Ls]=void 0;var i=!0}catch(t){}var r=Rs.call(t);return i&&(e?t[Ls]=n:delete t[Ls]),r}(t):function(t){return Ys.call(t)}(t)}function Gs(t){return null!=t&&"object"==typeof t}var qs="[object Symbol]";function Us(t){return"symbol"==typeof t||Gs(t)&&Fs(t)==qs}var zs=NaN;function Js(t){return"number"==typeof t?t:Us(t)?zs:+t}function Ws(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var Hs=Array.isArray,Xs=1/0,Zs=js?js.prototype:void 0,Ks=Zs?Zs.toString:void 0;function Qs(t){if("string"==typeof t)return t;if(Hs(t))return Ws(t,Qs)+"";if(Us(t))return Ks?Ks.call(t):"";var e=t+"";return"0"==e&&1/t==-Xs?"-0":e}function tl(t,e){return function(n,i){var r;if(void 0===n&&void 0===i)return e;if(void 0!==n&&(r=n),void 0!==i){if(void 0===r)return i;"string"==typeof n||"string"==typeof i?(n=Qs(n),i=Qs(i)):(n=Js(n),i=Js(i)),r=t(n,i)}return r}}var el=tl((function(t,e){return t+e}),0),nl=/\s/;function il(t){for(var e=t.length;e--&&nl.test(t.charAt(e)););return e}var rl=/^\s+/;function ol(t){return t?t.slice(0,il(t)+1).replace(rl,""):t}function al(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var sl=NaN,ll=/^[-+]0x[0-9a-f]+$/i,ul=/^0b[01]+$/i,cl=/^0o[0-7]+$/i,dl=parseInt;function fl(t){if("number"==typeof t)return t;if(Us(t))return sl;if(al(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=al(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=ol(t);var n=ul.test(t);return n||cl.test(t)?dl(t.slice(2),n?2:8):ll.test(t)?sl:+t}var pl=1/0,hl=17976931348623157e292;function gl(t){return t?(t=fl(t))===pl||t===-pl?(t<0?-1:1)*hl:t==t?t:0:0===t?t:0}function vl(t){var e=gl(t),n=e%1;return e==e?n?e-n:e:0}var yl="Expected a function";function bl(t){return t}var ml="[object AsyncFunction]",El="[object Function]",wl="[object GeneratorFunction]",_l="[object Proxy]";function Ol(t){if(!al(t))return!1;var e=Fs(t);return e==El||e==wl||e==ml||e==_l}var Tl,xl=Cs["__core-js_shared__"],Al=(Tl=/[^.]+$/.exec(xl&&xl.keys&&xl.keys.IE_PROTO||""))?"Symbol(src)_1."+Tl:"";var Sl=Function.prototype.toString;function Il(t){if(null!=t){try{return Sl.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var kl=/^\[object .+?Constructor\]$/,Pl=Function.prototype,Nl=Object.prototype,Cl=Pl.toString,jl=Nl.hasOwnProperty,Ml=RegExp("^"+Cl.call(jl).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Dl(t){return!(!al(t)||function(t){return!!Al&&Al in t}(t))&&(Ol(t)?Ml:kl).test(Il(t))}function Rl(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return Dl(n)?n:void 0}var Ll=Rl(Cs,"WeakMap"),Yl=Ll&&new Ll,Vl=Yl?function(t,e){return Yl.set(t,e),t}:bl,Bl=Object.create,$l=function(){function t(){}return function(e){if(!al(e))return{};if(Bl)return Bl(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function Fl(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=$l(t.prototype),i=t.apply(n,e);return al(i)?i:n}}var Gl=1;function ql(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var Ul=Math.max;function zl(t,e,n,i){for(var r=-1,o=t.length,a=n.length,s=-1,l=e.length,u=Ul(o-a,0),c=Array(l+u),d=!i;++s<l;)c[s]=e[s];for(;++r<a;)(d||r<o)&&(c[n[r]]=t[r]);for(;u--;)c[s++]=t[r++];return c}var Jl=Math.max;function Wl(t,e,n,i){for(var r=-1,o=t.length,a=-1,s=n.length,l=-1,u=e.length,c=Jl(o-s,0),d=Array(c+u),f=!i;++r<c;)d[r]=t[r];for(var p=r;++l<u;)d[p+l]=e[l];for(;++a<s;)(f||r<o)&&(d[p+n[a]]=t[r++]);return d}function Hl(){}var Xl=4294967295;function Zl(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Xl,this.__views__=[]}function Kl(){}Zl.prototype=$l(Hl.prototype),Zl.prototype.constructor=Zl;var Ql=Yl?function(t){return Yl.get(t)}:Kl,tu={},eu=Object.prototype.hasOwnProperty;function nu(t){for(var e=t.name+"",n=tu[e],i=eu.call(tu,e)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==t)return r.name}return e}function iu(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function ru(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}function ou(t){if(t instanceof Zl)return t.clone();var e=new iu(t.__wrapped__,t.__chain__);return e.__actions__=ru(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}iu.prototype=$l(Hl.prototype),iu.prototype.constructor=iu;var au=Object.prototype.hasOwnProperty;function su(t){if(Gs(t)&&!Hs(t)&&!(t instanceof Zl)){if(t instanceof iu)return t;if(au.call(t,"__wrapped__"))return ou(t)}return new iu(t)}function lu(t){var e=nu(t),n=su[e];if("function"!=typeof n||!(e in Zl.prototype))return!1;if(t===n)return!0;var i=Ql(n);return!!i&&t===i[0]}su.prototype=Hl.prototype,su.prototype.constructor=su;var uu=800,cu=16,du=Date.now;function fu(t){var e=0,n=0;return function(){var i=du(),r=cu-(i-n);if(n=i,r>0){if(++e>=uu)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var pu=fu(Vl),hu=/\{\n\/\* \[wrapped with (.+)\] \*/,gu=/,? & /;var vu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function yu(t){return function(){return t}}var bu=function(){try{var t=Rl(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),mu=bu?function(t,e){return bu(t,"toString",{configurable:!0,enumerable:!1,value:yu(e),writable:!0})}:bl,Eu=fu(mu);function wu(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function _u(t,e,n,i){for(var r=t.length,o=n+(i?1:-1);i?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function Ou(t){return t!=t}function Tu(t,e,n){return e==e?function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}(t,e,n):_u(t,Ou,n)}function xu(t,e){return!!(null==t?0:t.length)&&Tu(t,e,0)>-1}var Au=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function Su(t,e,n){var i=e+"";return Eu(t,function(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(vu,"{\n/* [wrapped with "+e+"] */\n")}(i,function(t,e){return wu(Au,(function(n){var i="_."+n[0];e&n[1]&&!xu(t,i)&&t.push(i)})),t.sort()}(function(t){var e=t.match(hu);return e?e[1].split(gu):[]}(i),n)))}var Iu=1,ku=2,Pu=4,Nu=8,Cu=32,ju=64;function Mu(t,e,n,i,r,o,a,s,l,u){var c=e&Nu;e|=c?Cu:ju,(e&=~(c?ju:Cu))&Pu||(e&=~(Iu|ku));var d=[t,e,r,c?o:void 0,c?a:void 0,c?void 0:o,c?void 0:a,s,l,u],f=n.apply(void 0,d);return lu(t)&&pu(f,d),f.placeholder=i,Su(f,t,e)}function Du(t){return t.placeholder}var Ru=9007199254740991,Lu=/^(?:0|[1-9]\d*)$/;function Yu(t,e){var n=typeof t;return!!(e=null==e?Ru:e)&&("number"==n||"symbol"!=n&&Lu.test(t))&&t>-1&&t%1==0&&t<e}var Vu=Math.min;var Bu="__lodash_placeholder__";function $u(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var a=t[n];a!==e&&a!==Bu||(t[n]=Bu,o[r++]=n)}return o}var Fu=1,Gu=2,qu=8,Uu=16,zu=128,Ju=512;function Wu(t,e,n,i,r,o,a,s,l,u){var c=e&zu,d=e&Fu,f=e&Gu,p=e&(qu|Uu),h=e&Ju,g=f?void 0:Fl(t);return function v(){for(var y=arguments.length,b=Array(y),m=y;m--;)b[m]=arguments[m];if(p)var E=Du(v),w=function(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}(b,E);if(i&&(b=zl(b,i,r,p)),o&&(b=Wl(b,o,a,p)),y-=w,p&&y<u){var _=$u(b,E);return Mu(t,e,Wu,v.placeholder,n,b,_,s,l,u-y)}var O=d?n:this,T=f?O[t]:t;return y=b.length,s?b=function(t,e){for(var n=t.length,i=Vu(e.length,n),r=ru(t);i--;){var o=e[i];t[i]=Yu(o,n)?r[o]:void 0}return t}(b,s):h&&y>1&&b.reverse(),c&&l<y&&(b.length=l),this&&this!==Cs&&this instanceof v&&(T=g||Fl(T)),T.apply(O,b)}}var Hu=1;var Xu="__lodash_placeholder__",Zu=1,Ku=2,Qu=4,tc=8,ec=128,nc=256,ic=Math.min;var rc="Expected a function",oc=1,ac=2,sc=8,lc=16,uc=32,cc=64,dc=Math.max;function fc(t,e,n,i,r,o,a,s){var l=e&ac;if(!l&&"function"!=typeof t)throw new TypeError(rc);var u=i?i.length:0;if(u||(e&=~(uc|cc),i=r=void 0),a=void 0===a?a:dc(vl(a),0),s=void 0===s?s:vl(s),u-=r?r.length:0,e&cc){var c=i,d=r;i=r=void 0}var f=l?void 0:Ql(t),p=[t,e,n,i,r,c,d,o,a,s];if(f&&function(t,e){var n=t[1],i=e[1],r=n|i,o=r<(Zu|Ku|ec),a=i==ec&&n==tc||i==ec&&n==nc&&t[7].length<=e[8]||i==(ec|nc)&&e[7].length<=e[8]&&n==tc;if(!o&&!a)return t;i&Zu&&(t[2]=e[2],r|=n&Zu?0:Qu);var s=e[3];if(s){var l=t[3];t[3]=l?zl(l,s,e[4]):s,t[4]=l?$u(t[3],Xu):e[4]}(s=e[5])&&(l=t[5],t[5]=l?Wl(l,s,e[6]):s,t[6]=l?$u(t[5],Xu):e[6]),(s=e[7])&&(t[7]=s),i&ec&&(t[8]=null==t[8]?e[8]:ic(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r}(p,f),t=p[0],e=p[1],n=p[2],i=p[3],r=p[4],!(s=p[9]=void 0===p[9]?l?0:t.length:dc(p[9]-u,0))&&e&(sc|lc)&&(e&=~(sc|lc)),e&&e!=oc)h=e==sc||e==lc?function(t,e,n){var i=Fl(t);return function r(){for(var o=arguments.length,a=Array(o),s=o,l=Du(r);s--;)a[s]=arguments[s];var u=o<3&&a[0]!==l&&a[o-1]!==l?[]:$u(a,l);return(o-=u.length)<n?Mu(t,e,Wu,r.placeholder,void 0,a,u,void 0,void 0,n-o):ql(this&&this!==Cs&&this instanceof r?i:t,this,a)}}(t,e,s):e!=uc&&e!=(oc|uc)||r.length?Wu.apply(void 0,p):function(t,e,n,i){var r=e&Hu,o=Fl(t);return function e(){for(var a=-1,s=arguments.length,l=-1,u=i.length,c=Array(u+s),d=this&&this!==Cs&&this instanceof e?o:t;++l<u;)c[l]=i[l];for(;s--;)c[l++]=arguments[++a];return ql(d,r?n:this,c)}}(t,e,n,i);else var h=function(t,e,n){var i=e&Gl,r=Fl(t);return function e(){return(this&&this!==Cs&&this instanceof e?r:t).apply(i?n:this,arguments)}}(t,e,n);return Su((f?Vl:pu)(h,p),t,e)}var pc=128;function hc(t,e,n){return e=n?void 0:e,e=t&&null==e?t.length:e,fc(t,pc,void 0,void 0,void 0,void 0,e)}function gc(t,e,n){"__proto__"==e&&bu?bu(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function vc(t,e){return t===e||t!=t&&e!=e}var yc=Object.prototype.hasOwnProperty;function bc(t,e,n){var i=t[e];yc.call(t,e)&&vc(i,n)&&(void 0!==n||e in t)||gc(t,e,n)}function mc(t,e,n,i){var r=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var s=e[o],l=i?i(n[s],t[s],s,n,t):void 0;void 0===l&&(l=t[s]),r?gc(n,s,l):bc(n,s,l)}return n}var Ec=Math.max;function wc(t,e,n){return e=Ec(void 0===e?t.length-1:e,0),function(){for(var i=arguments,r=-1,o=Ec(i.length-e,0),a=Array(o);++r<o;)a[r]=i[e+r];r=-1;for(var s=Array(e+1);++r<e;)s[r]=i[r];return s[e]=n(a),ql(t,this,s)}}function _c(t,e){return Eu(wc(t,e,bl),t+"")}var Oc=9007199254740991;function Tc(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Oc}function xc(t){return null!=t&&Tc(t.length)&&!Ol(t)}function Ac(t,e,n){if(!al(n))return!1;var i=typeof e;return!!("number"==i?xc(n)&&Yu(e,n.length):"string"==i&&e in n)&&vc(n[e],t)}function Sc(t){return _c((function(e,n){var i=-1,r=n.length,o=r>1?n[r-1]:void 0,a=r>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(r--,o):void 0,a&&Ac(n[0],n[1],a)&&(o=r<3?void 0:o,r=1),e=Object(e);++i<r;){var s=n[i];s&&t(e,s,i,o)}return e}))}var Ic=Object.prototype;function kc(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ic)}function Pc(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var Nc="[object Arguments]";function Cc(t){return Gs(t)&&Fs(t)==Nc}var jc=Object.prototype,Mc=jc.hasOwnProperty,Dc=jc.propertyIsEnumerable,Rc=Cc(function(){return arguments}())?Cc:function(t){return Gs(t)&&Mc.call(t,"callee")&&!Dc.call(t,"callee")};function Lc(){return!1}var Yc="object"==typeof exports&&exports&&!exports.nodeType&&exports,Vc=Yc&&"object"==typeof module&&module&&!module.nodeType&&module,Bc=Vc&&Vc.exports===Yc?Cs.Buffer:void 0,$c=(Bc?Bc.isBuffer:void 0)||Lc,Fc={};function Gc(t){return function(e){return t(e)}}Fc["[object Float32Array]"]=Fc["[object Float64Array]"]=Fc["[object Int8Array]"]=Fc["[object Int16Array]"]=Fc["[object Int32Array]"]=Fc["[object Uint8Array]"]=Fc["[object Uint8ClampedArray]"]=Fc["[object Uint16Array]"]=Fc["[object Uint32Array]"]=!0,Fc["[object Arguments]"]=Fc["[object Array]"]=Fc["[object ArrayBuffer]"]=Fc["[object Boolean]"]=Fc["[object DataView]"]=Fc["[object Date]"]=Fc["[object Error]"]=Fc["[object Function]"]=Fc["[object Map]"]=Fc["[object Number]"]=Fc["[object Object]"]=Fc["[object RegExp]"]=Fc["[object Set]"]=Fc["[object String]"]=Fc["[object WeakMap]"]=!1;var qc="object"==typeof exports&&exports&&!exports.nodeType&&exports,Uc=qc&&"object"==typeof module&&module&&!module.nodeType&&module,zc=Uc&&Uc.exports===qc&&Ps.process,Jc=function(){try{var t=Uc&&Uc.require&&Uc.require("util").types;return t||zc&&zc.binding&&zc.binding("util")}catch(t){}}(),Wc=Jc&&Jc.isTypedArray,Hc=Wc?Gc(Wc):function(t){return Gs(t)&&Tc(t.length)&&!!Fc[Fs(t)]},Xc=Object.prototype.hasOwnProperty;function Zc(t,e){var n=Hs(t),i=!n&&Rc(t),r=!n&&!i&&$c(t),o=!n&&!i&&!r&&Hc(t),a=n||i||r||o,s=a?Pc(t.length,String):[],l=s.length;for(var u in t)!e&&!Xc.call(t,u)||a&&("length"==u||r&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Yu(u,l))||s.push(u);return s}function Kc(t,e){return function(n){return t(e(n))}}var Qc=Kc(Object.keys,Object),td=Object.prototype.hasOwnProperty;function ed(t){if(!kc(t))return Qc(t);var e=[];for(var n in Object(t))td.call(t,n)&&"constructor"!=n&&e.push(n);return e}function nd(t){return xc(t)?Zc(t):ed(t)}var id=Object.prototype.hasOwnProperty,rd=Sc((function(t,e){if(kc(e)||xc(e))mc(e,nd(e),t);else for(var n in e)id.call(e,n)&&bc(t,n,e[n])}));var od=Object.prototype.hasOwnProperty;function ad(t){if(!al(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=kc(t),n=[];for(var i in t)("constructor"!=i||!e&&od.call(t,i))&&n.push(i);return n}function sd(t){return xc(t)?Zc(t,!0):ad(t)}var ld=Sc((function(t,e){mc(e,sd(e),t)})),ud=Sc((function(t,e,n,i){mc(e,sd(e),t,i)})),cd=Sc((function(t,e,n,i){mc(e,nd(e),t,i)})),dd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fd=/^\w*$/;function pd(t,e){if(Hs(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Us(t))||(fd.test(t)||!dd.test(t)||null!=e&&t in Object(e))}var hd=Rl(Object,"create");var gd="__lodash_hash_undefined__",vd=Object.prototype.hasOwnProperty;var yd=Object.prototype.hasOwnProperty;var bd="__lodash_hash_undefined__";function md(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Ed(t,e){for(var n=t.length;n--;)if(vc(t[n][0],e))return n;return-1}md.prototype.clear=function(){this.__data__=hd?hd(null):{},this.size=0},md.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},md.prototype.get=function(t){var e=this.__data__;if(hd){var n=e[t];return n===gd?void 0:n}return vd.call(e,t)?e[t]:void 0},md.prototype.has=function(t){var e=this.__data__;return hd?void 0!==e[t]:yd.call(e,t)},md.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=hd&&void 0===e?bd:e,this};var wd=Array.prototype.splice;function _d(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}_d.prototype.clear=function(){this.__data__=[],this.size=0},_d.prototype.delete=function(t){var e=this.__data__,n=Ed(e,t);return!(n<0)&&(n==e.length-1?e.pop():wd.call(e,n,1),--this.size,!0)},_d.prototype.get=function(t){var e=this.__data__,n=Ed(e,t);return n<0?void 0:e[n][1]},_d.prototype.has=function(t){return Ed(this.__data__,t)>-1},_d.prototype.set=function(t,e){var n=this.__data__,i=Ed(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};var Od=Rl(Cs,"Map");function Td(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function xd(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}xd.prototype.clear=function(){this.size=0,this.__data__={hash:new md,map:new(Od||_d),string:new md}},xd.prototype.delete=function(t){var e=Td(this,t).delete(t);return this.size-=e?1:0,e},xd.prototype.get=function(t){return Td(this,t).get(t)},xd.prototype.has=function(t){return Td(this,t).has(t)},xd.prototype.set=function(t,e){var n=Td(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};var Ad="Expected a function";function Sd(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Ad);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=t.apply(this,i);return n.cache=o.set(r,a)||o,a};return n.cache=new(Sd.Cache||xd),n}Sd.Cache=xd;var Id=500;var kd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pd=/\\(\\)?/g,Nd=function(t){var e=Sd(t,(function(t){return n.size===Id&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(kd,(function(t,n,i,r){e.push(i?r.replace(Pd,"$1"):n||t)})),e}));function Cd(t){return null==t?"":Qs(t)}function jd(t,e){return Hs(t)?t:pd(t,e)?[t]:Nd(Cd(t))}var Md=1/0;function Dd(t){if("string"==typeof t||Us(t))return t;var e=t+"";return"0"==e&&1/t==-Md?"-0":e}function Rd(t,e){for(var n=0,i=(e=jd(e,t)).length;null!=t&&n<i;)t=t[Dd(e[n++])];return n&&n==i?t:void 0}function Ld(t,e,n){var i=null==t?void 0:Rd(t,e);return void 0===i?n:i}function Yd(t,e){for(var n=-1,i=e.length,r=Array(i),o=null==t;++n<i;)r[n]=o?void 0:Ld(t,e[n]);return r}function Vd(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var Bd=js?js.isConcatSpreadable:void 0;function $d(t){return Hs(t)||Rc(t)||!!(Bd&&t&&t[Bd])}function Fd(t,e,n,i,r){var o=-1,a=t.length;for(n||(n=$d),r||(r=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?Fd(s,e-1,n,i,r):Vd(r,s):i||(r[r.length]=s)}return r}function Gd(t){return(null==t?0:t.length)?Fd(t,1):[]}function qd(t){return Eu(wc(t,void 0,Gd),t+"")}var Ud=qd(Yd),zd=Kc(Object.getPrototypeOf,Object),Jd="[object Object]",Wd=Function.prototype,Hd=Object.prototype,Xd=Wd.toString,Zd=Hd.hasOwnProperty,Kd=Xd.call(Object);function Qd(t){if(!Gs(t)||Fs(t)!=Jd)return!1;var e=zd(t);if(null===e)return!0;var n=Zd.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Xd.call(n)==Kd}var tf="[object DOMException]",ef="[object Error]";function nf(t){if(!Gs(t))return!1;var e=Fs(t);return e==ef||e==tf||"string"==typeof t.message&&"string"==typeof t.name&&!Qd(t)}var rf=_c((function(t,e){try{return ql(t,void 0,e)}catch(t){return nf(t)?t:new Error(t)}})),of="Expected a function";function af(t,e){var n;if("function"!=typeof e)throw new TypeError(of);return t=vl(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var sf=_c((function(t,e,n){var i=1;if(n.length){var r=$u(n,Du(sf));i|=32}return fc(t,i,e,n,r)}));sf.placeholder={};var lf=qd((function(t,e){return wu(e,(function(e){e=Dd(e),gc(t,e,sf(t[e],t))})),t})),uf=_c((function(t,e,n){var i=3;if(n.length){var r=$u(n,Du(uf));i|=32}return fc(e,i,t,n,r)}));function cf(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),(n=n>r?r:n)<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(r);++i<r;)o[i]=t[i+e];return o}function df(t,e,n){var i=t.length;return n=void 0===n?i:n,!e&&n>=i?t:cf(t,e,n)}uf.placeholder={};var ff=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function pf(t){return ff.test(t)}var hf="\\ud800-\\udfff",gf="["+hf+"]",vf="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",yf="\\ud83c[\\udffb-\\udfff]",bf="[^"+hf+"]",mf="(?:\\ud83c[\\udde6-\\uddff]){2}",Ef="[\\ud800-\\udbff][\\udc00-\\udfff]",wf="(?:"+vf+"|"+yf+")"+"?",_f="[\\ufe0e\\ufe0f]?",Of=_f+wf+("(?:\\u200d(?:"+[bf,mf,Ef].join("|")+")"+_f+wf+")*"),Tf="(?:"+[bf+vf+"?",vf,mf,Ef,gf].join("|")+")",xf=RegExp(yf+"(?="+yf+")|"+Tf+Of,"g");function Af(t){return pf(t)?function(t){return t.match(xf)||[]}(t):function(t){return t.split("")}(t)}function Sf(t){return function(e){var n=pf(e=Cd(e))?Af(e):void 0,i=n?n[0]:e.charAt(0),r=n?df(n,1).join(""):e.slice(1);return i[t]()+r}}var If=Sf("toUpperCase");function kf(t){return If(Cd(t).toLowerCase())}function Pf(t,e,n,i){var r=-1,o=null==t?0:t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function Nf(t){return function(e){return null==t?void 0:t[e]}}var Cf=Nf({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),jf=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Mf=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function Df(t){return(t=Cd(t))&&t.replace(jf,Cf).replace(Mf,"")}var Rf=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var Lf=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Yf="\\ud800-\\udfff",Vf="\\u2700-\\u27bf",Bf="a-z\\xdf-\\xf6\\xf8-\\xff",$f="A-Z\\xc0-\\xd6\\xd8-\\xde",Ff="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Gf="["+Ff+"]",qf="\\d+",Uf="["+Vf+"]",zf="["+Bf+"]",Jf="[^"+Yf+Ff+qf+Vf+Bf+$f+"]",Wf="(?:\\ud83c[\\udde6-\\uddff]){2}",Hf="[\\ud800-\\udbff][\\udc00-\\udfff]",Xf="["+$f+"]",Zf="(?:"+zf+"|"+Jf+")",Kf="(?:"+Xf+"|"+Jf+")",Qf="(?:['’](?:d|ll|m|re|s|t|ve))?",tp="(?:['’](?:D|LL|M|RE|S|T|VE))?",ep="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",np="[\\ufe0e\\ufe0f]?",ip=np+ep+("(?:\\u200d(?:"+["[^"+Yf+"]",Wf,Hf].join("|")+")"+np+ep+")*"),rp="(?:"+[Uf,Wf,Hf].join("|")+")"+ip,op=RegExp([Xf+"?"+zf+"+"+Qf+"(?="+[Gf,Xf,"$"].join("|")+")",Kf+"+"+tp+"(?="+[Gf,Xf+Zf,"$"].join("|")+")",Xf+"?"+Zf+"+"+Qf,Xf+"+"+tp,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qf,rp].join("|"),"g");function ap(t,e,n){return t=Cd(t),void 0===(e=n?void 0:e)?function(t){return Lf.test(t)}(t)?function(t){return t.match(op)||[]}(t):function(t){return t.match(Rf)||[]}(t):t.match(e)||[]}var sp=RegExp("['’]","g");function lp(t){return function(e){return Pf(ap(Df(e).replace(sp,"")),t,"")}}var up=lp((function(t,e,n){return e=e.toLowerCase(),t+(n?kf(e):e)}));var cp=Cs.isFinite,dp=Math.min;function fp(t){var e=Math[t];return function(t,n){if(t=fl(t),(n=null==n?0:dp(vl(n),292))&&cp(t)){var i=(Cd(t)+"e").split("e");return+((i=(Cd(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return e(t)}}var pp=fp("ceil");function hp(t){var e=su(t);return e.__chain__=!0,e}var gp=Math.ceil,vp=Math.max;function yp(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}var bp=200;function mp(t){var e=this.__data__=new _d(t);this.size=e.size}function Ep(t,e){return t&&mc(e,nd(e),t)}mp.prototype.clear=function(){this.__data__=new _d,this.size=0},mp.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},mp.prototype.get=function(t){return this.__data__.get(t)},mp.prototype.has=function(t){return this.__data__.has(t)},mp.prototype.set=function(t,e){var n=this.__data__;if(n instanceof _d){var i=n.__data__;if(!Od||i.length<bp-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new xd(i)}return n.set(t,e),this.size=n.size,this};var wp="object"==typeof exports&&exports&&!exports.nodeType&&exports,_p=wp&&"object"==typeof module&&module&&!module.nodeType&&module,Op=_p&&_p.exports===wp?Cs.Buffer:void 0,Tp=Op?Op.allocUnsafe:void 0;function xp(t,e){if(e)return t.slice();var n=t.length,i=Tp?Tp(n):new t.constructor(n);return t.copy(i),i}function Ap(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var a=t[n];e(a,n,t)&&(o[r++]=a)}return o}function Sp(){return[]}var Ip=Object.prototype.propertyIsEnumerable,kp=Object.getOwnPropertySymbols,Pp=kp?function(t){return null==t?[]:(t=Object(t),Ap(kp(t),(function(e){return Ip.call(t,e)})))}:Sp;var Np=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Vd(e,Pp(t)),t=zd(t);return e}:Sp;function Cp(t,e,n){var i=e(t);return Hs(t)?i:Vd(i,n(t))}function jp(t){return Cp(t,nd,Pp)}function Mp(t){return Cp(t,sd,Np)}var Dp=Rl(Cs,"DataView"),Rp=Rl(Cs,"Promise"),Lp=Rl(Cs,"Set"),Yp="[object Map]",Vp="[object Promise]",Bp="[object Set]",$p="[object WeakMap]",Fp="[object DataView]",Gp=Il(Dp),qp=Il(Od),Up=Il(Rp),zp=Il(Lp),Jp=Il(Ll),Wp=Fs;(Dp&&Wp(new Dp(new ArrayBuffer(1)))!=Fp||Od&&Wp(new Od)!=Yp||Rp&&Wp(Rp.resolve())!=Vp||Lp&&Wp(new Lp)!=Bp||Ll&&Wp(new Ll)!=$p)&&(Wp=function(t){var e=Fs(t),n="[object Object]"==e?t.constructor:void 0,i=n?Il(n):"";if(i)switch(i){case Gp:return Fp;case qp:return Yp;case Up:return Vp;case zp:return Bp;case Jp:return $p}return e});var Hp=Wp,Xp=Object.prototype.hasOwnProperty;var Zp=Cs.Uint8Array;function Kp(t){var e=new t.constructor(t.byteLength);return new Zp(e).set(new Zp(t)),e}var Qp=/\w*$/;var th=js?js.prototype:void 0,eh=th?th.valueOf:void 0;function nh(t,e){var n=e?Kp(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var ih="[object Boolean]",rh="[object Date]",oh="[object Map]",ah="[object Number]",sh="[object RegExp]",lh="[object Set]",uh="[object String]",ch="[object Symbol]",dh="[object ArrayBuffer]",fh="[object DataView]",ph="[object Float32Array]",hh="[object Float64Array]",gh="[object Int8Array]",vh="[object Int16Array]",yh="[object Int32Array]",bh="[object Uint8Array]",mh="[object Uint8ClampedArray]",Eh="[object Uint16Array]",wh="[object Uint32Array]";function _h(t,e,n){var i,r=t.constructor;switch(e){case dh:return Kp(t);case ih:case rh:return new r(+t);case fh:return function(t,e){var n=e?Kp(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case ph:case hh:case gh:case vh:case yh:case bh:case mh:case Eh:case wh:return nh(t,n);case oh:return new r;case ah:case uh:return new r(t);case sh:return function(t){var e=new t.constructor(t.source,Qp.exec(t));return e.lastIndex=t.lastIndex,e}(t);case lh:return new r;case ch:return i=t,eh?Object(eh.call(i)):{}}}function Oh(t){return"function"!=typeof t.constructor||kc(t)?{}:$l(zd(t))}var Th="[object Map]";var xh=Jc&&Jc.isMap,Ah=xh?Gc(xh):function(t){return Gs(t)&&Hp(t)==Th},Sh="[object Set]";var Ih=Jc&&Jc.isSet,kh=Ih?Gc(Ih):function(t){return Gs(t)&&Hp(t)==Sh},Ph=1,Nh=2,Ch=4,jh="[object Arguments]",Mh="[object Function]",Dh="[object GeneratorFunction]",Rh="[object Object]",Lh={};function Yh(t,e,n,i,r,o){var a,s=e&Ph,l=e&Nh,u=e&Ch;if(n&&(a=r?n(t,i,r,o):n(t)),void 0!==a)return a;if(!al(t))return t;var c=Hs(t);if(c){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Xp.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!s)return ru(t,a)}else{var d=Hp(t),f=d==Mh||d==Dh;if($c(t))return xp(t,s);if(d==Rh||d==jh||f&&!r){if(a=l||f?{}:Oh(t),!s)return l?function(t,e){return mc(t,Np(t),e)}(t,function(t,e){return t&&mc(e,sd(e),t)}(a,t)):function(t,e){return mc(t,Pp(t),e)}(t,Ep(a,t))}else{if(!Lh[d])return r?t:{};a=_h(t,d,s)}}o||(o=new mp);var p=o.get(t);if(p)return p;o.set(t,a),kh(t)?t.forEach((function(i){a.add(Yh(i,e,n,i,t,o))})):Ah(t)&&t.forEach((function(i,r){a.set(r,Yh(i,e,n,r,t,o))}));var h=c?void 0:(u?l?Mp:jp:l?sd:nd)(t);return wu(h||t,(function(i,r){h&&(i=t[r=i]),bc(a,r,Yh(i,e,n,r,t,o))})),a}Lh[jh]=Lh["[object Array]"]=Lh["[object ArrayBuffer]"]=Lh["[object DataView]"]=Lh["[object Boolean]"]=Lh["[object Date]"]=Lh["[object Float32Array]"]=Lh["[object Float64Array]"]=Lh["[object Int8Array]"]=Lh["[object Int16Array]"]=Lh["[object Int32Array]"]=Lh["[object Map]"]=Lh["[object Number]"]=Lh[Rh]=Lh["[object RegExp]"]=Lh["[object Set]"]=Lh["[object String]"]=Lh["[object Symbol]"]=Lh["[object Uint8Array]"]=Lh["[object Uint8ClampedArray]"]=Lh["[object Uint16Array]"]=Lh["[object Uint32Array]"]=!0,Lh["[object Error]"]=Lh[Mh]=Lh["[object WeakMap]"]=!1;var Vh=4;var Bh=1,$h=4;var Fh=1,Gh=4;var qh=4;var Uh="__lodash_hash_undefined__";function zh(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new xd;++e<n;)this.add(t[e])}function Jh(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function Wh(t,e){return t.has(e)}zh.prototype.add=zh.prototype.push=function(t){return this.__data__.set(t,Uh),this},zh.prototype.has=function(t){return this.__data__.has(t)};var Hh=1,Xh=2;function Zh(t,e,n,i,r,o){var a=n&Hh,s=t.length,l=e.length;if(s!=l&&!(a&&l>s))return!1;var u=o.get(t),c=o.get(e);if(u&&c)return u==e&&c==t;var d=-1,f=!0,p=n&Xh?new zh:void 0;for(o.set(t,e),o.set(e,t);++d<s;){var h=t[d],g=e[d];if(i)var v=a?i(g,h,d,e,t,o):i(h,g,d,t,e,o);if(void 0!==v){if(v)continue;f=!1;break}if(p){if(!Jh(e,(function(t,e){if(!Wh(p,e)&&(h===t||r(h,t,n,i,o)))return p.push(e)}))){f=!1;break}}else if(h!==g&&!r(h,g,n,i,o)){f=!1;break}}return o.delete(t),o.delete(e),f}function Kh(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function Qh(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var tg=1,eg=2,ng="[object Boolean]",ig="[object Date]",rg="[object Error]",og="[object Map]",ag="[object Number]",sg="[object RegExp]",lg="[object Set]",ug="[object String]",cg="[object Symbol]",dg="[object ArrayBuffer]",fg="[object DataView]",pg=js?js.prototype:void 0,hg=pg?pg.valueOf:void 0;var gg=1,vg=Object.prototype.hasOwnProperty;var yg=1,bg="[object Arguments]",mg="[object Array]",Eg="[object Object]",wg=Object.prototype.hasOwnProperty;function _g(t,e,n,i,r,o){var a=Hs(t),s=Hs(e),l=a?mg:Hp(t),u=s?mg:Hp(e),c=(l=l==bg?Eg:l)==Eg,d=(u=u==bg?Eg:u)==Eg,f=l==u;if(f&&$c(t)){if(!$c(e))return!1;a=!0,c=!1}if(f&&!c)return o||(o=new mp),a||Hc(t)?Zh(t,e,n,i,r,o):function(t,e,n,i,r,o,a){switch(n){case fg:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case dg:return!(t.byteLength!=e.byteLength||!o(new Zp(t),new Zp(e)));case ng:case ig:case ag:return vc(+t,+e);case rg:return t.name==e.name&&t.message==e.message;case sg:case ug:return t==e+"";case og:var s=Kh;case lg:var l=i&tg;if(s||(s=Qh),t.size!=e.size&&!l)return!1;var u=a.get(t);if(u)return u==e;i|=eg,a.set(t,e);var c=Zh(s(t),s(e),i,r,o,a);return a.delete(t),c;case cg:if(hg)return hg.call(t)==hg.call(e)}return!1}(t,e,l,n,i,r,o);if(!(n&yg)){var p=c&&wg.call(t,"__wrapped__"),h=d&&wg.call(e,"__wrapped__");if(p||h){var g=p?t.value():t,v=h?e.value():e;return o||(o=new mp),r(g,v,n,i,o)}}return!!f&&(o||(o=new mp),function(t,e,n,i,r,o){var a=n&gg,s=jp(t),l=s.length;if(l!=jp(e).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in e:vg.call(e,c)))return!1}var d=o.get(t),f=o.get(e);if(d&&f)return d==e&&f==t;var p=!0;o.set(t,e),o.set(e,t);for(var h=a;++u<l;){var g=t[c=s[u]],v=e[c];if(i)var y=a?i(v,g,c,e,t,o):i(g,v,c,t,e,o);if(!(void 0===y?g===v||r(g,v,n,i,o):y)){p=!1;break}h||(h="constructor"==c)}if(p&&!h){var b=t.constructor,m=e.constructor;b==m||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof m&&m instanceof m||(p=!1)}return o.delete(t),o.delete(e),p}(t,e,n,i,r,o))}function Og(t,e,n,i,r){return t===e||(null==t||null==e||!Gs(t)&&!Gs(e)?t!=t&&e!=e:_g(t,e,n,i,Og,r))}var Tg=1,xg=2;function Ag(t,e,n,i){var r=n.length,o=r,a=!i;if(null==t)return!o;for(t=Object(t);r--;){var s=n[r];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++r<o;){var l=(s=n[r])[0],u=t[l],c=s[1];if(a&&s[2]){if(void 0===u&&!(l in t))return!1}else{var d=new mp;if(i)var f=i(u,c,l,t,e,d);if(!(void 0===f?Og(c,u,Tg|xg,i,d):f))return!1}}return!0}function Sg(t){return t==t&&!al(t)}function Ig(t){for(var e=nd(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,Sg(r)]}return e}function kg(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}function Pg(t){var e=Ig(t);return 1==e.length&&e[0][2]?kg(e[0][0],e[0][1]):function(n){return n===t||Ag(n,t,e)}}function Ng(t,e){return null!=t&&e in Object(t)}function Cg(t,e,n){for(var i=-1,r=(e=jd(e,t)).length,o=!1;++i<r;){var a=Dd(e[i]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++i!=r?o:!!(r=null==t?0:t.length)&&Tc(r)&&Yu(a,r)&&(Hs(t)||Rc(t))}function jg(t,e){return null!=t&&Cg(t,e,Ng)}var Mg=1,Dg=2;function Rg(t,e){return pd(t)&&Sg(e)?kg(Dd(t),e):function(n){var i=Ld(n,t);return void 0===i&&i===e?jg(n,t):Og(e,i,Mg|Dg)}}function Lg(t){return function(e){return null==e?void 0:e[t]}}function Yg(t){return pd(t)?Lg(Dd(t)):function(t){return function(e){return Rd(e,t)}}(t)}function Vg(t){return"function"==typeof t?t:null==t?bl:"object"==typeof t?Hs(t)?Rg(t[0],t[1]):Pg(t):Yg(t)}var Bg="Expected a function";function $g(t,e,n){var i=n.length;if(null==t)return!i;for(t=Object(t);i--;){var r=n[i],o=e[r],a=t[r];if(void 0===a&&!(r in t)||!o(a))return!1}return!0}var Fg=1;function Gg(t,e,n,i){for(var r=-1,o=null==t?0:t.length;++r<o;){var a=t[r];e(i,a,n(a),t)}return i}function qg(t){return function(e,n,i){for(var r=-1,o=Object(e),a=i(e),s=a.length;s--;){var l=a[t?s:++r];if(!1===n(o[l],l,o))break}return e}}var Ug=qg();function zg(t,e){return t&&Ug(t,e,nd)}function Jg(t,e){return function(n,i){if(null==n)return n;if(!xc(n))return t(n,i);for(var r=n.length,o=e?r:-1,a=Object(n);(e?o--:++o<r)&&!1!==i(a[o],o,a););return n}}var Wg=Jg(zg);function Hg(t,e,n,i){return Wg(t,(function(t,r,o){e(i,t,n(t),o)})),i}function Xg(t,e){return function(n,i){var r=Hs(n)?Gg:Hg,o=e?e():{};return r(n,t,Vg(i),o)}}var Zg=Object.prototype.hasOwnProperty,Kg=Xg((function(t,e,n){Zg.call(t,n)?++t[n]:gc(t,n,1)}));var Qg=8;function tv(t,e,n){var i=fc(t,Qg,void 0,void 0,void 0,void 0,void 0,e=n?void 0:e);return i.placeholder=tv.placeholder,i}tv.placeholder={};var ev=16;function nv(t,e,n){var i=fc(t,ev,void 0,void 0,void 0,void 0,void 0,e=n?void 0:e);return i.placeholder=nv.placeholder,i}nv.placeholder={};var iv=function(){return Cs.Date.now()},rv="Expected a function",ov=Math.max,av=Math.min;function sv(t,e,n){var i,r,o,a,s,l,u=0,c=!1,d=!1,f=!0;if("function"!=typeof t)throw new TypeError(rv);function p(e){var n=i,o=r;return i=r=void 0,u=e,a=t.apply(o,n)}function h(t){var n=t-l;return void 0===l||n>=e||n<0||d&&t-u>=o}function g(){var t=iv();if(h(t))return v(t);s=setTimeout(g,function(t){var n=e-(t-l);return d?av(n,o-(t-u)):n}(t))}function v(t){return s=void 0,f&&i?p(t):(i=r=void 0,a)}function y(){var t=iv(),n=h(t);if(i=arguments,r=this,l=t,n){if(void 0===s)return function(t){return u=t,s=setTimeout(g,e),c?p(t):a}(l);if(d)return clearTimeout(s),s=setTimeout(g,e),p(l)}return void 0===s&&(s=setTimeout(g,e)),a}return e=fl(e)||0,al(n)&&(c=!!n.leading,o=(d="maxWait"in n)?ov(fl(n.maxWait)||0,e):o,f="trailing"in n?!!n.trailing:f),y.cancel=function(){void 0!==s&&clearTimeout(s),u=0,i=l=r=s=void 0},y.flush=function(){return void 0===s?a:v(iv())},y}var lv=Object.prototype,uv=lv.hasOwnProperty,cv=_c((function(t,e){t=Object(t);var n=-1,i=e.length,r=i>2?e[2]:void 0;for(r&&Ac(e[0],e[1],r)&&(i=1);++n<i;)for(var o=e[n],a=sd(o),s=-1,l=a.length;++s<l;){var u=a[s],c=t[u];(void 0===c||vc(c,lv[u])&&!uv.call(t,u))&&(t[u]=o[u])}return t}));function dv(t,e,n){(void 0!==n&&!vc(t[e],n)||void 0===n&&!(e in t))&&gc(t,e,n)}function fv(t){return Gs(t)&&xc(t)}function pv(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function hv(t){return mc(t,sd(t))}function gv(t,e,n,i,r){t!==e&&Ug(e,(function(o,a){if(r||(r=new mp),al(o))!function(t,e,n,i,r,o,a){var s=pv(t,n),l=pv(e,n),u=a.get(l);if(u)dv(t,n,u);else{var c=o?o(s,l,n+"",t,e,a):void 0,d=void 0===c;if(d){var f=Hs(l),p=!f&&$c(l),h=!f&&!p&&Hc(l);c=l,f||p||h?Hs(s)?c=s:fv(s)?c=ru(s):p?(d=!1,c=xp(l,!0)):h?(d=!1,c=nh(l,!0)):c=[]:Qd(l)||Rc(l)?(c=s,Rc(s)?c=hv(s):al(s)&&!Ol(s)||(c=Oh(l))):d=!1}d&&(a.set(l,c),r(c,l,i,o,a),a.delete(l)),dv(t,n,c)}}(t,e,a,n,gv,i,r);else{var s=i?i(pv(t,a),o,a+"",t,e,r):void 0;void 0===s&&(s=o),dv(t,a,s)}}),sd)}function vv(t,e,n,i,r,o){return al(t)&&al(e)&&(o.set(e,t),gv(t,e,void 0,vv,o),o.delete(e)),t}var yv=Sc((function(t,e,n,i){gv(t,e,n,i)})),bv=_c((function(t){return t.push(void 0,vv),ql(yv,void 0,t)})),mv="Expected a function";function Ev(t,e,n){if("function"!=typeof t)throw new TypeError(mv);return setTimeout((function(){t.apply(void 0,n)}),e)}var wv=_c((function(t,e){return Ev(t,1,e)})),_v=_c((function(t,e,n){return Ev(t,fl(e)||0,n)}));function Ov(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}var Tv=200;function xv(t,e,n,i){var r=-1,o=xu,a=!0,s=t.length,l=[],u=e.length;if(!s)return l;n&&(e=Ws(e,Gc(n))),i?(o=Ov,a=!1):e.length>=Tv&&(o=Wh,a=!1,e=new zh(e));t:for(;++r<s;){var c=t[r],d=null==n?c:n(c);if(c=i||0!==c?c:0,a&&d==d){for(var f=u;f--;)if(e[f]===d)continue t;l.push(c)}else o(e,d,i)||l.push(c)}return l}var Av=_c((function(t,e){return fv(t)?xv(t,Fd(e,1,fv,!0)):[]}));function Sv(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Iv=_c((function(t,e){var n=Sv(e);return fv(n)&&(n=void 0),fv(t)?xv(t,Fd(e,1,fv,!0),Vg(n)):[]})),kv=_c((function(t,e){var n=Sv(e);return fv(n)&&(n=void 0),fv(t)?xv(t,Fd(e,1,fv,!0),void 0,n):[]})),Pv=tl((function(t,e){return t/e}),1);function Nv(t,e,n,i){for(var r=t.length,o=i?r:-1;(i?o--:++o<r)&&e(t[o],o,t););return n?cf(t,i?0:o,i?o+1:r):cf(t,i?o+1:0,i?r:o)}function Cv(t){return"function"==typeof t?t:bl}function jv(t,e){return(Hs(t)?wu:Wg)(t,Cv(e))}function Mv(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}var Dv=qg(!0);function Rv(t,e){return t&&Dv(t,e,nd)}var Lv=Jg(Rv,!0);function Yv(t,e){return(Hs(t)?Mv:Lv)(t,Cv(e))}var Vv="[object Map]",Bv="[object Set]";function $v(t){return function(e){var n=Hp(e);return n==Vv?Kh(e):n==Bv?function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}(e):function(t,e){return Ws(e,(function(e){return[e,t[e]]}))}(e,t(e))}}var Fv=$v(nd),Gv=$v(sd),qv=Nf({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Uv=/[&<>"']/g,zv=RegExp(Uv.source);function Jv(t){return(t=Cd(t))&&zv.test(t)?t.replace(Uv,qv):t}var Wv=/[\\^$.*+?()[\]{}|]/g,Hv=RegExp(Wv.source);function Xv(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function Zv(t,e){var n=!0;return Wg(t,(function(t,i,r){return n=!!e(t,i,r)})),n}var Kv=4294967295;function Qv(t){return t?yp(vl(t),0,Kv):0}function ty(t,e){var n=[];return Wg(t,(function(t,i,r){e(t,i,r)&&n.push(t)})),n}function ey(t){return function(e,n,i){var r=Object(e);if(!xc(e)){var o=Vg(n);e=nd(e),n=function(t){return o(r[t],t,r)}}var a=t(e,n,i);return a>-1?r[o?e[a]:a]:void 0}}var ny=Math.max;function iy(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:vl(n);return r<0&&(r=ny(i+r,0)),_u(t,Vg(e),r)}var ry=ey(iy);function oy(t,e,n){var i;return n(t,(function(t,n,r){if(e(t,n,r))return i=n,!1})),i}var ay=Math.max,sy=Math.min;function ly(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i-1;return void 0!==n&&(r=vl(n),r=n<0?ay(i+r,0):sy(r,i-1)),_u(t,Vg(e),r,!0)}var uy=ey(ly);function cy(t){return t&&t.length?t[0]:void 0}function dy(t,e){var n=-1,i=xc(t)?Array(t.length):[];return Wg(t,(function(t,r,o){i[++n]=e(t,r,o)})),i}function fy(t,e){return(Hs(t)?Ws:dy)(t,Vg(e))}var py=1/0;var hy=1/0;var gy=512;var vy=fp("floor"),yy="Expected a function",by=8,my=32,Ey=128,wy=256;function _y(t){return qd((function(e){var n=e.length,i=n,r=iu.prototype.thru;for(t&&e.reverse();i--;){var o=e[i];if("function"!=typeof o)throw new TypeError(yy);if(r&&!a&&"wrapper"==nu(o))var a=new iu([],!0)}for(i=a?i:n;++i<n;){var s=nu(o=e[i]),l="wrapper"==s?Ql(o):void 0;a=l&&lu(l[0])&&l[1]==(Ey|by|my|wy)&&!l[4].length&&1==l[9]?a[nu(l[0])].apply(a,l[3]):1==o.length&&lu(o)?a[s]():a.thru(o)}return function(){var t=arguments,i=t[0];if(a&&1==t.length&&Hs(i))return a.plant(i).value();for(var r=0,o=n?e[r].apply(this,t):i;++r<n;)o=e[r].call(this,o);return o}}))}var Oy=_y(),Ty=_y(!0);function xy(t,e){return Ap(e,(function(e){return Ol(t[e])}))}var Ay=Object.prototype.hasOwnProperty,Sy=Xg((function(t,e,n){Ay.call(t,n)?t[n].push(e):gc(t,n,[e])}));function Iy(t,e){return t>e}function ky(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=fl(e),n=fl(n)),t(e,n)}}var Py=ky(Iy),Ny=ky((function(t,e){return t>=e})),Cy=Object.prototype.hasOwnProperty;function jy(t,e){return null!=t&&Cy.call(t,e)}var My=Math.max,Dy=Math.min;var Ry="[object String]";function Ly(t){return"string"==typeof t||!Hs(t)&&Gs(t)&&Fs(t)==Ry}function Yy(t,e){return Ws(e,(function(e){return t[e]}))}function Vy(t){return null==t?[]:Yy(t,nd(t))}var By=Math.max;var $y=Math.max;var Fy=Math.min;function Gy(t,e,n){for(var i=n?Ov:xu,r=t[0].length,o=t.length,a=o,s=Array(o),l=1/0,u=[];a--;){var c=t[a];a&&e&&(c=Ws(c,Gc(e))),l=Fy(c.length,l),s[a]=!n&&(e||r>=120&&c.length>=120)?new zh(a&&c):void 0}c=t[0];var d=-1,f=s[0];t:for(;++d<r&&u.length<l;){var p=c[d],h=e?e(p):p;if(p=n||0!==p?p:0,!(f?Wh(f,h):i(u,h,n))){for(a=o;--a;){var g=s[a];if(!(g?Wh(g,h):i(t[a],h,n)))continue t}f&&f.push(h),u.push(p)}}return u}function qy(t){return fv(t)?t:[]}var Uy=_c((function(t){var e=Ws(t,qy);return e.length&&e[0]===t[0]?Gy(e):[]})),zy=_c((function(t){var e=Sv(t),n=Ws(t,qy);return e===Sv(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?Gy(n,Vg(e)):[]})),Jy=_c((function(t){var e=Sv(t),n=Ws(t,qy);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?Gy(n,void 0,e):[]}));function Wy(t,e){return function(n,i){return function(t,e,n,i){return zg(t,(function(t,r,o){e(i,n(t),r,o)})),i}(n,t,e(i),{})}}var Hy=Object.prototype.toString,Xy=Wy((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Hy.call(e)),t[e]=n}),yu(bl)),Zy=Object.prototype,Ky=Zy.hasOwnProperty,Qy=Zy.toString,tb=Wy((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Qy.call(e)),Ky.call(t,e)?t[e].push(n):t[e]=[n]}),Vg);function eb(t,e){return e.length<2?t:Rd(t,cf(e,0,-1))}function nb(t,e,n){var i=null==(t=eb(t,e=jd(e,t)))?t:t[Dd(Sv(e))];return null==i?void 0:ql(i,t,n)}var ib=_c(nb),rb=_c((function(t,e,n){var i=-1,r="function"==typeof e,o=xc(t)?Array(t.length):[];return Wg(t,(function(t){o[++i]=r?ql(e,t,n):nb(t,e,n)})),o})),ob="[object ArrayBuffer]";var ab=Jc&&Jc.isArrayBuffer,sb=ab?Gc(ab):function(t){return Gs(t)&&Fs(t)==ob},lb="[object Boolean]";var ub="[object Date]";var cb=Jc&&Jc.isDate,db=cb?Gc(cb):function(t){return Gs(t)&&Fs(t)==ub};var fb="[object Map]",pb="[object Set]",hb=Object.prototype.hasOwnProperty;var gb=Cs.isFinite;function vb(t){return"number"==typeof t&&t==vl(t)}var yb="[object Number]";function bb(t){return"number"==typeof t||Gs(t)&&Fs(t)==yb}var mb=xl?Ol:Lc,Eb="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";var wb="[object RegExp]";var _b=Jc&&Jc.isRegExp,Ob=_b?Gc(_b):function(t){return Gs(t)&&Fs(t)==wb},Tb=9007199254740991;var xb="[object WeakMap]";var Ab="[object WeakSet]";var Sb=1;var Ib=Array.prototype.join;var kb=lp((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Pb=Xg((function(t,e,n){gc(t,n,e)}));var Nb=Math.max,Cb=Math.min;var jb=lp((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Mb=Sf("toLowerCase");function Db(t,e){return t<e}var Rb=ky(Db),Lb=ky((function(t,e){return t<=e}));var Yb=1;var Vb=1;function Bb(t,e,n){for(var i=-1,r=t.length;++i<r;){var o=t[i],a=e(o);if(null!=a&&(void 0===s?a==a&&!Us(a):n(a,s)))var s=a,l=o}return l}function $b(t,e){for(var n,i=-1,r=t.length;++i<r;){var o=e(t[i]);void 0!==o&&(n=void 0===n?o:n+o)}return n}var Fb=NaN;function Gb(t,e){var n=null==t?0:t.length;return n?$b(t,e)/n:Fb}var qb=Sc((function(t,e,n){gv(t,e,n)})),Ub=_c((function(t,e){return function(n){return nb(n,t,e)}})),zb=_c((function(t,e){return function(n){return nb(t,n,e)}}));function Jb(t,e,n){var i=nd(e),r=xy(e,i),o=!(al(n)&&"chain"in n&&!n.chain),a=Ol(t);return wu(r,(function(n){var i=e[n];t[n]=i,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=ru(this.__actions__)).push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,Vd([this.value()],arguments))})})),t}var Wb=tl((function(t,e){return t*e}),1),Hb="Expected a function";function Xb(t){if("function"!=typeof t)throw new TypeError(Hb);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}var Zb="[object Map]",Kb="[object Set]",Qb=js?js.iterator:void 0;function tm(t){if(!t)return[];if(xc(t))return Ly(t)?Af(t):ru(t);if(Qb&&t[Qb])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Qb]());var e=Hp(t);return(e==Zb?Kh:e==Kb?Qh:Vy)(t)}function em(t,e){var n=t.length;if(n)return Yu(e+=e<0?n:0,n)?t[e]:void 0}function nm(t,e){return null==(t=eb(t,e=jd(e,t)))||delete t[Dd(Sv(e))]}function im(t){return Qd(t)?void 0:t}var rm=qd((function(t,e){var n={};if(null==t)return n;var i=!1;e=Ws(e,(function(e){return e=jd(e,t),i||(i=e.length>1),e})),mc(t,Mp(t),n),i&&(n=Yh(n,7,im));for(var r=e.length;r--;)nm(n,e[r]);return n}));function om(t,e,n,i){if(!al(t))return t;for(var r=-1,o=(e=jd(e,t)).length,a=o-1,s=t;null!=s&&++r<o;){var l=Dd(e[r]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(r!=a){var c=s[l];void 0===(u=i?i(c,l,s):void 0)&&(u=al(c)?c:Yu(e[r+1])?[]:{})}bc(s,l,u),s=s[l]}return t}function am(t,e,n){for(var i=-1,r=e.length,o={};++i<r;){var a=e[i],s=Rd(t,a);n(s,a)&&om(o,jd(a,t),s)}return o}function sm(t,e){if(null==t)return{};var n=Ws(Mp(t),(function(t){return[t]}));return e=Vg(e),am(t,n,(function(t,n){return e(t,n[0])}))}function lm(t,e){if(t!==e){var n=void 0!==t,i=null===t,r=t==t,o=Us(t),a=void 0!==e,s=null===e,l=e==e,u=Us(e);if(!s&&!u&&!o&&t>e||o&&a&&l&&!s&&!u||i&&a&&l||!n&&l||!r)return 1;if(!i&&!o&&!u&&t<e||u&&n&&r&&!i&&!o||s&&n&&r||!a&&r||!l)return-1}return 0}function um(t,e,n){e=e.length?Ws(e,(function(t){return Hs(t)?function(e){return Rd(e,1===t.length?t[0]:t)}:t})):[bl];var i=-1;e=Ws(e,Gc(Vg));var r=dy(t,(function(t,n,r){var o=Ws(e,(function(e){return e(t)}));return{criteria:o,index:++i,value:t}}));return function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(r,(function(t,e){return function(t,e,n){for(var i=-1,r=t.criteria,o=e.criteria,a=r.length,s=n.length;++i<a;){var l=lm(r[i],o[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return t.index-e.index}(t,e,n)}))}function cm(t){return qd((function(e){return e=Ws(e,Gc(Vg)),_c((function(n){var i=this;return t(e,(function(t){return ql(t,i,n)}))}))}))}var dm=cm(Ws),fm=_c,pm=Math.min,hm=fm((function(t,e){var n=(e=1==e.length&&Hs(e[0])?Ws(e[0],Gc(Vg)):Ws(Fd(e,1),Gc(Vg))).length;return _c((function(i){for(var r=-1,o=pm(i.length,n);++r<o;)i[r]=e[r].call(this,i[r]);return ql(t,this,i)}))})),gm=cm(Xv),vm=cm(Jh),ym=9007199254740991,bm=Math.floor;function mm(t,e){var n="";if(!t||e<1||e>ym)return n;do{e%2&&(n+=t),(e=bm(e/2))&&(t+=t)}while(e);return n}var Em=Lg("length"),wm="\\ud800-\\udfff",_m="["+wm+"]",Om="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Tm="\\ud83c[\\udffb-\\udfff]",xm="[^"+wm+"]",Am="(?:\\ud83c[\\udde6-\\uddff]){2}",Sm="[\\ud800-\\udbff][\\udc00-\\udfff]",Im="(?:"+Om+"|"+Tm+")"+"?",km="[\\ufe0e\\ufe0f]?",Pm=km+Im+("(?:\\u200d(?:"+[xm,Am,Sm].join("|")+")"+km+Im+")*"),Nm="(?:"+[xm+Om+"?",Om,Am,Sm,_m].join("|")+")",Cm=RegExp(Tm+"(?="+Tm+")|"+Nm+Pm,"g");function jm(t){return pf(t)?function(t){for(var e=Cm.lastIndex=0;Cm.test(t);)++e;return e}(t):Em(t)}var Mm=Math.ceil;function Dm(t,e){var n=(e=void 0===e?" ":Qs(e)).length;if(n<2)return n?mm(e,t):e;var i=mm(e,Mm(t/jm(e)));return pf(e)?df(Af(i),0,t).join(""):i.slice(0,t)}var Rm=Math.ceil,Lm=Math.floor;var Ym=/^\s+/,Vm=Cs.parseInt;var Bm=_c((function(t,e){return fc(t,32,void 0,e,$u(e,Du(Bm)))}));Bm.placeholder={};var $m=_c((function(t,e){return fc(t,64,void 0,e,$u(e,Du($m)))}));$m.placeholder={};var Fm=Xg((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var Gm=qd((function(t,e){return null==t?{}:function(t,e){return am(t,e,(function(e,n){return jg(t,n)}))}(t,e)}));function qm(t,e,n,i){for(var r=n-1,o=t.length;++r<o;)if(i(t[r],e))return r;return-1}var Um=Array.prototype.splice;function zm(t,e,n,i){var r=i?qm:Tu,o=-1,a=e.length,s=t;for(t===e&&(e=ru(e)),n&&(s=Ws(t,Gc(n)));++o<a;)for(var l=0,u=e[o],c=n?n(u):u;(l=r(s,c,l,i))>-1;)s!==t&&Um.call(s,l,1),Um.call(t,l,1);return t}function Jm(t,e){return t&&t.length&&e&&e.length?zm(t,e):t}var Wm=_c(Jm);var Hm=Array.prototype.splice;function Xm(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(n==i||r!==o){var o=r;Yu(r)?Hm.call(t,r,1):nm(t,r)}}return t}var Zm=qd((function(t,e){var n=null==t?0:t.length,i=Yd(t,e);return Xm(t,Ws(e,(function(t){return Yu(t,n)?+t:t})).sort(lm)),i})),Km=Math.floor,Qm=Math.random;function tE(t,e){return t+Km(Qm()*(e-t+1))}var eE=parseFloat,nE=Math.min,iE=Math.random;var rE=Math.ceil,oE=Math.max;function aE(t){return function(e,n,i){return i&&"number"!=typeof i&&Ac(e,n,i)&&(n=i=void 0),e=gl(e),void 0===n?(n=e,e=0):n=gl(n),function(t,e,n,i){for(var r=-1,o=oE(rE((e-t)/(n||1)),0),a=Array(o);o--;)a[i?o:++r]=t,t+=n;return a}(e,n,i=void 0===i?e<n?1:-1:gl(i),t)}}var sE=aE(),lE=aE(!0),uE=qd((function(t,e){return fc(t,256,void 0,void 0,void 0,e)}));function cE(t,e,n,i,r){return r(t,(function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)})),n}function dE(t,e,n,i){var r=null==t?0:t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}var fE="Expected a function";var pE=Array.prototype.reverse;function hE(t){return null==t?t:pE.call(t)}var gE=fp("round");function vE(t){var e=t.length;return e?t[tE(0,e-1)]:void 0}function yE(t){return vE(Vy(t))}function bE(t,e){var n=-1,i=t.length,r=i-1;for(e=void 0===e?i:e;++n<e;){var o=tE(n,r),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}function mE(t,e){return bE(ru(t),yp(e,0,t.length))}function EE(t,e){var n=Vy(t);return bE(n,yp(e,0,n.length))}function wE(t){return bE(ru(t))}function _E(t){return bE(Vy(t))}var OE="[object Map]",TE="[object Set]";var xE=lp((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));function AE(t,e){var n;return Wg(t,(function(t,i,r){return!(n=e(t,i,r))})),!!n}var SE=_c((function(t,e){if(null==t)return[];var n=e.length;return n>1&&Ac(t,e[0],e[1])?e=[]:n>2&&Ac(e[0],e[1],e[2])&&(e=[e[0]]),um(t,Fd(e,1),[])})),IE=4294967294,kE=Math.floor,PE=Math.min;function NE(t,e,n,i){var r=0,o=null==t?0:t.length;if(0===o)return 0;for(var a=(e=n(e))!=e,s=null===e,l=Us(e),u=void 0===e;r<o;){var c=kE((r+o)/2),d=n(t[c]),f=void 0!==d,p=null===d,h=d==d,g=Us(d);if(a)var v=i||h;else v=u?h&&(i||f):s?h&&f&&(i||!p):l?h&&f&&!p&&(i||!g):!p&&!g&&(i?d<=e:d<e);v?r=c+1:o=c}return PE(o,IE)}var CE=2147483647;function jE(t,e,n){var i=0,r=null==t?i:t.length;if("number"==typeof e&&e==e&&r<=CE){for(;i<r;){var o=i+r>>>1,a=t[o];null!==a&&!Us(a)&&(n?a<=e:a<e)?i=o+1:r=o}return r}return NE(t,e,bl,n)}function ME(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var a=t[n],s=e?e(a):a;if(!n||!vc(s,l)){var l=s;o[r++]=0===a?0:a}}return o}var DE=4294967295;var RE="Expected a function",LE=Math.max;var YE=lp((function(t,e,n){return t+(n?" ":"")+If(e)}));var VE=tl((function(t,e){return t-e}),0);var BE=Object.prototype,$E=BE.hasOwnProperty;function FE(t,e,n,i){return void 0===t||vc(t,BE[n])&&!$E.call(i,n)?e:t}var GE={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function qE(t){return"\\"+GE[t]}var UE=/<%=([\s\S]+?)%>/g,zE={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:UE,variable:"",imports:{_:{escape:Jv}}},JE="Invalid `variable` option passed into `_.template`",WE=/\b__p \+= '';/g,HE=/\b(__p \+=) '' \+/g,XE=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ZE=/[()=,{}\[\]\/\s]/,KE=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,QE=/($^)/,tw=/['\n\r\u2028\u2029\\]/g,ew=Object.prototype.hasOwnProperty;var nw="Expected a function";function iw(t,e){return e(t)}var rw=9007199254740991,ow=4294967295,aw=Math.min;function sw(t,e){var n=t;return n instanceof Zl&&(n=n.value()),Pf(e,(function(t,e){return e.func.apply(e.thisArg,Vd([t],e.args))}),n)}function lw(){return sw(this.__wrapped__,this.__actions__)}var uw=9007199254740991;function cw(t,e){for(var n=t.length;n--&&Tu(e,t[n],0)>-1;);return n}function dw(t,e){for(var n=-1,i=t.length;++n<i&&Tu(e,t[n],0)>-1;);return n}var fw=/^\s+/;var pw=30,hw="...",gw=/\w*$/;var vw=Nf({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),yw=/&(?:amp|lt|gt|quot|#39);/g,bw=RegExp(yw.source);var mw=Lp&&1/Qh(new Lp([,-0]))[1]==1/0?function(t){return new Lp(t)}:Kl,Ew=200;function ww(t,e,n){var i=-1,r=xu,o=t.length,a=!0,s=[],l=s;if(n)a=!1,r=Ov;else if(o>=Ew){var u=e?null:mw(t);if(u)return Qh(u);a=!1,r=Wh,l=new zh}else l=e?[]:s;t:for(;++i<o;){var c=t[i],d=e?e(c):c;if(c=n||0!==c?c:0,a&&d==d){for(var f=l.length;f--;)if(l[f]===d)continue t;e&&l.push(d),s.push(c)}else r(l,d,n)||(l!==s&&l.push(d),s.push(c))}return s}var _w=_c((function(t){return ww(Fd(t,1,fv,!0))})),Ow=_c((function(t){var e=Sv(t);return fv(e)&&(e=void 0),ww(Fd(t,1,fv,!0),Vg(e))})),Tw=_c((function(t){var e=Sv(t);return e="function"==typeof e?e:void 0,ww(Fd(t,1,fv,!0),void 0,e)}));var xw=0;var Aw=Math.max;function Sw(t){if(!t||!t.length)return[];var e=0;return t=Ap(t,(function(t){if(fv(t))return e=Aw(t.length,e),!0})),Pc(e,(function(e){return Ws(t,Lg(e))}))}function Iw(t,e){if(!t||!t.length)return[];var n=Sw(t);return null==e?n:Ws(n,(function(t){return ql(e,void 0,t)}))}function kw(t,e,n,i){return om(t,e,n(Rd(t,e)),i)}var Pw=lp((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}));var Nw=_c((function(t,e){return fv(t)?xv(t,e):[]}));var Cw=qd((function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,r=function(e){return Yd(e,t)};return!(e>1||this.__actions__.length)&&i instanceof Zl&&Yu(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:iw,args:[r],thisArg:void 0}),new iu(i,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(r)}));function jw(t,e,n){var i=t.length;if(i<2)return i?ww(t[0]):[];for(var r=-1,o=Array(i);++r<i;)for(var a=t[r],s=-1;++s<i;)s!=r&&(o[r]=xv(o[r]||a,t[s],e,n));return ww(Fd(o,1),e,n)}var Mw=_c((function(t){return jw(Ap(t,fv))})),Dw=_c((function(t){var e=Sv(t);return fv(e)&&(e=void 0),jw(Ap(t,fv),Vg(e))})),Rw=_c((function(t){var e=Sv(t);return e="function"==typeof e?e:void 0,jw(Ap(t,fv),void 0,e)})),Lw=_c(Sw);function Yw(t,e,n){for(var i=-1,r=t.length,o=e.length,a={};++i<r;){var s=i<o?e[i]:void 0;n(a,t[i],s)}return a}var Vw=_c((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,Iw(t,n)})),Bw={chunk:function(t,e,n){e=(n?Ac(t,e,n):void 0===e)?1:vp(vl(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var r=0,o=0,a=Array(gp(i/e));r<i;)a[o++]=cf(t,r,r+=e);return a},compact:function(t){for(var e=-1,n=null==t?0:t.length,i=0,r=[];++e<n;){var o=t[e];o&&(r[i++]=o)}return r},concat:function(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return Vd(Hs(n)?ru(n):[n],Fd(e,1))},difference:Av,differenceBy:Iv,differenceWith:kv,drop:function(t,e,n){var i=null==t?0:t.length;return i?cf(t,(e=n||void 0===e?1:vl(e))<0?0:e,i):[]},dropRight:function(t,e,n){var i=null==t?0:t.length;return i?cf(t,0,(e=i-(e=n||void 0===e?1:vl(e)))<0?0:e):[]},dropRightWhile:function(t,e){return t&&t.length?Nv(t,Vg(e),!0,!0):[]},dropWhile:function(t,e){return t&&t.length?Nv(t,Vg(e),!0):[]},fill:function(t,e,n,i){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&Ac(t,e,n)&&(n=0,i=r),function(t,e,n,i){var r=t.length;for((n=vl(n))<0&&(n=-n>r?0:r+n),(i=void 0===i||i>r?r:vl(i))<0&&(i+=r),i=n>i?0:Qv(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},findIndex:iy,findLastIndex:ly,first:cy,flatten:Gd,flattenDeep:function(t){return(null==t?0:t.length)?Fd(t,hy):[]},flattenDepth:function(t,e){return(null==t?0:t.length)?Fd(t,e=void 0===e?1:vl(e)):[]},fromPairs:function(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i},head:cy,indexOf:function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:vl(n);return r<0&&(r=$y(i+r,0)),Tu(t,e,r)},initial:function(t){return(null==t?0:t.length)?cf(t,0,-1):[]},intersection:Uy,intersectionBy:zy,intersectionWith:Jy,join:function(t,e){return null==t?"":Ib.call(t,e)},last:Sv,lastIndexOf:function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=i;return void 0!==n&&(r=(r=vl(n))<0?Nb(i+r,0):Cb(r,i-1)),e==e?function(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}(t,e,r):_u(t,Ou,r,!0)},nth:function(t,e){return t&&t.length?em(t,vl(e)):void 0},pull:Wm,pullAll:Jm,pullAllBy:function(t,e,n){return t&&t.length&&e&&e.length?zm(t,e,Vg(n)):t},pullAllWith:function(t,e,n){return t&&t.length&&e&&e.length?zm(t,e,void 0,n):t},pullAt:Zm,remove:function(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],o=t.length;for(e=Vg(e);++i<o;){var a=t[i];e(a,i,t)&&(n.push(a),r.push(i))}return Xm(t,r),n},reverse:hE,slice:function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Ac(t,e,n)?(e=0,n=i):(e=null==e?0:vl(e),n=void 0===n?i:vl(n)),cf(t,e,n)):[]},sortedIndex:function(t,e){return jE(t,e)},sortedIndexBy:function(t,e,n){return NE(t,e,Vg(n))},sortedIndexOf:function(t,e){var n=null==t?0:t.length;if(n){var i=jE(t,e);if(i<n&&vc(t[i],e))return i}return-1},sortedLastIndex:function(t,e){return jE(t,e,!0)},sortedLastIndexBy:function(t,e,n){return NE(t,e,Vg(n),!0)},sortedLastIndexOf:function(t,e){if(null==t?0:t.length){var n=jE(t,e,!0)-1;if(vc(t[n],e))return n}return-1},sortedUniq:function(t){return t&&t.length?ME(t):[]},sortedUniqBy:function(t,e){return t&&t.length?ME(t,Vg(e)):[]},tail:function(t){var e=null==t?0:t.length;return e?cf(t,1,e):[]},take:function(t,e,n){return t&&t.length?cf(t,0,(e=n||void 0===e?1:vl(e))<0?0:e):[]},takeRight:function(t,e,n){var i=null==t?0:t.length;return i?cf(t,(e=i-(e=n||void 0===e?1:vl(e)))<0?0:e,i):[]},takeRightWhile:function(t,e){return t&&t.length?Nv(t,Vg(e),!1,!0):[]},takeWhile:function(t,e){return t&&t.length?Nv(t,Vg(e)):[]},union:_w,unionBy:Ow,unionWith:Tw,uniq:function(t){return t&&t.length?ww(t):[]},uniqBy:function(t,e){return t&&t.length?ww(t,Vg(e)):[]},uniqWith:function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?ww(t,void 0,e):[]},unzip:Sw,unzipWith:Iw,without:Nw,xor:Mw,xorBy:Dw,xorWith:Rw,zip:Lw,zipObject:function(t,e){return Yw(t||[],e||[],bc)},zipObjectDeep:function(t,e){return Yw(t||[],e||[],om)},zipWith:Vw},$w={countBy:Kg,each:jv,eachRight:Yv,every:function(t,e,n){var i=Hs(t)?Xv:Zv;return n&&Ac(t,e,n)&&(e=void 0),i(t,Vg(e))},filter:function(t,e){return(Hs(t)?Ap:ty)(t,Vg(e))},find:ry,findLast:uy,flatMap:function(t,e){return Fd(fy(t,e),1)},flatMapDeep:function(t,e){return Fd(fy(t,e),py)},flatMapDepth:function(t,e,n){return n=void 0===n?1:vl(n),Fd(fy(t,e),n)},forEach:jv,forEachRight:Yv,groupBy:Sy,includes:function(t,e,n,i){t=xc(t)?t:Vy(t),n=n&&!i?vl(n):0;var r=t.length;return n<0&&(n=By(r+n,0)),Ly(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&Tu(t,e,n)>-1},invokeMap:rb,keyBy:Pb,map:fy,orderBy:function(t,e,n,i){return null==t?[]:(Hs(e)||(e=null==e?[]:[e]),Hs(n=i?void 0:n)||(n=null==n?[]:[n]),um(t,e,n))},partition:Fm,reduce:function(t,e,n){var i=Hs(t)?Pf:cE,r=arguments.length<3;return i(t,Vg(e),n,r,Wg)},reduceRight:function(t,e,n){var i=Hs(t)?dE:cE,r=arguments.length<3;return i(t,Vg(e),n,r,Lv)},reject:function(t,e){return(Hs(t)?Ap:ty)(t,Xb(Vg(e)))},sample:function(t){return(Hs(t)?vE:yE)(t)},sampleSize:function(t,e,n){return e=(n?Ac(t,e,n):void 0===e)?1:vl(e),(Hs(t)?mE:EE)(t,e)},shuffle:function(t){return(Hs(t)?wE:_E)(t)},size:function(t){if(null==t)return 0;if(xc(t))return Ly(t)?jm(t):t.length;var e=Hp(t);return e==OE||e==TE?t.size:ed(t).length},some:function(t,e,n){var i=Hs(t)?Jh:AE;return n&&Ac(t,e,n)&&(e=void 0),i(t,Vg(e))},sortBy:SE},Fw={now:iv},Gw={after:function(t,e){if("function"!=typeof e)throw new TypeError(yl);return t=vl(t),function(){if(--t<1)return e.apply(this,arguments)}},ary:hc,before:af,bind:sf,bindKey:uf,curry:tv,curryRight:nv,debounce:sv,defer:wv,delay:_v,flip:function(t){return fc(t,gy)},memoize:Sd,negate:Xb,once:function(t){return af(2,t)},overArgs:hm,partial:Bm,partialRight:$m,rearg:uE,rest:function(t,e){if("function"!=typeof t)throw new TypeError(fE);return _c(t,e=void 0===e?e:vl(e))},spread:function(t,e){if("function"!=typeof t)throw new TypeError(RE);return e=null==e?0:LE(vl(e),0),_c((function(n){var i=n[e],r=df(n,0,e);return i&&Vd(r,i),ql(t,this,r)}))},throttle:function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new TypeError(nw);return al(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),sv(t,e,{leading:i,maxWait:e,trailing:r})},unary:function(t){return hc(t,1)},wrap:function(t,e){return Bm(Cv(e),t)}},qw={castArray:function(){if(!arguments.length)return[];var t=arguments[0];return Hs(t)?t:[t]},clone:function(t){return Yh(t,Vh)},cloneDeep:function(t){return Yh(t,Bh|$h)},cloneDeepWith:function(t,e){return Yh(t,Fh|Gh,e="function"==typeof e?e:void 0)},cloneWith:function(t,e){return Yh(t,qh,e="function"==typeof e?e:void 0)},conformsTo:function(t,e){return null==e||$g(t,e,nd(e))},eq:vc,gt:Py,gte:Ny,isArguments:Rc,isArray:Hs,isArrayBuffer:sb,isArrayLike:xc,isArrayLikeObject:fv,isBoolean:function(t){return!0===t||!1===t||Gs(t)&&Fs(t)==lb},isBuffer:$c,isDate:db,isElement:function(t){return Gs(t)&&1===t.nodeType&&!Qd(t)},isEmpty:function(t){if(null==t)return!0;if(xc(t)&&(Hs(t)||"string"==typeof t||"function"==typeof t.splice||$c(t)||Hc(t)||Rc(t)))return!t.length;var e=Hp(t);if(e==fb||e==pb)return!t.size;if(kc(t))return!ed(t).length;for(var n in t)if(hb.call(t,n))return!1;return!0},isEqual:function(t,e){return Og(t,e)},isEqualWith:function(t,e,n){var i=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===i?Og(t,e,void 0,n):!!i},isError:nf,isFinite:function(t){return"number"==typeof t&&gb(t)},isFunction:Ol,isInteger:vb,isLength:Tc,isMap:Ah,isMatch:function(t,e){return t===e||Ag(t,e,Ig(e))},isMatchWith:function(t,e,n){return n="function"==typeof n?n:void 0,Ag(t,e,Ig(e),n)},isNaN:function(t){return bb(t)&&t!=+t},isNative:function(t){if(mb(t))throw new Error(Eb);return Dl(t)},isNil:function(t){return null==t},isNull:function(t){return null===t},isNumber:bb,isObject:al,isObjectLike:Gs,isPlainObject:Qd,isRegExp:Ob,isSafeInteger:function(t){return vb(t)&&t>=-Tb&&t<=Tb},isSet:kh,isString:Ly,isSymbol:Us,isTypedArray:Hc,isUndefined:function(t){return void 0===t},isWeakMap:function(t){return Gs(t)&&Hp(t)==xb},isWeakSet:function(t){return Gs(t)&&Fs(t)==Ab},lt:Rb,lte:Lb,toArray:tm,toFinite:gl,toInteger:vl,toLength:Qv,toNumber:fl,toPlainObject:hv,toSafeInteger:function(t){return t?yp(vl(t),-uw,uw):0===t?t:0},toString:Cd},Uw={add:el,ceil:pp,divide:Pv,floor:vy,max:function(t){return t&&t.length?Bb(t,bl,Iy):void 0},maxBy:function(t,e){return t&&t.length?Bb(t,Vg(e),Iy):void 0},mean:function(t){return Gb(t,bl)},meanBy:function(t,e){return Gb(t,Vg(e))},min:function(t){return t&&t.length?Bb(t,bl,Db):void 0},minBy:function(t,e){return t&&t.length?Bb(t,Vg(e),Db):void 0},multiply:Wb,round:gE,subtract:VE,sum:function(t){return t&&t.length?$b(t,bl):0},sumBy:function(t,e){return t&&t.length?$b(t,Vg(e)):0}},zw=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=fl(n))==n?n:0),void 0!==e&&(e=(e=fl(e))==e?e:0),yp(fl(t),e,n)},Jw=function(t,e,n){return e=gl(e),void 0===n?(n=e,e=0):n=gl(n),function(t,e,n){return t>=Dy(e,n)&&t<My(e,n)}(t=fl(t),e,n)},Ww=function(t,e,n){if(n&&"boolean"!=typeof n&&Ac(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=gl(t),void 0===e?(e=t,t=0):e=gl(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var r=iE();return nE(t+r*(e-t+eE("1e-"+((r+"").length-1))),e)}return tE(t,e)},Hw={assign:rd,assignIn:ld,assignInWith:ud,assignWith:cd,at:Ud,create:function(t,e){var n=$l(t);return null==e?n:Ep(n,e)},defaults:cv,defaultsDeep:bv,entries:Fv,entriesIn:Gv,extend:ld,extendWith:ud,findKey:function(t,e){return oy(t,Vg(e),zg)},findLastKey:function(t,e){return oy(t,Vg(e),Rv)},forIn:function(t,e){return null==t?t:Ug(t,Cv(e),sd)},forInRight:function(t,e){return null==t?t:Dv(t,Cv(e),sd)},forOwn:function(t,e){return t&&zg(t,Cv(e))},forOwnRight:function(t,e){return t&&Rv(t,Cv(e))},functions:function(t){return null==t?[]:xy(t,nd(t))},functionsIn:function(t){return null==t?[]:xy(t,sd(t))},get:Ld,has:function(t,e){return null!=t&&Cg(t,e,jy)},hasIn:jg,invert:Xy,invertBy:tb,invoke:ib,keys:nd,keysIn:sd,mapKeys:function(t,e){var n={};return e=Vg(e),zg(t,(function(t,i,r){gc(n,e(t,i,r),t)})),n},mapValues:function(t,e){var n={};return e=Vg(e),zg(t,(function(t,i,r){gc(n,i,e(t,i,r))})),n},merge:qb,mergeWith:yv,omit:rm,omitBy:function(t,e){return sm(t,Xb(Vg(e)))},pick:Gm,pickBy:sm,result:function(t,e,n){var i=-1,r=(e=jd(e,t)).length;for(r||(r=1,t=void 0);++i<r;){var o=null==t?void 0:t[Dd(e[i])];void 0===o&&(i=r,o=n),t=Ol(o)?o.call(t):o}return t},set:function(t,e,n){return null==t?t:om(t,e,n)},setWith:function(t,e,n,i){return i="function"==typeof i?i:void 0,null==t?t:om(t,e,n,i)},toPairs:Fv,toPairsIn:Gv,transform:function(t,e,n){var i=Hs(t),r=i||$c(t)||Hc(t);if(e=Vg(e),null==n){var o=t&&t.constructor;n=r?i?new o:[]:al(t)&&Ol(o)?$l(zd(t)):{}}return(r?wu:zg)(t,(function(t,i,r){return e(n,t,i,r)})),n},unset:function(t,e){return null==t||nm(t,e)},update:function(t,e,n){return null==t?t:kw(t,e,Cv(n))},updateWith:function(t,e,n,i){return i="function"==typeof i?i:void 0,null==t?t:kw(t,e,Cv(n),i)},values:Vy,valuesIn:function(t){return null==t?[]:Yy(t,sd(t))}},Xw={at:Cw,chain:hp,commit:function(){return new iu(this.value(),this.__chain__)},lodash:su,next:function(){void 0===this.__values__&&(this.__values__=tm(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},plant:function(t){for(var e,n=this;n instanceof Hl;){var i=ou(n);i.__index__=0,i.__values__=void 0,e?r.__wrapped__=i:e=i;var r=i;n=n.__wrapped__}return r.__wrapped__=t,e},reverse:function(){var t=this.__wrapped__;if(t instanceof Zl){var e=t;return this.__actions__.length&&(e=new Zl(this)),(e=e.reverse()).__actions__.push({func:iw,args:[hE],thisArg:void 0}),new iu(e,this.__chain__)}return this.thru(hE)},tap:function(t,e){return e(t),t},thru:iw,toIterator:function(){return this},toJSON:lw,value:lw,valueOf:lw,wrapperChain:function(){return hp(this)}},Zw={camelCase:up,capitalize:kf,deburr:Df,endsWith:function(t,e,n){t=Cd(t),e=Qs(e);var i=t.length,r=n=void 0===n?i:yp(vl(n),0,i);return(n-=e.length)>=0&&t.slice(n,r)==e},escape:Jv,escapeRegExp:function(t){return(t=Cd(t))&&Hv.test(t)?t.replace(Wv,"\\$&"):t},kebabCase:kb,lowerCase:jb,lowerFirst:Mb,pad:function(t,e,n){t=Cd(t);var i=(e=vl(e))?jm(t):0;if(!e||i>=e)return t;var r=(e-i)/2;return Dm(Lm(r),n)+t+Dm(Rm(r),n)},padEnd:function(t,e,n){t=Cd(t);var i=(e=vl(e))?jm(t):0;return e&&i<e?t+Dm(e-i,n):t},padStart:function(t,e,n){t=Cd(t);var i=(e=vl(e))?jm(t):0;return e&&i<e?Dm(e-i,n)+t:t},parseInt:function(t,e,n){return n||null==e?e=0:e&&(e=+e),Vm(Cd(t).replace(Ym,""),e||0)},repeat:function(t,e,n){return e=(n?Ac(t,e,n):void 0===e)?1:vl(e),mm(Cd(t),e)},replace:function(){var t=arguments,e=Cd(t[0]);return t.length<3?e:e.replace(t[1],t[2])},snakeCase:xE,split:function(t,e,n){return n&&"number"!=typeof n&&Ac(t,e,n)&&(e=n=void 0),(n=void 0===n?DE:n>>>0)?(t=Cd(t))&&("string"==typeof e||null!=e&&!Ob(e))&&!(e=Qs(e))&&pf(t)?df(Af(t),0,n):t.split(e,n):[]},startCase:YE,startsWith:function(t,e,n){return t=Cd(t),n=null==n?0:yp(vl(n),0,t.length),e=Qs(e),t.slice(n,n+e.length)==e},template:function(t,e,n){var i=zE.imports._.templateSettings||zE;n&&Ac(t,e,n)&&(e=void 0),t=Cd(t),e=ud({},e,i,FE);var r,o,a=ud({},e.imports,i.imports,FE),s=nd(a),l=Yy(a,s),u=0,c=e.interpolate||QE,d="__p += '",f=RegExp((e.escape||QE).source+"|"+c.source+"|"+(c===UE?KE:QE).source+"|"+(e.evaluate||QE).source+"|$","g"),p=ew.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+"\n":"";t.replace(f,(function(e,n,i,a,s,l){return i||(i=a),d+=t.slice(u,l).replace(tw,qE),n&&(r=!0,d+="' +\n__e("+n+") +\n'"),s&&(o=!0,d+="';\n"+s+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+e.length,e})),d+="';\n";var h=ew.call(e,"variable")&&e.variable;if(h){if(ZE.test(h))throw new Error(JE)}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(WE,""):d).replace(HE,"$1").replace(XE,"$1;"),d="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=rf((function(){return Function(s,p+"return "+d).apply(void 0,l)}));if(g.source=d,nf(g))throw g;return g},templateSettings:zE,toLower:function(t){return Cd(t).toLowerCase()},toUpper:function(t){return Cd(t).toUpperCase()},trim:function(t,e,n){if((t=Cd(t))&&(n||void 0===e))return ol(t);if(!t||!(e=Qs(e)))return t;var i=Af(t),r=Af(e);return df(i,dw(i,r),cw(i,r)+1).join("")},trimEnd:function(t,e,n){if((t=Cd(t))&&(n||void 0===e))return t.slice(0,il(t)+1);if(!t||!(e=Qs(e)))return t;var i=Af(t);return df(i,0,cw(i,Af(e))+1).join("")},trimStart:function(t,e,n){if((t=Cd(t))&&(n||void 0===e))return t.replace(fw,"");if(!t||!(e=Qs(e)))return t;var i=Af(t);return df(i,dw(i,Af(e))).join("")},truncate:function(t,e){var n=pw,i=hw;if(al(e)){var r="separator"in e?e.separator:r;n="length"in e?vl(e.length):n,i="omission"in e?Qs(e.omission):i}var o=(t=Cd(t)).length;if(pf(t)){var a=Af(t);o=a.length}if(n>=o)return t;var s=n-jm(i);if(s<1)return i;var l=a?df(a,0,s).join(""):t.slice(0,s);if(void 0===r)return l+i;if(a&&(s+=l.length-s),Ob(r)){if(t.slice(s).search(r)){var u,c=l;for(r.global||(r=RegExp(r.source,Cd(gw.exec(r))+"g")),r.lastIndex=0;u=r.exec(c);)var d=u.index;l=l.slice(0,void 0===d?s:d)}}else if(t.indexOf(Qs(r),s)!=s){var f=l.lastIndexOf(r);f>-1&&(l=l.slice(0,f))}return l+i},unescape:function(t){return(t=Cd(t))&&bw.test(t)?t.replace(yw,vw):t},upperCase:Pw,upperFirst:If,words:ap},Kw={attempt:rf,bindAll:lf,cond:function(t){var e=null==t?0:t.length,n=Vg;return t=e?Ws(t,(function(t){if("function"!=typeof t[1])throw new TypeError(Bg);return[n(t[0]),t[1]]})):[],_c((function(n){for(var i=-1;++i<e;){var r=t[i];if(ql(r[0],this,n))return ql(r[1],this,n)}}))},conforms:function(t){return function(t){var e=nd(t);return function(n){return $g(n,t,e)}}(Yh(t,Fg))},constant:yu,defaultTo:function(t,e){return null==t||t!=t?e:t},flow:Oy,flowRight:Ty,identity:bl,iteratee:function(t){return Vg("function"==typeof t?t:Yh(t,Sb))},matches:function(t){return Pg(Yh(t,Yb))},matchesProperty:function(t,e){return Rg(t,Yh(e,Vb))},method:Ub,methodOf:zb,mixin:Jb,noop:Kl,nthArg:function(t){return t=vl(t),_c((function(e){return em(e,t)}))},over:dm,overEvery:gm,overSome:vm,property:Yg,propertyOf:function(t){return function(e){return null==t?void 0:Rd(t,e)}},range:sE,rangeRight:lE,stubArray:Sp,stubFalse:Lc,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(t,e){if((t=vl(t))<1||t>rw)return[];var n=ow,i=aw(t,ow);e=Cv(e),t-=ow;for(var r=Pc(i,e);++n<t;)e(n);return r},toPath:function(t){return Hs(t)?Ws(t,Dd):Us(t)?[t]:ru(Nd(Cd(t)))},uniqueId:function(t){var e=++xw;return Cd(t)+e}};var Qw=Math.max,t_=Math.min;var e_=1,n_=2,i_=Math.min;
/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var r_,o_=4294967295,a_=Array.prototype,s_=Object.prototype.hasOwnProperty,l_=js?js.iterator:void 0,u_=Math.max,c_=Math.min,d_=function(t){return function(e,n,i){if(null==i){var r=al(n),o=r&&nd(n),a=o&&o.length&&xy(n,o);(a?a.length:r)||(i=n,n=e,e=this)}return t(e,n,i)}}(Jb);su.after=Gw.after,su.ary=Gw.ary,su.assign=Hw.assign,su.assignIn=Hw.assignIn,su.assignInWith=Hw.assignInWith,su.assignWith=Hw.assignWith,su.at=Hw.at,su.before=Gw.before,su.bind=Gw.bind,su.bindAll=Kw.bindAll,su.bindKey=Gw.bindKey,su.castArray=qw.castArray,su.chain=Xw.chain,su.chunk=Bw.chunk,su.compact=Bw.compact,su.concat=Bw.concat,su.cond=Kw.cond,su.conforms=Kw.conforms,su.constant=Kw.constant,su.countBy=$w.countBy,su.create=Hw.create,su.curry=Gw.curry,su.curryRight=Gw.curryRight,su.debounce=Gw.debounce,su.defaults=Hw.defaults,su.defaultsDeep=Hw.defaultsDeep,su.defer=Gw.defer,su.delay=Gw.delay,su.difference=Bw.difference,su.differenceBy=Bw.differenceBy,su.differenceWith=Bw.differenceWith,su.drop=Bw.drop,su.dropRight=Bw.dropRight,su.dropRightWhile=Bw.dropRightWhile,su.dropWhile=Bw.dropWhile,su.fill=Bw.fill,su.filter=$w.filter,su.flatMap=$w.flatMap,su.flatMapDeep=$w.flatMapDeep,su.flatMapDepth=$w.flatMapDepth,su.flatten=Bw.flatten,su.flattenDeep=Bw.flattenDeep,su.flattenDepth=Bw.flattenDepth,su.flip=Gw.flip,su.flow=Kw.flow,su.flowRight=Kw.flowRight,su.fromPairs=Bw.fromPairs,su.functions=Hw.functions,su.functionsIn=Hw.functionsIn,su.groupBy=$w.groupBy,su.initial=Bw.initial,su.intersection=Bw.intersection,su.intersectionBy=Bw.intersectionBy,su.intersectionWith=Bw.intersectionWith,su.invert=Hw.invert,su.invertBy=Hw.invertBy,su.invokeMap=$w.invokeMap,su.iteratee=Kw.iteratee,su.keyBy=$w.keyBy,su.keys=nd,su.keysIn=Hw.keysIn,su.map=$w.map,su.mapKeys=Hw.mapKeys,su.mapValues=Hw.mapValues,su.matches=Kw.matches,su.matchesProperty=Kw.matchesProperty,su.memoize=Gw.memoize,su.merge=Hw.merge,su.mergeWith=Hw.mergeWith,su.method=Kw.method,su.methodOf=Kw.methodOf,su.mixin=d_,su.negate=Xb,su.nthArg=Kw.nthArg,su.omit=Hw.omit,su.omitBy=Hw.omitBy,su.once=Gw.once,su.orderBy=$w.orderBy,su.over=Kw.over,su.overArgs=Gw.overArgs,su.overEvery=Kw.overEvery,su.overSome=Kw.overSome,su.partial=Gw.partial,su.partialRight=Gw.partialRight,su.partition=$w.partition,su.pick=Hw.pick,su.pickBy=Hw.pickBy,su.property=Kw.property,su.propertyOf=Kw.propertyOf,su.pull=Bw.pull,su.pullAll=Bw.pullAll,su.pullAllBy=Bw.pullAllBy,su.pullAllWith=Bw.pullAllWith,su.pullAt=Bw.pullAt,su.range=Kw.range,su.rangeRight=Kw.rangeRight,su.rearg=Gw.rearg,su.reject=$w.reject,su.remove=Bw.remove,su.rest=Gw.rest,su.reverse=Bw.reverse,su.sampleSize=$w.sampleSize,su.set=Hw.set,su.setWith=Hw.setWith,su.shuffle=$w.shuffle,su.slice=Bw.slice,su.sortBy=$w.sortBy,su.sortedUniq=Bw.sortedUniq,su.sortedUniqBy=Bw.sortedUniqBy,su.split=Zw.split,su.spread=Gw.spread,su.tail=Bw.tail,su.take=Bw.take,su.takeRight=Bw.takeRight,su.takeRightWhile=Bw.takeRightWhile,su.takeWhile=Bw.takeWhile,su.tap=Xw.tap,su.throttle=Gw.throttle,su.thru=iw,su.toArray=qw.toArray,su.toPairs=Hw.toPairs,su.toPairsIn=Hw.toPairsIn,su.toPath=Kw.toPath,su.toPlainObject=qw.toPlainObject,su.transform=Hw.transform,su.unary=Gw.unary,su.union=Bw.union,su.unionBy=Bw.unionBy,su.unionWith=Bw.unionWith,su.uniq=Bw.uniq,su.uniqBy=Bw.uniqBy,su.uniqWith=Bw.uniqWith,su.unset=Hw.unset,su.unzip=Bw.unzip,su.unzipWith=Bw.unzipWith,su.update=Hw.update,su.updateWith=Hw.updateWith,su.values=Hw.values,su.valuesIn=Hw.valuesIn,su.without=Bw.without,su.words=Zw.words,su.wrap=Gw.wrap,su.xor=Bw.xor,su.xorBy=Bw.xorBy,su.xorWith=Bw.xorWith,su.zip=Bw.zip,su.zipObject=Bw.zipObject,su.zipObjectDeep=Bw.zipObjectDeep,su.zipWith=Bw.zipWith,su.entries=Hw.toPairs,su.entriesIn=Hw.toPairsIn,su.extend=Hw.assignIn,su.extendWith=Hw.assignInWith,d_(su,su),su.add=Uw.add,su.attempt=Kw.attempt,su.camelCase=Zw.camelCase,su.capitalize=Zw.capitalize,su.ceil=Uw.ceil,su.clamp=zw,su.clone=qw.clone,su.cloneDeep=qw.cloneDeep,su.cloneDeepWith=qw.cloneDeepWith,su.cloneWith=qw.cloneWith,su.conformsTo=qw.conformsTo,su.deburr=Zw.deburr,su.defaultTo=Kw.defaultTo,su.divide=Uw.divide,su.endsWith=Zw.endsWith,su.eq=qw.eq,su.escape=Zw.escape,su.escapeRegExp=Zw.escapeRegExp,su.every=$w.every,su.find=$w.find,su.findIndex=Bw.findIndex,su.findKey=Hw.findKey,su.findLast=$w.findLast,su.findLastIndex=Bw.findLastIndex,su.findLastKey=Hw.findLastKey,su.floor=Uw.floor,su.forEach=$w.forEach,su.forEachRight=$w.forEachRight,su.forIn=Hw.forIn,su.forInRight=Hw.forInRight,su.forOwn=Hw.forOwn,su.forOwnRight=Hw.forOwnRight,su.get=Hw.get,su.gt=qw.gt,su.gte=qw.gte,su.has=Hw.has,su.hasIn=Hw.hasIn,su.head=Bw.head,su.identity=bl,su.includes=$w.includes,su.indexOf=Bw.indexOf,su.inRange=Jw,su.invoke=Hw.invoke,su.isArguments=qw.isArguments,su.isArray=Hs,su.isArrayBuffer=qw.isArrayBuffer,su.isArrayLike=qw.isArrayLike,su.isArrayLikeObject=qw.isArrayLikeObject,su.isBoolean=qw.isBoolean,su.isBuffer=qw.isBuffer,su.isDate=qw.isDate,su.isElement=qw.isElement,su.isEmpty=qw.isEmpty,su.isEqual=qw.isEqual,su.isEqualWith=qw.isEqualWith,su.isError=qw.isError,su.isFinite=qw.isFinite,su.isFunction=qw.isFunction,su.isInteger=qw.isInteger,su.isLength=qw.isLength,su.isMap=qw.isMap,su.isMatch=qw.isMatch,su.isMatchWith=qw.isMatchWith,su.isNaN=qw.isNaN,su.isNative=qw.isNative,su.isNil=qw.isNil,su.isNull=qw.isNull,su.isNumber=qw.isNumber,su.isObject=al,su.isObjectLike=qw.isObjectLike,su.isPlainObject=qw.isPlainObject,su.isRegExp=qw.isRegExp,su.isSafeInteger=qw.isSafeInteger,su.isSet=qw.isSet,su.isString=qw.isString,su.isSymbol=qw.isSymbol,su.isTypedArray=qw.isTypedArray,su.isUndefined=qw.isUndefined,su.isWeakMap=qw.isWeakMap,su.isWeakSet=qw.isWeakSet,su.join=Bw.join,su.kebabCase=Zw.kebabCase,su.last=Sv,su.lastIndexOf=Bw.lastIndexOf,su.lowerCase=Zw.lowerCase,su.lowerFirst=Zw.lowerFirst,su.lt=qw.lt,su.lte=qw.lte,su.max=Uw.max,su.maxBy=Uw.maxBy,su.mean=Uw.mean,su.meanBy=Uw.meanBy,su.min=Uw.min,su.minBy=Uw.minBy,su.stubArray=Kw.stubArray,su.stubFalse=Kw.stubFalse,su.stubObject=Kw.stubObject,su.stubString=Kw.stubString,su.stubTrue=Kw.stubTrue,su.multiply=Uw.multiply,su.nth=Bw.nth,su.noop=Kw.noop,su.now=Fw.now,su.pad=Zw.pad,su.padEnd=Zw.padEnd,su.padStart=Zw.padStart,su.parseInt=Zw.parseInt,su.random=Ww,su.reduce=$w.reduce,su.reduceRight=$w.reduceRight,su.repeat=Zw.repeat,su.replace=Zw.replace,su.result=Hw.result,su.round=Uw.round,su.sample=$w.sample,su.size=$w.size,su.snakeCase=Zw.snakeCase,su.some=$w.some,su.sortedIndex=Bw.sortedIndex,su.sortedIndexBy=Bw.sortedIndexBy,su.sortedIndexOf=Bw.sortedIndexOf,su.sortedLastIndex=Bw.sortedLastIndex,su.sortedLastIndexBy=Bw.sortedLastIndexBy,su.sortedLastIndexOf=Bw.sortedLastIndexOf,su.startCase=Zw.startCase,su.startsWith=Zw.startsWith,su.subtract=Uw.subtract,su.sum=Uw.sum,su.sumBy=Uw.sumBy,su.template=Zw.template,su.times=Kw.times,su.toFinite=qw.toFinite,su.toInteger=vl,su.toLength=qw.toLength,su.toLower=Zw.toLower,su.toNumber=qw.toNumber,su.toSafeInteger=qw.toSafeInteger,su.toString=qw.toString,su.toUpper=Zw.toUpper,su.trim=Zw.trim,su.trimEnd=Zw.trimEnd,su.trimStart=Zw.trimStart,su.truncate=Zw.truncate,su.unescape=Zw.unescape,su.uniqueId=Kw.uniqueId,su.upperCase=Zw.upperCase,su.upperFirst=Zw.upperFirst,su.each=$w.forEach,su.eachRight=$w.forEachRight,su.first=Bw.head,d_(su,(r_={},zg(su,(function(t,e){s_.call(su.prototype,e)||(r_[e]=t)})),r_),{chain:!1}),su.VERSION="4.17.21",(su.templateSettings=Zw.templateSettings).imports._=su,wu(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){su[t].placeholder=su})),wu(["drop","take"],(function(t,e){Zl.prototype[t]=function(n){n=void 0===n?1:u_(vl(n),0);var i=this.__filtered__&&!e?new Zl(this):this.clone();return i.__filtered__?i.__takeCount__=c_(n,i.__takeCount__):i.__views__.push({size:c_(n,o_),type:t+(i.__dir__<0?"Right":"")}),i},Zl.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),wu(["filter","map","takeWhile"],(function(t,e){var n=e+1,i=1==n||3==n;Zl.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Vg(t),type:n}),e.__filtered__=e.__filtered__||i,e}})),wu(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Zl.prototype[t]=function(){return this[n](1).value()[0]}})),wu(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Zl.prototype[t]=function(){return this.__filtered__?new Zl(this):this[n](1)}})),Zl.prototype.compact=function(){return this.filter(bl)},Zl.prototype.find=function(t){return this.filter(t).head()},Zl.prototype.findLast=function(t){return this.reverse().find(t)},Zl.prototype.invokeMap=_c((function(t,e){return"function"==typeof t?new Zl(this):this.map((function(n){return nb(n,t,e)}))})),Zl.prototype.reject=function(t){return this.filter(Xb(Vg(t)))},Zl.prototype.slice=function(t,e){t=vl(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Zl(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=vl(e))<0?n.dropRight(-e):n.take(e-t)),n)},Zl.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Zl.prototype.toArray=function(){return this.take(o_)},zg(Zl.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),r=su[i?"take"+("last"==e?"Right":""):e],o=i||/^find/.test(e);r&&(su.prototype[e]=function(){var e=this.__wrapped__,a=i?[1]:arguments,s=e instanceof Zl,l=a[0],u=s||Hs(e),c=function(t){var e=r.apply(su,Vd([t],a));return i&&d?e[0]:e};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var d=this.__chain__,f=!!this.__actions__.length,p=o&&!d,h=s&&!f;if(!o&&u){e=h?e:new Zl(this);var g=t.apply(e,a);return g.__actions__.push({func:iw,args:[c],thisArg:void 0}),new iu(g,d)}return p&&h?t.apply(this,a):(g=this.thru(c),p?i?g.value()[0]:g.value():g)})})),wu(["pop","push","shift","sort","splice","unshift"],(function(t){var e=a_[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);su.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var r=this.value();return e.apply(Hs(r)?r:[],t)}return this[n]((function(n){return e.apply(Hs(n)?n:[],t)}))}})),zg(Zl.prototype,(function(t,e){var n=su[e];if(n){var i=n.name+"";s_.call(tu,i)||(tu[i]=[]),tu[i].push({name:e,func:n})}})),tu[Wu(void 0,2).name]=[{name:"wrapper",func:void 0}],Zl.prototype.clone=function(){var t=new Zl(this.__wrapped__);return t.__actions__=ru(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=ru(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=ru(this.__views__),t},Zl.prototype.reverse=function(){if(this.__filtered__){var t=new Zl(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Zl.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Hs(t),i=e<0,r=n?t.length:0,o=function(t,e,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=t_(e,t+a);break;case"takeRight":t=Qw(t,e-a)}}return{start:t,end:e}}(0,r,this.__views__),a=o.start,s=o.end,l=s-a,u=i?s:a-1,c=this.__iteratees__,d=c.length,f=0,p=i_(l,this.__takeCount__);if(!n||!i&&r==l&&p==l)return sw(t,this.__actions__);var h=[];t:for(;l--&&f<p;){for(var g=-1,v=t[u+=e];++g<d;){var y=c[g],b=y.iteratee,m=y.type,E=b(v);if(m==n_)v=E;else if(!E){if(m==e_)continue t;break t}}h[f++]=v}return h},su.prototype.at=Xw.at,su.prototype.chain=Xw.wrapperChain,su.prototype.commit=Xw.commit,su.prototype.next=Xw.next,su.prototype.plant=Xw.plant,su.prototype.reverse=Xw.reverse,su.prototype.toJSON=su.prototype.valueOf=su.prototype.value=Xw.value,su.prototype.first=su.prototype.head,l_&&(su.prototype[l_]=Xw.toIterator);const f_={TEST:{USER:"Luigi Test",EMAIL:"luigi.test05@gmail.com",CANVAS:!1,ATTRIBUTE:!1,PALETTE:!1,ACTIVITY:!1},LAYER:{META:"META",MODEL:"MODEL"},WIDGET:{NAME:{MAIN:"Canvas",PALETTE:"Palette",ATTRIBUTE:"Property Browser",ACTIVITY:"User Activity",GUIDANCE:"Guidance",HEATMAP:"Heatmap",METADATA:"METADATA",OPENAPI:"Metadata Widget",DEBUG:"Debug",IMSLD_EXPORT:"IMSLD Export",JSON_EXPORT:"JSON Export",VIEWCONTROL:"View Control"}},ENTITY:{NODE:"node",EDGE:"edge",ATTR:"attr",VAL:"val"},IWC:{FLAG:{PUBLISH_GLOBAL:"PUBLISH_GLOBAL",PUBLISH_LOCAL:"PUBLISH_LOCAL"},ACTION:{SYNC:"ACTION_SYNC",DATA:"ACTION_DATA",DATA_ARRAY:"ACTION_DATA_ARRAY"},POSITION:{NODE:{ADD:0,DEL:0,POS:1,Z:2,DIM:3},EDGE:{ADD:0,DEL:0,MOV:1},ATTR:{ADD:0,DEL:0}}},OPERATION:{TYPE:{INSERT:"insert",UPDATE:"update",DELETE:"delete"}},ACTIVITY:{TYPE:{NODEADD:0,EDGEADD:1,NODEDEL:2,EDGEDEL:3,NODEATTRCHANGE:4}},DATA:{RELATION:{GLOBAL:{MAIN:{MAIN:{OPERATION:"MAIN2MAIN4OPERATION"}}},LOCAL:{PALETTE:{MAIN:{TOOLSELECTION:"PALETTE2MAIN4TOOLSELECTION"}},MAIN:{ATTRIBUTE:{NODESELECTION:"MAIN2ATTRIBUTE4NODESELECTION",NODEADDITION:"MAIN2ATTRIBUTE4NODEADDITION",ATTRIBUTECHANGE:"MAIN2ATTRIBUTE4ATTRIBUTECHANGE"},ACTIVITY:{NEWACTIVITY:"MAIN2ACTIVITY4NEWACTIVITY"},PALETTE:{TOOLSELECTION:"MAIN2PALETTE4TOOLSELECTION"}},ATTRIBUTE:{MAIN:{ATTRIBUTECHANGE:"ATTRIBUTE2MAIN4ATTRIBUTECHANGE"}}}}},NS:{PERSON:{TITLE:"http://purl.org/dc/terms/title",JABBERID:"http://xmlns.com/foaf/0.1/jabberID",MBOX:"http://xmlns.com/foaf/0.1/mbox"},MY:{MODEL:"my:ns:model",METAMODEL:"my:ns:metamodel",INSTANCE:"my:ns:instance",VIEWPOINT:"my:ns:viewpoint",VIEW:"my:ns:view",COPY:"my:ns:copy",GUIDANCEMODEL:"my:ns:guidancemodel",METAMODELPREVIEW:"my:ns:metamodelpreview",GUIDANCEMETAMODEL:"my:ns:guidancemetamodel",LOGICALGUIDANCEREPRESENTATION:"my:ns:logicalguidancerepresentation"}}};function p_(t){if(!t)return;Object.values(f_.WIDGET.NAME).some((e=>e.toLocaleLowerCase()===t.toLocaleLowerCase()))||console.warn(`Widget name ${t} is not defined in config.js. Add it to the CONFIG.WIDGET.NAME object.`);let e=t;return e=e.replace(/\s+/g,"-"),`${e}-widget`.toLowerCase()}function h_(t){return t instanceof jQuery&&(t=t.get(0)),t.id?`[id="${t.id}"]`:t.className?`.${t.className}`:null}class g_{constructor(){}}class v_ extends g_{constructor(t,e,n,i){super();var r=null,o={name:t,value:e,type:n,position:i};this.setSender=function(t){r=t},this.getSender=function(){return r},this.getName=function(){return o.name},this.getValue=function(){return o.value},this.getType=function(){return o.type},this.getPosition=function(){return o.position},this.getOperationObject=function(){return o}}}function y_(t,e){var n=null,i={type:t,data:e};this.setSender=function(t){n=t},this.getSender=function(){return n},this.getType=function(){return i.type},this.getData=function(){return i.data},this.getOperationObject=function(){return i}}y_.prototype=new g_,y_.prototype.constructor=y_;class b_{static TYPES={AttributeAddOperation:"AttributeAddOperation",AttributeDeleteOperation:"AttributeDeleteOperation",EdgeAddOperation:"EdgeAddOperation",EdgeDeleteOperation:"EdgeDeleteOperation",NodeAddOperation:"NodeAddOperation",NodeDeleteOperation:"NodeDeleteOperation",NodeMoveOperation:"NodeMoveOperation",NodeMoveZOperation:"NodeMoveZOperation",NodeResizeOperation:"NodeResizeOperation",ValueChangeOperation:"ValueChangeOperation"};getOperationType;setOTOperation;_getOTOperation;getEntityId;getEntityType;adjust;inverse;toJSON;triggeredBy;constructor(t,e,n){this.triggeredBy=window.y.clientID;var i=t,r=null,o=e,a=n;this.getOperationType=function(){return i},this.setOTOperation=function(t){r=t},this._getOTOperation=function(){return r},this.getEntityId=function(){return o},this.getEntityType=function(){return a},this.adjust=function(t,e){return e},this.inverse=function(){return this}}getOTOperation(){return this._getOTOperation()}}class m_ extends b_{static TYPE="NodeDeleteOperation";getType;getLeft;getTop;getWidth;getHeight;getZIndex;getContainment;getJSON;constructor(t,e,n,i,r,o,a,s,l){super(b_.TYPES.NodeDeleteOperation,t,f_.ENTITY.NODE);var u=this,c=e,d=n,f=i,p=r,h=o,g=a,v=s,y=l;this.getType=function(){return c},this.getLeft=function(){return d},this.getTop=function(){return f},this.getWidth=function(){return p},this.getHeight=function(){return h},this.getZIndex=function(){return g},this.getContainment=function(){return v},this.getJSON=function(){return y},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.NODE+":"+u.getEntityId(),JSON.stringify({type:c,left:d,top:f,width:p,height:h,zIndex:g,containment:v,json:y}),f_.OPERATION.TYPE.UPDATE,f_.IWC.POSITION.NODE.DEL),this.setOTOperation(t)),t},this.adjust=function(t,e){var n;switch(e.getOperationType()){case b_.TYPES.AttributeAddOperation:case b_.TYPES.AttributeDeleteOperation:if((n=t.findEdge(e.getRootSubjectEntityId()))&&(n.getSource().getEntityId()===this.getEntityId()||n.getTarget().getEntityId()===this.getEntityId()))return null;if(this.getEntityId()===e.getRootSubjectEntityId())return null;break;case b_.TYPES.EdgeAddOperation:case b_.TYPES.EdgeDeleteOperation:if((n=t.findEdge(e.getEntityId()))&&(n.getSource().getEntityId()===this.getEntityId()||n.getTarget().getEntityId()===this.getEntityId()))return null;break;case b_.TYPES.NodeAddOperation:case b_.TYPES.NodeDeleteOperation:case b_.TYPES.NodeMoveOperation:case b_.TYPES.NodeResizeOperation:if(this.getEntityId()===e.getEntityId())return null;break;case b_.TYPES.ValueChangeOperation:if((n=t.findEdge(e.getRootSubjectEntityId()))&&(n.getSource().getEntityId()===this.getEntityId()||n.getTarget().getEntityId()===this.getEntityId()))return null;if(e.getRootSubjectEntityId()===this.getEntityId())return null}return e},this.inverse=function(){return new E_(this.getEntityId(),this.getType(),this.getLeft(),this.getTop(),this.getWidth(),this.getHeight(),this.getZIndex(),this.getContainment(),this.getContainment(),l)}}static getOperationDescription(t,e,n){return e||n?n?"..deleted "+t+" "+e+" in View "+n:"..deleted "+t+" "+e:"..deleted "+t}toJSON=function(){return{id:this.getEntityId(),type:this.getType(),left:this.getLeft(),top:this.getTop(),width:this.getWidth(),height:this.getHeight(),zIndex:this.getZIndex(),containment:this.getContainment(),json:this.getJSON()}}}class E_ extends b_{static TYPE="NodeAddOperation";getType;getOriginType;getLeft;getTop;getWidth;getHeight;getZIndex;getContainment;getJSON;getViewId;getJabberId;getDefaultLabel;getDefaultAttributeValues;toJSON;constructor(t,e,n,i,r,o,a,s,l=null,u=null,c=null,d=null,f=null,p=null){super(b_.TYPES.NodeAddOperation,t,f_.ENTITY.NODE);var h=this,g=u,v=d,y=c,b=e,m=n,E=i,w=r,_=o,O=a,T=s,x=l,A=f,S=p;this.getType=function(){return b},this.getOriginType=function(){return y},this.getLeft=function(){return m},this.getTop=function(){return E},this.getWidth=function(){return w},this.getHeight=function(){return _},this.getZIndex=function(){return O},this.getContainment=function(){return T},this.getJSON=function(){return x},this.getViewId=function(){return g},this.getJabberId=function(){return v},this.getDefaultLabel=function(){return A},this.getDefaultAttributeValues=function(){return S},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.NODE+":"+h.getEntityId(),JSON.stringify({type:b,left:m,top:E,width:w,height:_,zIndex:O,containment:T,json:x,viewId:g,oType:y,jabberId:v}),f_.OPERATION.TYPE.INSERT,f_.IWC.POSITION.NODE.ADD),this.setOTOperation(t)),t},this.adjust=function(t,e){return e},this.inverse=function(){return new m_(this.getEntityId(),this.getType(),this.getLeft(),this.getTop(),this.getWidth(),this.getHeight(),this.getZIndex(),this.getContainment(),l)},this.toJSON=function(){return{id:this.getEntityId(),type:this.getType(),left:this.getLeft(),top:this.getTop(),width:this.getWidth(),height:this.getHeight(),zIndex:this.getZIndex(),containment:this.getContainment(),json:this.getJSON(),viewId:this.getViewId(),oType:this.getOriginType(),jabberId:this.getJabberId(),defaultLabel:this.getDefaultLabel(),defaultAttributeValues:this.getDefaultAttributeValues(),triggeredBy:this.triggeredBy}}}static getOperationDescription(t,e,n){return e||n?n?".. created "+t+" "+e+" in View "+n:"..created "+t+" "+e:"..created a new "+t}}class w_ extends b_{static TYPE="EdgeDeleteOperation";getType;getSource;getTarget;getJSON;constructor(t,e,n,i,r=null){super(b_.TYPES.EdgeDeleteOperation,t,f_.ENTITY.EDGE);var o=this,a=e,s=n,l=i,u=r;this.getType=function(){return a},this.getSource=function(){return s},this.getTarget=function(){return l},this.getJSON=function(){return u},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.EDGE+":"+o.getEntityId(),JSON.stringify({type:a,source:s,target:l,json:u}),f_.OPERATION.TYPE.UPDATE,f_.IWC.POSITION.EDGE.DEL),this.setOTOperation(t)),t},this.adjust=function(t,e){switch(e.getOperationType()){case b_.TYPES.AttributeAddOperation:case b_.TYPES.AttributeDeleteOperation:if(this.getEntityId()===e.getRootSubjectEntityId())return null;break;case b_.TYPES.EdgeAddOperation:case b_.TYPES.EdgeDeleteOperation:if(this.getEntityId()===e.getEntityId())return null;break;case b_.TYPES.ValueChangeOperation:if(this.getEntityId()===e.getRootSubjectEntityId())return null}return e},this.inverse=function(){return new __(this.getEntityId(),this.getType(),this.getSource(),this.getTarget())}}static getOperationDescription(t,e,n){return e||n?n?"..deleted "+t+" "+e+"in View "+n:"..deleted "+t+" "+e:"..deleted "+t}toJSON=function(){return{id:this.getEntityId(),type:this.getType(),source:this.getSource(),target:this.getTarget(),json:this.getJSON()}}}class __ extends b_{static TYPE="EdgeAddOperation";getOriginType;getType;getSource;getTarget;getViewId;getJabberId;getJSON;constructor(t,e,n,i,r=null,o=null,a=null,s=null){super(b_.TYPES.EdgeAddOperation,t,f_.ENTITY.EDGE);var l=this,u=a,c=s;this.getOriginType=function(){return u};var d=o,f=e,p=n,h=i,g=r;this.getType=function(){return f},this.getSource=function(){return p},this.getTarget=function(){return h},this.getViewId=function(){return d},this.getJabberId=function(){return c},this.getJSON=function(){return g},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.EDGE+":"+l.getEntityId(),JSON.stringify({type:f,source:p,target:h,json:g,viewId:d,oType:u,jabberId:c}),f_.OPERATION.TYPE.INSERT,f_.IWC.POSITION.EDGE.ADD),this.setOTOperation(t)),t},this.adjust=function(t,e){return e},this.inverse=function(){return new w_(this.getEntityId(),this.getType(),this.getSource(),this.getTarget())}}static getOperationDescription(t,e,n,i,r,o,a){return e||a?a?"..created "+t+" "+e+" between "+n+" "+i+" and "+r+" "+o+" in View "+a:"..created "+t+" "+e+" between "+n+" "+i+" and "+r+" "+o:"..created a new "+t+" between "+n+" "+i+" and "+r+" "+o}toJSON=function(){return{id:this.getEntityId(),type:this.getType(),source:this.getSource(),target:this.getTarget(),json:this.getJSON(),viewId:this.getViewId(),oType:this.getOriginType(),jabberId:this.getJabberId()}}}class O_ extends b_{static TYPE="AttributeAddOperation";getSubjectEntityId;getRootSubjectEntityId;getType;getData;toJSON;constructor(t,e,n,i,r=null){super(b_.TYPES.AttributeAddOperation,t,f_.ENTITY.ATTR);var o=this,a=e,s=n,l=i,u=r;this.getSubjectEntityId=function(){return a},this.getRootSubjectEntityId=function(){return s},this.getType=function(){return l},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.ATTR+":"+o.getEntityId(),JSON.stringify({type:l,subjectEntityId:a,rootSubjectEntityId:s,data:u}),f_.OPERATION.TYPE.INSERT,f_.IWC.POSITION.ATTR.ADD),o.setOTOperation(t)),t},this.getData=function(){return u},this.adjust=function(t,e){return e},this.inverse=function(){return new T_(o.getEntityId(),o.getSubjectEntityId(),o.getRootSubjectEntityId(),o.getType())},this.toJSON=function(){return{entityId:this.getEntityId(),type:this.getType(),subjectEntityId:this.getSubjectEntityId(),rootSubjectEntityId:this.getRootSubjectEntityId(),data:this.getData()}}}}class T_ extends b_{static TYPE="AttributeDeleteOperation";getSubjectEntityId;getRootSubjectEntityId;getType;toJSON;constructor(t,e,n,i){super(b_.TYPES.AttributeDeleteOperation,t,f_.ENTITY.ATTR);var r=this,o=e,a=n,s=i;this.getSubjectEntityId=function(){return o},this.getRootSubjectEntityId=function(){return a},this.getType=function(){return s},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.ATTR+":"+r.getEntityId(),JSON.stringify({type:s,subjectEntityId:o,rootSubjectEntityId:a}),f_.OPERATION.TYPE.UPDATE,f_.IWC.POSITION.ATTR.DEL),r.setOTOperation(t)),t},this.adjust=function(t,e){switch(e.getOperationType()){case b_.TYPES.AttributeAddOperation:case b_.TYPES.AttributeDeleteOperation:if(r.getRootSubjectEntityId()===e.getRootSubjectEntityId())return null;break;case b_.TYPES.ValueChangeOperation:if(-1!==e.getEntityIdChain().indexOf(this.getEntityId()))return null}return e},this.inverse=function(){return new O_(this.getEntityId(),this.getSubjectEntityId(),this.getRootSubjectEntityId(),this.getType())},this.toJSON=function(){return{entityId:this.getEntityId(),type:this.getType(),subjectEntityId:this.getSubjectEntityId(),rootSubjectEntityId:this.getRootSubjectEntityId()}}}}class x_ extends b_{static TYPE="NodeMoveOperation";getOffsetX;getOffsetY;getJabberId;setJabberId;constructor(t,e,n,i){super(b_.TYPES.NodeMoveOperation,t,f_.ENTITY.NODE);var r=this,o=e,a=n,s=i;this.getOffsetX=function(){return o},this.getOffsetY=function(){return a},this.getJabberId=function(){return s},this.setJabberId=function(t){s=t},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.NODE+":"+r.getEntityId(),JSON.stringify({offsetX:o,offsetY:a,jabberId:s}),f_.OPERATION.TYPE.UPDATE,f_.IWC.POSITION.NODE.POS),this.setOTOperation(t)),t},this.adjust=function(t,e){return e},this.inverse=function(){return new x_(this.getEntityId(),-this.getOffsetX(),-this.getOffsetY(),this.getJabberId())}}static getOperationDescription(t,e,n){return e||n?n?"..moved "+t+" "+e+" in View "+n:"..moved "+t+" "+e:"..moved "+t}toJSON=function(){return{id:this.getEntityId(),offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),jabberId:this.getJabberId()}}}class A_ extends b_{static TYPE="NodeMoveZOperation";getOffsetZ;getJabberId;setJabberId;constructor(t,e,n){super(b_.TYPES.NodeMoveZOperation,t,f_.ENTITY.NODE);var i=this,r=e,o=n;this.getOffsetZ=function(){return r},this.getJabberId=function(){return o},this.setJabberId=function(t){o=t},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.NODE+":"+i.getEntityId(),JSON.stringify({offsetZ:r,jabberId:o}),f_.OPERATION.TYPE.UPDATE,f_.IWC.POSITION.NODE.Z),this.setOTOperation(t)),t},this.adjust=function(t,e){return e},this.inverse=function(){return new A_(this.getEntityId(),-this.getOffsetZ(),this.getJabberId())}}static getOperationDescription(t,e,n){return e||n?n?"..moved "+t+" "+e+" in View "+n+" on Z-Axis":"..moved "+t+" "+e+" on Z-Axis":"..moved "+t+" on on Z-Axis"}toJSON=function(){return{id:this.getEntityId(),offsetZ:this.getOffsetZ(),jabberId:this.getJabberId()}}}class S_ extends b_{static TYPE="NodeResizeOperation";getOffsetX;getOffsetY;getJabberId;setJabberId;constructor(t,e,n,i){super(b_.TYPES.NodeResizeOperation,t,f_.ENTITY.NODE);var r=this,o=i,a=e,s=n;this.getOffsetX=function(){return a},this.getOffsetY=function(){return s},this.getJabberId=function(){return o},this.setJabberId=function(t){o=t},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.NODE+":"+r.getEntityId(),JSON.stringify({offsetX:a,offsetY:s,jabberId:o}),f_.OPERATION.TYPE.UPDATE,f_.IWC.POSITION.NODE.DIM),this.setOTOperation(t)),t},this.adjust=function(t,e){return e},this.inverse=function(){return new S_(this.getEntityId(),-this.getOffsetX(),-this.getOffsetY(),this.getJabberId())}}static getOperationDescription(t,e,n){return e||n?n?"..resized "+t+" "+e+" in View "+n:"..resized "+t+" "+e:"..resized "+t}toJSON=function(){return{id:this.getEntityId(),offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),jabberId:this.getJabberId()}}}class I_ extends b_{static TYPE="ValueChangeOperation";getJabberId;setJabberId;getFromView;setFromView;getValue;getType;setPosition;getPosition;setRemote;getRemote;setEntityIdChain;getEntityIdChain;getRootSubjectEntityId;constructor(t,e,n,i,r=null,o=null){super(b_.TYPES.ValueChangeOperation,t,f_.ENTITY.VAL);var a=this,s=o,l=r,u=e,c=n,d=i,f=!0,p=[];this.getJabberId=function(){return l},this.setJabberId=function(t){l=t},this.getFromView=function(){return s},this.setFromView=function(t){s=t},this.getValue=function(){return u},this.getType=function(){return c},this.setPosition=function(t){d=t},this.getPosition=function(){return d},this.setRemote=function(t){f=t},this.getRemote=function(){return f},this.setEntityIdChain=function(t){p=t},this.getEntityIdChain=function(){return p},this.getRootSubjectEntityId=function(){return p[0]},this.getOTOperation=function(){var t=b_.prototype.getOTOperation.call(this);return null===t&&(t=new v_(f_.ENTITY.VAL+":"+a.getEntityId(),u,c,d,l,s),this.setOTOperation(t)),t},this.adjust=function(t,e){if(e.getOperationType()===b_.TYPES.ValueChangeOperation)if(this.getEntityId()===e.getEntityId()){if(this.getPosition()===e.getPosition&&this.getValue()===e.getValue&&this.getType()===f_.OPERATION.TYPE.INSERT&&e.getType()===f_.OPERATION.TYPE.DELETE||this.getType()===f_.OPERATION.TYPE.DELETE&&e.getType()===f_.OPERATION.TYPE.INSERT)return null;if(this.getPosition()<=e.getPosition())switch(this.getType()){case f_.OPERATION.TYPE.INSERT:e.setPosition(e.getPosition()+1);break;case f_.OPERATION.TYPE.DELETE:e.setPosition(e.getPosition()-1)}}return e},this.inverse=function(){var t,e=e;switch(this.getType()){case f_.OPERATION.TYPE.INSERT:t=f_.OPERATION.TYPE.DELETE;break;case f_.OPERATION.TYPE.DELETE:t=f_.OPERATION.TYPE.INSERT;break;case f_.OPERATION.TYPE.UPDATE:t=f_.OPERATION.TYPE.UPDATE}return new e(this.getEntityId(),this.getValue(),t,this.getPosition())},this.toJSON=function(){return{entityId:this.getEntityId(),value:this.getValue(),position:this.getPosition(),type:this.getType(),jabberId:this.getJabberId()}}}static getOperationDescription(t,e,n,i){return i?".. changed "+t+" of "+e+(n?" ":"")+n+" in View "+i:".. changed "+t+" of "+e+(n?" ":"")+n}}function k_(t,e,n){var i=t,r=n,o=e,a=null;this.getSelectedEntityId=function(){return i},this.getSelectedEntityType=function(){return o},this.getJabberId=function(){return r},this.setNonOTOperation=function(t){a=t},this.getNonOTOperation=function(){return a},this.toNonOTOperation=function(){return null===a&&(a=new y_(k_.TYPE,JSON.stringify({selectedEntityId:i,selectedEntityType:o}))),a}}k_.TYPE="EntitySelectOperation",k_.prototype.toJSON=function(){return{selectedEntityId:this.getSelectedEntityId(),selectedEntityType:this.getSelectedEntityType(),jabberId:this.getJabberId()}};class P_{static TYPE="ToolSelectOperation";selectedToolName;nonOTOperation;defaultLabel;defaultAttributeValues;getSelectedToolName;getDefaultLabel;getDefaultAttributeValues;toNonOTOperation;constructor(t,e,n={}){var i=t,r=null,o=e;this.getSelectedToolName=function(){return i},this.getDefaultLabel=function(){return o},this.getDefaultAttributeValues=function(){return n},this.toNonOTOperation=function(){return null===r&&(r=new y_(P_.TYPE,JSON.stringify({selectedToolName:i}))),r}}}class N_{static TYPE="ActivityOperation";constructor(t,e,n,i,r){var o=t,a=e,s=n,l=i,u=r,c=null;this.getType=function(){return o},this.getEntityId=function(){return a},this.getSender=function(){return s},this.getText=function(){return l},this.getData=function(){return u},this.toNonOTOperation=function(){return null===c&&(c=new y_(N_.TYPE,JSON.stringify({type:o,entityId:a,sender:s,text:l,data:u}))),c}}toJSON(){return{type:this.getType(),entityId:this.getEntityId(),sender:this.getSender(),text:this.getText(),data:this.getData()}}}function C_(t,e){var n=t,i=e,r=null;this.getRequestingComponent=function(){return n},this.getData=function(){return i},this.setData=function(t){i=t},this.toNonOTOperation=function(){return null===r&&(r=new y_(C_.TYPE,JSON.stringify({requestingComponent:n,data:i}))),r}}function j_(t,e){var n=t,i=e,r=null;this.getRequestingComponent=function(){return n},this.getData=function(){return i},this.setData=function(t){i=t},this.toNonOTOperation=function(){return null===r&&(r=new y_(j_.TYPE,JSON.stringify({requestingComponent:n,data:i}))),r}}function M_(t,e){var n=t,i=e,r=null;this.getRequestingComponent=function(){return n},this.getData=function(){return i},this.setData=function(t){i=t},this.toNonOTOperation=function(){return null===r&&(r=new y_(M_.TYPE,JSON.stringify({requestingComponent:n,data:i}))),r}}C_.TYPE="ExportMetaModelOperation",j_.TYPE="ExportLogicalGuidanceRepresentationOperation",M_.TYPE="ExportImageOperation";class D_{static TYPE="SetViewTypesOperation";_flag;nonOTOperation;getFlag=function(){return this._flag};toNonOTOperation=function(){return null===this.nonOTOperation&&(this.nonOTOperation=new y_(D_.TYPE,JSON.stringify({flag:this._flag}))),this.nonOTOperation};constructor(t){this._flag=t,this.nonOTOperation=null}}class R_{static TYPE="InitModelTypesOperation";nonOTOperation=null;_vls;_startViewGeneration;getVLS=function(){return this._vls};getViewGenerationFlag=function(){return this._startViewGeneration};toNonOTOperation=function(){return null===this.nonOTOperation&&(this.nonOTOperation=new y_(R_.TYPE,JSON.stringify({vls:this._vls,startViewGeneration:this._startViewGeneration}))),this.nonOTOperation};constructor(t,e){this._vls=t,this._startViewGeneration=e}}function L_(t,e){var n=t,i=e,r=null;this.getData=function(){return n},this.getViewpoint=function(){return i},this.toNonOTOperation=function(){return null===r&&(r=new y_(L_.TYPE,JSON.stringify({data:n,viewpoint:i}))),r}}L_.TYPE="ViewInitOperation";class Y_{static TYPE="DeleteViewOperation";constructor(t){var e=t,n=null;this.getViewId=function(){return e},this.toNonOTOperation=function(){return null===n&&(n=new y_(Y_.TYPE,JSON.stringify({viewId:e}))),n}}}function V_(){var t=null;this.toNonOTOperation=function(){return null===t&&(t=new y_(V_.TYPE,JSON.stringify({empty:"empty"}))),t}}function B_(){var t=null;this.toNonOTOperation=function(){return null===t&&(t=new y_(B_.TYPE,JSON.stringify({}))),t}}function $_(t,e,n){var i=null,r=t,o=e,a=n;this.getLabel=function(){return r},this.getGuidance=function(){return o},this.getEntityId=function(){return a},this.toNonOTOperation=function(){return null===i&&(i=new y_($_.TYPE,JSON.stringify({label:r,guidance:o,entityId:a}))),i}}function F_(t,e,n,i,r){var o=null;this.getLeft=function(){return t},this.getTop=function(){return e},this.getWidth=function(){return n},this.getHeight=function(){return i},this.getZoom=function(){return r},this.setNonOTOperation=function(t){o=t},this.getNonOTOperation=function(){return o},this.toNonOTOperation=function(){return null===o&&(o=new y_(F_.TYPE,JSON.stringify({left:t,top:e,width:n,height:i,zoom:r}))),o}}function G_(t){var e=null;this.getId=function(){return t},this.setNonOTOperation=function(t){e=t},this.getNonOTOperation=function(){return e},this.toNonOTOperation=function(){return null===e&&(e=new y_(G_.TYPE,JSON.stringify({id:t}))),e}}function q_(t){var e=null;this.getId=function(){return t},this.setNonOTOperation=function(t){e=t},this.getNonOTOperation=function(){return e},this.toNonOTOperation=function(){return null===e&&(e=new y_(q_.TYPE,JSON.stringify({id:t}))),e}}function U_(t,e){var n=null;this.getObjectId=function(){return t},this.getTransition=function(){return e},this.setNonOTOperation=function(t){n=t},this.getNonOTOperation=function(){return n},this.toNonOTOperation=function(){return null===n&&(n=new y_(U_.TYPE,JSON.stringify({objectId:t,transition:e}))),n}}V_.TYPE="SetModelAttributeNodeOperation",B_.TYPE="UpdateViewListOperation",$_.TYPE="ShowGuidanceBoxOperation",F_.TYPE="CanvasViewChangeOperation",G_.TYPE="RevokeSharedActivityOperation",G_.prototype.toJSON=function(){return{id:this.getId()}},q_.TYPE="CollaborateInActivityOperation",U_.TYPE="MoveCanvasOperation";class z_{static TYPE="GuidanceStrategyOperation";constructor(t){var e=null;this.getData=function(){return t},this.setNonOTOperation=function(t){e=t},this.getNonOTOperation=function(){return e},this.toNonOTOperation=function(){return null===e&&(e=new y_(z_.TYPE,JSON.stringify({data:t}))),e}}toJSON(){return{data:this.getData()}}}function J_(t,e){var n=t,i=e,r=null;this.getMetaModelingRoomName=function(){return n},this.getModelingRoomName=function(){return i},this.toNonOTOperation=function(){return null===r&&(r=new y_(J_.TYPE,JSON.stringify({empty:"empty"}))),r}}J_.TYPE="UpdateMetamodelOperation",J_.prototype.toJSON=function(){return{}};var W_={createOperationFromNonOTOperation:function(t){var e,n,i=t.getType();try{e=JSON.parse(t.getData())}catch(t){return console.error("Not able to parse data to JSON. Check the corresponding operation"),null}switch(i){case k_.TYPE:(n=new k_(e.selectedEntityId,e.selectedEntityType,e.jabberId)).setNonOTOperation(t);break;case P_.TYPE:n=new P_(e.selectedToolName,e.name,e.defaultAttributeValues);break;case N_.TYPE:n=new N_(e.type,e.entityId,e.sender,e.text,e.data);break;case C_.TYPE:n=new C_(e.requestingComponent,e.data);break;case j_.TYPE:n=new j_(e.requestingComponent,e.data);break;case M_.TYPE:n=new M_(e.requestingComponent,e.data);break;case D_.TYPE:n=new D_(e.flag);break;case R_.TYPE:n=new R_(e.vls,e.startViewGeneration);break;case L_.TYPE:n=new L_(e.data,e.viewpoint);break;case Y_.TYPE:n=new Y_(e.viewId);break;case $_.TYPE:n=new $_(e.label,e.guidance,e.entityId);break;case V_.TYPE:n=new V_;break;case B_.TYPE:n=new B_;break;case F_.TYPE:(n=new F_(e.left,e.top,e.width,e.height,e.zoom)).setNonOTOperation(t);break;case G_.TYPE:n=new G_(e.id);break;case q_.TYPE:n=new q_(e.id);break;case U_.TYPE:n=new U_(e.objectId,e.transition);break;case z_.TYPE:(n=new z_(e.data)).setNonOTOperation(t);break;case J_.TYPE:n=new J_(e.metamodelingRoomName,e.modelingRoomName);break;default:n=new y_(i,e)}return n},createOperationFromOTOperation:function(t){var e,n,i,r,o=t.getName().split(":");if(2===o.length)switch(n=o[0],i=o[1],n){case f_.ENTITY.NODE:try{e=JSON.parse(t.getValue())}catch(t){return null}switch(t.getPosition()){case f_.IWC.POSITION.NODE.ADD:switch(t.getType()){case f_.OPERATION.TYPE.INSERT:r=new E_(i,e.type,e.left,e.top,e.width,e.height,e.zIndex,e.containment,e.json,e.viewId,e.oType,e.jabberId);break;case f_.OPERATION.TYPE.UPDATE:r=new m_(i,e.type,e.left,e.top,e.width,e.height,e.zIndex,e.containment,e.json)}break;case f_.IWC.POSITION.NODE.POS:r=new x_(i,e.offsetX,e.offsetY,e.jabberId);break;case f_.IWC.POSITION.NODE.Z:r=new A_(i,e.offsetZ,e.jabberId);break;case f_.IWC.POSITION.NODE.DIM:r=new S_(i,e.offsetX,e.offsetY,e.jabberId)}break;case f_.ENTITY.EDGE:try{e=JSON.parse(t.getValue())}catch(t){return null}switch(t.getType()){case f_.OPERATION.TYPE.INSERT:r=new __(i,e.type,e.source,e.target,e.json,e.viewId,e.oType,e.jabberId);break;case f_.OPERATION.TYPE.UPDATE:r=new w_(i,e.type,e.source,e.target,e.json)}break;case f_.ENTITY.ATTR:try{e=JSON.parse(t.getValue())}catch(t){return null}switch(t.getType()){case f_.OPERATION.TYPE.INSERT:r=new O_(i,e.subjectEntityId,e.rootSubjectEntityId,e.type,e.data);break;case f_.OPERATION.TYPE.UPDATE:r=new T_(i,e.subjectEntityId,e.rootSubjectEntityId,e.type)}break;case f_.ENTITY.VAL:r=new I_(i,t.getValue(),t.getType(),t.getPosition(),null)}return null!==r&&r.setOTOperation(t),r}};class H_{openapp;gadgets;constructor(){var t={};this.openapp=t,t.event={};var e=void 0!==this.gadgets?this.gadgets:{};this.gadgets=e,e.openapp=e.openapp||{};var n,i,r,o="undefined"!=typeof window&&void 0!==window.parent&&void 0!==window.postMessage&&"undefined"!=typeof JSON&&void 0!==JSON.parse&&void 0!==JSON.stringify,a=!o&&void 0!==e&&void 0!==e.pubsub&&void 0!==e.pubsub.subscribe&&void 0!==e.pubsub.unsubscribe&&void 0!==e.pubsub.publish,s={postParentOnly:!0};o?(r=function(t){if("string"==typeof t.data&&'{"OpenApplicationEvent":{'===t.data.slice(0,25)){var e=JSON.parse(t.data).OpenApplicationEvent;if("openapp"===e.event&&!0===e.welcome&&t.source===window.parent)for(var n in e.message)e.message.hasOwnProperty(n)&&(s[n]=e.message[n]);else e.source=t.source,e.origin=t.origin,e.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&"function"!=typeof this[t]&&"source"!==t&&"origin"!==t&&(e[t]=this[t]);return e},"function"==typeof i&&!0===i(e,e.message)&&window.parent.postMessage(JSON.stringify({OpenApplicationEvent:{event:"openapp",receipt:!0}}),"*")}},void 0!==window.attachEvent?window.attachEvent("onmessage",r):window.addEventListener("message",r,!1),void 0!==window.parent&&window.parent.postMessage(JSON.stringify({OpenApplicationEvent:{event:"openapp",hello:!0}}),"*")):a&&(r=function(t,n){n.source=void 0,n.origin=void 0,n.sender=t,"function"==typeof i&&!0===i(n,n.message)&&e.pubsub.publish("openapp-recieve",!0)}),e.openapp.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",e.openapp.connect=function(t){i=t,a&&e.pubsub.subscribe("openapp",r)},e.openapp.disconnect=function(){a&&e.pubsub.unsubscribe("openapp"),i=null},e.openapp.publish=function(t,i){if(t.event=t.event||"select",t.type=t.type||"namespaced-properties",t.sharing=t.sharing||"public",t.date=t.date||new Date,t.message=i||t.message,o){if(!1===s.postParentOnly&&null===n){if(n={sender:"unknown",viewer:"unknown"},void 0!==window.location&&"string"==typeof window.location.search&&"function"==typeof window.unescape){var r,l=window.location.search.substring(1).split("&"),u={};if(1!=l.length||""!==l[0])for(var c=0;c<l.length;c++)2==(r=l[c].split("=")).length&&(u[r[0]]=window.unescape(r[1]));"string"==typeof u.url&&(n.sender=u.url)}if("undefined"!=typeof opensocial&&"function"==typeof opensocial.newDataRequest){(l=opensocial.newDataRequest()).add(l.newFetchPersonRequest(opensocial.IdSpec.PersonId.VIEWER),"viewer");var d=this;return void l.send((function(e){"object"==typeof(e=e.get("viewer").getData())&&null!==e&&"function"==typeof e.getId&&("string"==typeof(e=e.getId())&&(n.viewer=e)),d.publish(t,i)}))}}if(null!==n&&("string"==typeof n.sender&&(t.sender=n.sender),"string"==typeof n.viewer&&(t.viewer=n.viewer)),l=JSON.stringify({OpenApplicationEvent:t}),"undefined"!==window.parent){if(window.parent.postMessage(l,"*"),!s.postParentOnly)for(r=window.parent.frames,u=0;u<r.length;u++)r[u].postMessage(l,"*")}else window.postMessage(l,"*")}else a&&e.pubsub.publish("openapp",t)},t.io={},t.io.createXMLHttpRequest=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");throw{name:"XMLHttpRequestError",message:"XMLHttpRequest not supported"}},t.io.makeRequest=function(n,i,r){e.io.makeRequest(n,(function(e){var o,a,s,l,u,c,d,f;if(null===document.getElementById("oauthPersonalize")){o=document.createElement("div"),a=document.createElement("input"),s=document.createElement("input"),l=document.createElement("div"),u=document.createElement("input"),c=document.createElement("div"),d=document.createElement("span"),f=document.createElement("input"),o.id="oauthPersonalize",a.id="oauthPersonalizeButton",s.id="oauthPersonalizeDenyButton",l.id="oauthPersonalizeDone",u.id="oauthPersonalizeDoneButton",c.id="oauthPersonalizeComplete",d.id="oauthPersonalizeMessage",f.id="oauthPersonalizeHideButton",a.id="oauthPersonalizeButton",o.style.display="none",l.style.display="none",c.style.display="none",a.type="button",s.type="button",u.type="button",f.type="button",a.value="Continue",s.value="Ignore",u.value="Done",f.value="Hide",o.appendChild(document.createTextNode("In order to provide the full functionality of this tool, access to your personal data is being requested.")),l.appendChild(document.createTextNode("If you have provided authorization and are still reading this, click the Done button."));var p=document.getElementById("openappDialog");null==p&&(p=document.createElement("div"),null!=document.body.firstChild?document.body.insertBefore(p,document.body.firstChild):document.body.appendChild(p)),p.appendChild(o),p.appendChild(l),p.appendChild(c),o.appendChild(a),o.appendChild(s),l.appendChild(u),c.appendChild(d),c.appendChild(f),s.onclick=function(){o.style.display="none"},f.onclick=function(){c.style.display="none"}}if(e.oauthApprovalUrl){var h=function(){return b&&(window.clearInterval(b),b=null),y&&(y.close(),y=null),document.getElementById("oauthPersonalizeDone").style.display="none",document.getElementById("oauthPersonalizeComplete").style.display="block",t.io.makeRequest(n,i,r),!1},g=function(){y&&!y.closed||(y=null,h())},v=e.oauthApprovalUrl,y=null,b=null;e={createOpenerOnClick:function(){return function(){return(y=window.open(v,"_blank","width=450,height=500"))&&(b=window.setInterval(g,100),document.getElementById("oauthPersonalize").style.display="none",document.getElementById("oauthPersonalizeDone").style.display="block"),!1}},createApprovedOnClick:function(){return h}},document.getElementById("oauthPersonalizeButton").onclick=e.createOpenerOnClick(),document.getElementById("oauthPersonalizeDoneButton").onclick=e.createApprovedOnClick(),a="Please wait.",document.all?document.getElementById("oauthPersonalizeMessage").innerText=a:document.getElementById("oauthPersonalizeMessage").textContent=a,document.getElementById("oauthPersonalize").style.display="block"}else e.oauthError?(a="The authorization was not completed successfully. ("+e.oauthError+")",document.all?document.getElementById("oauthPersonalizeMessage").innerText=a:document.getElementById("oauthPersonalizeMessage").textContent=a,document.getElementById("oauthPersonalizeComplete").style.display="block"):(a="You have now granted authorization. To revoke authorization, go to your Privacy settings.",document.all?document.getElementById("oauthPersonalizeMessage").innerText=a:document.getElementById("oauthPersonalizeMessage").textContent=a,i(e))}),r)},t.ns={},t.ns.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#",t.ns.rdfs="http://www.w3.org/2000/01/rdf-schema#",t.ns.dcterms="http://purl.org/dc/terms/",t.ns.foaf="http://xmlns.com/foaf/0.1/",t.ns.rest="http://purl.org/openapp/",t.ns.conserve="http://purl.org/openapp/",t.ns.openapp="http://purl.org/openapp/",t.ns.role="http://purl.org/role/terms/",t.ns.widget="http://purl.org/role/widget/",t.resource={};var l=/<[^>]*>\s*(\s*;\s*[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|\$)/g,u=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g;function c(t){return'"'===t.charAt(0)&&'"'===t.charAt(t.length-1)?t.substring(1,t.length-1):t}function d(t){var e=(t+",").match(l);t={};var n,i,r,o,a,s={},d={};for(n=0;n<e.length;n++){for(r=(i=e[n].split(">"))[0].substring(1),o=i[1],(i={}).href=r,r=o.match(u),o=0;o<r.length;o++)i[(a=(a=r[o]).split("="))[0]]=c(a[1]);void 0!==i.rel&&void 0===i.anchor&&(t[i.rel]=i),void 0!==i.title&&void 0===i.anchor&&(s[i.title]=i),(o=(r=d[i.anchor||""]||{})[i.rel||"http://purl.org/dc/terms/relation"]||[]).push({type:"uri",value:i.href}),r[i.rel||"http://purl.org/dc/terms/relation"]=o,d[i.anchor||""]=r}return(e={}).rels=t,e.titles=s,e.rdf=d,e}var f=function(t){return""!==t&&"string"==typeof t};t.resource.makeRequest=function(e,n,i,r,o,a){var s,l=t.io.createXMLHttpRequest(),u=0;if(void 0!==r){for(s in r)r.hasOwnProperty(s)&&u++;if(0<u){switch(u="",-1!==n?.indexOf("?")&&(u=n?.substring(n.indexOf("?")),n=n?.substring(0,n.length-u.length)),n?.substring(n.length-1)){case"/":n+=":";break;case":":break;default:n+="/:"}for(s in r)r.hasOwnProperty(s)&&(n=s===t.ns.rdf+"predicate"?n+";predicate="+encodeURIComponent(r[s]):n+";"+encodeURIComponent(s)+"="+encodeURIComponent(r[s]));n+=u}}l.open(e,n,!0),l.setRequestHeader("Accept","application/json"),(0<(o=o||"").length||"POST"===e||"PUT"===e)&&l.setRequestHeader("Content-Type",void 0!==a?a:"application/json"),i=i||function(){},l.onreadystatechange=function(){if(4===l.readyState){var t={data:l.responseText,link:f(l.getResponseHeader("link"))?d(l.getResponseHeader("link")):{}};f(l.getResponseHeader("location"))?t.uri=l.getResponseHeader("location"):f(l.getResponseHeader("content-base"))?t.uri=l.getResponseHeader("content-base"):t.link.hasOwnProperty("http://purl.org/dc/terms/subject")&&(t.uri=t.link["http://purl.org/dc/terms/subject"].href),f(l.getResponseHeader("content-location"))&&(t.contentUri=l.getResponseHeader("content-location")),f(l.getResponseHeader("content-type"))&&"application/json"===l.getResponseHeader("content-type").split(";")[0]&&(t.data=JSON.parse(t.data)),t.subject=void 0!==l.responseText?t.data.hasOwnProperty("")?t.data[""]:t.data[t.uri]||{}:{},i(t)}},l.send(o)},"undefined"==typeof openapp_forceXhr&&void 0!==e&&void 0!==e.io&&void 0!==e.io.makeRequest&&(t.resource.makeRequest=function(n,i,r,o,a,s){var l,u={},c=0;if(void 0!==o){for(l in o)o.hasOwnProperty(l)&&c++;if(0<c){switch(c="",-1!==i.indexOf("?")&&(c=i.substring(i.indexOf("?")),i=i.substring(0,i.length-c.length)),i.substring(i.length-1)){case"/":i+=":";break;case":":break;default:i+="/:"}for(l in o)o.hasOwnProperty(l)&&(i=l===t.ns.rdf+"predicate"?i+";predicate="+encodeURIComponent(o[l]):i+";"+encodeURIComponent(l)+"="+encodeURIComponent(o[l]));i+=c}}u[e.io.RequestParameters.GET_FULL_HEADERS]=!0,u[e.io.RequestParameters.CONTENT_TYPE]=e.io.ContentType.TEXT,u[e.io.RequestParameters.AUTHORIZATION]=e.io.AuthorizationType.OAUTH,u[e.io.RequestParameters.OAUTH_SERVICE_NAME]="openapp",u[e.io.RequestParameters.OAUTH_USE_TOKEN]="always",u[e.io.RequestParameters.METHOD]=n,u[e.io.RequestParameters.HEADERS]=u[e.io.RequestParameters.HEADERS]||{},null!=a&&(u[e.io.RequestParameters.HEADERS]["Content-Type"]=void 0!==s?s:"application/json",u[e.io.RequestParameters.POST_DATA]=a),u[e.io.RequestParameters.HEADERS].Accept="application/json",r=r||function(){},t.io.makeRequest(i,(function(t){var n={data:t.data,link:void 0!==t.headers.link?d(t.headers.link[0]):{}};t.headers.hasOwnProperty("location")?n.uri=t.headers.location[0]:t.headers.hasOwnProperty("content-base")?n.uri=t.headers["content-base"][0]:n.link.hasOwnProperty("http://purl.org/dc/terms/subject")&&(n.uri=n.link["http://purl.org/dc/terms/subject"].href),t.headers.hasOwnProperty("content-location")&&(n.contentUri=t.headers["content-location"][0]),t.headers.hasOwnProperty("content-type")&&"application/json"===t.headers["content-type"][0].split(";")[0]&&(n.data=e.json.parse(n.data)),n.subject=void 0!==t.data?n.data.hasOwnProperty("")?n.data[""]:n.data[n.uri]||{}:{},r(n)}),u)}),t.resource.get=function(e,n,i){return t.resource.makeRequest("GET",e,n,i||{"http://www.w3.org/1999/02/22-rdf-syntax-ns#predicate":t.ns.conserve+"info"})},t.resource.post=function(e,n,i,r,o){return t.resource.makeRequest("POST",e,n,i,r,o)},t.resource.put=function(e,n,i,r,o){return t.resource.makeRequest("PUT",e,n,i,r,o)},t.resource.del=function(e,n,i){return t.resource.makeRequest("DELETE",e,n,i)},t.resource.context=function(n){return{sub:function(e){var i={};return{control:function(t,e){return i[t]=e,this},type:function(e){return this.control(t.ns.rdf+"type",e)},seeAlso:function(e){return this.control(t.ns.rdfs+"seeAlso",e)},list:function(){var t,r,o,a,s,l,u=[],c=n.subject[e];if(void 0===c)return u;o=0;t:for(;o<c.length;o++){for(a in t=c[o],r=n.data[t.value],i)if(i.hasOwnProperty(a)){if(!r.hasOwnProperty(a))continue t;for(l=!1,s=0;s<r[a].length;s++)if(r[a][s].value===i[a]){l=!0;break}if(!l)continue t}u.push({data:n.data,link:{},uri:t.value,subject:r})}return u},create:function(r){if(!n.link.rdf.hasOwnProperty(e))throw"The context does not support the requested relation: "+e;var o=n.uri;i[t.ns.rdf+"predicate"]=e,t.resource.post(o,(function(t){r(t)}),i)}}},metadata:function(){return t.resource.context(n).content(t.ns.rest+"metadata")},representation:function(){return t.resource.context(n).content(t.ns.rest+"representation")},content:function(e){return{get:function(i){t.resource.get(n.uri,(function(t){i(t)}),{"http://www.w3.org/1999/02/22-rdf-syntax-ns#predicate":e})},mediaType:function(i){var r=null;return{string:function(t){return r=t,this},json:function(t){return r=JSON.stringify(t),this},put:function(o){t.resource.put(n.uri,(function(t){"function"==typeof o&&o(t)}),{"http://www.w3.org/1999/02/22-rdf-syntax-ns#predicate":e},r,i)}}},string:function(t){return this.mediaType("text/plain").string(t)},json:function(t){return this.mediaType("application/json").json(t)},graph:function(){var i={},r="";return{subject:function(t){return r=t,this},resource:function(t,e){return i[r]=i[r]||{},i[r][t]=i[r][t]||[],i[r][t].push({value:e,type:"uri"}),this},literal:function(t,e,n,o){return i[r]=i[r]||{},i[r][t]=i[r][t]||[],i[r][t].push({value:e,type:"literal",lang:n,datatype:o}),this},put:function(r){t.resource.put(n.uri,(function(t){"function"==typeof r&&r(t)}),{"http://www.w3.org/1999/02/22-rdf-syntax-ns#predicate":e},JSON.stringify(i))}}}}},properties:function(){var t,e={};for(t in n.subject)n.subject.hasOwnProperty(t)&&(e[t]=n.subject[t][0].value);return e},string:function(){return"string"==typeof n.data?n.data:e.json.stringify(n.data)},json:function(){return"string"==typeof n.data?null:n.data},followSeeAlso:function(){var e,i,r=n.subject[t.ns.rdfs+"seeAlso"],o=0;if(void 0!==r){for(r=r[0].value,i=0;i<r.length&&i<n.uri.length&&r.charAt(i)===n.uri.charAt(i);i++)"/"===r.charAt(i)&&o++;for(e=o;i<r.length;i++)"/"===r.charAt(i)&&e++;return 3>o||4<e?this:t.resource.context({data:n.data,link:{},uri:r,subject:n.data[r]})}return this}}},t.resource.content=function(e){return{properties:function(){return t.resource.context(e).properties()},string:function(){return t.resource.context(e).string()},json:function(){return t.resource.context(e).json()}}},t.oo={},t.oo.Resource=function(t,e,n){this.uri=t,this.context=e,this.info=n};var p=t.oo.Resource.prototype;p.getURI=function(){return this.uri},p._call=function(e){var n=this;null==this.context?null==this._deferred?(this._deferred=[e],t.resource.get(this.uri,(function(t){n.context=t,t=n._deferred,delete n._deferred;for(var e=0;e<t.length;e++)t[e].call(n)}))):this._deferred.push(e):e.call(n)},p.refresh=function(t){delete this.context,delete this.info,t&&this._call((function(){t()}))},p.getSubResources=function(e){this._call((function(){for(var n=null!=e.type?t.resource.context(this.context).sub(e.relation).type(e.type).list():t.resource.context(this.context).sub(e.relation).list(),i=[],r=0;r<n.length;r++){var o=n[r].uri;if(e.followReference){var a=this.context.data[o]["http://www.w3.org/2002/07/owl#sameAs"];null!=a&&0<a.length&&(o=a[0].value)}a=new t.oo.Resource(o,null,n[r]),null==e.followReference&&(a._referenceLoaded=!0,null!=(o=this.context.data[o]["http://www.w3.org/2002/07/owl#sameAs"])&&0<o.length&&(a._reference=o[0].value)),e.onEach&&e.onEach(a),e.onAll&&i.push(a)}e.onAll&&e.onAll(i)}))},p.followReference=function(e){this._referenceLoaded?e(null!=this._reference?new t.oo.Resource(this._reference):this):this._call((function(){var n=this.context.data[this.uri]["http://www.w3.org/2002/07/owl#sameAs"];null!=n&&0<n.length?e(new t.oo.Resource(n[0].value)):e(this)}))},p.getReference=function(e){this._referenceLoaded?e(this._reference):this._call((function(){var n=this.context.subject[t.ns.rdfs+"seeAlso"];null!=n&&0<n.length?e(this.context.subject[t.ns.rdfs+"seeAlso"][0].value):e()}))},p.getMetadata=function(e,n){this._call((function(){t.resource.context(this.context).metadata().get((function(i){switch(e||"properties"){case"properties":n(t.resource.context(i).properties());break;case"graph":n(t.resource.content(i).graph());break;case"rdfjson":n(t.resource.content(i).json())}}))}))},p.getInfo=function(e){if(e)this.context||this.info?e(t.resource.context(this.context||this.info).properties()):this._call((function(){e(t.resource.context(this.context||this.info).properties())}));else if(this.context||this.info)return t.resource.context(this.context||this.info).properties()},p.getRepresentation=function(e,n){this._call((function(){t.resource.context(this.context).representation().get((function(i){switch(e||"text/html"){case"properties":n(t.resource.context(i).properties());break;case"graph":n(t.resource.content(i).graph());break;case"rdfjson":n(t.resource.content(i).json());break;case"text/html":n(t.resource.content(i).string())}}))}))},p.setMetadata=function(e,n,i){var r={};switch(n||"properties"){case"properties":for(var o in n={},e)n[o]=[{type:"literal",value:e[o]}];r[this.context.uri]=n;break;case"rdfjson":r=e;break;case"graph":return void graph.put(i)}t.resource.put(this.context.uri,i,{"http://www.w3.org/1999/02/22-rdf-syntax-ns#predicate":t.ns.rest+"metadata"},JSON.stringify(r))},p.setRepresentation=function(e,n,i){this._call((function(){var r=t.resource.context(this.context).representation().mediaType(n);"string"==typeof e?r.string(e).put(i):r.json(e).put(i)}))},p.create=function(e){this._call((function(){var n=t.resource.context(this.context).sub(e.relation||t.ns.role+"data");null!=e.referenceTo&&(n=n.seeAlso(e.referenceTo)),null!=e.type&&(n=n.type(e.type)),n.create((function(n){var i=new t.oo.Resource(n.uri,n);e.metadata?i.setMetadata(e.metadata,e.format,(function(){e.representation?i.setRepresentation(e.representation,e.medieType||"application/json",(function(){e.callback(i)})):e.callback(i)})):e.representation?i.setRepresentation(e.representation,e.medieType||"application/json",(function(){e.callback(i)})):e.callback(i)}))}))},p.del=function(e){t.resource.del(this.uri,e)},t.param={};var h=function(t){var e,n,i={};if(0>t.indexOf("?"))return{};if(1!=(t=t.substr(t.indexOf("?")+1).split("&")).length||""!==t[0])for(n=0;n<t.length;n++)2==(e=t[n].split("=")).length&&(i[e[0]]=window.unescape(e[1]));return i},g=function(t){var e,n,i={},r={};for(e in t)t.hasOwnProperty(e)&&"openapp['ns']."===e.substring(0,11)&&(i[e.substr(11)]=t[e]);for(e in t)t.hasOwnProperty(e)&&(3===(n=e.split(".")).length&&"openapp"===n[0]&&i.hasOwnProperty(n[1])&&(r[i[n[1]]+n[2]]=t[e]));return r}(h(h(window.location.href).url||""));t.param.get=function(t){return g[t]},t.param.space=function(){return t.param.get("http://purl.org/role/terms/space")},t.param.user=function(){return t.param.get("http://purl.org/role/terms/user")}}}const X_=(new H_).openapp;var Z_={generateRandomId:function(t){var e,n="1234567890abcdef",i=n.length,r="";for(void 0===t&&(t=24),e=0;e<t;e++)r+=n[Math.floor(Math.random()*i)];return r},generateAnonymousUser:function(){const t={};var e=this.generateRandomId();return t[f_.NS.PERSON.TITLE]="Anonymous",t[f_.NS.PERSON.JABBERID]=e,t[f_.NS.PERSON.MBOX]=e+"@anonym.com",t.globalId=-1,t.self=!0,t},delay:function(t){var e=jQuery.Deferred();return setTimeout((function(){e.resolve()}),t),e.promise()},union:function(t,e){var n,i={};for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);for(n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(i[n]=e[n]);return i},merge:function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n]);return t},toPromise:function(t){return function(){var e=Array.prototype.slice.call(arguments),n=jQuery.Deferred();return e.push((function(){n.resolve.apply(this,arguments)})),t.apply(this,e),n.promise()}},COLORS:["#8AFFC8","#8A9FFF","#FF8A8A","#FFC08A","#FF8AD2","#8AEBFF","#C68AFF","#8EFF8A"],getColor:function(t){return this.COLORS[t%this.COLORS.length]},getGlobalId:function(t,e){var n=t.user[f_.NS.PERSON.MBOX];const i=e.getMap("users");var r=Array.from(i.values()),o=r.indexOf(n);return-1===o&&(o=r.length,i.set(e.clientID,n)),o},GetCurrentBaseModel:function(){var t=new X_.oo.Resource(X_.param.space()),e=jQuery.Deferred();return t.getSubResources({relation:X_.ns.role+"data",type:f_.NS.MY.MODEL,onAll:function(t){null===t||0===t.length?e.resolve([]):t[0].getRepresentation("rdfjson",(function(t){t?e.resolve(t):e.resolve([])}))}}),e.promise()},getSpaceTitle:function(t){return t.substring(t.lastIndexOf("spaces/")).replace(/spaces|#\S*|\?\S*|\//g,"")}};class K_{_y;_componentName="unknown";_connected=!1;_categories;_callback;_origin;constructor(t,e,n,i){this._y=i,this._componentName=t,this._categories=e,this._origin=n}connect(t){this._callback=t;var e=this.receiveMessage.bind(this);const n=p_(this._componentName);try{const t=document.querySelector(n);if(!t)throw new Error("html tag not found in document. Please make sure that you added the "+n+" to the document. Hint: do not use the shadow dom.");t.addEventListener("syncmeta-message",e)}catch(t){console.error(t)}if(this._y){const t=this._y.getMap("intents");t&&t.observe(e)}}disconnect(){this._callback=null,null!==this._y&&void 0!==this._y&&this._y.getMap("intents").unobserve(this.receiveMessage)}publish(t){Q_.validateIntent(t)&&(t.flags[0]===Q_.FLAGS.PUBLISH_GLOBAL?this.publishGlobal(t,this._y):t.flags[0]===Q_.FLAGS.PUBLISH_LOCAL&&this.publishLocal(t,this._origin))}publishLocal(t,e){const n=[];for(const t of document.querySelectorAll("*"))t.tagName.match(/-widget$/i)&&n.push(t);n.forEach((function(n){const i=p_(t.receiver.toLowerCase());if(n.tagName.toLowerCase()===i.toLowerCase()){const i=new CustomEvent("syncmeta-message",{detail:{intent:t,origin:e}});n.dispatchEvent(i)}}))}publishGlobal(t,e){e.getMap("intents").set(t.receiver,t)}receiveMessage(t){if("syncmeta-message"===t.type)t instanceof CustomEvent&&this._callback(t.detail.intent);else if("add"===t.type||"update"==t.type){var e=t.object.get(t.name);t.object.delete(t.name),console.log(e),this._callback(e)}}}class Q_{static FLAGS={PUBLISH_LOCAL:"PUBLISH_LOCAL",PUBLISH_GLOBAL:"PUBLISH_GLOBAL"};static validateIntent(t){if("string"!=typeof t.sender)throw new Error("Intent object must possess property 'component' of type 'String'");if("string"!=typeof t.data)throw new Error("Intent object must possess property 'data' of type 'String'");if("string"!=typeof t.dataType)throw new Error("Intent object must possess property 'dataType' of type 'String'");return!0}}var tO="OTOperation",eO="NonOTOperation";class nO{BUFFER_ENABLED=!1;INTERVAL_SEND=25;Space=null;_messageBuffer=[];_onDataReceivedCallbacks=[];_onDataReceivedCallers=[];_times={};_iwc;disconnect;connect;sendLocalMessage;sendLocalOTOperation;sendLocalNonOTOperation;getUserColor;registerOnDataReceivedCallback;unregisterOnDataReceivedCallback;getUser;getMembers;getSpaceTitle;setSpace;componentName;encapsulateMessage(t,e,n,i){var r,o,a,s=[];if(e instanceof Array)for(r=0,o=e.length;r<o;r++)(a=e[r])!==f_.IWC.FLAG.PUBLISH_LOCAL&&a!==f_.IWC.FLAG.PUBLISH_GLOBAL||s.push(a);else{if("string"!=typeof e)throw"Parameter flags has wrong type. Array or String expected.";e!==f_.IWC.FLAG.PUBLISH_LOCAL&&e!==f_.IWC.FLAG.PUBLISH_GLOBAL||s.push(e)}if("string"!=typeof n)throw"Parameter action has wrong type. String expected.";return{receiver:t=t||"",sender:this.componentName,data:"",dataType:"",action:n,flags:s,extras:{payload:i,time:(new Date).getTime()}}}sendBufferedMessages(){var t,e=null;for(var n in this._messageBuffer)this._messageBuffer.hasOwnProperty(n)&&(1==(e=this._messageBuffer[n].splice(0,this._messageBuffer[n].length)).length?(t=this.encapsulateMessage(n,f_.IWC.FLAG.PUBLISH_LOCAL,f_.IWC.ACTION.DATA,e[0]),Q_.validateIntent(t)&&this._iwc.publish(t)):e.length>1&&(t=this.encapsulateMessage(n,f_.IWC.FLAG.PUBLISH_LOCAL,f_.IWC.ACTION.DATA_ARRAY,e),Q_.validateIntent(t)&&this._iwc.publish(t)))}onIntentReceivedCallback(t,e){if("string"==typeof e)try{(e=JSON.parse(e)).hasOwnProperty("OpenApplicationEvent")&&(e=e.OpenApplicationEvent).hasOwnProperty("message")&&(e=e.message)}catch(t){return}if(e.hasOwnProperty("extras")&&e.extras.hasOwnProperty("payload")){var n,i,r,o=e.extras.payload,a=e.extras.time,s=t._times[e.sender];if(-1===e.flags.indexOf(f_.IWC.FLAG.PUBLISH_GLOBAL)){if(void 0===s)s=t._times[e.sender]=[];else for(n=0,i=s.length;n<i;n++)if(a===s[n])return;switch(s.push(a),e.action){case f_.IWC.ACTION.DATA:l(o);break;case f_.IWC.ACTION.DATA_ARRAY:for(n=0,r=o.length;n<r;n++)l(o[n])}}}function l(e){var n,i,r,o,a,s,l;if(e&&e.hasOwnProperty("type")&&e.hasOwnProperty("data"))switch(n=e.type,i=e.data,r=e.sender,n){case tO:for((o=new v_(i.name,i.value,i.type,i.position)).setSender(r),a=W_.createOperationFromOTOperation(o),s=0,l=t._onDataReceivedCallbacks.length;s<l;s++)if("function"==typeof t._onDataReceivedCallbacks[s]){var u=t._onDataReceivedCallers[s]||t;t._onDataReceivedCallbacks[s].call(u,a)}break;case eO:for((o=new y_(i.type,i.data)).setSender(r),a=W_.createOperationFromNonOTOperation(o),s=0,l=t._onDataReceivedCallbacks.length;s<l;s++)if("function"==typeof t._onDataReceivedCallbacks[s]){u=t._onDataReceivedCallers[s]||t;t._onDataReceivedCallbacks[s].call(u,a)}}}}constructor(t,e){return this.componentName=t,this._iwc=new K_(t,"*",null,e),window._iwc_instance_=this._iwc,this.BUFFER_ENABLED&&setInterval(this.sendBufferedMessages,this.INTERVAL_SEND),this.connect=()=>this._iwc.connect((t=>this.onIntentReceivedCallback(this,t))),this.disconnect=()=>this._iwc.disconnect,this.sendLocalMessage=function(t,e){var n;t&&""!==t&&(this.BUFFER_ENABLED?this._messageBuffer.hasOwnProperty(t)?this._messageBuffer[t].push(e):this._messageBuffer[t]=[e]:(n=this.encapsulateMessage(t,f_.IWC.FLAG.PUBLISH_LOCAL,f_.IWC.ACTION.DATA,e),Q_.validateIntent(n)&&this._iwc.publish(n)))},this.sendLocalOTOperation=function(t,e){this.sendLocalMessage(t,{type:tO,data:e.getOperationObject(),sender:e.getSender()})},this.sendLocalNonOTOperation=function(t,e){this.sendLocalMessage(t,{type:eO,data:e.getOperationObject(),sender:e.getSender()})},this.getUserColor=function(t){return Z_.getColor(this.Space.members[t].globalId)},this.registerOnDataReceivedCallback=function(t,e){"function"==typeof t&&(this.unregisterOnDataReceivedCallback(t),this._onDataReceivedCallbacks.push(t),this._onDataReceivedCallers.push(e))},this.unregisterOnDataReceivedCallback=function(t){var e,n;if("function"==typeof t)for(e=0,n=this._onDataReceivedCallbacks.length;e<n;e++)t===this._onDataReceivedCallbacks[e]&&(this._onDataReceivedCallbacks.splice(e,1),this._onDataReceivedCallers.splice(e,1))},this.getUser=function(){return this.Space?this.Space.user||(console.error("User in space is null, generating new anonymous user"),this.Space.user=Z_.generateAnonymousUser()):(console.error("Space is null"),this.Space={user:{}}),this.Space.user},this.getMembers=function(){return this.Space.members},this.getSpaceTitle=function(){return this.Space.title},this.setSpace=function(t){this.Space=t},this}}class iO{static instances={};constructor(){}static hasInstance(t){return t in iO.instances}static getInstance(t,e){return this.hasInstance(t)||((e=e||window.y)||console.error("y is null, y is the shared y document that should be passed along when calling getInstance, proceed with caution"),iO.instances[t]=new nO(t,e),iO.instances[t].connect()),iO.instances[t]}}let rO=class{static MAX_Z_INDEX=32e3;static MIN_Z_INDEX=1;static CONTEXT_MENU_Z_INDEX=32001;static maxZIndex=16e3;static minZIndex=16e3;constructor(t){var e=t;this.getEntityId=function(){return e}}};let oO=class t extends rO{constructor(e,n,i){super(e);var r=e,o=n,a=$(su.template('<div class="attribute"></div>')()),s=i;this.setName=function(t){o=t},this.getName=function(){return o},this.getSubjectEntity=function(){return s},this.getRootSubjectEntity=function(){for(var e=this.getSubjectEntity();e instanceof t;)e=e.getSubjectEntity();return e},this.getSubjectEntityId=function(){return s.getEntityId()},this._get$node=function(){return a},this._toJSON=function(){return{id:r,name:o}}}get$node(){return this._get$node()}toJSON(){return this._toJSON()}registerYTypeForValue(t,e){var n=$.Deferred();return t.get(e.getEntityId()).then((function(t){e.registerYType(t),n.resolve()})),n.promise()}};function aO(t){return{unidirassociation:{type:"Arrow",options:{width:20,length:30,location:1,foldback:.1,paintStyle:{fill:"#ffffff",outlineWidth:2,outlineStroke:t}}},generalisation:{type:"Arrow",options:{width:20,length:30,location:1,foldback:1,paintStyle:{fill:"#ffffff",outlineWidth:2,outlineStroke:t}}},diamond:{type:"Arrow",options:{width:20,length:20,location:1,foldback:2,paintStyle:{fill:"#ffffff",outlineWidth:2,outlineStroke:t}}}}}let sO=class{constructor(t,e,n,i){var r=this,o=t,a=e,s=n,l=i;this.getEntityId=function(){return o},this.getName=function(){return a},this.getSubjectEntity=function(){return s},this.getRootSubjectEntity=function(){return l},this._toJSON=function(){return{id:r.getEntityId(),name:a}}}toJSON(){return this._toJSON()}},lO='<div class="val"><%= value %></div>';let uO=class extends sO{constructor(t,e,n,i,r){r&&(lO='<input\n  class="form-check-input val"\n  type="checkbox"\n  name="<%= name %>"\n  <% if (value) { %> checked="checked" <% } %> />\n'),super(t,e,n,i);var o=this,a=!1,s=$(su.template(lO)({value:a}));y=y||window.y;var l=iO.getInstance(f_.WIDGET.NAME.MAIN,y);this.setValue=function(t){a=t,r?s.prop("checked",t):s.text(t)},this.getValue=function(){return a},this.get$node=function(){return s},this.toJSON=function(){var t=sO.prototype.toJSON.call(this);return t.value=a,t},this.setValueFromJSON=function(t){this.setValue(t.value)},this.registerYType=function(){o.getRootSubjectEntity().getYMap().observe((function(t){Array.from(t.changes.keys.entries()).forEach((function([e,n]){const i=t.currentTarget.get(e);var r=new I_(i.entityId,i.value,i.type,i.position,i.jabberId);if(l.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,r.getOTOperation()),function(t){o.setValue(t.getValue())}(r),l.getUser()[f_.NS.PERSON.JABBERID]===r.getJabberId()){y.getMap("activity").set(N_.TYPE,new N_("ValueChangeActivity",o.getEntityId(),l.getUser()[f_.NS.PERSON.JABBERID],I_.getOperationDescription(o.getSubjectEntity().getName(),o.getRootSubjectEntity().getType(),o.getRootSubjectEntity().getLabel().getValue().getValue()),{value:r.getValue(),subjectEntityName:o.getSubjectEntity().getName(),rootSubjectEntityType:o.getRootSubjectEntity().getType(),rootSubjectEntityId:o.getRootSubjectEntity().getEntityId()}).toJSON())}else l.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,r.getOTOperation())}))})),o.getRootSubjectEntity().getYMap().observe(su.debounce((function(t){t.keysChanged.forEach((function(t){"jabberId"==t&&t===l.getUser()[f_.NS.PERSON.JABBERID]&&EntityManager.storeDataYjs()}))}),500))},s.off()}};let cO=class extends oO{constructor(t,e,n,i){i=void 0!==i&&i,super(t,e,n);var r=new uO(t,e,this,this.getRootSubjectEntity(),i),o=$(su.template('<div class="single_value_attribute">\n    <div class="name"></div>\n    <div class="value"></div>\n</div>')());this.setValue=function(t){r=t,o.val(t)},this.getValue=function(){return r},this.get$node=function(){return o},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.value=r.toJSON(),t},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},o.find(".name").text(this.getName()),o.find(".value").append(r.get$node())}};const dO=(new H_).openapp;let fO='<div class="val"><%= value %></div>';const pO='<div class="file">\n  <div class="select_file">\n    <input class="form-control" type="file" id="file_object" />\n    <input class="form-control" type="button" id="file_submit" value="Submit" />\n  </div>\n  <div class="manage_file">\n    <span id="file_name"></span>\n    <button id="file_preview">Preview</button>\n    <button>\n      <a\n        id="file_download"\n        href="#"\n        target="_blank"\n        style="color: #000; text-decoration: none"\n        >Download</a\n      >\n    </button>\n    <button id="file_delete">Delete</button>\n  </div>\n</div>\n';function hO(t,e,n,i,r){var o=this;r&&(fO=pO),sO.call(this,t,e,n,i);var a,s="",l=(a=r?$(su.template(fO)({name:e})):$(su.template(fO)({value:s}))).find(".select_file"),u=a.find(".manage_file");y=y||window.y;var c=iO.getInstance(f_.WIDGET.NAME.MAIN,y),d=function(t,e,n){var i=new I_(o.getEntityId(),e,t,n);f(i)},f=function(t){if(t.setEntityIdChain(function(){for(var t=[o.getEntityId()],e=o;e instanceof oO;)t.unshift(e.getSubjectEntity().getEntityId()),e=e.getSubjectEntity();return t}()),function(t){o.setValue(t.getValue())}(t),c.sendRemoteOTOperation(t)){c.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation());y.getMap("activity").set(N_.TYPE,new N_("ValueChangeActivity",o.getEntityId(),c.getUser()[f_.NS.PERSON.JABBERID],I_.getOperationDescription(o.getSubjectEntity().getName(),o.getRootSubjectEntity().getType(),o.getRootSubjectEntity().getLabel().getValue().getValue()),{value:t.getValue(),subjectEntityName:o.getSubjectEntity().getName(),rootSubjectEntityType:o.getRootSubjectEntity().getType(),rootSubjectEntityId:o.getRootSubjectEntity().getEntityId()}).toJSON())}},p=function(t){t instanceof I_&&t.getEntityId()===o.getEntityId()&&(f(t),c.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()))};this.setValue=function(t){""===(s=t)?a.text(""):$.get(s+"/:representation").done((function(t){a.text(t.name)}))},this.getValue=function(){return s},this.get$node=function(){return a},this.toJSON=function(){var t=sO.prototype.toJSON.call(this);return t.value=s,t},this.setValueFromJSON=function(t){this.setValue(t.value)},this.registerCallbacks=function(){c.registerOnDataReceivedCallback(p)},this.unregisterCallbacks=function(){c.unregisterOnDataReceivedCallback(p)},c&&o.registerCallbacks(),r&&(l.find("#file_object").change((function(){var t=$(this)[0].files;t&&0!==t.length&&t[0].size>1048576&&alert("Chosen file is too large. Maximum size: 1MB")})),l.find("#file_submit").click((function(){var t,e,n=l.find("#file_object")[0].files;n&&0!==n.length&&(e=n[0],(t=new FileReader).onload=function(t){!function(t,e,n){new dO.oo.Resource(dO.param.space()).create({relation:dO.ns.role+"data",type:"my:ns:file",representation:{name:t,type:e,data:n},callback:function(t){t.uri&&d(f_.OPERATION.TYPE.UPDATE,t.uri,0)}})}(e.name,e.type,t.target.result)},t.readAsDataURL(e))})),u.find("#file_delete").click((function(){d(f_.OPERATION.TYPE.UPDATE,"",0)})),l.show(),u.hide())}hO.prototype=new sO,hO.prototype.constructor=hO;let gO=class extends oO{constructor(t,e,n,i){i=void 0!==i&&i,super(t,e,n);var r=new hO(t,e,this,this.getRootSubjectEntity(),i),o=$(su.template('<div class="file_attribute">\n    <div class="name"></div>\n    <div class="value"></div>\n</div>')());this.setValue=function(t){r=t,o.val(t)},this.getValue=function(){return r},this.get$node=function(){return o},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.value=r.toJSON(),t},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},o.find(".name").text(this.getName()),o.find(".value").append(r.get$node())}},vO='<div class="val"><%= value %></div>';let yO=class extends sO{constructor(t,e,n,i,r){super(t,e,n,i);var o=this;r&&(vO='<input\n  class="form-control h-100 val"\n  type="number"\n  name="<%= name %>"\n  value="0"\n/>\n');var a=0,s=$(su.template(vO)({value:a}));y=y||window.y;var l=iO.getInstance(f_.WIDGET.NAME.MAIN,y);this.setValue=function(t){a=t,r?s.val(t):s.text(t)},this.getValue=function(){return a},this.get$node=function(){return s},this.toJSON=function(){var t=sO.prototype.toJSON.call(this);return t.value=a,t},this.setValueFromJSON=function(t){this.setValue(t.value)},this.registerYType=function(){o.getRootSubjectEntity().getYMap().observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{var i=new I_(t.entityId,t.value,t.type,t.position,t.jabberId);if(l.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,i.getOTOperation()),function(t){o.setValue(t.getValue())}(i),l.getUser()[f_.NS.PERSON.JABBERID]===i.getJabberId()){y.getMap("activity").set(N_.TYPE,new N_("ValueChangeActivity",o.getEntityId(),l.getUser()[f_.NS.PERSON.JABBERID],I_.getOperationDescription(o.getSubjectEntity().getName(),o.getRootSubjectEntity().getType(),o.getRootSubjectEntity().getLabel().getValue().getValue()),{value:i.getValue(),subjectEntityName:o.getSubjectEntity().getName(),rootSubjectEntityType:o.getRootSubjectEntity().getType(),rootSubjectEntityId:o.getRootSubjectEntity().getEntityId()}).toJSON())}else l.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,i.getOTOperation())}))})),o.getRootSubjectEntity().getYMap().observe(su.debounce((function(t){t&&t.jabberId===l.getUser()[f_.NS.PERSON.JABBERID]&&uT.storeDataYjs()}),500))},s.off()}};$.fn.autoGrowInput=function(t){return t=$.extend({maxWidth:1e3,minWidth:0,comfortZone:70},t),this.filter("input:text").each((function(){var e=t.minWidth||$(this).width(),n=$(this),i=$("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:n.css("fontSize"),fontFamily:n.css("fontFamily"),fontWeight:n.css("fontWeight"),letterSpacing:n.css("letterSpacing"),whiteSpace:"nowrap"});$("body").append(i),$(this).bind("keyup keydown blur update",(function(){var r=n.val().replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");i.html(r);var o=i.width(),a=o+t.comfortZone>=e?o+t.comfortZone:e;(a<n.width()&&a>=e||a>e&&a<t.maxWidth)&&n.width(a)}))})),this};let bO=class extends sO{value="";constructor(t,e,n,r,o){var a=iO.getInstance(f_.WIDGET.NAME.MAIN,o),s=null;if((o=o||window.y)&&-1==t.indexOf("undefined")){const e=r.getYMap();if(!e)throw new Error("yMap is undefined");e?.has(t)&&(s=r.getYMap().get(t))instanceof i||(s=new i,r.getYMap().set(t,s))}super(t,e,n,r);var l=this,u="";this.value=u;var c=$(su.template('<input\n  class="form-control val"\n  type="text"\n  name="<%= name %>"\n  disabled="disabled"\n/>\n')({name:e}));this.setValue=function(t){u=t,c.val(t).trigger("blur"),this.value=s.toString()},this.getValue=function(){return u},this.get$node=function(){return c},this.toJSON=function(){var t=sO.prototype.toJSON.call(this);return t.value=u,t},this.setValueFromJSON=function(t){this.setValue(t.value)},this.registerYType=function(){c.on("input",(function(){s&&c.val()!==s.toString()&&(s.toString().length>0&&s.delete(0,s.toString().length),s.insert(0,c.val()))})),l.getValue()!==s.toString()&&(s.toString().length>0&&s.delete(0,s.toString().length-1),s.insert(0,l.getValue())),s.observe((function(t){u=s.toString().replace(/\n/g,""),l.setValue(u)})),s.observe(su.debounce((function(t){t.keysChanged.forEach((e=>{if("delete"!==e){var n=o.getMap("users").get(t.object._content[t.index].id[0]);if(n===a.getUser()[f_.NS.PERSON.JABBERID]){uT.storeDataYjs();o.getMap("activity").set(N_.TYPE,new N_("ValueChangeActivity",l.getEntityId(),n,I_.getOperationDescription(l.getSubjectEntity().getName(),l.getRootSubjectEntity().getType(),l.getRootSubjectEntity().getLabel().getValue().getValue()),{value:u,subjectEntityName:l.getSubjectEntity().getName(),rootSubjectEntityType:l.getRootSubjectEntity().getType(),rootSubjectEntityId:l.getRootSubjectEntity().getEntityId()}).toJSON())}else uT.storeDataYjs()}}))}),500))},this.getYText=function(){return s},c.autoGrowInput({comfortZone:10,minWidth:40,maxWidth:1e3}).trigger("blur")}};function mO(){}mO.GetAllNodesOfBaseModelAsSelectionList=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n].getLabel().getValue().getValue());return e},mO.GetAllNodesOfBaseModelAsSelectionList2=function(t,e){var n={empty:""};for(var i in t)t.hasOwnProperty(i)&&-1!=su.indexOf(e,t[i].type)&&(n[i]=t[i].label.value.value);return n},mO.createReferenceToOrigin=function(t){var e,n=y.getMap("data").get("metamodelpreview");if(n){var i=t.getAttribute(t.getEntityId()+"[target]").getValue().getValue();"ViewObject"===t.getType()?n.nodes.hasOwnProperty(i)&&(e=n.nodes[i],t.getLabel().getValue().setValue(e.label)):n.edges.hasOwnProperty(i)&&(e=n.edges[i],t.getLabel().getValue().setValue(e.label));var r=e.attributes,o=t.getAttribute("[attributes]"),a={};for(var s in r)if(r.hasOwnProperty(s)){var l=r[s],u=Z_.generateRandomId(),c=new O_(u,o.getEntityId(),t.getEntityId,"RenamingAttribute"),d=o.propagateAttributeAddOperation(c);d.getKey().setValue(l.key),d.getRef().setValue(l.key),a[u]=l.key}t.getYMap().set("updateConditionOption",a),o.get$node().show(),t.getAttribute(t.getEntityId()+"[conjunction]").get$node().show(),t.getAttribute("[condition]").get$node().show()}};let EO=class extends oO{constructor(t,e,n){super(t,e,n);var i=new bO(t,e,this,this.getRootSubjectEntity()),r=$(su.template('<div class="single_quiz_attribute">\n  <div class="name"></div>\n  <div class="value"></div>\n  <table id="table" style="float: left; visibility: hidden">\n    <tr>\n      <th>Assessment Name :</th>\n      <th><input class="form-control" id="topic" /></th>\n    </tr>\n    <tr>\n      <td>Nr</td>\n      <td>Question</td>\n      <td>Correct Intent</td>\n      <td>Optional Hint</td>\n    </tr>\n  </table>\n  <button\n    id="b"\n    style="margin-left: 3px; float: left; width: 50%; visibility: hidden"\n  >\n    +\n  </button>\n  <button\n    id="c"\n    style="margin-left: 3px; float: left; width: 50%; visibility: hidden"\n  >\n    -\n  </button>\n  <button\n    id="submit"\n    style="margin-left: 3px; float: left; width: 50%; visibility: hidden"\n  >\n    Submit\n  </button>\n  <button\n    id="display"\n    style="margin-left: 3px; float: left; width: 50%; visibility: hidden"\n  >\n    Display\n  </button>\n</div>\n')({id:t}));function o(){var t=r.find("#table")[0],e=t.rows.length,n=t.insertRow(t.rows.length),i=n.insertCell(0),o=n.insertCell(1),a=n.insertCell(2),s=n.insertCell(3),l=document.createElement("input"),u=document.createElement("input"),c=document.createElement("input"),d=document.createElement("input");l.id=e+"0",u.id=e+"1",c.id=e+"2",d.id=e+"3",u.type="text",c.type="text",d.type="text",i.appendChild(l),o.appendChild(u),a.appendChild(c),s.appendChild(d)}this.setValue=function(t){i=t},this.getValue=function(){return i},this.get$node=function(){return r},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.value=i.toJSON(),t},this.setValueFromJSON=function(t){i.setValueFromJSON(t.value)},this.registerYType=function(){i.registerYType()},r.find(".name").text(this.getName()),r.find(".value").append(i.get$node()),this.showTable=function(){r.find("#table")[0].style.visibility="visible",r.find("#b")[0].style.visibility="visible",r.find("#c")[0].style.visibility="visible",r.find("#submit")[0].style.visibility="visible",r.find("#display")[0].style.visibility="visible"},this.hideTable=function(){r.find("#table")[0].style.visibility="hidden",r.find("#b")[0].style.visibility="hidden",r.find("#c")[0].style.visibility="hidden",r.find("#submit")[0].style.visibility="hidden",r.find("#display")[0].style.visibility="hidden"},r.find("#b").click((function(){o()})),r.find("#c").click((function(){var t=r.find("#table")[0],e=t.rows.length;t.deleteRow(e-1)})),r.find("#submit").click((function(){var t=r.find("#table")[0],e={};e.topic=r.find("#topic")[0].value;for(var n=[],i=[],o=[],a=[],s=t.rows.length,l=2;l<s;l++)""!=r.find("#"+l.toString()+"1")[0].value&&""!=r.find("#"+l.toString()+"2")[0].value&&(n.push(r.find("#"+l.toString()+"0")[0].value),i.push(r.find("#"+l.toString()+"1")[0].value),o.push(r.find("#"+l.toString()+"2")[0].value),""==r.find("#"+l.toString()+"3")[0].value?a.push("No Hint Available for this Question"):a.push(r.find("#"+l.toString()+"3")[0].value));e.Questions=i,e.Sequence=n,e.Intents=o,e.Hints=a,console.log(JSON.stringify(e)),r.find(".val")[0].value=JSON.stringify(e),r.find(".val")[0].dispatchEvent(new Event("input"))})),r.find("#display").click((function(){var t=r.find("#table")[0],e=r.find(".val")[0].value;console.log(e);var n=JSON.parse(e);r.find("#topic")[0].value=n.topic;var i=n.Questions.length;console.log(i);var a=t.rows.length-2;if(console.log(a),a<i)for(;a<i;a++)o();for(var s=2;s<i+2&&null!=r.find("#"+s.toString()+"0")[0].value;s++)r.find("#"+s.toString()+"0")[0].value=n.Sequence[s-2],r.find("#"+s.toString()+"1")[0].value=n.Questions[s-2],r.find("#"+s.toString()+"2")[0].value=n.Intents[s-2],r.find("#"+s.toString()+"3")[0].value=n.Hints[s-2]}))}},wO='<div class="val"><%= options[_.keys(options)[0]] %></div>';let _O=class extends sO{constructor(t,e,n,i,r,o){super(t,e,n,i);var a=this;o="undefinded"!=typeof o&&o;var s=su.keys(r)[0];o&&(wO='<select class="val form-select mb-3 h-100">\n  <% _.each(options,function(option,key){ %>\n  <option value="<%= key %>"><%= option %></option>\n  <% }); %>\n</select>\n');var l=$(su.template(wO)({name:e,options:r}));o&&l.off(),y=y||window.y;var u=iO.getInstance(f_.WIDGET.NAME.MAIN,y);this.setValue=function(t){s=t,o?(l.val(t),"Quiz"==t?Object.values(i.getAttributes()).forEach((t=>{t instanceof EO&&t.showTable()})):Object.values(i.getAttributes()).forEach((t=>{t instanceof EO&&t.hideTable()}))):l.text(r[t])},this.getValue=function(){return s},this.get$node=function(){return l},this.toJSON=function(){var t=sO.prototype.toJSON.call(this);return t.value=s,t},this.setValueFromJSON=function(t){this.setValue(t.value)},this.registerYType=function(){a.getRootSubjectEntity().getYMap().observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{var r=new I_(t.entityId,t.value,t.type,t.position,t.jabberId);if(u.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,r.getOTOperation()),function(t){a.setValue(t.getValue())}(r),u.getUser()[f_.NS.PERSON.JABBERID]===r.getJabberId()){y.getMap("activity").set(N_.TYPE,new N_("ValueChangeActivity",a.getEntityId(),u.getUser()[f_.NS.PERSON.JABBERID],I_.getOperationDescription(a.getSubjectEntity().getName(),a.getRootSubjectEntity().getType(),a.getRootSubjectEntity().getLabel().getValue().getValue()),{value:r.getValue(),subjectEntityName:a.getSubjectEntity().getName(),rootSubjectEntityType:a.getRootSubjectEntity().getType(),rootSubjectEntityId:a.getRootSubjectEntity().getEntityId()}).toJSON()),-1!=t.entityId.indexOf("[target]")&&(mO.createReferenceToOrigin(a.getRootSubjectEntity()),Promise.resolve().then((function(){return pS})).then((function(t){t(i)}))),uT.storeDataYjs()}else u.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,r.getOTOperation())}))}))}}};let OO=class extends oO{constructor(t,e,n,i){super(t,e,n);var r=i,o=new bO(t+"[key]","",this,this.getRootSubjectEntity()),a=new _O(t+"[value]","",this,this.getRootSubjectEntity(),r),s=$(su.template('<li class="key_value_attribute" id="<%= id %>">\n    <div class="key"></div>\n    <div class="value"></div>\n</li>')({id:t}));this.setKey=function(t){o=t},this.getKey=function(){return o},this.setValue=function(t){a=t},this.getValue=function(){return a},this.get$node=function(){return s},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.key=o.toJSON(),t.value=a.toJSON(),t},this.setValueFromJSON=function(t){o.setValueFromJSON(t.key),a.setValueFromJSON(t.value)},this.registerYMap=function(){o.registerYType(),a.registerYType()},this.getYMap=function(){return null},s.find(".key").append(o.get$node()),s.find(".value").append(a.get$node())}};let TO=class t extends oO{static TYPE="KeySelectionValueListAttribute";constructor(e,n,i,r){super(e,n,i);var o=this,a=r,s={},l=$(su.template('<div class="list_attribute">\n    <div class="name"></div>\n    <ul class="list"></ul>\n</div>')());y=y||window.y;var u=iO.getInstance(f_.WIDGET.NAME.MAIN,y),c=function(t){var e=new OO(t.getEntityId(),"Attribute",o,a);e.registerYMap(),o.addAttribute(e),0==l.find(".list").find("#"+e.getEntityId()).length&&l.find(".list").append(e.get$node())},d=function(t){var e=o.getAttribute(t.getEntityId());e&&(o.deleteAttribute(e.getEntityId()),e.get$node().remove())},f=function(t){t instanceof O_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&function(t){c(t)}(t)},p=function(t){t instanceof T_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&function(t){d(t),o.getRootSubjectEntity().getYMap().delete(t.getEntityId()+"[key]")}(t)};for(var h in this.addAttribute=function(t){var e=t.getEntityId();s.hasOwnProperty(e)||(s[e]=t)},this.getAttribute=function(t){return s.hasOwnProperty(t)?s[t]:null},this.deleteAttribute=function(t){s.hasOwnProperty(t)&&delete s[t]},this.getAttributes=function(){return s},this.setAttributes=function(t){s=t},this.get$node=function(){return l},this.toJSON=function(){var e=oO.prototype.toJSON.call(this);e.type=t.TYPE;var n={};return su.forEach(this.getAttributes(),(function(t,e){n[e]=t.toJSON()})),e.list=n,e},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new OO(n,n,o,a);i.setValueFromJSON(t.list[n]),o.addAttribute(i),0==l.find(".list").find("#"+i.getEntityId()).length&&l.find(".list").append(i.get$node())}))},this.registerCallbacks=function(){u.registerOnDataReceivedCallback(f),u.registerOnDataReceivedCallback(p)},this.unregisterCallbacks=function(){u.unregisterOnDataReceivedCallback(f),u.unregisterOnDataReceivedCallback(p)},l.find(".name").text(this.getName()),s)s.hasOwnProperty(h)&&l.find(".list").append(s[h].get$node());u&&o.registerCallbacks(),this.registerYMap=function(){var t=o.getRootSubjectEntity().getYMap(),e=o.getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];i.getKey().registerYType(),i.getValue().registerYType()}t.observe((function(t){t.keysChanged;Array.from(t.changes.keys.entries()).forEach((([e,n])=>{if(-1!=e.indexOf("[key]"))switch(t.currentTarget.get(e),n.action){case"add":(function(t){t instanceof O_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&c(t)})(new O_(e.replace(/\[\w*\]/g,""),o.getEntityId(),o.getRootSubjectEntity().getEntityId(),o.constructor.name));break;case"delete":(function(t){t instanceof T_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&d(t)})(new T_(e.replace(/\[\w*\]/g,""),o.getEntityId(),o.getRootSubjectEntity().getEntityId(),o.constructor.name))}}))}))}}};let xO=class extends oO{constructor(t,e,n,i,r){super(t,e,n);var o=i,a=r,s=new bO(t+"[key]","",this,this.getRootSubjectEntity()),l=new _O(t+"[value]","",this,this.getRootSubjectEntity(),o),u=new _O(t+"[value2]","",this,this.getRootSubjectEntity(),a),c=$(su.template('<li class="key_value_attribute" id="<%= id %>">\n    <div class="key"></div>\n    <div class="value"></div>\n</li>')({id:t}));this.setKey=function(t){s=t},this.getKey=function(){return s},this.setValue=function(t){l=t},this.getValue=function(){return l},this.setValue2=function(t){u=t},this.getValue2=function(){return u},this.get$node=function(){return c},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.key=s.toJSON(),t.value=l.toJSON(),t.value2=u.toJSON(),t},this.setValueFromJSON=function(t){s.setValueFromJSON(t.key),l.setValueFromJSON(t.value),u.setValueFromJSON(t.value2||{value:""})},this.registerYType=function(){s.registerYType(),l.registerYType(),u.registerYType()},c.find(".key").append(s.get$node()),c.find(".value").append(l.get$node())}};let AO=class t extends oO{static TYPE="KeySelectionValueSelectionValueListAttribute";constructor(e,n,i,r,o){super(e,n,i);var a=this,s=r,l=o,u={},c=$(su.template('<div class="list_attribute">\n    <div class="name"></div>\n    <ul class="list"></ul>\n</div>')());y=y||window.y;var d=iO.getInstance(f_.WIDGET.NAME.MAIN,y),f=function(t){var e=new xO(t.getEntityId(),"Attribute",a,s,l);e.registerYType(),a.addAttribute(e),0==c.find(".list").find("#"+e.getEntityId()).length&&c.find(".list").append(e.get$node())},p=function(t){var e=a.getAttribute(t.getEntityId());e&&(a.deleteAttribute(e.getEntityId()),e.get$node().remove())},h=function(t){t instanceof O_&&t.getRootSubjectEntityId()===a.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===a.getEntityId()&&function(t){f(t)}(t)},g=function(t){t instanceof T_&&t.getRootSubjectEntityId()===a.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===a.getEntityId()&&function(t){p(t),a.getRootSubjectEntity().getYMap().delete(t.getEntityId()+"[key]")}(t)};for(var v in this.addAttribute=function(t){var e=t.getEntityId();u.hasOwnProperty(e)||(u[e]=t)},this.getAttribute=function(t){return u.hasOwnProperty(t)?u[t]:null},this.deleteAttribute=function(t){u.hasOwnProperty(t)&&(u[t],delete u[t])},this.getAttributes=function(){return u},this.setAttributes=function(t){u=t},this.get$node=function(){return c},this.toJSON=function(){var e=oO.prototype.toJSON.call(this);e.type=t.TYPE;var n={};return su.forEach(this.getAttributes(),(function(t,e){n[e]=t.toJSON()})),e.list=n,e},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new xO(n,n,a,s,l);i.setValueFromJSON(t.list[n]),a.addAttribute(i),0==c.find(".list").find("#"+i.getEntityId()).length&&c.find(".list").append(i.get$node())}))},this.registerCallbacks=function(){d.registerOnDataReceivedCallback(h),d.registerOnDataReceivedCallback(g)},this.unregisterCallbacks=function(){d.unregisterOnDataReceivedCallback(h),d.unregisterOnDataReceivedCallback(g)},c.find(".name").text(this.getName()),u)u.hasOwnProperty(v)&&c.find(".list").append(u[v].get$node());d&&a.registerCallbacks(),this.registerYMap=function(){var t=a.getRootSubjectEntity().getYMap(),e=a.getAttributes();for(var n in e){if(e.hasOwnProperty(n))e[n].registerYType()}t.observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{if(-1!=e.indexOf("[key]"))switch(t.currentTarget.get(e),n.action){case"add":if(t.currentTarget.get("jabberId")===d.getUser()[f_.NS.PERSON.JABBERID])return;(function(t){t instanceof O_&&t.getRootSubjectEntityId()===a.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===a.getEntityId()&&f(t)})(new O_(e.replace(/\[\w*\]/g,""),a.getEntityId(),a.getRootSubjectEntity().getEntityId(),a.constructor.name));break;case"delete":(function(t){t instanceof T_&&t.getRootSubjectEntityId()===a.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===a.getEntityId()&&(d.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),p(t))})(new T_(e.replace(/\[\w*\]/g,""),a.getEntityId(),a.getRootSubjectEntity().getEntityId(),a.constructor.name))}}))}))}}};let SO=class extends oO{constructor(t,e,n){super(t,e,n);var i=new bO(t,e,this,this.getRootSubjectEntity()),r=$(su.template('<div class="single_value_attribute">\n    <div class="name"></div>\n    <div class="value"></div>\n</div>')());this.setValue=function(t){i=t},this.getValue=function(){return i},this.get$node=function(){return r},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.value=i.toJSON(),t},this.setValueFromJSON=function(t){i.setValueFromJSON(t.value)},r.find(".name").text(this.getName()),r.find(".value").append(i.get$node())}};let IO=class extends sO{constructor(t,e,n,r,o){super(t,e,n,r);var a=this,s=null;if(o=o||window.y){r.getYMap()||r.registerYMap(),r.getYMap()?.has(t)?s=r.getYMap().get(t):(s=new i,r.getYMap().set(t,s))}var l="",u=$(su.template('<div class="val"><%= value %></div>')({value:l}));o=o||window.y;var c=iO.getInstance(f_.WIDGET.NAME.MAIN,o),d=function(t){t.setEntityIdChain(function(){for(var t=[a.getEntityId()],e=a;e instanceof oO;)t.unshift(e.getSubjectEntity().getEntityId()),e=e.getSubjectEntity();return t}()),t.setRemote(!1),a.setValue(t.getValue()),t.setRemote(!0);o.getMap("activity").set(N_.TYPE,new N_("ValueChangeActivity",a.getEntityId(),c.getUser()[f_.NS.PERSON.JABBERID],I_.getOperationDescription(a.getSubjectEntity().getName(),a.getRootSubjectEntity().getType(),a.getRootSubjectEntity().getLabel().getValue().getValue()),{value:l,subjectEntityName:a.getSubjectEntity().getName(),rootSubjectEntityType:a.getRootSubjectEntity().getType(),rootSubjectEntityId:a.getRootSubjectEntity().getEntityId()}).toNonOTOperation().toJSON())},f=function(t){t instanceof I_&&t.getEntityId()===a.getEntityId()&&d(t)};this.setValue=function(t){l=t,u.text(t)},this.getValue=function(){return l},this.get$node=function(){return u},this.toJSON=function(){var t=sO.prototype.toJSON.call(this);return t.value=l,t},this.setValueFromJSON=function(t){this.setValue(t.value)},this.registerCallbacks=function(){c.registerOnDataReceivedCallback(f)},this.unregisterCallbacks=function(){c.unregisterOnDataReceivedCallback(f)},this.registerYType=function(){if(!s)throw new Error("_ytext is undefined");a.getValue()!==s.toString()&&(s.toString().length>0&&s.delete(0,s.toString().length-1),s.insert(0,a.getValue())),s.observe((function(t){if(l=s.toString(),"delete"!==t.type){o.getMap("users");o.getMap("activity").set(N_.TYPE,new N_("ValueChangeActivity",a.getEntityId(),"User",I_.getOperationDescription(a.getSubjectEntity().getName(),a.getRootSubjectEntity().getType(),a.getRootSubjectEntity().getLabel().getValue().getValue()),{value:"",subjectEntityName:a.getSubjectEntity().getName(),rootSubjectEntityType:a.getRootSubjectEntity().getType(),rootSubjectEntityId:a.getRootSubjectEntity().getEntityId()}).toJSON())}}))},c&&a.registerCallbacks()}};let kO=class extends oO{constructor(t,e,n,i){super(t,e,n);var r=new IO(t,e,this,this.getRootSubjectEntity(),i),o=$(su.template('<div class="single_value_attribute">\n    <div class="name"></div>\n    <div class="value"></div>\n</div>')());this.setValue=function(t){r=t},this.getValue=function(){return r},this.get$node=function(){return o},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.value=r.toJSON(),t},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},o.find(".name").text(this.getName()),o.find(".value").append(r.get$node())}};let PO=class extends oO{constructor(t,e,n,i,r){super(t,e,n),r="undefinded"!=typeof r&&r;var o=this,a=new _O(t,e,this,this.getRootSubjectEntity(),i,r),s=$(su.template('<div class="single_value_attribute">\n    <div class="name"></div>\n    <div class="value"></div>\n</div>')());this.setValue=function(t){a=t,s.val(t)},this.getValue=function(){return a},this.get$node=function(){return s},this.getOptionValue=function(){return i.hasOwnProperty(a.getValue())?i[a.getValue()]:null},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.value=a.toJSON(),t.option=o.getOptionValue(),t},this.getOptions=function(){return i},this.setValueFromJSON=function(t){a.setValueFromJSON(t.value)},s.find(".name").text(this.getName()),s.find(".value").append(a.get$node())}};let NO=class extends oO{value;constructor(t,e,n,i){if(!(i=i||window.y))throw new Error("y is undefined");super(t,e,n);var r=new bO(t,e,this,this.getRootSubjectEntity(),i);this.value=r;var o=$(su.template('<div class="single_value_attribute">\n    <div class="name"></div>\n    <div class="value"></div>\n</div>')());this.setValue=function(t){r=t,this.value=t},this.getValue=function(){return r},this.get$node=function(){return o},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.value=r.toJSON(),t},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},this.registerYType=function(){r.registerYType()},o.find(".name").text(this.getName()),o.find(".value").append(r.get$node())}};let CO=class t extends oO{static TYPE="SingleValueListAttribute";constructor(e,n,i){super(e,n,i);var r=this,o={},a=$(su.template('<div class="list_attribute">\n    <div class="name"></div>\n    <ul class="list"></ul>\n</div>')());y=y||window.y;var s=iO.getInstance(f_.WIDGET.NAME.MAIN,y),l=function(t){var e=new NO(t.getEntityId()+"[value]","Attribute",r);e.registerYType(),r.addAttribute(e),a.find(".list").append(e.get$node())},u=function(t){var e=r.getAttribute(t.getEntityId());e&&(r.deleteAttribute(e.getEntityId()),e.get$node().remove())},c=function(t){t instanceof O_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&function(t){l(t)}(t)},d=function(t){t instanceof T_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&function(t){u(t),r.getRootSubjectEntity().getYMap().delete(t.getEntityId())}(t)};for(var f in this.addAttribute=function(t){var e=t.getEntityId();o.hasOwnProperty(e)||(o[e]=t)},this.getAttribute=function(t){return o.hasOwnProperty(t)?o[t]:null},this.deleteAttribute=function(t){o.hasOwnProperty(t)&&delete o[t]},this.getAttributes=function(){return o},this.setAttributes=function(t){o=t},this.get$node=function(){return a},this.toJSON=function(){var e=oO.prototype.toJSON.call(this);e.type=t.TYPE;var n={};return su.forEach(this.getAttributes(),(function(t,e){n[e]=t.toJSON()})),e.list=n,e},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new NO(n,n,r,y);i.setValueFromJSON(t.list[n]),r.addAttribute(i),a.find(".list").append(i.get$node())}))},this.registerCallbacks=function(){s.registerOnDataReceivedCallback(c),s.registerOnDataReceivedCallback(d)},this.unregisterCallbacks=function(){s.unregisterOnDataReceivedCallback(c),s.unregisterOnDataReceivedCallback(d)},a.find(".name").text(this.getName()),o)o.hasOwnProperty(f)&&a.find(".list").append(o[f].get$node());s&&r.registerCallbacks(),this.registerYMap=function(t){var e=r.getRootSubjectEntity().getYMap(),n=r.getAttributes();for(var i in n){if(n.hasOwnProperty(i))n[i].getValue().registerYType()}e.observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{if(-1!=e.indexOf("[value]"))switch(n.action){case"add":if(t.target.get("jabberId")===s.getUser()[f_.NS.PERSON.JABBERID])return;(function(t){t instanceof O_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&l(t)})(new O_(e.replace(/\[\w*\]/g,""),r.getEntityId(),r.getRootSubjectEntity().getEntityId(),r.constructor.name));break;case"delete":!function(t){t instanceof T_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&u(t)}(new T_(e,r.getEntityId(),r.getRootSubjectEntity().getEntityId(),r.constructor.name))}}))}))}}};function jO(t,e,n,i,r,o,a,s,l,u,c,d){function f(c,d,f){var p=new u(c,d,f);return p.restyle(e,i,n,r,o,a,s,l),p.setCurrentViewType(t),p}return f.getConditions=function(){return c},f.getConditionConj=function(){return d},f.getArrowType=function(){return e},f.getShapeType=function(){return n},f.getColor=function(){return i},f.getOverlay=function(){return o},f.getOverlayPosition=function(){return a},f.getOverlayRotate=function(){return s},f.getAttributes=function(){return l},f.getTargetEdgeType=function(){return u},f.getType=function(){return t},f.getArrowOverlays=function(){var t=[];return aO().hasOwnProperty(e)&&t.push(aO(i)[e]),t},f.getShape=function(){return this.getTargetEdgeType().getShape()},f}function MO(t,e,n,i,r,o,a){function s(i,o,a,s,l,u){var c=new r(i,o,a,s,l,u);return c.set$shape(e),c.setAnchorOptions(n),c.setCurrentViewType(t),c}return s.prototype.constructor=s,s.getConditions=function(){return o},s.getConditionConj=function(){return a},s.get$shape=function(){return e},s.getAnchors=function(){return n},s.getTargetNodeType=function(){return r},s}let DO=class extends oO{static TYPE="ConditionPredicateAttribute";constructor(t,e,n,i,r){super(t,e,n);var o=i,a=r,s=new bO(t+"[value]","Attribute Value",this,this.getRootSubjectEntity()),l=new _O(t+"[property]","Attribute Name",this,this.getRootSubjectEntity(),o),u=new _O(t+"[operator]","Logical Operator",this,this.getRootSubjectEntity(),a),c=$(su.template('<li class="condition_predicate">\n    <div class="property"></div>\n    <div class="operator"></div>\n    <div class="val"></div>\n</li>')());this.setKey=function(t){s=t},this.getKey=function(){return s},this.setValue=function(t){l=t},this.getValue=function(){return l},this.setValue2=function(t){u=t},this.getValue2=function(){return u},this.get$node=function(){return c},this.setValueFromJSON=function(t){s.setValueFromJSON(t.val),l.setValueFromJSON(t.property),u.setValueFromJSON(t.operator||{value:""})},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.val=s.toJSON(),t.property=l.toJSON(),t.operator=u.toJSON(),t},c.find(".val").append(s.get$node()),c.find(".property").append(l.get$node()),c.find(".operator").append(u.get$node()),this.registerYMap=function(){s.registerYType(),l.registerYType(),u.registerYType()}}};function RO(t){const e=Array.from(t.changes.keys.keys());if(!e)return!1;const n=e.find((t=>"modifiedBy"===t));return!(!n||t.currentTarget.get(n)!==window.y.clientID)}let LO=class t extends oO{static TYPE="ConditionListAttribute";constructor(e,n,i,r,o,a){a=a||window.y,super(e,n,i);var s=this,l=r,u=o,c={},d=$(su.template('<div class="list_attribute">\n    <div class="name"></div>\n    <ul class="list"></ul>\n</div>')()),f=iO.getInstance(f_.WIDGET.NAME.MAIN,a),p=function(t){var e=new DO(t.getEntityId(),"Attribute",s,l,u);e.registerYMap(),s.addAttribute(e),d.find(".list").append(e.get$node())},h=function(t){var e=s.getAttribute(t.getEntityId());e&&(s.deleteAttribute(e.getEntityId()),e.get$node().remove())},g=function(t){t instanceof O_&&t.getRootSubjectEntityId()===s.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===s.getEntityId()&&function(t){p(t)}(t)},v=function(t){t instanceof T_&&t.getRootSubjectEntityId()===s.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===s.getEntityId()&&function(t){h(t),s.getRootSubjectEntity().getYMap().delete(t.getEntityId()+"[val]")}(t)};for(var y in this.addAttribute=function(t){var e=t.getEntityId();c.hasOwnProperty(e)||(c[e]=t)},this.getAttribute=function(t){return c.hasOwnProperty(t)?c[t]:null},this.deleteAttribute=function(t){c.hasOwnProperty(t)&&delete c[t]},this.getAttributes=function(){return c},this.setAttributes=function(t){c=t},this.get$node=function(){return d},this.setOptions=function(t){l=t},this.toJSON=function(){var e=oO.prototype.toJSON.call(this);e.type=t.TYPE;var n={};return su.forEach(this.getAttributes(),(function(t,e){n[e]=t.toJSON()})),e.list=n,e},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new DO(n,n,s,l,u);i.setValueFromJSON(t.list[n]),s.addAttribute(i),d.find(".list").append(i.get$node())}))},this.registerCallbacks=function(){f.registerOnDataReceivedCallback(g),f.registerOnDataReceivedCallback(v)},this.unregisterCallbacks=function(){f.unregisterOnDataReceivedCallback(g),f.unregisterOnDataReceivedCallback(v)},d.find(".name").text(this.getName()),c)c.hasOwnProperty(y)&&d.find(".list").append(c[y].get$node());this.registerYMap=function(){var t=s.getRootSubjectEntity().getYMap(),e=s.getAttributes();for(var n in e)e.hasOwnProperty(n)&&e[n].registerYMap();t.observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{if(-1!=e.indexOf("[value]"))switch(t.currentTarget.get(e),n.action){case"add":if(RO(t))return;if(t.currentTarget.get("jabberId")===f.getUser()[f_.NS.PERSON.JABBERID])return;(function(t){t instanceof O_&&t.getRootSubjectEntityId()===s.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===s.getEntityId()&&p(t)})(new O_(e.replace(/\[\w*\]/g,""),s.getEntityId(),s.getRootSubjectEntity().getEntityId(),s.constructor.name));break;case"delete":(function(t){t instanceof T_&&t.getRootSubjectEntityId()===s.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===s.getEntityId()&&h(t)})(new T_(e.replace(/\[\w*\]/g,""),s.getEntityId(),s.getRootSubjectEntity().getEntityId(),s.constructor.name))}else-1!=e.indexOf("updateConditionOption")&&s.setOptions(t.value)}))}))},f&&s.registerCallbacks()}};var YO={AND:"&&",OR:"||"},VO={greater:">",smaller:"<",equal:"==",greater_eq:">=",smaller_eq:"<=",nequal:"!="};let BO=class extends oO{static TYPE="RenamingAttribute";constructor(t,e,n,i){super(t,e,n);var r=i,o=new bO(t+"[val]","Attribute Name",this,this.getRootSubjectEntity()),a=new bO(t+"[ref]","Attribute Reference",this,this.getRootSubjectEntity()),s=new _O(t+"[vis]","Attribute Visibility",this,this.getRootSubjectEntity(),r),l=$(su.template('<li class="renaming_attr">\n    <div class="val"></div>\n    <div class="ref" ></div>\n    <div class="vis"></div>\n</li>')());this.setKey=function(t){o=t},this.getKey=function(){return o},this.getRef=function(){return a},this.getVis=function(){return s},this.setVis=function(t){s=t},this.get$node=function(){return l},this.setValueFromJSON=function(t){o.setValueFromJSON(t.val),a.setValueFromJSON(t.ref),s.setValueFromJSON(t.vis||{value:""})},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.val=o.toJSON(),t.ref=a.toJSON(),t.vis=s.toJSON(),t},l.find(".val").append(o.get$node()),l.find(".ref").append(a.get$node()).hide(),l.find(".vis").append(s.get$node()),this.registerYMap=function(){o.registerYType(),a.registerYType(),s.registerYType()}}};let $O=class t extends oO{static TYPE="RenamingListAttribute";constructor(e,n,i,r,o){o=o||window.y,super(e,n,i);var a=this,s=r,l={},u=$(su.template('<div class="list_attribute">\n    <div class="name"></div>\n    <ul class="list"></ul>\n</div>')()),c=iO.getInstance(f_.WIDGET.NAME.MAIN,o),d=function(t){var e=new BO(t.getEntityId(),"Attribute",a,s);return a.addAttribute(e),e.registerYMap(),u.find(".list").append(e.get$node()),e};this.propagateAttributeAddOperation=function(t){return d(t)};var f=function(t){var e=a.getAttribute(t.getEntityId());e&&(a.deleteAttribute(e.getEntityId()),e.get$node().remove())},p=function(t){t instanceof O_&&t.getRootSubjectEntityId()===a.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===a.getEntityId()&&propagateAttributeAddOperation(t)},h=function(t){t instanceof T_&&t.getRootSubjectEntityId()===a.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===a.getEntityId()&&function(t){f(t),a.getRootSubjectEntity().getYMap().delete(t.getEntityId()+"[val]")}(t)};for(var g in this.addAttribute=function(t){var e=t.getEntityId();l.hasOwnProperty(e)||(l[e]=t)},this.getAttribute=function(t){return l.hasOwnProperty(t)?l[t]:null},this.deleteAttribute=function(t){l.hasOwnProperty(t)&&delete l[t]},this.getAttributes=function(){return l},this.setAttributes=function(t){l=t},this.get$node=function(){return u},this.setOptions=function(t){s=t},this.toJSON=function(){var e=oO.prototype.toJSON.call(this);e.type=t.TYPE;var n={};return su.forEach(this.getAttributes(),(function(t,e){n[e]=t.toJSON()})),e.list=n,e},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new BO(n,n,a,s);i.setValueFromJSON(t.list[n]),a.addAttribute(i),u.find(".list").append(i.get$node())}))},this.registerCallbacks=function(){c.registerOnDataReceivedCallback(p),c.registerOnDataReceivedCallback(h)},this.unregisterCallbacks=function(){c.unregisterOnDataReceivedCallback(p),c.unregisterOnDataReceivedCallback(h)},u.find(".name").text(this.getName()),l)l.hasOwnProperty(g)&&u.find(".list").append(l[g].get$node());c&&a.registerCallbacks(),this.registerYMap=function(){var t=a.getRootSubjectEntity().getYMap(),e=a.getAttributes();for(var n in e){if(e.hasOwnProperty(n))e[n].registerYMap()}t.observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{if(-1!=e.indexOf("[val]"))switch(t.currentTarget.get(e),n.action){case"add":!function(t){t instanceof O_&&t.getRootSubjectEntityId()===a.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===a.getEntityId()&&(d(t),i.showAttributes())}(new O_(e.replace(/\[\w*\]/g,""),a.getEntityId(),a.getRootSubjectEntity().getEntityId(),a.constructor.name));break;case"delete":!function(t){t instanceof T_&&t.getRootSubjectEntityId()===a.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===a.getEntityId()&&f(t)}(new T_(e.replace(/\[\w*\]/g,""),a.getEntityId(),a.getRootSubjectEntity().getEntityId(),a.constructor.name));break}}))}))}}};const FO='<div class="custom_node">\n    <div class="type"><%= "<\\%= type %\\>" %></div>\n    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 100 100" class="fill_parent">\n        <rect x="0" y="0" rx="20" ry="20" width="100" height="100" fill="white" stroke="lightgray" stroke-width="2" />\n    </svg>\n    <div class="fill_parent" style="overflow:hidden;">\n    \t<table style="width:100%; height:100%">\n\t\t  <tr>\n\t\t    <td style="width:1px; white-space:nowrap; padding:10px;"><i class="fa fa-<%= icon %> fa-2x"></i></td>\n\t\t    <td style="text-align:center"><%= label %></td>\t\t\n\t\t  </tr>\n\t\t</table>\n    </div>\n</div>',GO='<div class="custom_node">\n    <div class="type"><%= "<\\%= type %\\>" %></div>\n    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 100 100" class="fill_parent">\n        <defs>\n            <linearGradient id="entityGrad" x1="0%" y1="0%" x2="0%" y2="100%">\n              <stop offset="0%" style="stop-color:#DAE8FC;stop-opacity:1" />\n              <stop offset="100%" style="stop-color:#7EA6E0;stop-opacity:1" />\n            </linearGradient>\n          </defs>\n        <rect x="0" y="0" width="100" height="100" fill="url(#entityGrad)" stroke="lightgray" stroke-width="2" />\n    </svg>\n    <div class="fill_parent" style="overflow:hidden;">\n    \t<table style="width:100%; height:100%">\n\t\t  <tr>\n\t\t    <td style="width:1px; white-space:nowrap; padding:10px;"><i class="fa fa-<%= icon %> fa-2x"></i></td>\n\t\t    <td style="text-align:center"><%= label %></td>\t\t\n\t\t  </tr>\n\t\t</table>\n    </div>\n</div>',qO='<div class="custom_node">\n    <div class="type"><%= "<\\%= type %\\>" %></div>\n    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 100 100" class="fill_parent">\n        <rect x="0" y="0" rx="20" ry="20" width="100" height="100" fill="white" stroke="lightgray" stroke-width="2" />\n    </svg>\n    <div class="fill_parent" style="overflow:hidden">\n    \t<table style="width:100%; height:100%">\n\t\t  <tr>\n\t\t    <td style="width:1px; white-space:nowrap; padding:10px;"><i class="fa fa-pencil-square-o fa-2x"></i></td>\n\t\t    <td style="text-align:center" class="property"></td>\t\t\n\t\t  </tr>\n\t\t</table>\n    </div>\n</div>';var UO={straight:{type:Ut.type,options:{gap:0}},curved:{type:hs.type,options:{gap:0}},segmented:{type:As.type,options:{gap:0}}};const zO=new function(){var t=null,e=null,n=[],i=[],r=$("#undo"),o=$("#redo"),a=function(e){var n,i=i,r=null,o=null;switch(e.TYPE){case m_.TYPE:(n=i.findNode(e.id))&&(n.triggerDeletion(!0),r=new m_(e.id,e.type,e.left,e.top,e.width,e.height,e.zIndex,e.containment,e.json));break;case E_.TYPE:t.createNode(e.type,e.left,e.top,e.width,e.height,e.zIndex,e.containment,e.json,e.id,!0),r=new E_(e.id,e.type,e.left,e.top,e.width,e.height,e.zIndex,e.containment,e.json);break;case __.TYPE:t.createEdge(e.type,e.source,e.target,e.json,e.id,!0),r=new __(e.id,e.type,e.source,e.target,e.json);break;case w_.TYPE:(n=i.findEdge(e.id))&&(n.triggerDeletion(!0),r=new w_(e.id,e.type,e.source,e.target,e.json));break;case x_.TYPE:if(n=i.findNode(e.id)){const t=y.getMap("nodes");r=new x_(e.id,e.offsetX,e.offsetY);var a=t.get(e.id);(o=r.toJSON()).historyFlag=!0,a.set(x_.TYPE,o)}break;case A_.TYPE:if(n=i.findNode(e.id)){r=new A_(e.id,e.offsetZ);a=y.getMap("nodes").get(e.id);(o=r.toJSON()).historyFlag=!0,a.set(A_.TYPE,o)}break;case S_.TYPE:if(n=i.findNode(e.id)){r=new S_(e.id,e.offsetX,e.offsetY);a=y.getMap("nodes").get(e.id);(o=r.toJSON()).historyFlag=!0,a.set(S_.TYPE,o)}}return r};return{init:function(e){if(!e)throw new Error("Canvas is null");t=e},add:function(t){if(t.hasOwnProperty("inverse")){var e=t.inverse(),a=e.toJSON();a.TYPE=e.constructor.name,n.push(a),i=[],r.prop("disabled",!1),o.prop("disabled",!0)}n.length>20&&n.shift()},undo:function(){if(n.length>0){var t=n.pop();0===n.length&&r.prop("disabled",!0);var s=a(t);if(!s)return void this.undo();e=s;var l=s.inverse(),u=l.toJSON();u.TYPE=l.constructor.name,0===i.length&&o.prop("disabled",!1),i.push(u)}else r.prop("disabled",!0)},redo:function(){if(i.length>0){var t=i.pop();0===i.length&&o.prop("disabled",!0);var s=a(t);if(!s)return void this.redo();e=s;var l=s.inverse(),u=l.toJSON();u.TYPE=l.constructor.name,0===n.length&&r.prop("disabled",!1),n.push(u)}else o.prop("disabled",!0)},clean:function(t){var e=function(e,n){return e.id!==t};n=n.filter(e),i=i.filter(e),0===n.length&&r.prop("disabled",!0),0===i.length&&o.prop("disabled",!0)},getLatestOperation:function(){return e},getUndoList:function(){return n},getRedoList:function(){return i}}},JO=(new H_).openapp;var WO={circle:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <circle\n      cx="50"\n      cy="50"\n      r="50"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n',diamond:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <rect\n      x="15"\n      y="15"\n      width="70"\n      height="70"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n      transform="rotate(-45 50 50)"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n',rectangle:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <rect\n      x="0"\n      y="0"\n      width="100"\n      height="100"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n',rounded_rectangle:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <rect\n      x="0"\n      y="0"\n      rx="20"\n      ry="20"\n      width="100"\n      height="100"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n',triangle:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <path\n      d="M0,100 L50,0 L100,100 L0,100"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n'},HO=$("<div></div>"),XO=null,ZO={},KO=function(t){var e,n,i,r={},o=t.nodes;for(var a in o)if(o.hasOwnProperty(a)){if(n=(e=o[a]).shape.customShape?e.shape.customShape:WO.hasOwnProperty(e.shape.shape)?WO[e.shape.shape]:su.keys(WO)[0],e.shape.customAnchors)try{e.shape.customAnchors&&(i=JSON.parse(e.shape.customAnchors)),!e.shape.customAnchors instanceof Array&&(i={type:"Perimeter",options:{shape:"Rectangle",anchorCount:10}})}catch(t){i={type:"Perimeter",options:{shape:"Rectangle",anchorCount:10}}}else switch(e.shape.shape){case"circle":i={type:"Perimeter",options:{shape:"Circle",anchorCount:10}};break;case"diamond":i={type:"Perimeter",options:{shape:"Diamond",anchorCount:10}};break;case"rounded_rectangle":default:case"rectangle":i={type:"Perimeter",options:{shape:"Rectangle",anchorCount:10}};break;case"triangle":i={type:"Perimeter",options:{shape:"Triangle",anchorCount:10}}}var s=e.shape.color?HO.css("color","#FFFFFF").css("color",e.shape.color).css("color"):"#FFFFFF",l=$(su.template(n)({color:s,type:e.label}));e.hasOwnProperty("targetName")&&!$.isEmptyObject(ZO)&&ZO.hasOwnProperty(e.targetName)?(r[e.label]=MO(e.label,l,i,e.attributes,ZO[e.targetName],e.conditions,e.conjunction),ZO[e.targetName].VIEWTYPE=e.label):r[e.label]=cT(e.label,l,i,e.attributes),r[e.label].TYPE=e.label,r[e.label].DEFAULT_WIDTH=e.shape.defaultWidth,r[e.label].DEFAULT_HEIGHT=e.shape.defaultHeight,r[e.label].CONTAINMENT=e.shape.containment,r[e.label].SHAPE=l}return r},QO=function(t){var e,n={},i={},r=t.edges;for(var o in r)r.hasOwnProperty(o)&&((e=r[o]).hasOwnProperty("targetName")&&!$.isEmptyObject(nT)&&nT.hasOwnProperty(e.targetName)?(n[e.label]=jO(e.label,e.shape.arrow,e.shape.shape,e.shape.color,e.shape.dashstyle,e.shape.overlay,e.shape.overlayPosition,e.shape.overlayRotate,e.attributes,nT[e.targetName],e.conditions,e.conjunction),nT[e.targetName].VIEWTYPE=e.label):n[e.label]=gT(e.label,e.shape.arrow,e.shape.shape,e.shape.color,e.shape.dashstyle,e.shape.overlay,e.shape.overlayPosition,e.shape.overlayRotate,e.attributes),n[e.label].TYPE=e.label,i[e.label]=e.relations);return{edgeTypes:n,relations:i}},tT={},eT={},nT={},iT={};let rT=class extends oO{constructor(t,e,n,i){i=void 0!==i&&i,super(t,e,n);var r=new yO(t,e,this,this.getRootSubjectEntity(),i),o=$(su.template('<div class="single_value_attribute">\n    <div class="name"></div>\n    <div class="value"></div>\n</div>')());this.setValue=function(t){r=t,o.val(t)},this.getValue=function(){return r},this.get$node=function(){return o},this.toJSON=function(){var t=oO.prototype.toJSON.call(this);return t.value=r.toJSON(),t},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},o.find(".name").text(this.getName()),o.find(".value").append(r.get$node())}},oT=class extends rO{constructor(t,e,n,i,o,a){super(t),a=a||window.y;var s=this,l=iO.getInstance(f_.WIDGET.NAME.MAIN,a),u=null;if(!a)throw new Error("y is not defined");const c=a.getMap("edges");c.has(t)?u=c.get(t):t&&e&&n&&i&&(u=new r,c.set(t,new r),a.transact((()=>{u.set("id",t),u.set("type",e),u.set("source",n.getEntityId()),u.set("target",i.getEntityId()),u.set("jabberId",l.getUser()[f_.NS.PERSON.JABBERID])}))),this.getYMap=function(){return u};var d=e,f=new NO(t+"[label]","Label",this,a),p={source:n,target:i},h=!1!==o,g=$(su.template('<div>\n    <div class="type fixed"><%= type %></div>\n    <div class="edge_label"></div>\n</div>')({type:e})).find(".edge_label").append(f.get$node()).parent(),v=null,y=null,b={},m=function(){return{}},E=function(t){s.remove()},w=function(t){E(),l.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),l.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation());a.getMap("activity").set(N_.TYPE,new N_("EdgeDeleteActivity",t.getEntityId(),l.getUser()[f_.NS.PERSON.JABBERID],w_.getOperationDescription(s.getType(),s.getLabel().getValue().getValue()),{}).toJSON())};this.remoteEdgeDeleteCallback=function(t){t instanceof w_&&t.getEntityId()==s.getEntityId()&&(l.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),l.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()),E())};var _;this.setDefaultPaintStyle=function(t){_=t},this.getDefaultPaintStyle=function(){return _},this.triggerDeletion=function(e){v.select(null);var n=new w_(t,s.getType(),s.getSource().getEntityId(),s.getTarget().getEntityId());if(u){w(n);a.getMap("edges").delete(s.getEntityId())}else w(n);e||zO.add(n)},this.getContextMenuItemCallback=function(){return m},this.setContextMenuItemCallback=function(t){m=t},this.addToCanvas=function(t){if(!t)throw new Error("Canvas is null");v=t},this.getCanvas=function(){return v},this.removeFromCanvas=function(){v=null,$.contextMenu("destroy","."+s.getEntityId()),window.jsPlumbInstance.deleteConnection(y,{fireEvent:!1}),y=null},this.addAttribute=function(t){var e=t.getEntityId();b.hasOwnProperty(e)||(b[e]=t)},this.setAttributes=function(t){b=t},this.getAttributes=function(){return b},this.getAttribute=function(t){return b.hasOwnProperty(t)?b[t]:null},this.deleteAttribute=function(t){b.hasOwnProperty(t)||delete b[t]},this.setLabel=function(t){f=t},this.getLabel=function(){return f},this.getType=function(){return d},this.getSource=function(){return p.source},this.getTarget=function(){return p.target},this.get$overlay=function(){return g},this.setRotateOverlay=function(t){h=t},this.isRotateOverlay=function(){return h},this.setJsPlumbConnection=function(t){y=t,_=t.getPaintStyle()},this.getJsPlumbConnection=function(){return y},this.repaintOverlays=function(){function t(t){return function(){var e=$(this),n=e.css("transform","").css("transform");"none"===n&&(n=""),e.css({transform:n+" rotate("+t+"rad)","-o-transform":n+" rotate("+t+"rad)","-ms-transform":n+" rotate("+t+"rad)","-moz-transform":n+" rotate("+t+"rad)","-webkit-transform":n+" rotate("+t+"rad)"})}}var e,n,i,r,o,a;if(!y)throw new Error("jsPlumbConnection is null");for(r=y.endpoints[0].endpoint,o=y.endpoints[1].endpoint,a=Math.atan2(r.y-o.y,r.x-o.x),(!h||Math.abs(a)>Math.PI/2)&&(a+=Math.PI),e=0,n=(i=y.getOverlays()).length;e<n;e++)i[e]instanceof jsPlumb.Overlays.Custom&&($(i[e].getElement()).find(".fixed").not(".segmented").each(t(a)),$(i[e].getElement()).find(".fixed.type").not(".segmented").each(t(Math.abs(a-Math.PI)>Math.PI/2?a:a+Math.PI)))},this.setZIndex=function(){var e=function(){var e,n,i,r=$("."+t);if(!y)throw new Error("jsPlumbConnection is null");for(n=0,i=(e=y.getOverlays()).length;n<i;n++)e[n]instanceof jsPlumb.Overlays.Custom&&(r=r.add(e[n].getElement()));return r}(),r=Math.max(n.getZIndex(),i.getZIndex());e.css("zIndex",r)},this.connect=function(){n.addOutgoingEdge(this),i.addIngoingEdge(this),y=window.jsPlumbInstance.connect({source:p.source.get$node().get(0),target:p.target.get$node().get(0),paintStyle:{stroke:"black",outlineWidth:4},endpoint:"Dot",connector:{type:As.type},anchors:[n.getAnchorOptions(),i.getAnchorOptions()],overlays:[{type:"Custom",options:{create:function(){return g.get(0)},location:.5,id:"label"}}],cssClass:t}),this.repaintOverlays(),su.each(uT.getEdges(),(function(t){t.setZIndex()}))},this.lowlight=function(){$("."+t).addClass("lowlighted")},this.unlowlight=function(){$("."+t).removeClass("lowlighted")},this.select=function(){var t,e,n,i=su.clone(_);function r(){$(this).css("fontWeight","bold")}if(this.unhighlight(),!y)throw new Error("jsPlumbConnection is null");for(i.lineWidth=4,y.setPaintStyle(i),e=0,n=(t=y.getOverlays()).length;e<n;e++)t[e]instanceof jsPlumb.Overlays.Custom&&$(t[e].getElement()).find(".fixed").each(r)},this.unselect=function(){var t,e,n;function i(){$(this).css("fontWeight","")}if(this.highlight(null),y)for(y.setPaintStyle(_),e=0,n=(t=y.getOverlays()).length;e<n;e++)t[e]instanceof jsPlumb.Overlays.Custom&&$(t[e].getElement()).find(".fixed").each(i);uT.storeDataYjs()},this.highlight=function(t){var e=su.clone(_);if(t){if(e.strokeStyle=t,e.lineWidth=4,!y)throw new Error("jsPlumbConnection is null");y.setPaintStyle(e)}},this.unhighlight=function(){if(!y)throw new Error("jsPlumbConnection is null");y.setPaintStyle(_)},this.remove=function(){n.deleteOutgoingEdge(this),i.deleteIngoingEdge(this),this.removeFromCanvas(),uT.deleteEdge(this.getEntityId()),u&&(u=null)},this._toJSON=function(){var t={};return su.forEach(this.getAttributes(),(function(e,n){t[n]=e.toJSON()})),{label:f.toJSON(),source:n.getEntityId(),target:i.getEntityId(),attributes:t,type:d}},this.bindMoveToolEvents=function(){if(!y)throw new Error("jsPlumbConnection is null");if($("."+t).on("click",(function(t){v.select(s)})),$(y.getOverlay("label").canvas).find("input").prop("disabled",!1).css("pointerEvents",""),t){if(a.getMap("widgetConfig").get("view_only"))return}$.contextMenu({selector:"."+t,zIndex:rO.CONTEXT_MENU_Z_INDEX,build:function(){return{items:su.extend(m(),{delete:{name:"Delete",callback:function(){s.triggerDeletion()}}}),events:{show:function(){v.select(s)}}}}})},this.unbindMoveToolEvents=function(){if(!y)throw new Error("jsPlumbConnection is null");y.unbind("click"),$(y.getOverlay("label").canvas).find("input").prop("disabled",!0).css("pointerEvents","none")},this._registerYMap=function(){s.getLabel().getValue().registerYType()}}toJSON(){return this._toJSON()}hide(){this.getJsPlumbConnection().setVisible(!1)}show(){this.getJsPlumbConnection().setVisible(!0)}registerYMap(){this._registerYMap()}},aT=class extends rO{nodeSelector;_$node;constructor(t,e,n,i,o,a,s,l,u,c){super(t);var d=this;if(!(c=c||window.y))throw new Error("y is undefined");var f=iO.getInstance(f_.WIDGET.NAME.MAIN,c),p=null;if(!(c=c||window.y))throw new Error("y is undefined");const h=c.getMap("nodes");h.has(t)?p=h.get(t):window.y.transact((()=>{p=new r,h.set(t,p),p.set("modifiedBy",window.y.clientID),p.set("left",n),p.set("top",i),p.set("width",o),p.set("height",a),p.set("zIndex",s),p.set("containment",l),p.set("type",e),p.set("id",t),u&&p.set("json",u),-1!==f.getUser().globalId&&p.set("jabberId",f.getUser()[f_.NS.PERSON.JABBERID])})),this.getYMap=function(){return p};var g=e,v=new NO(t+"[label]","Label",this,c),y={left:n,top:i,width:o,height:a,containment:l},b=s,m=l,E=null,w=$(su.template('<div id="<%= id %>" class="node">\n</div>')({id:t}));this._$node=w;const _=$('<div class="resize-handle p-1"><i class="bi bi-aspect-ratio" style="font-size:3em;"></i></div>');_.css({position:"absolute",bottom:"0",right:"0",cursor:"nwse-resize",zIndex:1e5}),w.append(_),_.on("mouseover",(()=>{this.disableDraggable()})),_.on("mouseout",(()=>{this.enableDraggable()})),this.nodeSelector=h_(this._$node[0]);var O=$(su.template('<div id="<%= id %>" class="trace_awareness">\n<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 100 100" style="overflow: visible;">\n        <circle cx="0" cy="0" r="50" stroke="lightgray" stroke-width="0" />\n</svg>\n</div>')({id:t+"_awareness"})),T=setInterval((function(){var t=O.css("opacity");(t-=.1)<0&&(t=0),O.css({opacity:t})}),3e3);this._$node.on("mousedown",(function(t){E.select(d),E.unbindMoveToolEvents()})),this._$node.on("mouseup",(function(t){E.bindMoveToolEvents()}));var x={},A=function(){return{}},S={},I={},k={},P={},N=[],C=function(t){E.hideGuidanceBox(),d.move(t.getOffsetX(),t.getOffsetY(),0),E.showGuidanceBox()},j=function(t){d.move(0,0,t.getOffsetZ())};this.propagateNodeMoveOperation=function(t){t.setJabberId(f.getUser()[f_.NS.PERSON.JABBERID]),C(t),zO.add(t),uT.storeDataYjs(),Y(),f.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.HEATMAP,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation());c.getMap("activity").set(N_.TYPE,new N_("NodeMoveActivity",t.getEntityId(),t.getJabberId(),x_.getOperationDescription(d.getType(),d.getLabel().getValue().getValue()),{nodeType:d.getType()}).toJSON()),p&&p.set(x_.TYPE,t.toJSON())},this.propagateNodeMoveZOperation=function(t){var e=f.getUser()[f_.NS.PERSON.JABBERID];t.setJabberId(e),j(t),zO.add(t),Y(),f.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation());c.getMap("activity").set(N_.TYPE,new N_("NodeMoveActivity",t.getEntityId(),e,x_.getOperationDescription(d.getType(),d.getLabel().getValue().getValue()),{nodeType:d.getType()}).toJSON()),p&&p.set(A_.TYPE,t.toJSON())};var M=function(t){E.hideGuidanceBox(),d.resize(t.getOffsetX(),t.getOffsetY()),E.showGuidanceBox()};this.propagateNodeResizeOperation=function(t){t.setJabberId(f.getUser()[f_.NS.PERSON.JABBERID]),M(t),zO.add(t),uT.storeDataYjs(),Y(),f.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.HEATMAP,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation());c.getMap("activity").set(N_.TYPE,new N_("NodeResizeActivity",t.getEntityId(),t.getJabberId(),S_.getOperationDescription(d.getType(),d.getLabel().getValue().getValue()),{nodeType:d.getType()}).toJSON()),p&&p.set("NodeResizeOperation",t.toJSON())};var D=function(t){var e,n=d.getEdges();for(e in n)n.hasOwnProperty(e)&&n[e].remove();for(var i=0;i<N.length;i++)"function"==typeof N[i].remove&&N[i].remove();p&&(p=null),d.remove()},R=function(t){D(),uT.storeDataYjs(),f.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.HEATMAP,t.getOTOperation());c.getMap("activity").set(N_.TYPE,new N_("NodeDeleteActivity",t.getEntityId(),f.getUser()[f_.NS.PERSON.JABBERID],m_.getOperationDescription(d.getType(),d.getLabel().getValue().getValue()),{}).toJSON())},L=function(t){O.css({opacity:1,fill:t})},Y=function(){O.css({opacity:0})};this.remoteNodeDeleteCallback=function(t){t instanceof m_&&t.getEntityId()===d.getEntityId()&&(f.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.HEATMAP,t.getOTOperation()),D(),zO.clean(t.getEntityId()))},this.init=function(){$.contextMenu({selector:"#"+t,zIndex:rO.CONTEXT_MENU_Z_INDEX,build:function(t,e){var n=uT;return $(e.target).offset(),d.getCanvas().get$node().offset(),null===E.getSelectedEntity()||E.getSelectedEntity()===d?{items:su.extend(A(),{connectTo:n.generateConnectToMenu(d),sepMove:"---------",moveToForeground:{name:"Move to Foreground",callback:function(){d.propagateNodeMoveZOperation(new A_(d.getEntityId(),++rO.maxZIndex-b))}},moveToBackground:{name:"Move to Background",callback:function(){d.propagateNodeMoveZOperation(new A_(d.getEntityId(),--rO.minZIndex-b))}},sepDelete:"---------",delete:{name:"Delete",callback:function(){d.triggerDeletion()}},quit:{name:" ",disabled:!0}}),events:{show:function(){E.select(d)}}}:(E.select(null),!1)}})};var V=et.AutoDefault;this.getAnchorOptions=function(){return V},this.triggerDeletion=function(e){var n,i=this.getEdges();for(n in E.select(null),i)i.hasOwnProperty(n)&&i[n].triggerDeletion();var r=new m_(t,d.getType(),y.left,y.top,y.width,y.height,b,y.containment,d.toJSON());if(p){R(r);c.getMap("nodes").delete(d.getEntityId())}else R(r);e||zO.add(r)},this.getContextMenuItemCallback=function(){return A},this.setContextMenuItemCallback=function(t){"function"==typeof t&&(A=t)},this.getAppearance=function(){return y},this.getZIndex=function(){return b},this.refreshTraceAwareness=function(t){L(t)},this.addToCanvas=function(t){if(!t)throw new Error("Canvas is null");E=t,t.get$canvas().append(O),t.get$canvas().append(this._$node)},this.getCanvas=function(){return E},this.removeFromCanvas=function(){this._$node.remove(),$.contextMenu("destroy","#"+d.getEntityId()),E=null,O.remove(),this.hasOwnProperty("unregisterCallbacks")&&this.unregisterCallbacks()},this.addAttribute=function(t){var e=t.getEntityId();x.hasOwnProperty(e)||(x[e]=t)},this.getAttribute=function(t){return x.hasOwnProperty(t)?x[t]:null},this.deleteAttribute=function(t){x.hasOwnProperty(t)&&delete x[t]},this.setAttributes=function(t){x=t},this.getAttributes=function(){return x},this.setLabel=function(t){v=t},this.getLabel=function(){return v},this.getType=function(){return g},this.getContainment=function(){return m},this._get$node=function(){return this._$node},this._draw=function(){O.css({left:y.left+y.width/2,top:y.top+y.height/2,width:1.2*y.width,height:1.2*y.height,zIndex:b-1}),this._$node.css({left:y.left,top:y.top,width:y.width,height:y.height,zIndex:b})},this.move=function(t,e,n){const i=y.left+t,r=y.top+e;i<0||r<0||i>E.width-y.width||r>E.height-y.height?(w.css({left:y.left,top:y.top}),console.error("Node cannot be moved outside of canvas"),p&&window.y.transact((()=>{p.set("left",y.left),p.set("top",y.top),p.set("zIndex",b)}))):p&&window.y.transact((()=>{p.set("left",y.left+=t),p.set("top",y.top+=e),p.set("zIndex",b)})),this._draw(),this.repaint()},this.moveAbs=function(t,e,n){(t<0||e<0)&&console.error("Node cannot be moved outside of canvas"),(t>E.width-y.width||e>E.height-y.height)&&console.error("Node cannot be moved outside of canvas"),y.left=t,y.top=e,n&&(b=n),p&&c.transact((()=>{p.set("left",y.left),p.set("top",y.top),n&&p.set("zIndex",b)})),this._draw(),this.repaint()},this.resize=function(t,e){y.width+=t,y.height+=e,p&&c.transact((()=>{p.set("width",y.width),p.set("height",y.height)})),this._draw(),this.repaint()},this.addIngoingEdge=function(t){var e=t.getEntityId(),n=t.getSource(),i=n.getEntityId();S.hasOwnProperty(e)||(S[e]=t,k.hasOwnProperty(i)||(k[i]=n))},this.addOutgoingEdge=function(t){var e=t.getEntityId(),n=t.getTarget(),i=n?.getEntityId();I.hasOwnProperty(e)||(I[e]=t,P.hasOwnProperty(i)||(P[i]=n))},this.deleteIngoingEdge=function(t){var e=t.getEntityId(),n=t.getSource().getEntityId(),i=!1;if(S.hasOwnProperty(e)){for(var r in delete S[e],S)S.hasOwnProperty(r)&&S[r].getSource().getEntityId()===n&&(i=!0);i||delete k[n]}},this.deleteOutgoingEdge=function(t){var e=t.getEntityId(),n=t.getTarget(),i=n?.getEntityId(),r=!1;if(I.hasOwnProperty(e)){for(var o in delete I[e],I)I.hasOwnProperty(o)&&I[o].getTarget().getEntityId()===i&&(r=!0);r||delete P[i]}},this.getIngoingEdges=function(){return S},this.getOutgoingEdges=function(){return I},this.getEdges=function(){return Z_.union(S,I)},this.getIngoingNeighbors=function(){return k},this.getOutgoingNeighbors=function(){return P},this.getNeighbors=function(){return Z_.union(k,P)},this.lowlight=function(){this._$node.addClass("lowlighted")},this.unlowlight=function(){this._$node.removeClass("lowlighted")},this.select=function(){this.unhighlight(),this._$node.addClass("selected"),Z_.delay(100).then((function(){su.each(uT.getEdges(),(function(t){t.setZIndex()}))}))},this.unselect=function(){this._$node.removeClass("selected"),uT.storeDataYjs(),Z_.delay(100).then((function(){su.each(uT.getEdges(),(function(t){t.setZIndex()}))}))},this.highlight=function(t,e){t&&e&&(this._$node.css({border:"2px solid "+t}),this._$node.append($("<div></div>").addClass("user_highlight").css("color",t).text(e)),Z_.delay(100).then((function(){su.each(uT.getEdges(),(function(t){t.setZIndex()}))})))},this.unhighlight=function(){this._$node.css({border:""}),this._$node.find(".user_highlight").remove(),Z_.delay(100).then((function(){su.each(uT.getEdges(),(function(t){t.setZIndex()}))}))},this.remove=function(){clearInterval(T),this.removeFromCanvas(),jsPlumbInstance.removeAllEndpoints(w.get(0)),jsPlumbInstance.unmanage(w.get(0)),uT.deleteNode(this.getEntityId())},this._toJSON=function(){var t={};return su.forEach(this.getAttributes(),(function(e,n){t[n]=e.toJSON()})),{label:v.toJSON(),left:y.left,top:y.top,width:y.width,height:y.height,zIndex:b,type:g,attributes:t}},this.addGhostEdge=function(t){N.push(t)},this.bindMoveToolEvents=()=>{this.enableDraggable();var e={left:0,top:0},n=$('<div class="size-preview"></div>').hide();this.makeResizable(d,E,n,t),this._$node.contextMenu(!0).find("input").prop("disabled",!1).css("pointerEvents",""),this.jsPlumbManagedElement=jsPlumbInstance.manage(this._$node.get(0)),jsPlumbInstance.bind(kr,(t=>(t.el.id!==this._$node.attr("id")||(e.top=t.el.offsetTop,e.left=t.el.offsetLeft,E.hideGuidanceBox(),w.css({opacity:.5})),!0))),jsPlumbInstance.bind(Ir,(t=>{if(t.el.id!==this._$node.attr("id"))return!0;w.css({opacity:""}),E.bindMoveToolEvents();var n=Math.round(t.el.offsetLeft-e.left),i=Math.round(t.el.offsetTop-e.top);if(0!==n||0!==i)if(t.el.offsetLeft<0||t.el.offsetTop<0||t.el.offsetLeft>E.width||t.el.offsetTop>E.height)console.error(" offset bigger than canvas size");else{var r=new x_(d.getEntityId(),n,i);d.propagateNodeMoveOperation(r),E.showGuidanceBox()}}));c.getMap("widgetConfig").get("view_only")&&(this.disableDraggable(),w.on("click").contextMenu(!1))},this.unbindMoveToolEvents=()=>{this._$node.off("click").contextMenu(!1).find("input").prop("disabled",!0).css("pointerEvents","none"),this.disableDraggable()},this.makeSource=()=>{w.addClass("source"),this.endPoint=window.jsPlumbInstance.addEndpoint(this._$node.get(0),{connectorPaintStyle:{fill:"black",strokeWidth:4},source:!0,endpoint:{type:"Rectangle",options:{width:w.width()+50,height:w.height()+50}},paintStyle:{fill:"transparent"},anchor:et.Center,deleteOnEmpty:!0,uniqueEndpoint:!1,deleteEndpointsOnDetach:!0,onMaxConnections:function(t){console.log("element is ",t.element,"maxConnections is",t.maxConnections)}})},this.makeTarget=()=>{w.addClass("target"),this.endPoint=window.jsPlumbInstance.addEndpoint(this._$node.get(0),{target:!0,endpoint:{type:"Rectangle",options:{width:w.width()+50,height:w.height()+50}},paintStyle:{fill:"transparent"},anchor:et.Center,uniqueEndpoint:!1,deleteOnEmpty:!0,onMaxConnections:function(t){console.log("user tried to drop connection",t.connection,"on element",t.element,"with max connections",t.maxConnections)}})},this.unbindEdgeToolEvents=function(){try{w.removeClass("source target"),jsPlumbInstance.getEndpoints(w.get(0)).forEach((t=>{0===t.connections.length&&jsPlumbInstance.deleteEndpoint(t)}))}catch(t){console.error(t)}},d.init(),this._registerYMap=function(){p.observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{var i=t.currentTarget.doc.clientID;if(c.clientID!==i||t.value&&t.value.historyFlag){var r=t.value;var o=c.getMap("users").get(i);switch(e){case x_.TYPE:(function(t){if(t instanceof x_&&t.getEntityId()===d.getEntityId()){if(f.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.HEATMAP,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()),c.getMap("users").get(c.clientID)!==t.getJabberId()){const n=c.getMap("userList");var e=Z_.getColor(n.get(t.getJabberId()).globalId);L(e)}C(t)}})(new x_(r.id,r.offsetX,r.offsetY,o));break;case A_.TYPE:(function(t){if(t instanceof A_&&t.getEntityId()===d.getEntityId()){if(f.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()),c.getMap("users").get(c.clientID)!==t.getJabberId()){const n=c.getMap("userList");var e=Z_.getColor(n.get(t.getJabberId()).globalId);L(e)}j(t)}})(new A_(r.id,r.offsetZ,o));break;case S_.TYPE:(function(t){if(t instanceof S_&&t.getEntityId()===d.getEntityId()){if(f.sendLocalOTOperation(f_.WIDGET.NAME.ATTRIBUTE,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.HEATMAP,t.getOTOperation()),f.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()),c.getMap("users").get(c.clientID)!==t.getJabberId()){const n=c.getMap("userList");var e=Z_.getColor(n.get(t.getJabberId()).globalId);L(e)}M(t)}})(new S_(r.id,r.offsetX,r.offsetY,o))}}}))}))},jsPlumbInstance.manage(this._$node.get(0))}nodeSelector;jsPlumbManagedElement;endPoint;repaint(){window.jsPlumbInstance.repaint(this._$node.get(0)),su.each(uT.getEdges(),(function(t){t.setZIndex()}))}enableDraggable(){jsPlumbInstance.setDraggable(this._$node.get(0),!0)}disableDraggable(){jsPlumbInstance.setDraggable(this._$node.get(0),!1)}makeResizable(t,e,n,i){const r={width:t._$node.width(),height:t._$node.height()};ks(t.nodeSelector).resizable({edges:{right:".bi",bottom:".bi"},square:!0,listeners:{move(e){t.disableDraggable();let{x:i,y:r}=e.target.dataset;i=(parseFloat(i)||0)+e.deltaRect.left,r=(parseFloat(r)||0)+e.deltaRect.top,Object.assign(e.target.style,{width:`${e.rect.width}px`,height:`${e.rect.height}px`,transform:`translate(${i}px, ${r}px)`}),Object.assign(e.target.dataset,{x:i,y:r}),e.rect.width=Math.max(50,e.rect.width),e.rect.height=Math.max(50,e.rect.height),n.text(Math.round(e.rect.width)+"×"+Math.round(e.rect.height))}},modifiers:[ks.modifiers.restrictEdges({outer:"parent"}),ks.modifiers.restrictSize({min:{width:40,height:40}})],inertia:{enabled:!1}}).on(["resizestart"],(i=>{t._$node.addClass("resizing"),t.disableDraggable(),e.hideGuidanceBox(),n.show(),t._$node.css({opacity:.5}),t._$node.append(n),r.width=t._$node.width(),r.height=t._$node.height(),e.unbindMoveToolEvents()})).on(["resizeend"],(o=>{t._$node.removeClass("resizing"),t.enableDraggable();const a=o.rect.width-r.width,s=o.rect.height-r.height;n.hide(),t._$node.css({opacity:""}),t.repaint();var l=new S_(i,a,s);t.propagateNodeResizeOperation(l),e.bindMoveToolEvents()})).draggable()}disableResizable(){ks(this.nodeSelector).unset()}draw(){return this._draw()}get$node(){return this._get$node()}toJSON(){return this._toJSON()}hide(){this.get$node().hide(),window.jsPlumbInstance.hide(this.get$node())}show(){this.get$node().show(),window.jsPlumbInstance.show(this.get$node()[0]),window.jsPlumbInstance.repaint(this.get$node()[0])}registerYMap(){this._registerYMap()}},sT=class t extends aT{static TYPE="Enumeration";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=100;constructor(e,n,i,r,o,a,s){super(e,t.TYPE,n,i,r,o,a,s);var l=this,u=$(su.template('<div class="class_node enum">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;Enumeration&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:l.getType()})),c=aT.prototype.get$node.call(this).append(u).addClass("class"),d=c.find(".attributes"),f=this.getAttributes();this.toJSON=function(){var e=aT.prototype.toJSON.call(this);return e.type=t.TYPE,e};var p=new CO("[attributes]","Attributes",this);for(var h in this.addAttribute(p),this.registerYMap=function(){aT.prototype.registerYMap.call(this),l.getLabel().getValue().registerYType(),p.registerYMap()},this.unregisterCallbacks=function(){l.getAttribute("[attributes]").unregisterCallbacks()},this.registerYTextAttributes=function(t){t.get(l.getLabel().getValue().getEntityId()).then((function(t){l.getLabel().getValue().registerYType(t)}))},c.find(".label").append(this.getLabel().get$node()),f)f.hasOwnProperty(h)&&d.append(f[h].get$node())}},lT=class t extends aT{static TYPE="Node Shape";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=150;constructor(e,n,i,r,o,a,s,l){super(e,"Node Shape",n,i,r,o,a,s,l);var u=this,c=$(su.template('<div class="class_node nodeshape">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;NodeShape&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:u.getType()})),d=aT.prototype.get$node.call(this).append(c).addClass("class"),f=d.find(".attributes"),p=this.getAttributes();this.toJSON=function(){var e=aT.prototype.toJSON.call(this);return e.type=t.TYPE,e};var h=new PO(this.getEntityId()+"[shape]","Shape",this,{circle:"Circle",diamond:"Diamond",rectangle:"Rectangle",rounded_rectangle:"Rounded Rectangle",triangle:"Triangle"}),g=new rT(this.getEntityId()+"[defaultWidth]","Default Width",this),v=new rT(this.getEntityId()+"[defaultHeight]","Default Height",this),y=new SO(this.getEntityId()+"[color]","Color",this),b=new cO(this.getEntityId()+"[containment]","Containment",this),m=new kO(this.getEntityId()+"[customShape]","Custom Shape",this),E=new NO(this.getEntityId()+"[customAnchors]","Custom Anchors",this);for(var w in this.addAttribute(h),this.addAttribute(y),this.addAttribute(g),this.addAttribute(v),this.addAttribute(b),this.addAttribute(m),this.addAttribute(E),d.find(".label").append(this.getLabel().get$node()),p)p.hasOwnProperty(w)&&f.append(p[w].get$node());this.registerYMap=function(){aT.prototype.registerYMap.call(this),h.getValue().registerYType(),g.getValue().registerYType(),v.getValue().registerYType(),b.getValue().registerYType(),u.getLabel().getValue().registerYType(),y.getValue().registerYType(),E.getValue().registerYType(),m.getValue().registerYType()}}};const uT=new class{y=null;setSharedDocument(t){this.y=t}_nodes;_edges;constructor(){var t=void 0,e=null,n={};this._nodes=n;var i={};this._edges=i;var r=null,o=null;return{createNode:function(e,i,r,o,a,s,l,u,c,d){var f;return rO.maxZIndex=Math.max(rO.maxZIndex,l),rO.minZIndex=Math.min(rO.minZIndex,l),t&&tT.hasOwnProperty(e)?f=tT[e](i,r,o,a,s,l,u,c,d):ZO.hasOwnProperty(e)&&(f=new ZO[e](i,r,o,a,s,l,u,c,d)),n[i]=f,f},findObjectNodeByLabel(t){const e=new RegExp(t,"gi");for(const[t,i]of Object.entries(n)){const n=y.getMap("nodes").get(t).toJSON();for(const[r,o]of Object.entries(n))if(r.match(t)&&o.match(e))return i}return null},createModelAttributesNode:function(t){return null===e?e=new yT("modelAttributes",r?r.attributes:null,t):e},findNodeByAttribute:function(t,e){for(const i in n){const r=n[i];if(r.getAttribute(t)===e)return r}},findNode:function(t){return n.hasOwnProperty(t)?n[t]:null},find:function(t){return this.findNode(t)||this.findEdge(t)},deleteNode:function(t){n.hasOwnProperty(t)&&delete n[t]},getNodes:function(){return n},getNodesByType:function(t){var e,i,r={};for(e in"string"==typeof t&&(t=[t]),n)n.hasOwnProperty(e)&&(i=n[e],-1!==t.indexOf(i.getType())&&(r[e]=i));return r},createEdge:function(e,n,r,o){var a;if(t&&eT.hasOwnProperty(e))a=eT[e](n,r,o);else{if(!nT.hasOwnProperty(e))return;a=new nT[e](n,r,o)}return r.addOutgoingEdge(a),o?.addIngoingEdge(a),i[n]=a,a},findEdge:function(t){return i.hasOwnProperty(t)?i[t]:null},deleteEdge:function(t){i.hasOwnProperty(t)&&delete i[t]},getEdges:function(){return i},getEdgesByType:function(t){var e,n,r={};for(e in i)i.hasOwnProperty(e)&&(n=i[e]).getType()===t&&(r[e]=n);return r},graphToJSON:function(){var t,r={},o={};return t=e?e.toJSON():{},su.forEach(n,(function(t,e){r[e]=t.toJSON()})),su.forEach(i,(function(t,e){o[e]=t.toJSON()})),{attributes:t,nodes:r,edges:o}},createModelAttributesNodeFromJSON:function(t){var e=this.createModelAttributesNode();if(e)for(var n in e.getLabel().getValue().setValue(t.label.value.value),t.attributes)if(t.attributes.hasOwnProperty(n)){var i=e.getAttribute(n);i&&i.setValueFromJSON(t.attributes[n])}return e},createNodeFromJSON:function(t,e,n,i,r,o,a,s,l,u){var c=this.createNode(t,e,n,i,r,o,a,s,l,u);if(c)for(var d in c.getLabel().getValue().setValue(l.label.value.value),l.attributes)if(l.attributes.hasOwnProperty(d)){var f=c.getAttribute(d);if(f)f.setValueFromJSON(l.attributes[d]);else{var p=d.replace(/[^\[\]]*/,e);(f=c.getAttribute(p))&&f.setValueFromJSON(l.attributes[d])}}return c},createEdgeFromJSON:function(t,e,n,i,r){const o=this.findNode(n),a=this.findNode(i);var s=this.createEdge(t,e,o,a);if(s)for(var l in s.getLabel().getValue().setValue(r.label.value.value),r.attributes)if(r.attributes.hasOwnProperty(l)){var u=s.getAttribute(l);u&&u.setValueFromJSON(r.attributes[l])}return s},generateAddNodeMenu:function(e,n,i){function r(t,r,o,a){return function(){e.createNode(t,n,i,r,o,32e3,a)}}var o,a,s={};for(o in a=t&&XO===f_.LAYER.MODEL?tT:ZO)if(a.hasOwnProperty(o)){if(XO===f_.LAYER.META&&!t&&("ViewObject"===o||"ViewRelationship"===o))continue;if(XO===f_.LAYER.META&&t&&("Object"===o||"Relationship"===o||"Enumeration"===o||"Abstract Class"===o))continue;s[o]={name:".."+o,callback:r(o,a[o].DEFAULT_WIDTH,a[o].DEFAULT_HEIGHT,a[o].CONTAINMENT)}}return s},generateVisibilityNodeMenu:function(e){var n,i,r=function(e,n){return function(){if("show"===n||"hide"===n){var i;for(var r in i=t&&XO===f_.LAYER.MODEL?o.getNodesByViewType(e):o.getNodesByType(e))i.hasOwnProperty(r)&&i[r][n]();return"hide"===n?this.data("show"+e+"Disabled",!0):this.data("show"+e+"Disabled",!1),!1}}},o=this,a={};for(n in i=t&&XO===f_.LAYER.MODEL?tT:ZO)if(i.hasOwnProperty(n)){if(XO===f_.LAYER.META&&!t&&("ViewObject"===n||"ViewRelationship"===n))continue;if(XO===f_.LAYER.META&&t&&("Object"===n||"Relationship"===n||"Enumeration"===n||"Abstract Class"===n))continue;a[e+n]={name:".."+n,callback:r(n,e),disabled:function(t){return function(){return"hide"===e?this.data(e+t+"Disabled"):!this.data(e+t+"Disabled")}}(n)}}return a},generateVisibilityEdgeMenu:function(e){function n(e,n){return function(){if("show"===n||"hide"===n){var i;for(var r in i=t&&XO===f_.LAYER.MODEL?o.getEdgesByViewType(e):o.getEdgesByType(e))i.hasOwnProperty(r)&&i[r][n]();"hide"===n?this.data("show"+e+"Disabled",!0):this.data("show"+e+"Disabled",!1)}}}var i,r,o=this,a={};for(i in r=t&&XO===f_.LAYER.MODEL?eT:nT)r.hasOwnProperty(i)&&(a[e+i]={name:".."+i,callback:n(i,e),disabled:function(t){return function(){return"hide"===e?this.data(e+t+"Disabled"):!this.data(e+t+"Disabled")}}(i)});return a},generateConnectToMenu:function(e){function n(t,n){return function(){e.getCanvas().createEdge(t,e.getEntityId(),n)}}var i,r,o,a,s,l,u,c,d,f,p,h,g,v,y,b=e.getAppearance();for(i in s={},iT)if(iT.hasOwnProperty(i)){for(l={},c=0,d=iT[i].length;c<d;c++)if(r=iT[i][c].sourceTypes,o=iT[i][c].targetTypes,-1!==r.indexOf(e.getType())||XO===f_.LAYER.MODEL&&t&&-1!==r.indexOf(e.getCurrentViewType()))for(f=0,p=o.length;f<p;f++){for(g in a=o[f],u={},h=t&&XO===f_.LAYER.MODEL?this.getNodesByViewType(a):this.getNodesByType(a))if(h.hasOwnProperty(g)){if((v=h[g])===e)continue;if(XO===f_.LAYER.MODEL&&t&&null===v.getCurrentViewType())continue;y=v.getAppearance(),v.getNeighbors().hasOwnProperty(e.getEntityId())||(u[i+a+c+g]={name:".."+(v.getLabel().getValue().getValue()||v.getType()),callback:n(i,g),distanceSquare:Math.pow(y.left-b.left,2)+Math.pow(y.top-b.top,2),targetNodeId:i+a+c+g})}if(su.size(u)>0){var m=su.sortBy(u,"distanceSquare");u={};for(var E=0,w=m.length;E<w;E++)u[E+m[E].targetNodeId]=m[E];l[i+a+c]={name:"..to "+a+"..",items:u}}}su.size(l)>0&&(s[i]={name:"..with "+i+"..",items:l})}return{name:"Connect..",items:s,disabled:function(t){return 0===su.size(t)}(s)}},generateGuidanceMetamodel:function(){var t=this.generateMetaModel(),e=[],n=[],i={attributes:{},nodes:{},edges:{}},r={label:o.INITIAL_NODE_LABEL,shape:{shape:"",color:"",defaultWidth:200,defaultHeight:60,containment:!1,customShape:'<div class="custom_node">\n    <div class="type"><%= type %></div>\n    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 100 100" class="fill_parent">\n        <defs>\n            <linearGradient id="startActivityGrad" x1="0%" y1="0%" x2="0%" y2="100%">\n              <stop offset="0%" style="stop-color:#FFF2CC;stop-opacity:1" />\n              <stop offset="100%" style="stop-color:#FFD966;stop-opacity:1" />\n            </linearGradient>\n          </defs>\n        <rect x="0" y="0" rx="20" ry="20" width="100" height="100" fill="url(#startActivityGrad)" stroke="lightgray" stroke-width="2" />\n    </svg>\n    <div class="fill_parent" style="overflow:hidden;">\n    \t<table style="width:100%; height:100%">\n\t\t  <tr>\n\t\t    <td style="width:1px; white-space:nowrap; padding:10px;"><i class="fa fa-circle fa-2x"></i></td>\n\t\t    <td style="text-align:center" class="label"></td>\t\t\n\t\t  </tr>\n\t\t</table>\n    </div>\n</div>',customAnchors:""},attributes:{}};r.attributes[Z_.generateRandomId()]={key:"label",value:"string"},i.nodes[Z_.generateRandomId()]=r;var a={label:o.ACTIVITY_FINAL_NODE_LABEL,shape:{shape:"circle",color:"",defaultWidth:50,defaultHeight:50,containment:!1,customShape:'<div class="custom_node">\n    <div class="type"><%= type %></div>\n    <svg style="overflow:visible;" viewBox="0 0 100 100" preserveAspectRatio="none" class="fill_parent">\n  <circle cx="50" cy="50" r="50" stroke="black" stroke-width="5" fill="transparent" />\n<circle cx="50" cy="50" r="40" stroke="black" stroke-width="0" fill="black" /> \n</svg> \n    <div class="fill_parent">\n    </div>\n</div>',customAnchors:["Perimeter",{shape:"Circle",anchorCount:60}]},attributes:{}};i.nodes[Z_.generateRandomId()]=a;var s={label:o.MERGE_NODE_LABEL,shape:{shape:"diamond",color:"yellow",defaultWidth:0,defaultHeight:0,containment:!1,customShape:"",customAnchors:""},attributes:{}};i.nodes[Z_.generateRandomId()]=s;var l={label:o.CALL_ACTIVITY_NODE_LABEL,shape:{shape:"rounded_rectangle",color:"",defaultWidth:100,defaultHeight:50,containment:!1,customShape:'<div class="custom_node">\n    <div class="type"><%= type %></div>\n    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 100 100" class="fill_parent">\n        <rect x="0" y="0" rx="20" ry="20" width="100" height="100" fill="white" stroke="lightgray" stroke-width="2" />\n    </svg>\n    <div class="fill_parent" style="overflow:hidden;">\n      <table style="width:100%; height:100%">\n      <tr>\n        <td style="width:1px; white-space:nowrap; padding:10px;"><i class="fa fa-external-link fa-2x"></i></td>\n        <td class="label" style="text-align:center"></td>   \n      </tr>\n    </table>\n    </div>\n</div>',customAnchors:""},attributes:{}};e.push(o.CALL_ACTIVITY_NODE_LABEL),l.attributes[Z_.generateRandomId()]={key:"label",value:"string"},i.nodes[Z_.generateRandomId()]=l;var u={label:o.CONCURRENCY_NODE_LABEL,shape:{shape:"rectangle",color:"black",defaultWidth:10,defaultHeight:200,containment:!1,customShape:"",customAnchors:""},attributes:{}};i.nodes[Z_.generateRandomId()]=u;var c=[],d=[],f=t.nodes;for(var p in f)if(f.hasOwnProperty(p)){var h=f[p],g={sourceTypes:[],targetTypes:[]},v=o.getCreateObjectNodeLabelForType(h.label);g.sourceTypes.push(v),e.push(v),n.push(v);var y=Z_.generateRandomId();i.nodes[y]={label:v,attributes:{},shape:{shape:"rounded_rectangle",color:"",defaultWidth:100,defaultHeight:50,containment:!1,customShape:su.template(FO)({label:h.label,icon:"plus"}),customAnchors:""}};var b=o.getEntityNodeLabelForType(h.label);g.targetTypes.push(v),y=Z_.generateRandomId(),i.nodes[y]={label:b,attributes:{},shape:{shape:"rectangle",color:"",defaultWidth:100,defaultHeight:50,containment:!1,customShape:su.template(GO)({icon:"square",label:h.label}),customAnchors:""}},S=o.getSetPropertyNodeLabelForType(h.label),e.push(S),y=Z_.generateRandomId(),i.nodes[y]={label:S,attributes:{},shape:{shape:"",defaultWidth:130,defaultHeight:50,containment:!1,customShape:su.template(qO)(),customAnchors:""}};var m={};for(var E in h.attributes){m[(I=h.attributes[E]).key]=I.key}for(var w in i.nodes[y].attributes[Z_.generateRandomId()]={key:"Property",value:"Value",options:m},d.push({sourceTypes:[v],targetTypes:[b]}),d.push({sourceTypes:[b],targetTypes:[S]}),t.edges){var _=t.edges[w];for(var O in _.relations){var T=_.relations[O];if(T.sourceTypes.indexOf(h.label)>-1||T.targetTypes.indexOf(h.label)>-1){d.push({sourceTypes:[b],targetTypes:o.getCreateRelationshipNodeLabelForType(_.label)});break}}}}var x={},A=t.edges;for(var w in A)if(A.hasOwnProperty(w)){_=A[w],v=o.getCreateRelationshipNodeLabelForType(_.label);e.push(v),n.push(v),x[_.label]=_;y=Z_.generateRandomId();i.nodes[y]={label:v,attributes:{},shape:{shape:"rounded_rectangle",color:"",defaultWidth:100,defaultHeight:50,containment:!1,customShape:su.template(FO)({label:_.label,icon:"plus"}),customAnchors:""}};b=o.getEntityNodeLabelForType(_.label),y=Z_.generateRandomId();if(i.nodes[y]={label:b,attributes:{},shape:{shape:"rectangle",color:"black",defaultWidth:100,defaultHeight:50,containment:!1,customShape:su.template(GO)({icon:"exchange",label:_.label}),customAnchors:""}},Object.keys(_.attributes).length>0){var S=o.getSetPropertyNodeLabelForType(_.label);e.push(S),y=Z_.generateRandomId(),i.nodes[y]={label:S,attributes:{},shape:{shape:"",defaultWidth:0,defaultHeight:0,containment:!1,customShape:su.template(qO)({type:S,color:"white"}),customAnchors:""}};m={};for(var E in _.attributes){var I;m[(I=_.attributes[E]).key]=I.key}i.nodes[y].attributes[Z_.generateRandomId()]={key:"Property",value:"Value",options:m}}d.push({sourceTypes:[v],targetTypes:[b]}),d.push({sourceTypes:[b],targetTypes:[S]})}c=(c=(c=(c=c.concat({sourceTypes:e,targetTypes:e.concat([o.MERGE_NODE_LABEL,o.ACTIVITY_FINAL_NODE_LABEL,o.CONCURRENCY_NODE_LABEL])})).concat({sourceTypes:[o.INITIAL_NODE_LABEL],targetTypes:[o.CALL_ACTIVITY_NODE_LABEL,o.MERGE_NODE_LABEL,o.CONCURRENCY_NODE_LABEL].concat(n)})).concat({sourceTypes:[o.MERGE_NODE_LABEL],targetTypes:[o.ACTIVITY_FINAL_NODE_LABEL,o.MERGE_NODE_LABEL,o.CONCURRENCY_NODE_LABEL].concat(e)})).concat({sourceTypes:[o.CONCURRENCY_NODE_LABEL],targetTypes:[o.ACTIVITY_FINAL_NODE_LABEL,o.CONCURRENCY_NODE_LABEL,o.MERGE_NODE_LABEL].concat(e)}),i.edges[Z_.generateRandomId()]={label:"Action flow edge",shape:{arrow:"unidirassociation",shape:"curved",color:"black",overlay:"",overlayPosition:"top",overlayRotate:!0},relations:c};var k={label:"Data flow edge",shape:{arrow:"unidirassociation",shape:"curved",color:"black",overlay:"",overlayPosition:"top",overlayRotate:!0},attributes:{},relations:d};return k.attributes[Z_.generateRandomId()]={key:"Destination",value:"Value",options:{Source:"Source",Target:"Target"}},i.edges[Z_.generateRandomId()]=k,i.edges[Z_.generateRandomId()]={label:"Association edge",shape:{arrow:"unidirassociation",shape:"curved",color:"",dashstyle:"4 2",overlay:"",overlayPosition:"hidden",overlayRotate:!0},relations:[{sourceTypes:[o.CALL_ACTIVITY_NODE_LABEL],targetTypes:[o.INITIAL_NODE_LABEL]}]},i},generateLogicalGuidanceRepresentation:function(t){const e=y.getMap("data");var n,i=new graphlib.Graph;if(!(n=t||e.get("guidancemodel")))return null;var r=n.nodes,a=n.edges,s=function(t){var e=[],n=[];for(var i in a){var r=a[i];r.source==t&&"Action flow edge"==r.type&&(e.push(r.target),n.push(r.label.value.value))}return{targets:e,labels:n}},l=function(t){for(var e in a){var n=a[e];if(n.source==t){var i=r[n.target].type;if(i=o.isEntityNodeLabel(i))return n.target}}return""},u=function(t){var e={Source:"",Target:""};for(var n in a){var i=a[n];if(i.target==t){var s=r[i.source].type;if(s=o.isEntityNodeLabel(s))e[f(i,"Destination")]=i.source}}return e},c=function(t){for(var e in a){var n=a[e];if(n.target==t){var i=r[n.source].type;if(i=o.isEntityNodeLabel(i))return n.source}}return""},d=function(t){for(var e in a){var n=a[e];if(n.source==t&&"Association edge"==n.type)return n.target}return""},f=function(t,e){for(var n in t.attributes){var i=t.attributes[n];if(i.name==e)return i.value.value}return""};for(var p in r){var h=r[p],g=h.type,v="";if(g==o.INITIAL_NODE_LABEL){var b=s(p);i.setNode(p,{type:"INITIAL_NODE",name:f(h,"label")});for(var m=0;m<b.targets.length;m++)i.setEdge(p,b.targets[m],b.labels[m])}else if(g==o.MERGE_NODE_LABEL){b=s(p);i.setNode(p,{type:"MERGE_NODE"});for(m=0;m<b.targets.length;m++)i.setEdge(p,b.targets[m],b.labels[m])}else if(g==o.CONCURRENCY_NODE_LABEL){b=s(p);i.setNode(p,{type:"CONCURRENCY_NODE"});for(m=0;m<b.targets.length;m++)i.setEdge(p,b.targets[m],b.labels[m])}else if(g==o.ACTIVITY_FINAL_NODE_LABEL)i.setNode(p,{type:"ACTIVITY_FINAL_NODE"});else if(v=o.isCreateObjectNodeLabel(g)){b=s(p);i.setNode(p,{type:"CREATE_OBJECT_ACTION",objectType:v,createdObjectId:l(p)});for(m=0;m<b.targets.length;m++)i.setEdge(p,b.targets[m],b.labels[m])}else if(v=o.isCreateRelationshipNodeLabel(g)){var E=u(p);b=s(p);i.setNode(p,{type:"CREATE_RELATIONSHIP_ACTION",relationshipType:v,createdRelationshipId:l(p),sourceObjectId:E.Source,targetObjectId:E.Target});for(m=0;m<b.targets.length;m++)i.setEdge(p,b.targets[m],b.labels[m])}else if(v=o.isSetPropertyNodeLabel(g)){b=s(p);i.setNode(p,{type:"SET_PROPERTY_ACTION",entityType:v,propertyName:f(h,"Property"),sourceObjectId:c(p)});for(m=0;m<b.targets.length;m++)i.setEdge(p,b.targets[m],b.labels[m])}else if(g==o.CALL_ACTIVITY_NODE_LABEL){b=s(p);i.setNode(p,{type:"CALL_ACTIVITY_ACTION",initialNodeId:d(p)});for(m=0;m<b.targets.length;m++)i.setEdge(p,b.targets[m],b.labels[m])}}return graphlib.json.write(i)},generateGuidanceRules:function(){var t={objectToolRules:[]},e=o.guidancemodel.nodes,n=o.guidancemodel.edges;for(var i in e){var r=e[i],a=r.type;if(o.isObjectToolType(a)){var s,l=o.getObjectTypeForObjectToolType(a),u=null,c=null,d=[],f="";for(var p in r.attributes)"label"==r.attributes[p].name&&(f=r.attributes[p].value.value);for(s in n)n[s].source==i&&d.push(n[s]);for(var h=0;h<d.length;h++){var g=e[d[h].target];o.isObjectContextType(g.type)?u=o.getObjectTypeForObjectContextType(g.type):o.isRelationshipContextType(g.type)&&(c=o.getRelationshipTypeForRelationshipContextType(g.type))}if(null!==u&&null!==c){var v={srcObjectType:l,destObjectType:u,relationshipType:c,label:f};t.objectToolRules.push(v)}}}return t},generateMetaModel:function(){function t(e,n){var i,r,o,a,s,l=[];if(n||(n=[]),-1!==n.indexOf(e))return[];for(i in n.push(e),s=e.getLabel().getValue().getValue(),e instanceof dT&&-1===l.indexOf(s)&&l.push(s),o=e.getIngoingEdges())o.hasOwnProperty(i)&&(a=(r=o[i]).getSource(),(r instanceof ET&&a instanceof dT||r instanceof ET&&a instanceof fT)&&(l=l.concat(t(a,n))));return l}function e(t,n){var i,r,o,a,s,l,u,c,d,f,p={},h={};if(n||(n=[]),-1!==n.indexOf(t))return{};for(a in n.push(t),l=t.getOutgoingEdges())if(l.hasOwnProperty(a))if(u=(s=l[a]).getSource(),c=s.getTarget(),s instanceof ET&&c instanceof fT||s instanceof ET&&t instanceof dT&&c instanceof dT||s instanceof ET&&t instanceof pT&&c instanceof pT||s instanceof ET&&t instanceof sT&&c instanceof sT)Z_.merge(p,e(c,n));else if(s instanceof _T&&(c===t&&(d=u)instanceof sT||u===t&&(d=c)instanceof sT)||s instanceof wT&&(d=c)instanceof sT){for(r in f={},i={},Z_.merge(i,e(d,[])),i)i.hasOwnProperty(r)&&(f[(o=i[r]).value]=o.value);(h={})[d.getEntityId()]={key:s.getLabel().getValue().getValue(),value:d.getLabel().getValue().getValue(),options:f},Z_.merge(p,h)}for(r in i=t.getAttribute("[attributes]").getAttributes())i.hasOwnProperty(r)&&(o=i[r],t instanceof pT?((h={})[r]={key:o.getKey().getValue(),value:o.getValue().getValue(),position:o.getValue2().getValue()},Z_.merge(p,h)):t instanceof sT?((h={})[r]={value:o.getValue().getValue()},Z_.merge(p,h)):((h={})[r]={key:o.getKey().getValue(),value:o.getValue().getValue()},Z_.merge(p,h)));return p}var i,r,o,a,s,l,u,c,d,f,p,h,g,v,y,b,m,E,w,_,O,T,x,A={attributes:{},nodes:{},edges:{}};for(i in n)if(n.hasOwnProperty(i))if((r=n[i])instanceof dT)if("Model Attributes"===r.getLabel().getValue().getValue())o=e(r),A.attributes=o;else{for(s in o=e(r),g=null,l=r.getEdges())l.hasOwnProperty(s)&&(u=(a=l[s]).getSource(),c=a.getTarget(),(a instanceof _T&&(c===r&&(d=u)instanceof lT||u===r&&(d=c)instanceof lT)||a instanceof wT&&(d=c)instanceof lT)&&(g={shape:d.getAttribute(d.getEntityId()+"[shape]").getValue().getValue(),color:d.getAttribute(d.getEntityId()+"[color]").getValue().getValue(),defaultWidth:parseInt(d.getAttribute(d.getEntityId()+"[defaultWidth]").getValue().getValue()),defaultHeight:parseInt(d.getAttribute(d.getEntityId()+"[defaultHeight]").getValue().getValue()),containment:d.getAttribute(d.getEntityId()+"[containment]").getValue().getValue(),customShape:d.getAttribute(d.getEntityId()+"[customShape]").getValue().getValue(),customAnchors:d.getAttribute(d.getEntityId()+"[customAnchors]").getValue().getValue()}));A.nodes[i]={label:r.getLabel().getValue().getValue(),attributes:o,shape:g||{shape:"rectangle",color:"white",containment:!1,customShape:"",customAnchors:"",defaultWidth:0,defaultHeight:0}}}else if(r instanceof pT){for(s in o=e(r),v=[],y=[],_=[],g=null,l=r.getEdges())if(l.hasOwnProperty(s))if(u=(a=l[s]).getSource(),c=a.getTarget(),a instanceof _T&&(c===r&&(d=u)instanceof dT||u===r&&(d=c)instanceof dT))b=t(d),v=v.concat(b),y=y.concat(b);else if(a instanceof wT&&u===r&&c instanceof dT)y=y.concat(t(c));else if(a instanceof wT&&c===r&&u instanceof dT)v=v.concat(t(u));else if(a instanceof _T&&(c===r&&(d=u)instanceof fT||u===r&&(d=c)instanceof fT))b=t(d),v=v.concat(b),y=y.concat(b);else if(a instanceof wT&&u===r&&c instanceof fT)y=y.concat(t(c));else if(a instanceof wT&&c===r&&u instanceof fT)v=v.concat(t(u));else if(a instanceof _T&&(c===r&&(d=u)instanceof hT||u===r&&(d=c)instanceof hT)||a instanceof wT&&u===r&&(d=c)instanceof hT)g={arrow:d.getAttribute(d.getEntityId()+"[arrow]").getValue().getValue(),shape:d.getAttribute(d.getEntityId()+"[shape]").getValue().getValue(),color:d.getAttribute(d.getEntityId()+"[color]").getValue().getValue(),overlay:d.getAttribute(d.getEntityId()+"[overlay]").getValue().getValue(),overlayPosition:d.getAttribute(d.getEntityId()+"[overlayPosition]").getValue().getValue(),overlayRotate:d.getAttribute(d.getEntityId()+"[overlayRotate]").getValue().getValue()};else if(a instanceof ET&&c===r&&(d=u)instanceof vT){for(T in m=[],E=[],x=d.getEdges())x.hasOwnProperty(T)&&(f=(O=x[T]).getSource(),p=O.getTarget(),O instanceof _T&&(p===d&&(h=f)instanceof dT||f===d&&(h=p)instanceof dT)?(w=t(h),m=m.concat(w),E=E.concat(w)):O instanceof wT&&f===d&&p instanceof dT?E=E.concat(t(p)):O instanceof wT&&p===d&&f instanceof dT?m=m.concat(t(f)):O instanceof _T&&(p===d&&(h=f)instanceof fT||f===d&&(h=p)instanceof fT)?(w=t(h),m=m.concat(w),E=E.concat(w)):O instanceof wT&&f===d&&p instanceof fT?E=E.concat(t(p)):O instanceof wT&&p===d&&f instanceof fT&&(m=m.concat(t(f))));m.length>0&&E.length>0&&_.push({sourceTypes:m,targetTypes:E})}v.length>0&&y.length>0&&_.push({sourceTypes:v,targetTypes:y}),A.edges[i]={label:r.getLabel().getValue().getValue(),shape:g||{arrow:"bidirassociation",shape:"straight",color:"black",overlay:"",overlayPosition:"top",overlayRotate:!0},relations:_,attributes:o}}return A},storeData:function(){var t=new JO.oo.Resource(JO.param.space()),e=this.graphToJSON(),n=[],i=[];o.isGuidanceEditor()?n.push({typeName:f_.NS.MY.GUIDANCEMODEL,representation:e}):(r.hasOwnProperty("nodes")||(n.push({typeName:f_.NS.MY.METAMODELPREVIEW,representation:this.generateMetaModel()}),n.push({typeName:f_.NS.MY.GUIDANCEMETAMODEL,representation:this.generateGuidanceMetamodel()})),n.push({typeName:f_.NS.MY.MODEL,representation:e}));for(var a=function(e,n){var i=$.Deferred(),r=$.Deferred();return t.getSubResources({relation:JO.ns.role+"data",type:e,onEach:function(t){t.del()},onAll:function(){r.resolve()}}),r.then((function(){t.create({relation:JO.ns.role+"data",type:e,representation:n,callback:function(){i.resolve()}})})),i.promise()},s=0;s<n.length;s++){var l=n[s];i.push(a(l.typeName,l.representation))}return $.when.apply($,i)},storeDataYjs:function(){var t=this.graphToJSON();const e=y.getMap("data");o.isGuidanceEditor()?e.set("guidancemodel",t):(r||(e.set("metamodelpreview",this.generateMetaModel()),e.set("guidancemetamodel",this.generateGuidanceMetamodel())),e.set("model",t))},deleteModelAttribute:function(){e=null},reset:function(){n={},i={},this.deleteModelAttribute()},initNodeTypes:function(t){ZO=KO(t)},initEdgeTypes:function(t){var e=QO(t);nT=e.edgeTypes,iT=e.relations},initModelTypes:function(t){this.initNodeTypes(t),this.initEdgeTypes(t)},getNodeType:function(t){return ZO.hasOwnProperty(t)?ZO[t]:null},getEdgeType:function(t){return nT.hasOwnProperty(t)?nT[t]:null},initViewNodeTypes:function(t){for(var e in ZO)ZO.hasOwnProperty(e)&&delete ZO[e].VIEWTYPE;tT=KO(t)},initViewEdgeTypes:function(t){for(var e in nT)nT.hasOwnProperty(e)&&delete nT[e].VIEWTYPE;var n=QO(t);eT=n.edgeTypes,iT=n.relations},initViewTypes:function(t){this.setViewId(t.id),this.initViewNodeTypes(t),this.initViewEdgeTypes(t)},getViewNodeType:function(t){return tT.hasOwnProperty(t)?tT[t]:null},getViewEdgeType:function(t){return eT.hasOwnProperty(t)?eT[t]:null},setViewId:function(e){t=e},getViewId:function(){return t},getNodesByViewType:function(t){return tT.hasOwnProperty(t)?this.getNodesByType(tT[t].getTargetNodeType().TYPE):null},getEdgesByViewType:function(t){return eT.hasOwnProperty(t)?this.getEdgesByType(eT[t].getTargetEdgeType().TYPE):null},getLayer:function(){return XO},getRelations:function(){return iT},setGuidance:function(t){o=t},init:function(t){if((r=t)&&r.hasOwnProperty("nodes")?(ZO=KO(r),XO=f_.LAYER.MODEL):(XO=f_.LAYER.META,ZO[dT.TYPE]=dT,ZO[fT.TYPE]=fT,ZO[pT.TYPE]=pT,ZO[vT.TYPE]=vT,ZO[sT.TYPE]=sT,ZO[lT.TYPE]=lT,ZO[hT.TYPE]=hT,ZO[bT.TYPE]=bT,ZO[mT.TYPE]=mT),r&&r.hasOwnProperty("edges")){var e=QO(r);nT=e.edgeTypes,iT=e.relations}else nT[ET.TYPE]=ET,nT[_T.TYPE]=_T,nT[wT.TYPE]=wT,iT[_T.TYPE]=_T.RELATIONS,iT[wT.TYPE]=wT.RELATIONS,iT[ET.TYPE]=ET.RELATIONS}}}};function cT(t,e,n,i){return class extends aT{constructor(r,o,a,s,l,u,c){super(r,t,o,a,s,l,u,c);var d=this,f=null;this.setCurrentViewType=function(t){f=t},this.getCurrentViewType=function(){return f};var p=e.clone(),h=aT.prototype.get$node.call(this).append(p),g=n;this.nodeSelector=h_(h);this.getAnchorOptions=function(){return g},this.setAnchorOptions=function(t){g=t},this.makeSource=()=>{h.addClass("source"),window.jsPlumbInstance.addEndpoint(h.get(0),{connectorPaintStyle:{fill:"black",strokeWidth:4},source:!0,endpoint:{type:"Rectangle",options:{width:h.width()+50,height:h.height()+50}},paintStyle:{fill:"transparent"},anchor:et.Center,deleteOnEmpty:!0,uuid:r+"_eps1",uniqueEndpoint:!1,deleteEndpointsOnDetach:!0,onMaxConnections:function(t){console.log("element is ",t.element,"maxConnections is",t.maxConnections)}})},this.makeTarget=()=>{h.addClass("target"),window.jsPlumbInstance.addEndpoint(h.get(0),{target:!0,endpoint:{type:"Rectangle",options:{width:h.width()+50,height:h.height()+50}},uuid:r+"_ept1",paintStyle:{fill:"transparent"},anchor:et.Center,uniqueEndpoint:!1,deleteOnEmpty:!0,onMaxConnections:function(t){console.log("user tried to drop connection",t.connection,"on element",t.element,"with max connections",t.maxConnections)}}),window.jsPlumbInstance.bind("beforeDrop",(function(t){return!(window.jsPlumbInstance.getConnections({target:t.targetId,source:t.sourceId}).length>0)}))},this.unbindEdgeToolEvents=function(){try{h.removeClass("source target"),jsPlumbInstance.getEndpoints(h.get(0)).forEach((t=>{0===t.connections.length&&jsPlumbInstance.deleteEndpoint(t)}))}catch(t){console.error(t)}},this.toJSON=function(){var e=aT.prototype.toJSON.call(this);return e.type=t,e},this.set$shape=function(t){p.remove();var e=t.clone(),n=d.getAttributes();for(var i in n)if(n.hasOwnProperty(i)){var r=n[i],o=e.find("."+r.getName().toLowerCase());if(o.length>0){r.getValue().hasOwnProperty("init")&&r.getValue().init(),o.append(r.get$node());break}}p=e,h.append(e)},this.get$node=function(){return h},function(){var t,e,n;for(e in n={},i)if(i.hasOwnProperty(e)){var o=(t=i[e]).key.toLowerCase();switch(t.value){case"boolean":n[e]=new cO(r+"["+t.key.toLowerCase()+"]",t.key,d);break;case"string":n[e]=new NO(r+"["+t.key.toLowerCase()+"]",t.key,d),"label"!==t.key.toLowerCase()&&"title"!==t.key.toLowerCase()&&"name"!==t.key.toLowerCase()||d.setLabel(n[e]);break;case"integer":n[e]=new rT(r+"["+t.key.toLowerCase()+"]",t.key,d);break;case"file":n[e]=new gO(r+"["+t.key.toLowerCase()+"]",t.key,d);break;case"quiz":n[e]=new EO(r+"["+t.key.toLowerCase()+"]",t.key,d),"label"!==t.key.toLowerCase()&&"title"!==t.key.toLowerCase()&&"name"!==t.key.toLowerCase()||d.setLabel(n[e]);default:t.options&&(n[e]=new PO(r+"["+t.key.toLowerCase()+"]",t.key,d,t.options))}h.find("."+o).append(n[e].get$node())}d.setAttributes(n)}(),this.registerYMap=function(){aT.prototype.registerYMap.call(this);var t=d.getLabel();t&&t.registerYType();var e=d.getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getValue();i.hasOwnProperty("registerYType")&&i.registerYType()}}}nodeSelector;static get$shape(){return e}static getAnchors(){return n}static getAttributes(){return i}}}let dT=class t extends aT{static TYPE="Object";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=100;constructor(e,n,i,r,o,a,s,l){super(e,t.TYPE,n,i,r,o,a,s,l);var u=this,c=$(su.template('<div class="class_node object">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;Object&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:u.getType()})),d=aT.prototype.get$node.call(this).append(c).addClass("object"),f=d.find(".attributes"),p=this.getAttributes();this.toJSON=function(){return aT.prototype.toJSON.call(this)};var h=new TO("[attributes]","Attributes",this,{string:"String",boolean:"Boolean",integer:"Integer",file:"File",quiz:"Questions"});for(var g in this.addAttribute(h),this.registerYMap=function(){aT.prototype.registerYMap.call(this),u.getLabel().getValue().registerYType(),h.registerYMap()},d.find(".label").append(this.getLabel().get$node()),p)p.hasOwnProperty(g)&&f.append(p[g].get$node());this.unregisterCallbacks=function(){u.getAttribute("[attributes]").unregisterCallbacks()},this.setContextMenuItemCallback((function(){return{addShape:{name:"Add Node Shape",callback:function(){var t=u.getCanvas(),e=u.getAppearance();const n=t.createNode(lT.TYPE,e.left+e.width+50,e.top,150,100);t.createEdge(_T.TYPE,u.getEntityId(),n)},disabled:function(){var t,e,n=u.getEdges();for(e in n)if(n.hasOwnProperty(e)&&((t=n[e])instanceof _T&&(t.getTarget()===u&&t.getSource()instanceof lT||t.getSource()===u&&t.getTarget()instanceof lT)||t instanceof wT&&t.getTarget()instanceof lT))return!0;return!1}},sepConvertTo:"---------",convertTo:{name:"Convert to..",items:{abstractClassNode:{name:"..Abstract Class",callback:function(){var t,e=u.getCanvas(),n=u.getAppearance();t=e.createNode(fT.TYPE,n.left,n.top,n.width,n.height,u.getZIndex(),u.toJSON());var i,r,o=u.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=u.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());u.triggerDeletion()}},relationshipNode:{name:"..Relationship",callback:function(){var t,e=u.getCanvas(),n=u.getAppearance();t=e.createNode(pT.TYPE,n.left,n.top,n.width,n.height,u.getZIndex(),u.toJSON());var i,r,o=u.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=u.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());u.triggerDeletion()}},relationshipGroupNode:{name:"..Relationship Group",callback:function(){var t,e=u.getCanvas(),n=u.getAppearance();t=e.createNode(vT.TYPE,n.left,n.top,n.width,n.height,u.getZIndex(),u.toJSON());var i,r,o=u.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=u.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());u.triggerDeletion()}}}},sep:"---------"}}))}},fT=class t extends aT{static TYPE="Abstract Class";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=100;constructor(e,n,i,r,o,a,s){super(e,t.TYPE,n,i,r,o,a,s);var l=this,u=$(su.template('<div class="class_node abstractclass">\n  <div class="type"><%= type %></div>\n  <div class="label">&lt;&lt;abstract&gt;&gt;</div>\n  <div class="attributes"></div>\n</div>\n')({type:l.getType()})),c=aT.prototype.get$node.call(this).append(u).addClass("class"),d=c.find(".attributes"),f=this.getAttributes();this.toJSON=function(){var e=aT.prototype.toJSON.call(this);return e.type=t.TYPE,e};var p=new TO("[attributes]","Attributes",this,{string:"String",boolean:"Boolean",integer:"Integer",file:"File",quiz:"Questions"});for(var h in this.addAttribute(p),this.registerYMap=function(){aT.prototype.registerYMap.call(this),l.getLabel().getValue().registerYType(),p.registerYMap()},this.unregisterCallbacks=function(){l.getAttribute("[attributes]").unregisterCallbacks()},c.find(".label").append(this.getLabel().get$node()),f)f.hasOwnProperty(h)&&d.append(f[h].get$node());this.setContextMenuItemCallback((function(){return{convertTo:{name:"Convert to..",items:{objectNode:{name:"..Object",callback:function(){var t,e=l.getCanvas(),n=l.getAppearance();t=e.createNode(dT.TYPE,n.left,n.top,n.width,n.height,l.getZIndex(),l.getContainment(),l.toJSON());var i,r,o=l.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=l.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());l.triggerDeletion()}},relationshipNode:{name:"..Relationship",callback:function(){var t,e=l.getCanvas(),n=l.getAppearance();t=e.createNode(pT.TYPE,n.left,n.top,n.width,n.height,l.getZIndex(),l.getContainment(),l.toJSON());var i,r,o=l.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=l.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());l.triggerDeletion()}},relationshipGroupNode:{name:"..Relationship Group",callback:function(){var t,e=l.getCanvas(),n=l.getAppearance();t=e.createNode(vT.TYPE,n.left,n.top,n.width,n.height,l.getZIndex(),l.getContainment(),l.toJSON());var i,r,o=l.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=l.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());l.triggerDeletion()}}}},sep:"---------"}}))}},pT=class extends aT{static TYPE="Relationship";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=100;constructor(t,e,n,i,r,o,a){super(t,"Relationship",e,n,i,r,o,a);var s=this,l=$(su.template('<div class="class_node relationship">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;Relationship&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:s.getType()})),u=aT.prototype.get$node.call(this).append(l).addClass("relation"),c=u.find(".attributes"),d=this.getAttributes();this.toJSON=function(){return aT.prototype.toJSON.call(this)};var f=new AO("[attributes]","Attributes",this,{string:"String",boolean:"Boolean",integer:"Integer",file:"File"},{hidden:"Hide",top:"Top",center:"Center",bottom:"Bottom"});for(var p in this.addAttribute(f),this.registerYMap=function(){aT.prototype.registerYMap.call(this),s.getLabel().getValue().registerYType(),f.registerYMap()},this.unregisterCallbacks=function(){s.getAttribute("[attributes]").unregisterCallbacks()},u.find(".label").append(this.getLabel().get$node()),d)d.hasOwnProperty(p)&&c.append(d[p].get$node());this.setContextMenuItemCallback((function(){return{addShape:{name:"Add Edge Shape",callback:function(){var t=s.getCanvas(),e=s.getAppearance();t.createNode(hT.TYPE,e.left+e.width+50,e.top,150,100).done((function(e){t.createEdge(_T.TYPE,s.getEntityId(),e)}))},disabled:function(){var t,e,n=s.getEdges();for(e in n)if(n.hasOwnProperty(e)&&((t=n[e])instanceof _T&&(t.getTarget()===s&&t.getSource()instanceof hT||t.getSource()===s&&t.getTarget()instanceof hT)||t instanceof wT&&t.getTarget()instanceof hT))return!0;return!1}},sepConvertTo:"---------",convertTo:{name:"Convert to..",items:{abstractNode:{name:"..Abstract Class Node",callback:function(){var t,e=s.getCanvas(),n=s.getAppearance();t=e.createNode(fT.TYPE,n.left,n.top,n.width,n.height,s.getZIndex(),s.toJSON());var i,r,o=s.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=s.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());s.triggerDeletion()}},objectNode:{name:"..Object Node",callback:function(){var t,e=s.getCanvas(),n=s.getAppearance();t=e.createNode(dT.TYPE,n.left,n.top,n.width,n.height,s.getZIndex(),s.toJSON());var i,r,o=s.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=s.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());s.triggerDeletion()}},relationshipGroupNode:{name:"..Relationship Group",callback:function(){var t,e=s.getCanvas(),n=s.getAppearance();t=e.createNode(vT.TYPE,n.left,n.top,n.width,n.height,s.getZIndex(),s.toJSON());var i,r,o=s.getOutgoingEdges();for(r in o)o.hasOwnProperty(r)&&(i=o[r],e.createEdge(i.getType(),t,i.getTarget().getEntityId(),i.toJSON()));for(r in o=s.getIngoingEdges())o.hasOwnProperty(r)&&(i=o[r]).getSource()!==i.getTarget()&&e.createEdge(i.getType(),i.getSource().getEntityId(),t,i.toJSON());s.triggerDeletion()}}}},sep:"---------"}}))}},hT=class t extends aT{static TYPE="Edge Shape";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=150;constructor(e,n,i,r,o,a,s){super(e,t.TYPE,n,i,r,o,a,s);var l=this,u=$(su.template('<div class="class_node edgeshape">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;EdgeShape&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:l.getType()})),c=aT.prototype.get$node.call(this).append(u).addClass("class"),d=c.find(".attributes"),f=this.getAttributes();this.toJSON=function(){var e=aT.prototype.toJSON.call(this);return e.type=t.TYPE,e};var p=new PO(this.getEntityId()+"[arrow]","Arrow",this,{bidirassociation:"---",unidirassociation:"--\x3e",generalisation:"--▷",diamond:"-◁▷"}),h=new PO(this.getEntityId()+"[shape]","Shape",this,{straight:"Straight",curved:"Curved",segmented:"Segmented"}),g=new SO(this.getEntityId()+"[color]","Color",this),v=new NO(this.getEntityId()+"[overlay]","Overlay Text",this),y=new PO(this.getEntityId()+"[overlayPosition]","Overlay Position",this,{hidden:"Hide",top:"Top",center:"Center",bottom:"Bottom"}),b=new cO(this.getEntityId()+"[overlayRotate]","Autoflip Overlay",this);for(var m in this.addAttribute(p),this.addAttribute(h),this.addAttribute(g),this.addAttribute(v),this.addAttribute(y),this.addAttribute(b),this.registerYMap=function(t,e){aT.prototype.registerYMap.call(this,t),p.getValue().registerYType(),h.getValue().registerYType(),y.getValue().registerYType(),b.getValue().registerYType(),l.getLabel().getValue().registerYType(),g.getValue().registerYType(),v.getValue().registerYType()},c.find(".label").append(this.getLabel().get$node()),f)f.hasOwnProperty(m)&&d.append(f[m].get$node())}};function gT(t,e,n,i,r,o,a,s,l){var u=UO.hasOwnProperty(n)?UO[n]:su.values(UO)[0];i=i?HO.css("color","#000000").css("color",i).css("color"):"#000000";return class extends oT{constructor(r,c,d){super(r,t,c,d,s);var f=this,p=null;this.setCurrentViewType=function(t){p=t},this.getCurrentViewType=function(){return p};var h=[],g=function(t){return function(){return $("<div></div>").append($("<div></div>").addClass("edge_label fixed").css("color",i).text(t))}},v=function(t){return function(){return $("<div></div>").append($("<div></div>").addClass("edge_label").append(t.get$node())).get(0)}};this.connect=function(){var t=this.getSource(),e=this.getTarget(),n={source:t.get$node().get(0),target:e.get$node().get(0),paintStyle:f.getDefaultPaintStyle(),endpoint:"Dot",anchors:[t.getAnchorOptions(),e.getAnchorOptions()],connector:u,overlays:h,cssClass:this.getEntityId()};t===e&&(n.anchors=["TopCenter","LeftMiddle"]),t.addOutgoingEdge(this),e.addIngoingEdge(this),this.setJsPlumbConnection(window.jsPlumbInstance.connect(n)),this.repaintOverlays(),su.each(uT.getEdges(),(function(t){t.setZIndex()}))},this.toJSON=function(){var e=oT.prototype.toJSON.call(this);return e.type=t,e},this.restyle=function(t,e,n,i,r,o,a,s){if(h=[],e=e?HO.css("color","black").css("color",e).css("color"):"black",aO().hasOwnProperty(t)&&h.push(aO(e)[t]),r)switch(o){case"top":h.push({type:"Custom",options:{create:g(r),location:.9,id:"label"}});break;case"bottom":h.push({type:"Custom",options:{create:g(r),location:.1,id:"label"}});break;default:h.push({type:"Custom",options:{create:g(r),location:.5,id:"label"}})}for(var l in h.push({type:"Custom",options:{create:function(){return f.get$overlay().hide().find(".type").addClass(n),f.get$overlay().get(0)},location:.5,id:"label"}}),r&&f.get$overlay().find("input[name='Label']").css("visibility","hidden"),s){if(s.hasOwnProperty(l))switch(s[l].position){case"top":h.push({type:"Custom",options:{create:v(f.getAttribute(l)),location:1,id:"label "+l}});break;case"center":h.push({type:"Custom",options:{create:v(f.getAttribute(l)),location:.5,id:"label "+l}});break;case"bottom":h.push({type:"Custom",options:{create:v(f.getAttribute(l)),location:0,id:"label "+l}})}}var u={strokeStyle:e,lineWidth:2,dashstyle:i};if(f.setDefaultPaintStyle(u),f.setRotateOverlay(a),f.getJsPlumbConnection()){f.getJsPlumbConnection().removeAllOverlays();for(var c=0;c<h.length;c++)f.getJsPlumbConnection().addOverlay(h[c]);f.getJsPlumbConnection().setPaintStyle(u),f.repaintOverlays()}},this.registerYMap=function(){oT.prototype.registerYMap.call(this);var t=f.getAttributes();for(var e in t)if(t.hasOwnProperty(e)){var n=t[e].getValue();n.hasOwnProperty("registerYType")&&n.registerYType()}},function(){var t,s,u;if(aO().hasOwnProperty(e)&&h.push(aO(i)[e]),o)switch(a){case"top":h.push({type:"Custom",options:{create:g(o),location:.9,id:"label"}});break;case"bottom":h.push({type:"Custom",options:{create:g(o),location:.1,id:"label"}});break;default:h.push({type:"Custom",options:{create:g(o),location:.5,id:"label"}})}for(s in u={},l)if(l.hasOwnProperty(s)){switch((t=l[s]).value){case"boolean":u[s]=new cO(r+"["+t.key.toLowerCase()+"]",t.key,f);break;case"string":u[s]=new NO(r+"["+t.key.toLowerCase()+"]",t.key,f);break;case"integer":u[s]=new rT(r+"["+t.key.toLowerCase()+"]",t.key,f);break;case"file":u[s]=new gO(r+"["+t.key.toLowerCase()+"]",t.key,f);break;default:t.options&&(u[s]=new PO(r+"["+t.key.toLowerCase()+"]",t.key,f,t.options))}switch(t.position){case"top":h.push({type:"Custom",options:{create:v(u[s]),location:1,id:"label "+s}});break;case"center":h.push({type:"Custom",options:{create:v(u[s]),location:.5,id:"label "+s}});break;case"bottom":h.push({type:"Custom",options:{create:v(u[s]),location:0,id:"label "+s}})}}f.setAttributes(u),h.push({type:"Custom",options:{create:function(){return f.get$overlay().hide().find(".type").addClass(n),f.get$overlay().get(0)},location:.5,id:"label"}}),o&&f.get$overlay().find("input[name='Label']").css("visibility","hidden"),f.setDefaultPaintStyle({stroke:i,strokeWidth:4})}()}static getArrowType(){return e}static getShapeType(){return n}static getShape(){return u}static getColor(){return i}static getOverlay(){return o}static getOverlayPosition(){return a}static getOverlayRotate(){return s}static getAttributes(){return l}static getType(){return t}static getArrowOverlays(){var t=[];return aO().hasOwnProperty(e)&&t.push(aO(i)[e]),t}}}let vT=class t extends aT{static TYPE="Relation";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=100;constructor(e,n,i,r,o,a){super(e,t.TYPE,n,i,r,o,a);var s=this,l=$(su.template('<div class="class_node relation">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;Relation&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:s.getType()})),u=aT.prototype.get$node.call(this).append(l).addClass("class"),c=u.find(".attributes"),d=this.getAttributes();for(var f in this.toJSON=function(){var e=aT.prototype.toJSON.call(this);return e.type=t.TYPE,e},this.registerYMap=function(){aT.prototype.registerYMap.call(this),s.getLabel().getValue().registerYType()},u.find(".label").append(this.getLabel().get$node()),d)d.hasOwnProperty(f)&&c.append(d[f].get$node())}},yT=class t extends aT{static TYPE="ModelAttributesNode";constructor(e,n,i){if(super(e,t.TYPE,0,0,0,0,0,null,null,i),!(i=i||window.y))throw new Error("y is not defined");var r=$(su.template('<div class="abstract_class_node">\n    <div class="label"></div>\n    <div class="attributes"></div>\n</div>')()),o=aT.prototype.get$node.call(this).append(r).addClass("class"),a=o.find(".attributes"),s=this.getAttributes();if(this.toJSON=function(){var e=aT.prototype.toJSON.call(this);return e.type=t.TYPE,e},n){for(var l in n)if(n.hasOwnProperty(l))switch(n[l].value){case"boolean":this.addAttribute(new cO(this.getEntityId()+"["+n[l].key.toLowerCase()+"]",n[l].key,this));break;case"string":this.addAttribute(new NO(this.getEntityId()+"["+n[l].key.toLowerCase()+"]",n[l].key,this));break;case"integer":this.addAttribute(new rT(this.getEntityId()+"["+n[l].key.toLowerCase()+"]",n[l].key,this));break;case"file":this.addAttribute(new gO(this.getEntityId()+"["+n[l].key.toLowerCase()+"]",n[l].key,this));break;default:n[l].options&&this.addAttribute(new PO(this.getEntityId()+"["+n[l].key.toLowerCase()+"]",n[l].key,this,n[l].options))}}else this.addAttribute(new NO(this.getEntityId()+"[name]","Name",this,i)),this.addAttribute(new kO(this.getEntityId()+"[description]","Description",this,i));for(var u in this.getLabel().getValue().setValue("Model Attributes"),o.find(".label").text("Model Attributes"),o.hide(),s)s.hasOwnProperty(u)&&a.append(s[u].get$node());this.registerYMap=function(){aT.prototype.registerYMap.call(this);var t=this.getAttributes();for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];n instanceof NO||n instanceof kO?n.getValue().registerYType():n instanceof gO||n instanceof NO||n instanceof kO||n.getValue().registerYType()}}}},bT=class extends aT{static TYPE="ViewObject";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=100;constructor(t,e,n,i,r,o,a){var s=this;super(t,"ViewObject",e,n,i,r,o,a);var l,u,c,d,f=$(su.template('<div class="class_node">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;ViewObject&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:s.getType()})),p=aT.prototype.get$node.call(this).append(f).addClass("viewobject"),h=p.find(".attributes");if(this.getAttributes(),this.toJSON=function(){return aT.prototype.toJSON.call(this)},this.createConditionListAttribute=function(t){var e={};if(t&&"RenamingListAttribute"===t.constructor.name){var n=t.getAttributes();for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i].getKey().getValue())}else for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i].val.value);var r=new LO("[condition]","Conditions",s,e,VO);return s.addAttribute(r),h.append(r.get$node()),r.get$node().hide(),r},this.registerYMap=function(){aT.prototype.registerYMap.call(this),s.getLabel().getValue().registerYType(),u.registerYMap(),d&&d.registerYMap(),l.getValue().registerYType(),c.getValue().registerYType()},this.showAttributes=function(){u.get$node().is(":hidden")&&u.get$node().show(),c.get$node().is(":hidden")&&c.get$node().show(),d.get$node().is(":hidden")&&d.get$node().show(),l.get$node().is(":hidden")||l.get$node().hide()},p.find(".label").append(this.getLabel().get$node()),window.hasOwnProperty("y")){var g=y.getMap("data").get("model");if(g){var v=ViewTypesUtil.GetAllNodesOfBaseModelAsSelectionList2(g.nodes,["Object"]);l=new PO(t+"[target]","Target",s,v),s.addAttribute(l),h.prepend(l.get$node())}d=a?s.createConditionListAttribute(a.attributes["[attributes]"].list):s.createConditionListAttribute()}u=new $O("[attributes]","Attributes",s,{show:"Visible",hide:"Hidden"}),s.addAttribute(u),h.append(u.get$node()),u.get$node().hide(),c=new PO(t+"[conjunction]","Conjunction",s,YO),s.addAttribute(c),h.append(c.get$node()),c.get$node().hide(),a&&c&&d&&u&&l&&s.showAttributes(),this.setContextMenuItemCallback((function(){var t=$("#lblCurrentView").text();return{addShape:{name:"Add Node Shape",callback:function(){var e=s.getCanvas(),n=s.getAppearance();e.createNode(lT.TYPE,n.left+n.width+50,n.top,150,100).done((function(n){e.createEdge(_T.TYPE,s.getEntityId(),n,null,null,t)}))},disabled:function(){var t,e,n=s.getEdges();for(e in n)if(n.hasOwnProperty(e)&&((t=n[e])instanceof _T&&(t.getTarget()===s&&t.getSource()instanceof lT||t.getSource()===s&&t.getTarget()instanceof lT)||t instanceof wT&&t.getTarget()instanceof lT))return!0;return!1}},sep:"---------"}}))}},mT=class extends aT{static TYPE="ViewRelationship";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=100;constructor(t,e,n,i,r,o,a){super(t,"ViewRelationship",e,n,i,r,o,a);var s,l,u,c,d=this,f=$(su.template('<div class="class_node">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;ViewRelationship&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:d.getType()})),p=aT.prototype.get$node.call(this).append(f).addClass("viewrelationship"),h=p.find(".attributes");if(this.getAttributes(),this.toJSON=function(){return aT.prototype.toJSON.call(this)},this.registerYMap=function(){aT.prototype.registerYMap.call(this),d.getLabel().getValue().registerYType(),attributeList.registerYMap(),c&&c.registerYMap(),attribute.getValue().registerYType(),u.getValue().registerYType()},this.showAttributes=function(){l.get$node().is(":hidden")&&l.get$node().show(),u.get$node().is(":hidden")&&u.get$node().show(),c.get$node().is(":hidden")&&c.get$node().show(),s.get$node().is(":hidden")||s.get$node().hide()},this.createConditionListAttribute=function(t){var e={};if(t&&"RenamingListAttribute"===t.constructor.name){var n=t.getAttributes();for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i].getKey().getValue())}else for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i].val.value);var r=new LO("[condition]","Conditions",d,e,VO);return d.addAttribute(r),h.append(r.get$node()),r.get$node().hide(),r},this.registerYMap=function(){aT.prototype.registerYMap.call(this),d.getLabel().getValue().registerYType(),l.registerYMap(),c&&c.registerYMap(),s.getValue().registerYType(),u.getValue().registerYType()},p.find(".label").append(this.getLabel().get$node()),window.hasOwnProperty("y")){var g=y.getMap("data").get("model");if(g){var v=ViewTypesUtil.GetAllNodesOfBaseModelAsSelectionList2(g.nodes,["Relationship"]);s=new PO(t+"[target]","Reference",d,v),d.addAttribute(s),h.prepend(s.get$node()),c=a?d.createConditionListAttribute(a.attributes["[attributes]"].list):d.createConditionListAttribute()}}l=new $O("[attributes]","Attributes",d,{hidden:"Show",top:"Show Top",center:"Show Center",bottom:"Show Bottom",hide:"Hide"}),d.addAttribute(l),h.append(l.get$node()),l.get$node().hide(),u=new PO(t+"[conjunction]","Conjunction",d,YO),d.addAttribute(u),h.append(u.get$node()),u.get$node().hide(),a&&u&&c&&l&&s&&d.showAttributes(),this.setContextMenuItemCallback((function(){var t=$("#lblCurrentView").text();return{addShape:{name:"Add Edge Shape",callback:function(){var e=d.getCanvas(),n=d.getAppearance();e.createNode(hT.TYPE,n.left+n.width+50,n.top,150,100),e.createEdge(_T.TYPE,d.getEntityId(),undefined,null,null,t)},disabled:function(){var t,e,n=d.getEdges();for(e in n)if(n.hasOwnProperty(e)&&((t=n[e])instanceof _T&&(t.getTarget()===d&&t.getSource()instanceof hT||t.getSource()===d&&t.getTarget()instanceof hT)||t instanceof wT&&t.getTarget()instanceof hT))return!0;return!1}},sep:"---------"}}))}},ET=class t extends oT{static TYPE="Generalisation";static RELATIONS=[{sourceTypes:[dT.TYPE],targetTypes:[dT.TYPE,fT.TYPE]},{sourceTypes:[pT.TYPE],targetTypes:[pT.TYPE,fT.TYPE]},{sourceTypes:[vT.TYPE],targetTypes:[pT.TYPE,mT.TYPE]},{sourceTypes:[fT.TYPE],targetTypes:[fT.TYPE]},{sourceTypes:[sT.TYPE],targetTypes:[sT.TYPE]}];constructor(e,n,i){super(e,t.TYPE,n,i);var r=this;this.connect=function(){var t=this.getSource(),e=this.getTarget(),n={source:t.get$node().get(0),target:e.get$node().get(0),paintStyle:{stroke:"black",strokeWidth:4},endpoint:"Dot",anchors:[t.getAnchorOptions(),e.getAnchorOptions()],connector:{type:Ut.type,options:{gap:0}},overlays:[{type:"Arrow",options:{width:20,length:25,location:1,foldback:1,paintStyle:{fill:"#ffffff",outlineWidth:2,dashstyle:"black"}}},{type:"Custom",options:{create:function(){return r.get$overlay().get(0)},location:.5,id:"label"}}],cssClass:this.getEntityId()};t===e&&(n.anchor=["TopCenter","LeftMiddle"]),t.addOutgoingEdge(this),e.addIngoingEdge(this),this.setJsPlumbConnection(window.jsPlumbInstance.connect(n)),this.repaintOverlays(),su.each(uT.getEdges(),(function(t){t.setZIndex()}))},this.get$overlay().find(".type").addClass("segmented")}},wT=class t extends oT{static TYPE="Uni-Dir-Association";static RELATIONS=[{sourceTypes:[dT.TYPE],targetTypes:[sT.TYPE,lT.TYPE,pT.TYPE,vT.TYPE,mT.TYPE]},{sourceTypes:[pT.TYPE],targetTypes:[sT.TYPE,hT.TYPE,dT.TYPE,fT.TYPE,bT.TYPE]},{sourceTypes:[vT.TYPE],targetTypes:[dT.TYPE,fT.TYPE]},{sourceTypes:[fT.TYPE],targetTypes:[sT.TYPE,pT.TYPE,vT.TYPE]},{sourceTypes:[bT.TYPE],targetTypes:[sT.TYPE,lT.TYPE,pT.TYPE,vT.TYPE,mT.TYPE]},{sourceTypes:[mT.TYPE],targetTypes:[sT.TYPE,hT.TYPE,dT.TYPE,fT.TYPE,bT.TYPE]}];constructor(e,n,i){super(e,t.TYPE,n,i);var r=this;this.connect=function(){var t=this.getSource(),e=this.getTarget(),n={source:t.get$node().get(0),target:e.get$node().get(0),paintStyle:{stroke:"black",strokeWidth:4},endpoint:"Dot",anchors:[t.getAnchorOptions(),e.getAnchorOptions()],connector:{type:Ut.type,options:{gap:0}},overlays:[{type:"Arrow",options:{width:20,length:30,location:1,foldback:.5,paintStyle:{fill:"#ffffff",outlineWidth:2,outlineStroke:"black"}}},{type:"Custom",options:{create:function(){return r.get$overlay().get(0)},location:.5,id:"label"}}],cssClass:this.getEntityId()};t===e&&(n.anchors=["TopCenter","LeftMiddle"]),t.addOutgoingEdge(this),e.addIngoingEdge(this),this.setJsPlumbConnection(window.jsPlumbInstance.connect(n)),this.repaintOverlays(),su.each(uT.getEdges(),(function(t){t.setZIndex()}))},this.get$overlay().find(".type").addClass("segmented")}},_T=class t extends oT{static TYPE="Bi-Dir-Association";static RELATIONS=[{sourceTypes:[dT.TYPE],targetTypes:[sT.TYPE,lT.TYPE,pT.TYPE,vT.TYPE,mT.TYPE]},{sourceTypes:[pT.TYPE],targetTypes:[sT.TYPE,hT.TYPE,dT.TYPE,fT.TYPE,bT.TYPE]},{sourceTypes:[vT.TYPE],targetTypes:[dT.TYPE,fT.TYPE]},{sourceTypes:[fT.TYPE],targetTypes:[sT.TYPE,pT.TYPE,vT.TYPE]},{sourceTypes:[sT.TYPE],targetTypes:[dT.TYPE,pT.TYPE,fT.TYPE]},{sourceTypes:[lT.TYPE],targetTypes:[dT.TYPE]},{sourceTypes:[hT.TYPE],targetTypes:[pT.TYPE]},{sourceTypes:[bT.TYPE],targetTypes:[sT.TYPE,lT.TYPE,pT.TYPE,vT.TYPE,mT.TYPE]},{sourceTypes:[mT.TYPE],targetTypes:[sT.TYPE,hT.TYPE,dT.TYPE,fT.TYPE,bT.TYPE]}];constructor(e,n,i){super(e,t.TYPE,n,i);var r=this;this.connect=function(){var t=this.getSource(),e=this.getTarget(),n={source:t.get$node().get(0),target:e.get$node().get(0),paintStyle:{stroke:"black",strokeWidth:4},endpoint:"Dot",anchors:[t.getAnchorOptions(),e.getAnchorOptions()],connector:{type:Ut.type,options:{gap:0}},overlays:[{type:"Custom",options:{create:function(){return r.get$overlay().get(0)},location:.5,id:"label"}}],cssClass:this.getEntityId()};t===e&&(n.anchors=["TopCenter","LeftMiddle"]),t.addOutgoingEdge(this),e.addIngoingEdge(this),this.setJsPlumbConnection(window.jsPlumbInstance.connect(n)),this.repaintOverlays(),su.each(uT.getEdges(),(function(t){t.setZIndex()}))},this.get$overlay().find(".type").addClass("segmented")}};class OT{constructor(t,e,n){var i=null,r=t||"AbstractTool",o=e||"tool-abstract",a=n||"An abstract canvas tool";this.setCanvas=function(t){if(!t)throw new Error("Canvas is null");i=t},this.getCanvas=function(){return i},this.getName=function(){return r},this.getClassName=function(){return o},this.getDescription=function(){return a},this._mount=function(){i.get$canvas().addClass(o)},this._unmount=function(){i.get$canvas().removeClass(o)}}mount(){this._mount()}unmount(){this._unmount()}}let TT=class extends OT{constructor(t,e,n,i,r,o){super(t,e||"tool-node",n||"Add a node");var a=r||100,s=o||50;this.mount=function(t,e){var n=this.getCanvas().get$canvas(),r=this;OT.prototype.mount.call(this),n.on("mouseup.nodeadd",(function(o){var l;if(1==o.which){l=n.offset();var u=r.getCanvas().getZoom(),c=(o.pageX-l.left)/u-a/2,d=(o.pageY-l.top)/u-s/2;r.getCanvas().createNode(r.getName(),c,d,a,s,null,i,null,null,null,t,e),r.getCanvas().resetTool()}})),n.bind("contextmenu",(function(t){return t.target!=this||(t.preventDefault(),r.getCanvas().resetTool(),!1)})),n.find(".node").bind("contextmenu",(function(t){return t.preventDefault(),r.getCanvas().resetTool(),r.getCanvas().select(uT.findNode($(this).attr("id"))),!1}))},this.unmount=function(){var t=this.getCanvas().get$canvas();OT.prototype.unmount.call(this),t.off("mouseup.nodeadd"),t.unbind("contextmenu"),t.find(".node").unbind("contextmenu")}}},xT=class extends TT{constructor(){super(fT.TYPE,null,null,null,fT.DEFAULT_WIDTH,fT.DEFAULT_HEIGHT)}},AT=class extends OT{constructor(t,e,n,i){super(t,n||"tool-edge",i||"Add an edge");const r=window.jsPlumbInstance;var o=e;this.mount=function(){function t(t){return function(e){return e.getEntityId()!==t&&!e.getNeighbors().hasOwnProperty(t)}}OT.prototype.mount.call(this);var n,i,a,s,l,u,c=this,d=this.getCanvas().get$canvas(),f=uT.getNodes();for(n in f)if(f.hasOwnProperty(n))for((i=f[n]).lowlight(),void 0===uT.getViewId()||uT.getLayer()===f_.LAYER.META?(a=i.getType(),s="getNodesByType"):(a=i.getCurrentViewType(),s="getNodesByViewType"),l=0,u=o.length;l<u;l++)if(-1!==e[l].sourceTypes.indexOf(a)&&su.size(su.filter(uT[s](e[l].targetTypes),t(i.getEntityId())))>0){i.makeSource(),i.unbindMoveToolEvents(),i.unlowlight();break}r.bind("beforeDrag",(function(n){var i,r,a,s,l=uT.findNode(n.sourceId);if(l)for(void 0===uT.getViewId()||uT.getLayer()===f_.LAYER.META?(i=l.getType(),s="getNodesByType"):(i=l.getCurrentViewType(),s="getNodesByViewType"),r=0,a=o.length;r<a;r++)-1!==e[r].sourceTypes.indexOf(i)&&su.each(su.filter(uT[s](e[r].targetTypes),t(l.getEntityId())),(function(t){t.makeTarget(),t.unlowlight()}));return $(n.source).addClass("current"),d.addClass("dragging"),!0})),r.bind("beforeDrop",(function(){return d.removeClass("dragging"),$(".node.current").removeClass("current"),!0})),r.bind("beforeDetach",(function(t){return t.connection?.pending&&($(".node.current").removeClass("current"),d.removeClass("dragging")),!0})),r.bind("connection",(function(t,e){return void 0!==e&&(t.connection&&r.deleteConnection(t.connection,{fireEvent:!1}),c.getCanvas().createEdge(c.getName(),t.sourceId,t.targetId)),!0})),d.bind("contextmenu",(function(t){return t.target!=this||(t.preventDefault(),c.getCanvas().resetTool(),!1)})),d.find(".node").bind("contextmenu",(function(t){return t.preventDefault(),c.getCanvas().resetTool(),c.getCanvas().select(uT.findNode($(this).attr("id"))),!1}))},this.unmount=function(){OT.prototype.unmount.call(this,arguments);var t,e,n=this.getCanvas().get$canvas(),i=uT.getNodes();for(t in i)i.hasOwnProperty(t)&&((e=i[t]).unlowlight(),e.unbindEdgeToolEvents(),e.bindMoveToolEvents());r.unbind("connectionDrag"),r.unbind("beforeDrop"),r.unbind("connection"),n.unbind("contextmenu"),n.find(".node").unbind("contextmenu")}}},ST=class extends AT{constructor(){super(_T.TYPE,_T.RELATIONS)}};var IT={apply:function(){var t,e,n,i,r,o,a,s,l=new dagre.graphlib.Graph;l.setGraph({}),l.setDefaultEdgeLabel((function(){return{}}));var u=uT.getNodes();for(var c in u)u.hasOwnProperty(c)&&(t=u[c],i=t.getAppearance(),l.setNode(c,{width:i.width,height:i.height}));var d=uT.getEdges();for(var f in d)d.hasOwnProperty(f)&&(e=d[f],l.setEdge(e.getSource().getEntityId(),e.getTarget().getEntityId()));dagre.layout(l,{rankdir:"BT",align:"UL",ranker:"tight-tree",marginx:9e3,marginy:9e3}),r=4500-l.graph().width/2,o=4500-l.graph().height/2,l.nodes().forEach((function(e){(n=uT.findNode(e))&&(i=n.getAppearance(),t=l.node(e),a=r+t.x,s=o+t.y,i.top===a&&i.top===s||n.moveAbs(a,s))}))}};class kT{constructor(t,e,n,i,r,o){o=o||window.y;var a=iO.getInstance(f_.WIDGET.NAME.MAIN,o),s=r,l=$(su.template('<button class="bs-btn bs-btn-default">\n\t<i class="fa fa-users"></i>\n\t<%= text %>\n</button>')({text:e,icon:"users"}));l.click((function(){var t=new q_(n);a.sendLocalNonOTOperation(f_.WIDGET.NAME.GUIDANCE,t.toNonOTOperation()),s.hideGuidanceBox(),s.scrollNodeIntoView(i)})),this.get$node=function(){return l}}}class PT{constructor(t,e,n,i){var r=null,o=e.getType();n.addGhostEdge(this),i.addGhostEdge(this),this.getLabel=function(){return o},this.connect=function(t){if(!r){var o=e.getArrowOverlays();o.push(["Custom",{create:function(e){return $("<div></div>").append(t)},location:.5,id:"customOverlay",cssClass:"ghost-edge-overlay"}]);var a={source:n.get$node(),target:i.get$node(),paintStyle:{stroke:e.getColor(),strokeWidth:4,dashstyle:""},endpoint:"Dot",anchors:[n.getAnchorOptions(),i.getAnchorOptions()],connector:e.getShape(),overlays:o,cssClass:"ghost-edge"};n===i&&(a.anchors=["TopCenter","LeftMiddle"]),r=window.JsPlumbInstance.connect(a),su.each(uT.getEdges(),(function(t){t.setZIndex()}))}},this.remove=function(){r&&window.JsPlumbInstance.destroyConnector(r),r=null},this.getEdgeFunction=function(){return e},this.getSource=function(){return n},this.getTarget=function(){return i}}}const NT='\x3c!-- <button class=\'bs-btn bs-btn-default bs-btn-s\' style="z-index: 30000; opacity:0.4;">\n\t<i class=\'fa fa-plus\' style=\'margin-right:5px;\'></i><%= label %>\n</button> --\x3e\n\x3c!-- Split button --\x3e\n<div class="bs-btn-group" style="z-index: 30000; opacity:0.4;">\n  <button type="bs-button" class="bs-btn bs-btn-default create-edge-button"><i class=\'fa fa-plus\' style=\'margin-right:5px;\'></i><span class="label"></span></button>\n  <button type="bs-button" class="bs-btn bs-btn-default bs-dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="min-height:34px;">\n    <span class="bs-caret"></span>\n  </button>\n  <ul class="bs-dropdown-menu edge-list">\n  </ul>\n</div>';function CT(t,e,n){var i=$(NT),r=i.find(".bs-dropdown-toggle");r.detach();var o=i.find(".edge-list");o.detach();var a=t,s=this,l=[],u=e,c=n,d=null;u.addGhostEdge(this),c.addGhostEdge(this),i.hover((function(){$(this).css({opacity:1})}),(function(){$(this).css({opacity:.4})})),this.show=function(){d.connect(i)},this.addEdge=function(t,e,n){var u=new PT(a,t,e,n);l.push(u);var c=$("<li><a href='javascript:;'></a></li>");c.click((function(){s.remove(),s.setCurrentEdge(u),s.show()})),c.find("a").text(u.getLabel()),o.append(c),1==l.length&&this.setCurrentEdge(u),2==l.length&&(i.append(r),i.append(o))},this.remove=function(){i.detach(),d&&d.remove()},this.getNode1=function(){return u},this.getNode2=function(){return c},this.setCurrentEdge=function(t){d&&d.remove(),d=t,i.find(".label").text(d.getLabel());var e=i.find(".create-edge-button");e.off("click"),e.click((function(t){t.stopPropagation(),s.remove(),a.createEdge(d.getEdgeFunction().getType(),d.getSource().getEntityId(),d.getTarget().getEntityId())}))}}const jT='<div id="<%= id %>" class="node">\n</div>',MT='<div class="guidance-box bs-panel bs-panel-info" style="opacity:0.5;">\n  <div class="bs-panel-body" style="padding:2px;">\n  \t\t<div class="bs-btn-group bs-gtn-group-s buttons" role="group">\n\t\t</div>\n  </div>\n  <div class="bs-panel-footer" style="padding-top:0px; padding-bottom:0px; background-color:#337ab7; color:white; font-size:12px; overflow:hidden;">\n  \t<p class="scroll-text" style="width:1; white-space:nowrap; position:relative; margin:0px;"><i class="fa fa-puzzle-piece" style="margin-right:5px;"></i>Guidance</p>\n  </div>\n</div>';function DT(t,e,n,i){var r=$(su.template(jT)({id:t})).append(MT);r.find(".guidance-box").hover((function(){$(this).css({opacity:1})}),(function(){$(this).css({opacity:.5})}));var o={left:n,top:i};this.get$node=function(){return r},this.addGuidance=function(t){r.find(".buttons").append(t.get$node())},this.draw=function(){var t=r.width();r.css({left:o.left-t/2,top:o.top,zIndex:3e4})},this.addToCanvas=function(t){t.get$canvas().append(r)},this.remove=function(){r.remove()}}const RT='<button class="bs-btn bs-btn-default">\n\t<i class="fa fa-<%= icon %>"></i>\n\t<%= text %>\n</button>';function LT(t,e,n,i,r){var o=i,a=$(su.template(RT)({text:e,icon:r||"plus-circle"}));a.click((function(){void 0!==uT.getViewId()&&uT.getLayer()===f_.LAYER.MODEL&&null!==uT.getNodeType(n)?o.mountTool(uT.getNodeType(n).VIEWTYPE):o.mountTool(n),o.hideGuidanceBox()})),this.get$node=function(){return a}}const YT='<div class="bs-btn-group" role="group">\n<button class="bs-btn bs-btn-default bs-dropdown-toggle" data-toggle="dropdown">\n\t<i class="fa fa-<%= icon %>"></i>\n\t<%= text %>\n</button>\n<ul class="bs-dropdown-menu">\n\t<li class="property-input"></li>\n</ul>\n</div>';function VT(t,e,n,i,r){var o,a=n.getEntityId(),s=r,l=null,u=$(su.template(YT)({text:e,icon:"edit"})),c=n.getAttributes();for(var d in c){var f=c[d];f.getEntityId()==n.getEntityId()+"["+i.toLowerCase()+"]"&&(l=f)}if(l instanceof NO){if((o=new NO(n.getEntityId()+"["+i.toLowerCase()+"]",i,n)).getValue().setValue(l.getValue().getValue()),"Edge"===l.getRootSubjectEntity().constructor.name){y.getMap("edges").get(n.getEntityId()).get(n.getEntityId()+"["+i.toLowerCase()+"]").bind(o.getValue().get$node()[0])}else{y.getMap("nodes").get(n.getEntityId()).get(n.getEntityId()+"["+i.toLowerCase()+"]").bind(o.getValue().get$node()[0])}u.find(".property-input").append(o.get$node().find(".val").prop("disabled",!1))}else if(l instanceof PO){var p=l.getOptions();(o=new PO(n.getEntityId()+"["+i.toLowerCase()+"]",i,n,p,!0)).getValue().setValue(l.getValue().getValue()),o.getValue().get$node().bind("change",(function(t){l.getValue().setValue(o.getValue().getValue())})),u.find(".property-input").append(o.getValue().get$node()),u.find(".property-input").click((function(t){t.stopPropagation()}))}else l instanceof rT?((o=new rT(n.getEntityId()+"["+i.toLowerCase()+"]",i,n,!0)).getValue().setValue(l.getValue().getValue()),l.get$node().find(".val").bind("change",(function(){o.getValue().setValue(l.getValue().getValue())})),o.get$node().find(".val").bind("change",(function(t){l.getValue().setValue(o.getValue().getValue())})),u.find(".property-input").append(o.get$node().find(".val").prop("disabled",!1)),u.find(".property-input").click((function(t){t.stopPropagation()}))):l instanceof cO?((o=new cO(n.getEntityId()+"["+i.toLowerCase()+"]",i,n,!0)).getValue().setValue(l.getValue().getValue()),l.get$node().find(".val").bind("change",(function(){o.getValue().setValue(l.getValue().getValue())})),o.get$node().find(".val").bind("change",(function(t){l.getValue().setValue(o.getValue().getValue())})),u.find(".property-input").append(o.get$node().find(".val")),u.find(".property-input").click((function(t){t.stopPropagation()}))):l instanceof gO&&((o=new gO(n.getEntityId()+"["+i.toLowerCase()+"]",i,n,!0)).getValue().setValue(l.getValue().getValue()),o.getValue().setValue(l.getValue().getValue()),u.find(".property-input").append(o.getValue().get$node()),u.find(".property-input").click((function(t){t.stopPropagation()})));o&&o.get$node().find(".val").keypress((function(t){13==t.which&&u.find(".bs-dropdown-toggle").dropdown("toggle")})),u.hover((function(){a&&s.highlightEntity(a)}),(function(){a&&s.unhighlightEntity(a)})),this.get$node=function(){return u}}let BT=class t extends OT{static TYPE="MoveTool";mount;unmount;constructor(){super(t.TYPE,"tool-move","Move Nodes and Edges"),this.mount=function(){OT.prototype.mount.call(this),this.getCanvas().bindMoveToolEvents()},this.unmount=function(){OT.prototype.unmount.call(this),this.getCanvas().unbindMoveToolEvents()}}};class $T{constructor(t){var e=this,n={},i=null,r=t;this.get$canvas=function(){return r},this.addTool=function(t,e){n.hasOwnProperty(t)||"function"!=typeof e.mount||"function"!=typeof e.unmount||"function"!=typeof e.setCanvas||(e.setCanvas(this),n[t]=e)},this.getTool=function(t){return n.hasOwnProperty(t)?n[t]:null},this.mountTool=function(t,e,r){if(i&&n[i]&&n[i].unmount(),n.hasOwnProperty(t))n[t].mount(e,r);else{if("MoveTool"!==t)throw new Error("Tool "+t+" not found");n.MoveTool.mount()}i=t},this.remountCurrentTool=function(){e.mountTool(i)},this.getCurrentToolName=function(){return i},this.removeTools=function(){n={}}}}class FT extends $T{constructor(t,e=window.y){super(t);var n=this,i=t,r=1,o=9e3;this.width=o;var a=9e3;this.height=a;var s=null,l=iO.getInstance(f_.WIDGET.NAME.MAIN,e),u=null,c=i.offset(),d=null,f="",p=null,h=[],g=null;const v=Ba({container:i.get(0),elementsDraggable:!0,connectionsDetachable:!1,dragOptions:{filter:".resizing"}});window.jsPlumbInstance=v,$(window).resize((function(){m()}));var y=function(t){var i;if(i=t.getJSON()?uT.createNodeFromJSON(t.getType(),t.getEntityId(),t.getLeft(),t.getTop(),t.getWidth(),t.getHeight(),t.getZIndex(),t.getContainment(),t.getJSON()):uT.createNode(t.getType(),t.getEntityId(),t.getLeft(),t.getTop(),t.getWidth(),t.getHeight(),t.getZIndex(),t.getContainment()),t.getDefaultLabel()&&i.getLabel().getValue().setValue(t.getDefaultLabel()),t.getDefaultAttributeValues())for(const[e,n]of Object.entries(t.getDefaultAttributeValues()))i.getAttribute(e).getValue().setValue(n);if(e.getMap("users").get(e.clientID)!==t.getJabberId()){const n=e.getMap("userList");var r=Z_.getColor(n.get(t.getJabberId()).globalId);i.refreshTraceAwareness(r)}e&&i.registerYMap(),i.draw(),i.addToCanvas(n),i.bindMoveToolEvents(),n.remountCurrentTool()},b=function(t){var e;e=t.getJSON()?uT.createEdgeFromJSON(t.getType(),t.getEntityId(),t.getSource(),t.getTarget(),t.getJSON()):uT.createEdge(t.getType(),t.getEntityId(),uT.findNode(t.getSource()),uT.findNode(t.getTarget())),window.hasOwnProperty("y")&&e.registerYMap(),e.connect(),e.addToCanvas(n),e.bindMoveToolEvents(),n.remountCurrentTool()},m=function(){var t=$("#canvas-frame"),e=new F_(i.position().left,i.position().top,t.width(),t.height(),r);l.sendLocalNonOTOperation(f_.WIDGET.NAME.HEATMAP,e.toNonOTOperation())},E=function(t){t instanceof P_&&function(t){n.mountTool(t.getSelectedToolName(),t.getDefaultLabel(),t.getDefaultAttributeValues())}(t)},w=function(t){t instanceof $_&&O(t)},O=function(t){p=t.getGuidance(),f=t.getLabel(),n.showGuidanceBox(t.getEntityId())},T=function(t){if(t instanceof C_)if(null===t.getData())t.setData(uT.generateMetaModel()),l.sendLocalNonOTOperation(t.getRequestingComponent(),t.toNonOTOperation());else{var n=t.getData(),i=new N_("EditorGenerateActivity","-1",l.getUser()[f_.NS.PERSON.JABBERID],'..generated new Editor <a href="'+n.spaceURI+'" target="_blank">'+n.spaceTitle+"</a>",{});e.getMap("activity").set("EditorGenerateActivity",i.toJSON())}},x=function(t){t instanceof U_&&n.scrollEntityIntoView(t.getObjectId())},A=function(t){t instanceof j_&&null===t.getData()&&(t.setData(uT.generateLogicalGuidanceRepresentation()),l.sendLocalNonOTOperation(t.getRequestingComponent(),t.toNonOTOperation()))},S=function(t){const n=e.getMap("canvas");t instanceof z_&&n.set(z_.TYPE,t.toJSON())},I=function(t){if(t instanceof G_){e.getMap("canvas").set(G_.TYPE,t.toJSON())}},k=function(t){t instanceof M_&&n.toPNG().then((function(e){t.setData(e),l.sendLocalNonOTOperation(t.getRequestingComponent(),t.toNonOTOperation())}))};this.get$node=function(){return i},this.showGuidanceBox=function(t){if(this.hideGuidanceBox(),void 0===t?t=g:g=t,null!==p&&0!=p.length&&(t||(t=u.getEntityId()),l=uT.findNode(t))){var e=l.getAppearance(),i={top:e.top,left:e.left,width:e.width,height:e.height};i.top+=e.height+10,i.left+=e.width/2,d=new DT(Z_.generateRandomId(),f,i.left,i.top);var r=!1;null!=uT.getViewId()&&uT.getLayer()===f_.LAYER.MODEL&&(r=!0);for(var o=0;o<p.length;o++){var a=null;switch(p[o].type){case"SELECT_TOOL_GUIDANCE":var s;if(r&&null===uT.getNodeType(p[o].tool).VIEWTYPE)continue;s=r?uT.getNodeType(p[o].tool).VIEWTYPE:p[o].tool,a=new LT(p[o].id,p[o].label,s,n,p[o].icon);break;case"SET_PROPERTY_GUIDANCE":var l;(l=uT.findNode(p[o].entityId))||(l=uT.findEdge(p[o].entityId)),a=new VT(p[o].id,p[o].label,l,p[o].propertyName,n);break;case"COLLABORATION_GUIDANCE":a=new kT("",p[o].label,p[o].activityId,p[o].objectId,n);break;case"GHOST_EDGE_GUIDANCE":var c;if(r&&void 0===uT.getEdgeType(p[o].relationshipType).VIEWTYPE)continue;c=r?uT.getEdgeType(p[o].relationshipType).VIEWTYPE:p[o].relationshipType,n.showGhostEdge(p[o].sourceId,p[o].targetId,c)}a&&d.addGuidance(a)}d.addToCanvas(n),d.draw()}},this.hideGuidanceBox=function(){null!==d&&d.remove(),d=null;for(var t=0;t<h.length;t++)h[t].remove();h=[]},this.setModelAttributesNode=function(t){s=t},this.getModelAttributesNode=function(){return s},this.bindMoveToolEvents=function(){i.draggable("enable");e.getMap("widgetConfig").get("view_only")?$.contextMenu({selector:"#"+i.attr("id"),build:function(t,e){return!1}}):$.contextMenu({selector:"#"+i.attr("id"),zIndex:rO.CONTEXT_MENU_Z_INDEX,build:function(t,e){return null===u?{items:{addNode:{name:"Add node..",items:uT.generateAddNodeMenu(n,e.originalEvent.offsetX,e.originalEvent.offsetY)},hide:{name:"Hide entities..",items:{nodes:{name:"nodes..",items:uT.generateVisibilityNodeMenu("hide")},edges:{name:"edges..",items:uT.generateVisibilityEdgeMenu("hide")}}},show:{name:"Show entities..",items:{nodes:{name:"nodes..",items:uT.generateVisibilityNodeMenu("show")},edges:{name:"edges..",items:uT.generateVisibilityEdgeMenu("show")}}}}}:(n.select(null),!1)}})},this.unbindMoveToolEvents=function(){i.draggable("disable"),null!=i.transformable&&i.transformable("destroy"),i.unbind("contextmenu")},this.select=function(t){u!=t&&(u&&u.unselect(),t&&t.select());var n=new k_(t?t.getEntityId():null,t?t.getType():null,l.getUser()[f_.NS.PERSON.JABBERID]);l.sendLocalNonOTOperation(f_.WIDGET.NAME.ATTRIBUTE,n.toNonOTOperation()),l.sendLocalNonOTOperation(f_.WIDGET.NAME.GUIDANCE,n.toNonOTOperation()),l.sendLocalNonOTOperation(f_.WIDGET.NAME.METADATA,n.toNonOTOperation()),l.sendLocalNonOTOperation(f_.WIDGET.NAME.OPENAPI,n.toNonOTOperation());const i=e.getMap("select"),r=e.getMap("users");null===t?i.set(r.get(e.clientID),null):i.set(r.get(e.clientID),t.getEntityId()),u=t},this.getSelectedEntity=function(){return u},this.setZoom=function(t){t<.1||t>2||(r=t,i.css("transform",`scaleX(${t}) scaleY(${t})`),i.animate({transform:`scaleX(${t}) scaleY(${t})`}),window.jsPlumbInstance.setZoom(t),m())},this.showGhostEdge=function(t,e,i){var r=uT.findNode(t),o=uT.findNode(e);if(r&&o){for(var a=null,s=0;s<h.length;s++){var l=h[s],u=l.getNode1(),c=l.getNode2();if(r==u&&o==c||r==c&&o==u){a=l;break}}a||(a=new CT(n,r,o),h.push(a)),uT.getViewId()&&uT.getLayer()===f_.LAYER.MODEL?a.addEdge(uT.getViewEdgeType(i),r,o):a.addEdge(uT.getEdgeType(i),r,o);for(var d=0;d<h.length;d++)h[d].show()}},this.highlightEntity=function(t){var e=uT.findNode(t);e?e.highlight("blue","Set property"):(e=uT.findEdge(t)).highlight("blue")},this.unhighlightEntity=function(t){var e=uT.findNode(t);e||(e=uT.findEdge(t)),e.unhighlight()},this.getZoom=function(){return r},this.resetTool=function(){var t=new P_(BT.TYPE);l.sendLocalNonOTOperation(f_.WIDGET.NAME.PALETTE,t.toNonOTOperation()),this.mountTool(BT.TYPE)},this.createNode=function(t,n,i,r,o,a,s,u,c,d,f,p){var h,g=null;h=c||Z_.generateRandomId(24),a=a||rO.maxZIndex+1,void 0!==uT.getViewId()&&uT.getLayer()===f_.LAYER.MODEL&&(g=uT.getViewNodeType(t).getTargetNodeType().TYPE);var v=new E_(h,t,n,i,r,o,a,s,u||null,uT.getViewId(),g,l.getUser()[f_.NS.PERSON.JABBERID],f,p);try{!function(t){y(t),l.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()),l.sendLocalOTOperation(f_.WIDGET.NAME.HEATMAP,t.getOTOperation()),e.getMap("activity").set(N_.TYPE,new N_("NodeAddActivity",t.getEntityId(),l.getUser()[f_.NS.PERSON.JABBERID],E_.getOperationDescription(t.getType()),{nodeType:t.getType()}).toJSON())}(v)}catch(t){console.error(t)}if(e){e.getMap("canvas").set(E_.TYPE,v.toJSON())}return d||zO.add(v),h},this.createEdge=function(t,n,i,r,o,a){var s=null,u=null;s=o||Z_.generateRandomId(24),void 0!==uT.getViewId()&&uT.getLayer()===f_.LAYER.MODEL&&(u=uT.getViewEdgeType(t).getTargetEdgeType().TYPE);var c=new __(s,t,n,i,r||null,uT.getViewId(),u,l.getUser()[f_.NS.PERSON.JABBERID]);if(function(t){var n=uT.findNode(t.getSource()),i=uT.findNode(t.getTarget());b(t),uT.storeDataYjs(),l.sendLocalOTOperation(f_.WIDGET.NAME.GUIDANCE,t.getOTOperation()),e.getMap("activity").set(N_.TYPE,new N_("EdgeAddActivity",t.getEntityId(),l.getUser()[f_.NS.PERSON.JABBERID],__.getOperationDescription(t.getType(),"",n.getLabel().getValue().getValue(),n.getType(),i.getType(),i.getLabel().getValue().getValue()),{nodeType:t.getType(),sourceNodeId:t.getSource(),sourceNodeLabel:n.getLabel().getValue().getValue(),sourceNodeType:n.getType(),targetNodeId:t.getTarget(),targetNodeLabel:i.getLabel().getValue().getValue(),targetNodeType:i.getType()}).toJSON())}(c),window.hasOwnProperty("y")){e.getMap("canvas").set(__.TYPE,c.toJSON())}return a||zO.add(c),s},this.scrollNodeIntoView=function(t){if(t){var e=$("#canvas-frame").offset(),n=$("#canvas-frame").width(),r=$("#canvas-frame").height(),o=t.get$node().offset(),a=t.get$node().width(),s=t.get$node().height(),l=o.left-e.left,u=o.top-e.top;i.position().top,i.position().left,i.animate({top:"+="+(r/2-u-s/2),left:"+="+(n/2-l-a/2)},1e3)}},this.scrollEdgeIntoView=function(t){if(t){var e=$("#canvas-frame").offset(),n=$("#canvas-frame").width(),r=$("#canvas-frame").height(),o=t.getSource(),a=t.getTarget(),s=o.get$node().offset(),l=o.get$node().width(),u=o.get$node().height(),c=a.get$node().offset(),d=a.get$node().width(),f=a.get$node().height(),p=(s.left+c.left)/2-e.left,h=(s.top+c.top)/2-e.top;i.position().top,i.position().left,i.animate({top:"+="+(r/2-h-Math.max(u,f)/2),left:"+="+(n/2-p-Math.max(l,d)/2)},1e3)}},this.scrollEntityIntoView=function(t){if(!t)return null;-1!=t.indexOf("[")&&-1!=t.indexOf("]")&&(t=t.replace(/\[\w*\]/g,""));var e=uT.findNode(t);if(e)n.scrollNodeIntoView(e);else{if(!(e=uT.findEdge(t)))return null;n.scrollEdgeIntoView(e)}return!0},this.toPNG=function(){var t=$("<canvas></canvas>").insertAfter(i).attr("width",i.width()).attr("height",i.height()),e=t[0].getContext("2d"),r=$.Deferred(),s=[],l=this.getZoom();return $("#loading").show(),this.setZoom(1),c=i.offset(),e.beginPath(),e.rect(0,0,o,a),e.fillStyle=i.css("backgroundColor"),e.fill(),_.each(_.sortBy($.makeArray(i.children()),(function(t){return $(t).css("zIndex")})),(function(t){var n=$(t);void 0!==n.attr("id")&&(n.attr("id").startsWith("modelAttributes")||n.attr("id").endsWith("awareness"))||s.push(N(n,e))})),$.when.apply($,s).then((function(){var e,i,s,u,c=document.createElement("canvas"),d=c.getContext("2d"),f=o,p=a,h=0,g=0,v=uT.getNodes(),y=!1;for(e in v)v.hasOwnProperty(e)&&(y=!0,i=v[e].getAppearance(),f=Math.min(f,i.left),p=Math.min(p,i.top),h=Math.max(h,i.left+i.width),g=Math.max(g,i.top+i.height));y||(f=4500,p=4500,h=4500,g=4500),s=(h+=20)-(f-=20),u=(g+=20)-(p-=20),c.width=s,c.height=u,d.drawImage(t[0],f,p,s,u,0,0,s,u),n.setZoom(l),$("#loading").hide(),r.resolve(c.toDataURL())})),r.promise()};var P,N=function(t,e){function n(t,e,n,i){var r=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),o=self.URL||self.webkitURL||self,a=o.createObjectURL(r),s=new Image,l=$.Deferred();return s.onload=function(){t.drawImage(s,n,i),o.revokeObjectURL(a),l.resolve()},s.src=a,setTimeout((function(){l.resolve()}),500),l.promise()}var i=t.contents();return function(t){if(t[0].nodeType===Node.TEXT_NODE){if(""===$.trim(t.text()))return $.Deferred().resolve().promise();t=t.wrap($("<span></span>")).parent()}if(!t.is(":visible"))return $.Deferred().resolve().promise();var i,r,o,a=t.height(),s=t.width(),l=parseInt(t.css("paddingLeft"),10),u=parseInt(t.css("paddingTop"),10),d=parseInt(t.css("paddingRight"),10),f=parseInt(t.css("paddingBottom"),10),p={width:parseInt(t.css("borderWidth")),color:t.css("borderColor"),left:{width:parseInt(t.css("borderLeftWidth")),color:t.css("borderLeftColor")},top:{width:parseInt(t.css("borderTopWidth")),color:t.css("borderTopColor")},right:{width:parseInt(t.css("borderRightWidth")),color:t.css("borderRightColor")},bottom:{width:parseInt(t.css("borderBottomWidth")),color:t.css("borderBottomColor")}},h=[],g=t.css("backgroundColor"),v=t.css("color"),y=t.css("font"),b=parseInt(t.css("fontSize"),10),m=t.css("textDecoration").split(" ")[0],E=t.offset(),w=a,_=t.contents();if("svg"===t[0].nodeName.toLowerCase())return t.attr("width",s),t.attr("height",a),n(e,t[0].outerHTML.replace(/style="[^"]*"/,"").replace(/http:\/\/www\.w3\.org\/1999\/xhtml/g,"http://www.w3.org/2000/svg"),E.left-c.left,E.top-c.top);i=1===_.length&&_[0].nodeType===Node.TEXT_NODE?t.text():t.val();var O={"&":"&amp;","<":"&lt;",">":"&gt;"};switch(i=$.trim(i).replace(/[&<>]/g,(function(t){return O[t]||t})),t.css("textAlign")){case"right":r=s,o="right";break;case"center":r=s/2,o="middle";break;default:r=0,o="left"}return r+=l,w+=u+p.width-Math.ceil((a-b)/2)-1,a+=u+f+2*p.width,s+=l+d+2*p.width,1===p.color.split(" ").length&&1===p.width.split(" ").length||(p.width=0,p.left.width>0&&h.push('<line x1="0" y1="0" x2="0" y2="'+a+'" style="stroke:'+p.left.color+"; stroke-width:"+p.left.width+'" />'),p.top.width>0&&h.push('<line x1="0" y1="0" x2="'+s+'" y2="0" style="stroke:'+p.top.color+"; stroke-width:"+p.top.width+'" />'),p.right.width>0&&h.push('<line x1="'+s+'" y1="0" x2="'+s+'" y2="'+a+'" style="stroke:'+p.right.color+"; stroke-width:"+p.right.width+'" />'),p.bottom.width>0&&h.push('<line x1="0" y1="'+a+'" x2="'+s+'" y2="'+a+'" style="stroke:'+p.bottom.color+"; stroke-width:"+p.bottom.width+'" />')),n(e,'<svg xmlns="http://www.w3.org/2000/svg" width="'+s+'" height="'+a+'"><rect x="0" y="0" width="'+s+'" height="'+a+'" fill="'+g+'" style="stroke: '+p.color+"; stroke-width: "+p.width+'"/>'+h.join("\n")+'<text x="'+r+'" y="'+w+'" fill="'+v+'" style="text-anchor: '+o+"; font: "+y+"; text-decoration: "+m+';">'+i+"</text></svg>",E.left-c.left,E.top-c.top)}(t).then((function(){var n=[];return 1===i.length&&i[0].nodeType===Node.TEXT_NODE||i.each((function(){var i=$(this);"svg"!==t[0].nodeName.toLowerCase()&&n.push(N(i,e))})),$.when.apply($,n).then((function(){return!0}))}))};if(this.registerCallbacks=function(){l.registerOnDataReceivedCallback(E),l.registerOnDataReceivedCallback(T),l.registerOnDataReceivedCallback(A),l.registerOnDataReceivedCallback(k),l.registerOnDataReceivedCallback(w),l.registerOnDataReceivedCallback(I),l.registerOnDataReceivedCallback(x),l.registerOnDataReceivedCallback(S)},this.unregisterCallbacks=function(){l.unregisterOnDataReceivedCallback(E),l.unregisterOnDataReceivedCallback(T),l.unregisterOnDataReceivedCallback(A),l.unregisterOnDataReceivedCallback(k),l.unregisterOnDataReceivedCallback(w),l.unregisterOnLocalDataReceivedCallback(I),l.unregisterOnLocalDataReceivedCallback(x),l.unregisterOnLocalDataReceivedCallback(S)},P=i.parent(),n.addTool(BT.TYPE,new BT),i.css({width:o,height:a,left:(-9e3+P.width())/2,top:(-9e3+P.height())/2}),i.draggable({stop:function(){m()}}),null!=i.transformable&&i.transformable({rotatable:!1,skewable:!1,scalable:!1}),i.mousewheel((function(t){n.setZoom(n.getZoom()+.1*t.deltaY),t.preventDefault()})),window.hasOwnProperty("y")){e.getMap("canvas").observe((function(t){var i=t.currentTarget.doc.clientID;t.keysChanged.forEach((function(r){const o=t.currentTarget.get(r);if(!(window.y.clientID===o.triggeredBy)||o.historyFlagSet){var a=e.getMap("users").get(i);switch(r){case E_.TYPE:(function(t){if(t instanceof E_)if(l.sendLocalOTOperation(f_.WIDGET.NAME.HEATMAP,t.getOTOperation()),t.getViewId()===uT.getViewId()&&uT.getLayer()===f_.LAYER.META)y(t);else if(uT.getLayer()===f_.LAYER.MODEL){var i,r,o;if(i=t.getViewId()?t.getOriginType():t.getType(),uT.getViewId()&&(o=uT.getNodeType(i).VIEWTYPE)&&(i=o),r=t.getJSON()?uT.createNodeFromJSON(i,t.getEntityId(),t.getLeft(),t.getTop(),t.getWidth(),t.getHeight(),t.getZIndex(),t.getContainment(),t.getJSON()):uT.createNode(i,t.getEntityId(),t.getLeft(),t.getTop(),t.getWidth(),t.getHeight(),t.getZIndex(),t.getContainment()),t.getDefaultLabel()&&r.getLabel().getValue().setValue(t.getDefaultLabel()),t.getDefaultAttributeValues())for(const[e,n]of Object.entries(t.getDefaultAttributeValues()))r.getAttribute(e).getValue().setValue(n);if(r.registerYMap(),r.draw(),r.addToCanvas(n),r.bindMoveToolEvents(),!o&&uT.getViewId())r.hide();else if(e.getMap("users").get(e.clientID)!==t.getJabberId()&&null!=t.getJabberId()){const n=e.getMap("userList");var a=Z_.getColor(n.get(t.getJabberId()).globalId);r.refreshTraceAwareness(a)}n.remountCurrentTool()}})(new E_(o.id,o.type,o.left,o.top,o.width,o.height,o.zIndex,o.containment,o.json,o.viewId,o.oType,a||o.jabberId,o.defaultLabel,o.defaultAttributeValues));break;case __.TYPE:(function(t){if(t instanceof __)if(uT.findNode(t.getSource()),uT.findNode(t.getTarget()),t.getViewId()===uT.getViewId()||uT.getLayer()===f_.LAYER.META)b(t);else if(uT.getLayer()===f_.LAYER.MODEL){var e,i,r;e=t.getViewId()?t.getOriginType():t.getType(),uT.getViewId()&&(r=uT.getEdgeType(e).VIEWTYPE)&&(e=r),(i=t.getJSON()?uT.createEdgeFromJSON(e,t.getEntityId(),t.getSource(),t.getTarget(),t.getJSON()):uT.createEdge(e,t.getEntityId(),uT.findNode(t.getSource()),uT.findNode(t.getTarget()))).registerYMap(),i.connect(),i.addToCanvas(n),!r&&uT.getViewId()&&i.hide(),n.remountCurrentTool()}})(new __(o.id,o.type,o.source,o.target,o.json,o.viewId,o.oType,a||o.jabberId));break;case G_.TYPE:(function(t){t instanceof G_&&l.sendLocalNonOTOperation(f_.WIDGET.NAME.GUIDANCE,t.toNonOTOperation())})(new G_(o.id));break;case z_.TYPE:(function(t){t instanceof z_&&l.sendLocalNonOTOperation(f_.WIDGET.NAME.GUIDANCE,t.toNonOTOperation())})(new z_(o.data));break;case"ViewApplyActivity":var s=new N_("ViewApplyActivity",t.value.viewId,t.value.jabberId);e.getMap("activity").set(N_.TYPE,s.toJSON());break;case"triggerSave":o.value===l.getUser()[f_.NS.PERSON.JABBERID]&&uT.storeDataYjs();break;case"applyLayout":IT.apply(),v.repaintEverything();break;case"highlight":var u=l.getUser()[f_.NS.PERSON.JABBERID];if(!t.value.remote&&u!==t.value.userId)return;if(t.value.moveCanvasToEntity){var c=t.value.moveCanvasToEntity,d=uT.find(c);n.scrollEntityIntoView(c),n.select(d)}for(var f=0;f<t.value.entities.length;f++){c=t.value.entities[f];(d=uT.find(c))&&d.highlight(t.value.color,t.value.label)}break;case"unhighlight":u=l.getUser()[f_.NS.PERSON.JABBERID];if(!t.value.remote&&u!==t.value.userId)return;for(f=0;f<t.value.entities.length;f++){c=t.value.entities[f];(d=uT.find(c))&&d.unhighlight()}break;case m_.TYPE:{u=l.getUser()[f_.NS.PERSON.JABBERID];const n=e.getMap("nodes");t.value.jabberId===u&&n.delete(t.value.entityId),setTimeout((function(){uT.storeDataYjs()}),300);break}case w_.TYPE:}}else"applyLayout"===r&&(IT.apply(),uT.storeDataYjs())}))}));e.getMap("select").observe((function(t){Array.from(t.changes.keys.entries()).forEach((([n,i])=>{if(n!==e.getMap("users").get(e.clientID)){var r=e.getMap("userList").get(n);if(null!=t.oldValue){var o=uT.find(t.oldValue);o&&o.unhighlight()}if(null!=t.value){var a=uT.find(t.value);a&&a.highlight(Z_.getColor(r.globalId),r[f_.NS.PERSON.TITLE])}}}))}));e.getMap("nodes").observe((function(t){if(RO(t))return;Array.from(t.changes.keys.entries()).forEach((([t,e])=>{if("delete"===e.action){var n=uT.findNode(t);n&&n.remoteNodeDeleteCallback(new m_(t))}}))}));e.getMap("edges").observe((function(t){Array.from(t.changes.keys.entries()).forEach((([t,e])=>{if("delete"===e.action){var n=uT.findEdge(t);n&&n.remoteEdgeDeleteCallback(new w_(t))}}))}))}l&&n.registerCallbacks()}width;height}let GT=class extends TT{constructor(){super(hT.TYPE,null,null,null,hT.DEFAULT_WIDTH,hT.DEFAULT_HEIGHT)}},qT=class extends TT{constructor(){super(sT.TYPE,null,null,null,sT.DEFAULT_WIDTH,sT.DEFAULT_HEIGHT)}},UT=class extends AT{constructor(){super(ET.TYPE,ET.RELATIONS)}};let zT=class extends aT{static TYPE="ViewRelationship";static DEFAULT_WIDTH=150;static DEFAULT_HEIGHT=100;constructor(t,e,n,i,r,o,a){super(t,"ViewRelationship",e,n,i,r,o,a);var s,l,u,c,d=this,f=$(su.template('<div class="class_node">\n    <div class="type"><%= type %></div>\n    <div class="label">&lt;&lt;ViewRelationship&gt;&gt;</div>\n    <div class="attributes"></div>\n</div>')({type:d.getType()})),p=aT.prototype.get$node.call(this).append(f).addClass("viewrelationship"),h=p.find(".attributes");if(this.getAttributes(),this.toJSON=function(){return aT.prototype.toJSON.call(this)},this.registerYMap=function(){aT.prototype.registerYMap.call(this),d.getLabel().getValue().registerYType(),attributeList.registerYMap(),c&&c.registerYMap(),attribute.getValue().registerYType(),u.getValue().registerYType()},this.showAttributes=function(){l.get$node().is(":hidden")&&l.get$node().show(),u.get$node().is(":hidden")&&u.get$node().show(),c.get$node().is(":hidden")&&c.get$node().show(),s.get$node().is(":hidden")||s.get$node().hide()},this.createConditionListAttribute=function(t){var e={};if(t&&"RenamingListAttribute"===t.constructor.name){var n=t.getAttributes();for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i].getKey().getValue())}else for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i].val.value);var r=new LO("[condition]","Conditions",d,e,VO);return d.addAttribute(r),h.append(r.get$node()),r.get$node().hide(),r},this.registerYMap=function(){aT.prototype.registerYMap.call(this),d.getLabel().getValue().registerYType(),l.registerYMap(),c&&c.registerYMap(),s.getValue().registerYType(),u.getValue().registerYType()},p.find(".label").append(this.getLabel().get$node()),window.hasOwnProperty("y")){var g=y.getMap("data").get("model");if(g){var v=mO.GetAllNodesOfBaseModelAsSelectionList2(g.nodes,["Relationship"]);s=new PO(t+"[target]","Reference",d,v),d.addAttribute(s),h.prepend(s.get$node()),c=a?d.createConditionListAttribute(a.attributes["[attributes]"].list):d.createConditionListAttribute()}}l=new $O("[attributes]","Attributes",d,{hidden:"Show",top:"Show Top",center:"Show Center",bottom:"Show Bottom",hide:"Hide"}),d.addAttribute(l),h.append(l.get$node()),l.get$node().hide(),u=new PO(t+"[conjunction]","Conjunction",d,YO),d.addAttribute(u),h.append(u.get$node()),u.get$node().hide(),a&&u&&c&&l&&s&&d.showAttributes(),this.setContextMenuItemCallback((function(){var t=$("#lblCurrentView").text();return{addShape:{name:"Add Edge Shape",callback:function(){var e=d.getCanvas(),n=d.getAppearance();e.createNode(hT.TYPE,n.left+n.width+50,n.top,150,100),e.createEdge(_T.TYPE,d.getEntityId(),undefined,null,null,t)},disabled:function(){var t,e,n=d.getEdges();for(e in n)if(n.hasOwnProperty(e)&&((t=n[e])instanceof _T&&(t.getTarget()===d&&t.getSource()instanceof hT||t.getSource()===d&&t.getTarget()instanceof hT)||t instanceof wT&&t.getTarget()instanceof hT))return!0;return!1}},sep:"---------"}}))}};function JT(t,e){for(var n in uT.init(),t.nodes)if(t.nodes.hasOwnProperty(n)){var i=t.nodes[n];const r=i.width||i.containment.width,o=i.height||i.containment.height,a=i.left||i.containment.left,s=i.top||i.containment.top,l=i.zIndex||i.containment.zIndex;uT.createNodeFromJSON(i.type,n,a,s,r,o,l,i.containment,i,e)}for(var r in t.edges)if(t.edges.hasOwnProperty(r)){var o=t.edges[r];uT.createEdgeFromJSON(o.type,r,o.source,o.target,o)}function a(t,e){var n,i,r,o,s,l=[];if(e||(e=[]),-1!==e.indexOf(t))return[];for(n in e.push(t),s=t.getLabel().getValue().getValue(),(t instanceof dT||t instanceof bT)&&-1===l.indexOf(s)&&l.push(s),r=t.getIngoingEdges())r.hasOwnProperty(n)&&(o=(i=r[n]).getSource(),(i instanceof ET&&o instanceof dT||i instanceof ET&&o instanceof fT||i instanceof ET&&o instanceof bT)&&(l=l.concat(a(o,e))));return l}function s(t,e){var n,i,r,o,a,l,u,c,d,f,p={},h={};if(e||(e=[]),-1!==e.indexOf(t))return{};for(o in e.push(t),l=t.getOutgoingEdges())if(l.hasOwnProperty(o))if(u=(a=l[o]).getSource(),c=a.getTarget(),a instanceof ET&&c instanceof fT||a instanceof ET&&t instanceof dT&&c instanceof dT||a instanceof ET&&t instanceof pT&&c instanceof pT||a instanceof ET&&t instanceof sT&&c instanceof sT)Z_.merge(p,s(c,e));else if(a instanceof _T&&(c===t&&(d=u)instanceof sT||u===t&&(d=c)instanceof sT)||a instanceof wT&&(d=c)instanceof sT){for(i in f={},n={},Z_.merge(n,s(d,[])),n)n.hasOwnProperty(i)&&(f[(r=n[i]).value]=r.value);(h={})[d.getEntityId()]={key:a.getLabel().getValue().getValue(),value:d.getLabel().getValue().getValue(),options:f},Z_.merge(p,h)}for(i in n=t.getAttribute("[attributes]").getAttributes())n.hasOwnProperty(i)&&(r=n[i],t instanceof pT?((h={})[i]={key:r.getKey().getValue(),value:r.getValue().getValue(),position:r.getValue2().getValue()},Z_.merge(p,h)):t instanceof zT?((h={})[i]={key:r.getKey().getValue(),ref:r.getRef().getValue(),position:r.getVis().getValue()},Z_.merge(p,h)):t instanceof sT?((h={})[i]={value:r.getValue().getValue()},Z_.merge(p,h)):t instanceof bT?((h={})[i]={key:r.getKey().getValue(),ref:r.getRef().getValue(),visibility:r.getVis().getValue()},Z_.merge(p,h)):((h={})[i]={key:r.getKey().getValue(),value:r.getValue().getValue()},Z_.merge(p,h)));return p}function l(e){var n,i,r,o={},a=e.getEntityId();if(t.nodes.hasOwnProperty(a)){if(t.nodes[a].attributes.hasOwnProperty(a+"[target]")){var s=t.nodes[a].attributes[a+"[target]"];n=s.value.value,i=s.hasOwnProperty("option")?s.option:null}if(t.nodes[a].attributes.hasOwnProperty("[condition]")){var l=t.nodes[a].attributes["[condition]"].list;for(var u in l)l.hasOwnProperty(u)&&(o[u]={property:l[u].property.value,operator:l[u].operator.value,value:l[u].val.value})}t.nodes[a].attributes.hasOwnProperty(a+"[conjunction]")&&(r=t.nodes[a].attributes[a+"[conjunction]"].value.value)}return{target:n,targetName:i,conditions:o,conjunction:r}}var u,c,d,f,p,h,g,v,y,b,m,E,w,_,O,T,x,A,S,I,k,P,N,C,j={attributes:{},nodes:{},edges:{}},M=uT.getNodes();for(u in M)if(M.hasOwnProperty(u))if((c=M[u])instanceof dT||c instanceof bT)if("Model Attributes"===c.getLabel().getValue().getValue())d=s(c),j.attributes=d;else{for(p in d=s(c),w=null,h=c.getEdges())h.hasOwnProperty(p)&&(g=(f=h[p]).getSource(),v=f.getTarget(),(f instanceof _T&&(v===c&&(y=g)instanceof lT||g===c&&(y=v)instanceof lT)||f instanceof wT&&(y=v)instanceof lT)&&(w={shape:y.getAttribute(y.getEntityId()+"[shape]").getValue().getValue(),color:y.getAttribute(y.getEntityId()+"[color]").getValue().getValue(),defaultWidth:parseInt(y.getAttribute(y.getEntityId()+"[defaultWidth]").getValue().getValue()),defaultHeight:parseInt(y.getAttribute(y.getEntityId()+"[defaultHeight]").getValue().getValue()),containment:y.getAttribute(y.getEntityId()+"[containment]").getValue().getValue(),customShape:y.getAttribute(y.getEntityId()+"[customShape]").getValue().getValue(),customAnchors:y.getAttribute(y.getEntityId()+"[customAnchors]").getValue().getValue()}));j.nodes[u]={label:c.getLabel().getValue().getValue(),attributes:d,shape:w||{shape:"rectangle",color:"white",containment:!1,customShape:"",customAnchors:"",defaultWidth:0,defaultHeight:0}},c instanceof bT&&(C=l(c),Z_.merge(j.nodes[u],C))}else if(c instanceof pT||c instanceof zT){for(p in d=s(c),_=[],O=[],I=[],w=null,h=c.getEdges())if(h.hasOwnProperty(p))if(g=(f=h[p]).getSource(),v=f.getTarget(),f instanceof _T&&(v===c&&(y=g)instanceof dT||v===c&&(y=g)instanceof bT||g===c&&(y=v)instanceof dT||g===c&&(y=v)instanceof bT))T=a(y),_=_.concat(T),O=O.concat(T);else if(f instanceof wT&&g===c&&(v instanceof dT||v instanceof bT))O=O.concat(a(v));else if(f instanceof wT&&v===c&&(g instanceof dT||g instanceof bT))_=_.concat(a(g));else if(f instanceof _T&&(v===c&&(y=g)instanceof fT||g===c&&(y=v)instanceof fT))T=a(y),_=_.concat(T),O=O.concat(T);else if(f instanceof wT&&g===c&&v instanceof fT)O=O.concat(a(v));else if(f instanceof wT&&v===c&&g instanceof fT)_=_.concat(a(g));else if(f instanceof _T&&(v===c&&(y=g)instanceof hT||g===c&&(y=v)instanceof hT)||f instanceof wT&&g===c&&(y=v)instanceof hT)w={arrow:y.getAttribute(y.getEntityId()+"[arrow]").getValue().getValue(),shape:y.getAttribute(y.getEntityId()+"[shape]").getValue().getValue(),color:y.getAttribute(y.getEntityId()+"[color]").getValue().getValue(),overlay:y.getAttribute(y.getEntityId()+"[overlay]").getValue().getValue(),overlayPosition:y.getAttribute(y.getEntityId()+"[overlayPosition]").getValue().getValue(),overlayRotate:y.getAttribute(y.getEntityId()+"[overlayRotate]").getValue().getValue()};else if(f instanceof ET&&v===c&&(y=g)instanceof vT){for(P in x=[],A=[],N=y.getEdges())N.hasOwnProperty(P)&&(b=(k=N[P]).getSource(),m=k.getTarget(),k instanceof _T&&(m===y&&(E=b)instanceof dT||b===y&&(E=m)instanceof dT||m===y&&(E=b)instanceof bT||b===y&&(E=m)instanceof bT)?(S=a(E),x=x.concat(S),A=A.concat(S)):k instanceof wT&&b===y&&(m instanceof dT||m instanceof bT)?A=A.concat(a(m)):k instanceof wT&&m===y&&(b instanceof dT||b instanceof bT)?x=x.concat(a(b)):k instanceof _T&&(m===y&&(E=b)instanceof fT||b===y&&(E=m)instanceof fT)?(S=a(E),x=x.concat(S),A=A.concat(S)):k instanceof wT&&b===y&&m instanceof fT?A=A.concat(a(m)):k instanceof wT&&m===y&&b instanceof fT&&(x=x.concat(a(b))));x.length>0&&A.length>0&&I.push({sourceTypes:x,targetTypes:A})}_.length>0&&O.length>0&&I.push({sourceTypes:_,targetTypes:O}),j.edges[u]={label:c.getLabel().getValue().getValue(),shape:w||{arrow:"bidirassociation",shape:"straight",color:"black",overlay:"",overlayPosition:"top",overlayRotate:!0},relations:I,attributes:d},c instanceof zT&&(C=l(c),Z_.merge(j.edges[u],C))}return j.id=t.id,uT.reset(),j}function WT(t,e){if(!e)return new Error("No canvas object defined!");$.Deferred();var n=su.keys(t.nodes).length,i=su.keys(t.edges).length,r=0,o=0,a={widget:"CANVAS",createdYText:0,modelAttributes:{attributes:{}},nodes:{},edges:{}};if(!su.isEmpty(t.attributes)){var s=uT.createModelAttributesNodeFromJSON(t.attributes);s.registerYMap(),e.setModelAttributesNode(s),s.addToCanvas(e)}function l(t,n){var i=y.getMap("nodes").get(t),r=null;if(void 0===(r=i?uT.createNodeFromJSON(n.type,t,i.get("left")?i.get("left"):n.left,i.get("top")?i.get("top"):n.top,i.get("width")?i.get("width"):n.width,i.get("height")?i.get("height"):n.height,i.get("zIndex")?i.get("zIndex"):n.zIndex,i.get("containment")?i.get("containment"):n.containment,n):uT.createNodeFromJSON(n.type,t,n.left,n.top,n.width,n.height,n.zIndex,n.containment,n))){console.error("SYNCMETA: Node undefined. Check if "+n.type+"  type is defined in the VLS");var o=$("#errorMsg");return $("#loading").hide(),$("#canvas-frame").hide(),o.parent().css("display","inline-table"),void o.text("SYNCMETA: Model is not compatible to the current Metamodel! Delete the current model or change the metamodel.")}r.registerYMap(),r.addToCanvas(e),r.bindMoveToolEvents(),r.draw()}return n>0&&(!function(t){for(var e in t)t.hasOwnProperty(e)&&(l(e,t[e]),r++)}(t.nodes),r===n&&(i>0?(!function(t){for(const r in t)if(t.hasOwnProperty(r)){var n=uT.createEdgeFromJSON(t[r].type,r,t[r].source,t[r].target,t[r]);if(void 0===n){console.error("SYNCMETA: Edge undefined. Check if "+t[r].type+"  type is defined in the VLS");var i=$("#errorMsg");i.parent().show(),$("#canvas-frame").hide(),$("#loading").hide(),i.parent().css("display","inline-table"),i.text("SYNCMETA: Model is not compatible to the current Metamodel! Delete the current model or change the metamodel.");continue}n.registerYMap(),n.addToCanvas(e),n.connect(),n.bindMoveToolEvents(),o++}}(t.edges),o===i&&(e.resetTool(),a.createdNodes=r,a.createdEdges=o)):(a.createdNodes=r,a.createdEdges=0))),a}let HT=class extends TT{constructor(){super(lT.TYPE,null,null,null,lT.DEFAULT_WIDTH,lT.DEFAULT_HEIGHT)}},XT=class extends TT{constructor(){super(dT.TYPE,null,null,null,dT.DEFAULT_WIDTH,dT.DEFAULT_HEIGHT)}},ZT=class extends TT{constructor(){super(vT.TYPE,null,null,null,vT.DEFAULT_WIDTH,vT.DEFAULT_HEIGHT)}},KT=class extends TT{constructor(){super(pT.TYPE,null,null,null,pT.DEFAULT_WIDTH,pT.DEFAULT_HEIGHT)}},QT=class extends AT{constructor(){super(wT.TYPE,wT.RELATIONS)}};function tx(){}function ex(t,e){nx(t,e)?(e.set$shape(t.get$shape()),e.setAnchorOptions(t.getAnchors()),e.setCurrentViewType(t.TYPE),e.show()):(e.setCurrentViewType(null),e.hide())}function nx(t,e){if("Edge"===t.name||"Node"===t.name)return!0;var n,i=t.getConditionConj(),r=t.getConditions();for(var o in r)if(r.hasOwnProperty(o)){n=r[o];var a=e.getAttribute(n.property);if(a){var s=ix(a.getValue().getValue(),n.operator,n.value);if("AND"===i&&!s)return!1;if("OR"===i&&s)return!0}}return"AND"===i||"OR"!==i&&void 0}function ix(t,e,n){var i=null;try{i="boolean"==typeof i?n:parseInt(n),isNaN(i)&&(i=n)}catch(t){i=n}switch(e){case"greater":return t>i;case"smaller":return t<i;case"equal":return t===i;case"greater_eq":return t>=i;case"smaller_eq":return t<=i;case"nequal":return t!=i}}function rx(t,e){for(var n in e)e.hasOwnProperty(n)&&ex(t,e[n])}function ox(t,e){nx(t,e)?(e.restyle(t.getArrowType(),t.getColor(),t.getShapeType(),null,t.getOverlay(),t.getOverlayPosition(),t.getOverlayRotate(),t.getAttributes()),e.setCurrentViewType(t.TYPE)):e.hide()}function ax(t,e){for(var n in e)e.hasOwnProperty(n)&&ox(t,e[n])}tx.generate=function(t,e){var n={},i=e.nodes;for(var r in i)if(i.hasOwnProperty(r)){var o=i[r];if(o.hasOwnProperty("target")){n[o.target]=!0;var a=uT.getViewNodeType(o.label);rx(a,uT.getNodesByType(a.getTargetNodeType().TYPE))}}var s=t.nodes;for(var l in s)if(s.hasOwnProperty(l)&&!n.hasOwnProperty(l)){var u=uT.getNodesByType(s[l].label);for(var c in u)u.hasOwnProperty(c)&&u[c].hide()}var d=e.edges;for(var f in d)if(d.hasOwnProperty(f)){var p=d[f];if(p.hasOwnProperty("target")){n[p.target]=!0;var h=uT.getViewEdgeType(p.label);ax(h,uT.getEdgesByType(h.getTargetEdgeType().TYPE))}}var g=t.edges;for(var v in g)if(g.hasOwnProperty(v)&&!n.hasOwnProperty(v)){var y=uT.getEdgesByType(g[v].label);for(var b in y)y.hasOwnProperty(b)&&y[b].hide()}window.jsPlumbInstance.repaintEverything(),_.each(uT.getEdges(),(function(t){t.setZIndex()}))},tx.reset=function(t){var e,n=t.nodes;for(var i in n)n.hasOwnProperty(i)&&(e=n[i].label,rx(uT.getNodeType(e),uT.getNodesByType(e)));var r=t.edges;for(var o in r)r.hasOwnProperty(o)&&(e=r[o].label,ax(uT.getEdgeType(e),uT.getEdgesByType(e)));window.jsPlumbInstance.repaintEverything(),_.each(uT.getEdges(),(function(t){t.setZIndex()}))};const sx='<option id="<%= id %>"><%= id %></option>';var lx=new function(){var t=$("#ddmViewSelection"),e=su.template(sx);return{GetViewpointList:function(){y=window.y;const n=y.getMap("views");t.empty();for(var i=n.keys(),r=0;r<i.length;r++){n.get(i[r])?t.append($(e({id:i[r]}))):n.delete(i[r])}},existsView:function(t){return y.getMap("views").has(t)},getViewIdOfSelected:function(){return this.getSelected$node().attr("id")},getSelected$node:function(){return t.find("option:selected")},addView:function(t){const e=y.getMap("views");return!!e.has(t)&&(e.set(t,{viewId:t,attributes:{},nodes:{},edges:{}}),!0)},deleteView:function(e){y.getMap("views").delete(e),t.find("#"+e).remove()},updateViewContent:function(t){const e=y.getMap("views");var n=this.viewToJSON(t);e.set(t,n)},viewToJSON:function(t){var e=uT.graphToJSON();return e.id=t,e}}};let ux=class extends TT{constructor(){super(bT.TYPE,null,null,null,bT.DEFAULT_WIDTH,bT.DEFAULT_HEIGHT)}},cx=class extends TT{constructor(){super(zT.TYPE,null,null,null,zT.DEFAULT_WIDTH,zT.DEFAULT_HEIGHT)}};function dx(){var t={},e=$(".activityEntry.activitySel",parent.document).find(".activity-title").text();return t.INITIAL_NODE_LABEL="Initial node",t.MERGE_NODE_LABEL="Decision node",t.CALL_ACTIVITY_NODE_LABEL="Call activity node",t.ACTIVITY_FINAL_NODE_LABEL="Activity final node",t.CONCURRENCY_NODE_LABEL="Fork node",t.isGuidanceEditor=function(){return"Guidance modeling"==e},t.getCreateObjectNodeLabelForType=function(t){return"Create "+t+" object"},t.isCreateObjectNodeLabel=function(t){var e=/Create (.*?) object/.exec(t);return e?e[1]:""},t.getCreateRelationshipNodeLabelForType=function(t){return"Create "+t+" relationship"},t.isCreateRelationshipNodeLabel=function(t){var e=/Create (.*?) relationship/.exec(t);return e?e[1]:""},t.getSetPropertyNodeLabelForType=function(t){return"Set property for "+t},t.isSetPropertyNodeLabel=function(t){var e=/Set property for (.*)/.exec(t);return e?e[1]:""},t.getEntityNodeLabelForType=function(t){return t+" entity"},t.isEntityNodeLabel=function(t){var e=/(.*?) entity/.exec(t);return e?e[1]:""},t.getObjectContextLabelForType=function(t){return t+" Object Context"},t.getObjectTypeForObjectContextType=function(t){var e=t.lastIndexOf(" Object Context");return t.substring(0,e)},t.isObjectContextType=function(t){return-1!==t.indexOf(" Object Context",t.length-" Object Context".length)},t.getRelationshipContextLabelForType=function(t){return t+" Relationship Context"},t.getRelationshipTypeForRelationshipContextType=function(t){var e=t.lastIndexOf(" Relationship Context");return t.substring(0,e)},t.isRelationshipContextType=function(t){return-1!==t.indexOf(" Relationship Context",t.length-" Relationship Context".length)},t.getObjectToolLabelForType=function(t){return t+" Tool"},t.getObjectTypeForObjectToolType=function(t){var e=t.lastIndexOf(" Tool");return t.substring(0,e)},t.isObjectToolType=function(t){return-1!==t.indexOf(" Tool",t.length-" Tool".length)},t}async function fx(t,e="localhost:1234",n="ws"){let i;if(t||(i=window.caeRoom?window.caeRoom:localStorage.getItem("syncmetaSpace")?localStorage.getItem("syncmetaSpace"):Z_.getSpaceTitle(location.href)),window.y&&i===t)return new Promise((t=>t(window.y)));const r=new o,s=new a(`${n}://${e}`,i,r);return await new Promise(((t,e)=>{s.on("status",(e=>{"connected"==e.status&&(window.y||(window.y=r),t(i))})),setTimeout((()=>{e("YJS connection timed out. This means syncmeta widgets wont work")}),5e3)})),window.y?window.y:r}function px(){var t=function(){var e=window._iwc_instance_,n=[];if(e&&null!=e.onIntent){var i=e.onIntent;e.onIntent=function(t){if("RELOAD"===t.action)console.log(" K!!!!!!!!!!!!!!!!!!!!!!!!!!!! RELOAD!!!!!!!!!!!!!!!!!!!!!"),window.location.reload();else for(var e=0;e<n.length;e++)n[e].apply(this,arguments);i.apply(this,arguments)},window._addIwcIntentListener=function(t){n.push(t)},window._reloadThisFuckingInstance=function(){console.log("Reloading Everything");e.publish({action:"RELOAD",component:"",data:"",dataType:"",flags:["PUBLISH_GLOBAL"],extras:{reload:!0}})}}else setTimeout(t,5e3)};setTimeout(t,1e4)}const hx=(n,i)=>{if(!i)throw new Error("widgetName cannot be empty");class r extends n{constructor(){super(...arguments),this.widgetName=i}createRenderRoot(){return this}render(){return e` <error-alert></error-alert> `}firstUpdated(){this.hideErrorAlert()}connectedCallback(){super.connectedCallback(),px(),window.hasOwnProperty("y")||fx().then((t=>{window.hasOwnProperty("y")||(window.y=t)}))}disconnectedCallback(){super.disconnectedCallback()}hideErrorAlert(){$(this.widgetName).find("#alert-message").text(""),$(this.widgetName).find("error-alert").hide()}showErrorAlert(t){$(this.widgetName).find("#alert-message").text(t),$(this.widgetName).find("error-alert").hide()}}return r.styles=t`
      .loading {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        /*noinspection CssUnknownTarget*/
        background: white url("/img/loading.gif") no-repeat center center;
        z-index: 32032;
        opacity: 0.75;
      }

      #oauthPersonalize,
      #oauthPersonalizeDone,
      #oauthPersonalizeComplete {
        position: relative;
        z-index: 32033;
      }

      #q {
        position: absolute;
        width: 100%;
        height: 3px;
        bottom: 0;
        left: 0;
        cursor: s-resize;
      }
    `,r};let gx=class extends(hx(n,p_(f_.WIDGET.NAME.MAIN))){render(){return e`
      <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.9.2/jquery.contextMenu.min.css"
      />

      <style>
        ${p_(f_.WIDGET.NAME.MAIN)} {
          height: 100%;
        }
        .ui-resizable {
          /*jquery-ui adds this class to resizable objects. 
          However, the jsplumb library requires the position to be absolute, otherwise 
          offsets will be wrong. So we need to override this here.
          see https://github.com/rwth-acis/syncmeta/issues/86
          */
          position: absolute !important;
        }
        .button_bar {
          width: 50%;
          float: left;
          display: flex;
          flex-wrap: wrap;
        }
        .main-container {
          position: relative;
        }
        .button_bar.left {
          text-align: left;
        }
        .button_bar.right {
          text-align: right;
        }
        .node {
          z-index: 1;
          position: absolute;
          overflow: visible;
          border: 2px solid transparent;
        }
        .trace_awareness {
          z-index: 0;
          position: absolute;
          overflow: visible;
          opacity: 0;
          pointer-events: none;
        }
        div.class_node {
          height: inherit;
          width: inherit;
          border: 1px solid #aaa;
          border-radius: 1px;
          box-shadow: 2px 2px 2px #cccccc;
          color: #666 !important;
          font-size: 12px;
        }
        div.default_node {
          height: inherit;
          width: inherit;
        }
        div.custom_node {
          height: 100%;
          width: 100%;
          position: relative;
        }
        div.custom_node .fill_parent {
          position: absolute;
          top: 0;
          left: 0;
          bottom: 0;
          right: 0;
          width: inherit;
          height: inherit;
        }
        /*adjust label of custom nodes*/
        div.custom_node .fill_parent > div {
          left: 50%;
          top: -8px !important;
          -webkit-transform: translateY(-50%) translateX(-50%);
          -moz-transform: translateY(-50%) translateX(-50%);
          transform: translateY(-50%) translateX(-50%);
          pointer-events: none;
          overflow-x: auto;
        }

        div.simple_node {
          height: inherit;
          width: inherit;
          display: table;
        }

        .center .single_value_attribute .name {
          display: none;
        }
        .center .single_value_attribute .value .val {
          text-align: center;
        }

        div.simple_node div.label {
          display: table-cell;
          text-align: center;
          vertical-align: middle;
        }
        .box-overlay {
          position: absolute;
          background-color: #bbbbbb;
          opacity: 0;
          border-radius: 10px;
          cursor: move;
        }
        .selected {
          border: 3px solid #2bff6e;
        }
        #canvas-frame {
          overflow: hidden;
          width: 100%;
          height: 100%;
          position: relative;
        }
        #canvas {
          width: 100%;
          height: 100%;
          max-width: none !important;
          max-height: none !important;
          border-radius: 6px;
          position: relative !important; /*important because jsplumb will position according to this*/
          background-image: url("../images/grid.png");
          opacity: 1 !important;
        }
        #canvas.tool-move {
          cursor: move !important;
        }
        #canvas.tool-move ._jsPlumb_connector {
          cursor: pointer !important;
        }
        #canvas.tool-node {
          cursor: pointer !important;
        }
        #canvas.tool-edge {
          cursor: default !important;
        }
        #canvas.tool-edge.dragging {
          cursor: move !important;
        }
        #canvas.tool-edge .node,
        #canvas.tool-node .node {
          opacity: 1;
        }
        #canvas.tool-edge .node {
          cursor: pointer !important;
        }
        #canvas.tool-edge.dragging .node {
          cursor: move !important;
        }

        #feedback {
          margin: 10px;
          color: #777777;
        }

        button[disabled="disabled"],
        button:disabled {
          opacity: 0.5;
        }

        ._jsPlumb_overlay {
          font-size: 12px;
        }

        .class_node,
        .edge_shape_node,
        .node_shape_node,
        .enum_node,
        .abstract_class_node,
        .object_node,
        .relation_node {
          overflow: hidden;
        }

        .class_node .label,
        .edge_shape_node .label,
        .node_shape_node .label,
        .enum_node .label,
        .abstract_class_node .label,
        .object_node .label,
        .relation_node .label {
          border-bottom: 1px solid #999999;
        }

        .edge_label .single_value_attribute .name,
        .label .single_value_attribute .name,
        .title .single_value_attribute .name,
        .name .single_value_attribute .name {
          display: none;
        }

        .class_node .label,
        .edge_shape_node .label,
        .node_shape_node .label,
        .enum_node .label,
        .abstract_class_node .label,
        .object_node .label,
        .relation_node .label {
          text-align: center;
          font-weight: bold;
          display: block;
        }

        .value input {
          border: 0;
          background: none;
          outline: none;
        }

        .edge_label {
          width: 200px;
          cursor: pointer;
        }

        .edge_label.fixed {
          background-color: #f5f5f5;
          width: auto;
          font-size: 14px;
        }

        .edge_label .single_value_attribute .value input,
        .label .single_value_attribute .value input,
        .title .single_value_attribute .value input,
        .name .single_value_attribute .value input {
          border: 0;
          background: none;
          width: 100%;
          text-align: center;
          font-weight: bold;
          outline: none;
          margin: 2px auto;
          display: block;
        }

        .edge_label .single_value_attribute .value div.val {
          text-align: center;
        }

        .attributes .list_attribute .name {
          display: none;
        }

        .attributes .list_attribute ul.list {
          padding: 2px;
          margin: 0;
          list-style: none;
        }

        .attributes .list_attribute ul.list li.key_value_attribute,
        .attributes .list_attribute ul.list li.condition_predicate,
        .attributes .list_attribute ul.list li.renaming_attr {
          overflow: hidden;
        }

        .attributes .list_attribute ul.list li.key_value_attribute div.key {
          float: left;
          width: 50%;
        }

        .attributes .list_attribute ul.list li.key_value_attribute div.value {
          float: left;
          width: 50%;
        }
        .attributes .list_attribute ul.list li.condition_predicate div.property,
        .attributes .list_attribute ul.list li.condition_predicate div.operator,
        .attributes .list_attribute ul.list li.condition_predicate div.val,
        .attributes
          .list_attribute
          ul.list
          li.condition_predicate
          div.operator2 {
          float: left;
          margin-left: 3px;
        }

        .attributes .list_attribute ul.list li.renaming_attr div.val,
        .attributes .list_attribute ul.list li.renaming_attr div.ref {
          float: left;
          margin-left: 3px;
          width: 50%;
        }

        .attributes .list_attribute ul.list li.renaming_attr div.vis {
          float: right;
          margin-left: 3px;
        }

        .attributes
          .list_attribute
          ul.list
          li.key_value_attribute
          div.key
          input,
        .attributes
          .list_attribute
          ul.list
          li.key_value_attribute
          div.value
          input,
        .attributes
          .list_attribute
          ul.list
          li.condition_predicate
          div.val
          input,
        .attributes .list_attribute ul.list li.renaming_attr div.val input,
        .attributes .list_attribute ul.list li.renaming_attr div.ref input {
          width: 100%;
          border: 0;
          outline: none;
          background: none;
        }

        .attributes .single_value_attribute {
          overflow: hidden;
          margin-left: 1px;
        }

        .attributes .single_value_attribute .name {
          width: 50%;
          float: left;
          margin: 3px 0;
        }

        .attributes .single_value_attribute .value {
          width: 50%;
          float: left;
        }

        .attributes .single_value_attribute .value input {
          border: 0;
          color: #666 !important;
          margin: 0;
          background: none;
        }

        .attributes .value div.val {
          text-align: right;
          margin: 3px;
        }

        .attributes .value input.val {
          text-align: right;
          float: right;
        }

        .size-preview {
          z-index: 99;
          background-color: #ffffff;
          color: #666666;
          position: absolute;
          top: 0;
          left: 0;
          border: 1px dashed black;
        }

        #canvas.tool-edge .node.lowlighted,
        #canvas.tool-edge .node.target {
          opacity: 0.5;
        }

        #canvas.tool-edge .node.source {
          opacity: 1;
        }

        #canvas.tool-edge.dragging .node.source {
          opacity: 0.5;
        }

        #canvas.tool-edge.dragging .node.source.current,
        #canvas.tool-edge.dragging .node.target {
          opacity: 1;
        }

        #canvas.tool-edge ._jsPlumb_connector {
          opacity: 0.5;
        }

        #canvas.tool-edge ._jsPlumb_connector._jsPlumb_dragging {
          opacity: 1;
        }

        /*noinspection CssUnknownProperty*/
        .type {
          position: absolute;
          bottom: 105%;
          left: 50%;
          transform: translateX(-50%);
          -o-transform: translateX(-50%);
          -ms-transform: translateX(-50%);
          -moz-transform: translateX(-50%);
          -webkit-transform: translateX(-50%);
          text-align: center;
          overflow: visible;
          white-space: nowrap;
          color: #aaaaaa;
          font-size: 0.9em;
        }

        #canvas.hide_type .type {
          display: none;
        }

        #viewsHide {
          display: none;
        }

        #lblCurrentView {
          display: none;
        }
        .user_highlight {
          position: absolute;
          top: 100%;
          left: 0;
          font-size: 12px;
          font-weight: bold;
          white-space: nowrap;
          text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
        }

        .jtk-endpoint {
          z-index: 300000;
        }

        .ghost-edge {
          opacity: 0.3;
          z-index: 30000;
        }

        .ghost-edge-overlay {
          z-index: 31000;
        }
        /* VML colors */
        .object {
          background-color: rgb(213, 235, 253);
        }
        .nodeshape {
          background-color: rgba(213, 235, 253, 0.5);
        }
        .enum {
          background-color: #f9ffc6;
        }
        .relationship {
          background-color: #ffcece;
        }
        .edgeshape {
          background-color: rgba(255, 206, 206, 0.5);
        }
        .relation {
          background-color: #d5f5d5;
        }
        .abstractclass {
          background-color: #ffffff;
        }
        .main-container {
          position: relative;
        }
      </style>
      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.1/font/bootstrap-icons.css"
      />
      <link
        rel="stylesheet"
        type="text/css"
        href="https://code.jquery.com/ui/1.13.1/themes/smoothness/jquery-ui.css"
      />
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
        crossorigin="anonymous"
      />

      <div class="main-container p-2 d-flex flex-column h-100">
        <error-alert></error-alert>
        <div id="loading" class="loading"></div>
        <div class="row mb-2" id="main-widget-utilities-container">
          <div class="col-9">
            <button
              id="viewsHide"
              class="btn btn-light"
              title="Close the View Panel"
            >
              <i class="bi bi-caret-up"></i>
            </button>
            <button
              id="viewsShow"
              class="btn btn-light"
              title="Show the View Panel"
            >
              <i class="bi bi-caret-down"></i>
            </button>
            <button
              id="save"
              class="btn btn-light"
              title="Save the current state of the model"
            >
              <i class="bi bi-save"></i>
            </button>
            <!-- Uncommented the below line for Export as PNG! -->
            <button id="save_image" class="btn btn-light">
              <i class="bi bi-camera"></i>
            </button>
            <!--<button id="generate" style="display: none"><img width="20px" height="20px" src="<%= grunt.config('baseUrl') %>/img/generate.png" /></button>-->
            <button
              id="showtype"
              class="btn btn-light"
              title="Show the types of nodes and edges"
            >
              <i class="bi bi-tag"></i>
            </button>
            <button
              id="hideType"
              class="btn btn-light"
              title="Hide types of nodes and edges"
            >
              <i class="bi bi-tag-fill"></i>
            </button>
            <button id="applyLayout" class="btn btn-light" title="Apply Layout">
              <i class="bi bi-layout-wtf"></i>
            </button>
            <button id="zoomIn" class="btn btn-light" title="Zoom in">
              <i class="bi bi-zoom-in"></i>
            </button>
            <button id="zoomOut" class="btn btn-light" title="Zoom out">
              <i class="bi bi-zoom-out"></i>
            </button>
            <button
              id="undo"
              class="btn btn-light"
              title="Undo your latest changes"
            >
              <i class="bi bi-arrow-counterclockwise"></i>
            </button>
            <button
              id="redo"
              class="btn btn-light"
              title="Redo your latest changes"
            >
              <i class="bi bi-arrow-clockwise"></i>
            </button>
            <span id="feedback"></span>
            <strong id="lblCurrentView"
              >View:<span id="lblCurrentViewId"></span
            ></strong>
          </div>
          <div class="col-3">
            <div class="input-group mb-3">
              <input
                type="text"
                class="form-control"
                placeholder="Search Node..."
                aria-label="Search Node..."
                aria-describedby="button-addon2"
                id="searchNodeInput"
              />
              <button
                class="btn btn-outline-secondary"
                type="button"
                id="searchNodeButton"
              >
                <i class="bi bi-search"></i>
              </button>
            </div>
          </div>
          <div id="ViewCtrlContainer" class="flex my-2" style="display:none">
            <button
              id="btnCreateViewpoint"
              class="btn btn-light"
              title="Create a viewpoint"
            >
              <i class="bi bi-plus-circle"></i>
            </button>
            <button
              class="btn btn-light"
              id="btnCancelCreateViewpoint"
              title="Cancel"
              style="display: none;"
            >
              <i class="bi bi-x-circle"></i>
            </button>
            <input
              id="txtNameViewpoint"
              type="text"
              placeholder="name"
              style="display: none;"
            />
            <select id="ddmViewpointSelection" style="display: none;"></select>
            <button
              class="btn btn-light"
              id="btnAddViewpoint"
              title="Create an empty viewpoint"
              style="display: none;"
            >
              <i class="bi bi-check"></i>
            </button>

            <select id="ddmViewSelection"></select>
            <button
              id="btnShowView"
              class="btn btn-light"
              title="Apply a viewpoint to the current model or visualize the viewpoint"
            >
              Show
            </button>
            <button
              class="btn btn-light"
              id="btnRefreshView"
              title="Refresh viewpoint list"
              style="display: none;"
            >
              Refresh
            </button>
            <button
              class="btn btn-light"
              id="btnDelViewPoint"
              title="Delete current viewpoint in the list"
            >
              <i class="bi bi-trash"></i>
            </button>
          </div>

          <div
            class="col"
            id="dialog"
            style="display:none"
            title="Generate editor"
          >
            <p>
              <strong>Editor space url:</strong>
              <br />
              <span id="space_link_input"
                ><%= grunt.config('roleSandboxUrl') %>/<input
                  size="16"
                  type="text"
                  id="space_label"
              /></span>
              <span id="space_link_text" style="display: none"
                ><a id="space_link" target="_blank" href="#"></a
              ></span>
              <br />
              <span
                id="space_link_comment"
                style="color: #FF3333; display: none"
                >Space already exists, will be overwritten!</span
              >
            </p>
            <p>
              <strong>Editor space title:</strong
              ><input size="32" type="text" id="space_title" />
            </p>
          </div>
        </div>
        <div
          class="ui-state-error ui-corner-all"
          style="margin-top: 20px; padding: 0 .7em; display:none"
        >
          <p id="errorMsg">
            <span
              class="ui-icon ui-icon-alert"
              style="float: left; margin-right: .3em;"
            ></span>
            <strong>SYNCMETA!</strong>
          </p>
        </div>
        <div
          class="row mx-auto border border-dark border-2 rounded"
          id="canvas-frame"
        >
          <div id="canvas"></div>
        </div>
        <div id="q"></div>
        <loading-spinner></loading-spinner>
      </div>
    `}connectedCallback(){super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback()}async firstUpdated(t){super.firstUpdated(t);const e=$(p_(f_.WIDGET.NAME.MAIN)).find(".alert");e.attr("style","display:none !important");const n=await async function(){const t=localStorage.getItem("userinfo_endpoint")||"https://auth.las2peer.org/auth/realms/main/protocol/openid-connect/userinfo",e=await fetch(t,{headers:{Authorization:"Bearer "+localStorage.access_token}}).catch((t=>{console.warn("Error while fetching profile information : "+t)}));try{if(e&&e.ok){const t=await e.json(),n={user:{}};return n.user[f_.NS.PERSON.TITLE]=t.preferred_username,n.user[f_.NS.PERSON.JABBERID]=t.sub,n.user[f_.NS.PERSON.MBOX]=t.email,n.user.globalId=-1,n.user.self=!0,n}}catch(t){console.error(t)}return{user:Z_.generateAnonymousUser()}}();n||console.error("user is undefined"),fx().then((t=>{console.info("CANVAS: Yjs Initialized successfully in room "+window.spaceTitle+" with y-user-id: "+t.clientID);const e=iO.getInstance(f_.WIDGET.NAME.MAIN,t);e.setSpace(n);const i=t.getMap("users"),r=t.getMap("data");setTimeout((()=>{try{const n=e.getUser();if(!n)throw new Error("User not set");-1!==n.globalId&&i.set(t.clientID.toString(),e.getUser()[f_.NS.PERSON.JABBERID])}catch(t){console.error(t)}if(!i.get(e.getUser()[f_.NS.PERSON.JABBERID])){var o=e.getUser();o.globalId=Z_.getGlobalId(n,t),i.set(e.getUser()[f_.NS.PERSON.JABBERID],o)}let a,s;const l=dx();l.isGuidanceEditor()?(s=r.get("guidancemodel"),a=r.get("guidancemetamodel")):(a=r.get("metamodel"),s=r.get("model")),s&&console.info("CANVAS: Found model in yjs room with "+Object.keys(s.nodes).length+" nodes and "+Object.keys(s.edges).length+" edges."),uT.init(a),uT.setGuidance(l),function(t,e,n,i,r){const o=$(p_(f_.WIDGET.NAME.MAIN)).find("loading-spinner"),a=[],s=$("#canvas"),l=new FT(s),u=r.getMap("join");if(zO.init(l),u.forEach((function(t,e){a.push(e)})),u.observe((function(t){t.keysChanged.forEach((function(e){const i=t.keysChanged[e];if(-1===a.indexOf(i)&&a.push(i),i!==n.getUser()[f_.NS.PERSON.JABBERID]){const t=r.getMap("join");t.has(n.getUser()[f_.NS.PERSON.JABBERID])||t.set(n.getUser()[f_.NS.PERSON.JABBERID],!0)}else l.resetTool()}));r.getMap("canvas").observe((function(t){t.keysChanged.forEach((e=>{var i;switch(e){case B_.TYPE:lx.GetViewpointList();break;case"ReloadWidgetOperation":{var o;switch(t.currentTarget.get(e)){case"import":var a=r.getMap("data").get("model");o="ATTENTION! Imported new model containing <strong>"+Object.keys(a.nodes).length+" nodes</strong> and <strong>"+Object.keys(a.edges).length+" edges</strong>. Some widgets will reload";break;case"delete":o="ATTENTION! Deleted current model. Some widgets will reload";break;case"meta_delete":o="ATTENTION! Deleted current metamodel. Some widgets will reload";break;case"meta_import":o="ATTENTION! Imported new metamodel. Some widgets will reload"}const l=r.getMap("data"),u=r.getMap("nodes");for(var e of u.keys()){var s=null===(i=l.get("model"))||void 0===i?void 0:i.nodes[e];s&&(u.get(e).set("left",s.left),u.get(e).set("top",s.top))}r.getMap("activity").set("ReloadWidgetOperation",new N_("ReloadWidgetOperation",void 0,n.getUser()[f_.NS.PERSON.JABBERID],o).toJSON()),location.reload()}}}))}))})),function(t,e,n,i){t.registerOnDataReceivedCallback((function(r){const o=e.getMap("canvas");if(r instanceof V_)t.sendLocalNonOTOperation(f_.WIDGET.NAME.ATTRIBUTE,(new V_).toNonOTOperation());else if(r instanceof B_)o.set(B_.TYPE,!0);else if(r instanceof J_){var a=JT(e.getMap("data").get("model"));fx(r.getModelingRoomName()).then((function(t){t.getMap("data").set("metamodel",a);t.getMap("metaModelStatus").set("uploaded",!0)})).fail((()=>{e.getMap("metaModelStatus").set("error",!0)}))}else if(r.hasOwnProperty("getType")&&"WaitForCanvasOperation"===r.getType())switch(r.getData().widget){case f_.WIDGET.NAME.ACTIVITY:t.sendLocalNonOTOperation(f_.WIDGET.NAME.ACTIVITY,new y_("WaitForCanvasOperation",JSON.stringify({local:i,list:n})));break;case f_.WIDGET.NAME.HEATMAP:t.sendLocalNonOTOperation(f_.WIDGET.NAME.HEATMAP,new y_("WaitForCanvasOperation",JSON.stringify(i)));break;case f_.WIDGET.NAME.ATTRIBUTE:t.sendLocalNonOTOperation(f_.WIDGET.NAME.ATTRIBUTE,new y_("WaitForCanvasOperation",JSON.stringify(i)));break;case f_.WIDGET.NAME.PALETTE:var s=e.getMap("data").get("metamodel");s=s?JSON.stringify(s):"{}",t.sendLocalNonOTOperation(f_.WIDGET.NAME.PALETTE,new y_("WaitForCanvasOperation",s))}}))}(n,r,a,i),t){if(t.hasOwnProperty("nodes")){let e,n=t.nodes;for(const t in n)n.hasOwnProperty(t)&&(e=n[t],l.addTool(e.label,new TT(e.label,null,null,e.shape.containment,e.shape.defaultWidth,e.shape.defaultHeight)))}if(t.hasOwnProperty("edges")){var c,d=t.edges;for(var f in d)d.hasOwnProperty(f)&&(c=d[f],l.addTool(c.label,new AT(c.label,c.relations)))}lx.GetViewpointList(),$("#btnCreateViewpoint").hide(),$("#btnDelViewPoint").hide();var p=function(t){if(t&&t.hasOwnProperty("nodes")){var e,n=t.nodes;for(var i in n)n.hasOwnProperty(i)&&(e=n[i],l.addTool(e.label,new TT(e.label,null,null,e.shape.containment,e.shape.defaultWidth,e.shape.defaultHeight)))}if(t&&t.hasOwnProperty("edges")){var r,o=t.edges;for(var a in o)o.hasOwnProperty(a)&&(r=o[a],l.addTool(r.label,new AT(r.label,r.relations)))}};$("#btnShowView").click((function(){var e=lx.getViewIdOfSelected(),i=$("#lblCurrentViewId");if(e===i.text())return;var o=r.getMap("views").get(e);uT.initViewTypes(o);var a=new R_(o,!0).toNonOTOperation();n.sendLocalNonOTOperation(f_.WIDGET.NAME.PALETTE,a),n.sendLocalNonOTOperation(f_.WIDGET.NAME.ATTRIBUTE,a),n.sendLocalNonOTOperation(f_.WIDGET.NAME.METADATA,a),n.sendLocalNonOTOperation(f_.WIDGET.NAME.OPENAPI,a);var s=new N_("ViewApplyActivity",o.id,n.getUser()[f_.NS.PERSON.JABBERID]);n.sendLocalNonOTOperation(f_.WIDGET.NAME.ACTIVITY,s.toNonOTOperation());r.getMap("canvas").set("ViewApplyActivity",{viewId:e,jabberId:n.getUser()[f_.NS.PERSON.JABBERID]}),p(o),tx.generate(t,o),$("#lblCurrentView").show(),i.text(e)})),$("#viewsHide").click((function(){$(this).hide(),$("#viewsShow").show(),$("#ViewCtrlContainer").hide();var e=$("#lblCurrentViewId");if(e.text().length>0){var i=new R_(t,!0);n.sendLocalNonOTOperation(f_.WIDGET.NAME.PALETTE,i.toNonOTOperation()),n.sendLocalNonOTOperation(f_.WIDGET.NAME.ATTRIBUTE,i.toNonOTOperation());var o=new N_("ViewApplyActivity","",n.getUser()[f_.NS.PERSON.JABBERID]);n.sendLocalNonOTOperation(f_.WIDGET.NAME.ACTIVITY,o.toNonOTOperation());r.getMap("canvas").set("ViewApplyActivity",{viewId:"",jabberId:n.getUser()[f_.NS.PERSON.JABBERID]}),uT.setViewId(null),uT.initModelTypes(t),p(t),tx.reset(t),$("#lblCurrentView").hide(),e.text("")}}));var h=$("#save_image");h.show(),h.click((function(){l.toPNG().then((function(t){var e=document.createElement("a");e.download="export.png",e.href=t,e.click()}))}))}else l.addTool(dT.TYPE,new XT),l.addTool(fT.TYPE,new xT),l.addTool(pT.TYPE,new KT),l.addTool(vT.TYPE,new ZT),l.addTool(sT.TYPE,new qT),l.addTool(lT.TYPE,new HT),l.addTool(hT.TYPE,new GT),l.addTool(ET.TYPE,new UT),l.addTool(_T.TYPE,new ST),l.addTool(wT.TYPE,new QT),l.addTool(bT.TYPE,new ux),l.addTool(zT.TYPE,new cx),$("#btnCreateViewpoint").click((function(){g()})),$("#btnCancelCreateViewpoint").click((function(){v()})),$("#btnShowView").click((function(){var t=lx.getViewIdOfSelected();t!==$("#lblCurrentViewId").text()&&($("#loading").show(),$("#lblCurrentView").show(),$("#lblCurrentViewId").text(t),b(t))})),$("#btnDelViewPoint").click((function(){const t=r.getMap("views");var e=lx.getViewIdOfSelected();e&&e!==$("#lblCurrentViewId").text()?(t.delete(e),n.sendLocalNonOTOperation(f_.WIDGET.NAME.ATTRIBUTE,new Y_(e).toNonOTOperation()),lx.deleteView(e)):(t.set(e,null),lx.deleteView(e),$("#viewsHide").click())})),$("#btnAddViewpoint").click((function(){var t=$("#txtNameViewpoint").val();if(lx.existsView(t))return void alert("View already exists");lx.addView(t),v();r.getMap("canvas").set(B_.TYPE,!0)})),$("#viewsHide").click((function(){$(this).hide(),$("#viewsShow").show(),$("#ViewCtrlContainer").hide("fast");var t=$("#lblCurrentViewId");const e=r.getMap("data");if(t.text().length>0){$("#loading").show();var i=e.get("model"),o=new D_(!1);n.sendLocalNonOTOperation(f_.WIDGET.NAME.PALETTE,o.toNonOTOperation());var a=new N_("ViewApplyActivity","",n.getUser()[f_.NS.PERSON.JABBERID]);n.sendLocalNonOTOperation(f_.WIDGET.NAME.ACTIVITY,a.toNonOTOperation());r.getMap("canvas").set("ViewApplyActivity",{viewId:"",jabberId:n.getUser()[f_.NS.PERSON.JABBERID]}),y(),WT(i,l),$("#loading").hide(),l.resetTool(),$("#lblCurrentView").hide(),t.text(""),uT.setViewId(null)}}));var g=function(){$("#btnCreateViewpoint").hide(),$("#ddmViewSelection").hide(),$("#btnShowView").hide(),$("#btnDelViewPoint").hide(),$("#txtNameViewpoint").show(),$("#btnAddViewpoint").show(),$("#btnCancelCreateViewpoint").show()},v=function(){$("#btnCreateViewpoint").show(),$("#ddmViewSelection").show(),$("#btnDelViewPoint").show(),$("#btnShowView").show(),$("#txtNameViewpoint").hide(),$("#btnAddViewpoint").hide(),$("#btnCancelCreateViewpoint").hide()};function y(){var t=uT.getEdges();for(f in t){if(t.hasOwnProperty(f))uT.findEdge(f).remove()}var e=uT.getNodes();for(const t in e){if(e.hasOwnProperty(t))uT.findNode(t).remove()}uT.deleteModelAttribute()}var b=function(t){var e=r.getMap("views").get(t);e&&(y(),m(e),$("#lblCurrentView").show(),$("#lblCurrentViewId").text(e.id),uT.setViewId(e.id),l.resetTool())};function m(t){var e=new L_(t);n.sendLocalNonOTOperation(f_.WIDGET.NAME.ATTRIBUTE,e.toNonOTOperation()),e=new D_(!0),n.sendLocalNonOTOperation(f_.WIDGET.NAME.PALETTE,e.toNonOTOperation());var i=new N_("ViewApplyActivity",t.id,n.getUser()[f_.NS.PERSON.JABBERID]);n.sendLocalNonOTOperation(f_.WIDGET.NAME.ACTIVITY,i.toNonOTOperation());r.getMap("canvas").set("ViewApplyActivity",{viewId:t.id,jabberId:n.getUser()[f_.NS.PERSON.JABBERID]}),WT(t,l),$("#loading").hide(),l.resetTool()}var E=$("#undo");E.prop("disabled",!0);var w=$("#redo");w.prop("disabled",!0),E.click((function(){zO.undo()})),w.click((function(){zO.redo()})),$("#showtype").click((function(){l.get$node().removeClass("hide_type"),$(this).hide(),$("#hideType").show()})).hide(),$("#hideType").click((function(){l.get$node().addClass("hide_type"),$(this).hide(),$("#showtype").show()})),$("#viewsShow").click((function(){$(this).hide(),$("#viewsHide").show(),$("#ViewCtrlContainer").show("fast")})),$("#zoomIn").click((function(){l.setZoom(l.getZoom()+.1)})),$("#zoomOut").click((function(){l.setZoom(l.getZoom()-.1)})),$("#applyLayout").click((function(){const t=window.y.getMap("users");window.y.getMap("canvas").set("applyLayout",t.get(window.y.clientID.toString()));window.y.getMap("activity").set("ApplyLayoutActivity",new N_("ApplyLayoutActivity",null,t.get(window.y.clientID.toString()),"..applied Layout").toJSON())}));var _=$("#feedback"),O=function(){_.text("Saving...");var e=$("#lblCurrentViewId").text();e.length>0&&!t?(lx.updateViewContent(e),_.text("Saved!"),setTimeout((function(){_.text("")}),1e3)):(uT.storeDataYjs(),_.text("Saved!"),setTimeout((function(){_.text("")}),1e3))};$("#save").click((function(){O()})),$("#dialog").dialog({autoOpen:!1,resizable:!1,height:350,width:400,modal:!0,buttons:{Generate:function(t){var e=$("#space_title").val(),i=$("#space_label").val().toString().replace(/[^a-zA-Z]/g,"").toLowerCase();""!==e&&""!==i&&uT.generateSpace(i,e).then((function(e){var i=new N_("EditorGenerateActivity","-1",n.getUser()[f_.NS.PERSON.JABBERID],'..generated new Editor <a href="'+e.spaceURI+'" target="_blank">'+e.spaceTitle+"</a>",{}).toNonOTOperation();n.sendLocalNonOTOperation(f_.WIDGET.NAME.ACTIVITY,i),$("#space_link").text(e.spaceURI).attr({href:e.spaceURI}).show(),$("#space_link_text").show(),$("#space_link_input").hide(),$(t.target).parent().hide()}))},Close:function(){$(this).dialog("close")}},open:function(){var t=l.getModelAttributesNode().getAttribute("modelAttributes[name]").getValue().getValue(),e=$("#space_title"),n=$("#space_label");""===e.val()&&e.val(t),""===n.val()&&n.val(t.replace(/[^a-zA-Z]/g,"").toLowerCase()),$(":button:contains('Generate')").show()},close:function(){$("#space_link_text").hide(),$("#space_link_input").show()}});var T=$("#generate").click((function(){$("#dialog").dialog("open")}));t&&(t.hasOwnProperty("nodes")||t.hasOwnProperty("edges"))||T.show();if(t){var x=new R_(t);n.sendLocalNonOTOperation(f_.WIDGET.NAME.PALETTE,x.toNonOTOperation()),n.sendLocalNonOTOperation(f_.WIDGET.NAME.ATTRIBUTE,x.toNonOTOperation())}const A=$("#searchNodeInput"),S=$("#searchNodeButton");if(S.click((function(){const t=A.val(),e=uT.findObjectNodeByLabel(t);e&&(l.scrollNodeIntoView(e),l.select(e))})),A.keypress((function(t){13==t.which&&S.click()})),e){var I=WT(e,l);console.info("CANVAS: Initialization of model completed ",I);const t=r.getMap("data");uT.getLayer()===f_.LAYER.META&&(t.set("guidancemetamodel",uT.generateGuidanceMetamodel()),t.set("metamodelpreview",uT.generateMetaModel()))}else if(null===l.getModelAttributesNode()){var k=uT.createModelAttributesNode(r);k.registerYMap(),l.setModelAttributesNode(k),k.addToCanvas(l)}const P=n.getUser()[f_.NS.PERSON.JABBERID];u.has(n.getUser()[f_.NS.PERSON.JABBERID])||u.set(P.toString(),!1);lx.GetViewpointList(),o.hide()}(a,s,e,n,t),window.onbeforeunload=function(){const n=t.getMap("userList"),i=t.getMap("users");n.delete(e.getUser()[f_.NS.PERSON.JABBERID]),i.delete(t.clientID.toString());const r=t.getMap("activity"),o=new N_("UserLeftActivity",null,e.getUser()[f_.NS.PERSON.JABBERID]);r.set("UserLeftActivity",o.toJSON())}}),1e3)})).catch((function(t){console.warn(t),e.find("#alert-message").text("Cannot connect to Yjs server."),e.show();$(p_(f_.WIDGET.NAME.MAIN)).find("loading-spinner").hide(),alert("ERROR: "+t)}))}};gx=l([u(p_(f_.WIDGET.NAME.MAIN))],gx);class vx{constructor(t){var e=t;this.getEntityId=function(){return e}}}class yx extends vx{constructor(t,e,n){super(t);var i=e,r=$(su.template('<div class="attribute"></div>')()),o=n;this.setName=function(t){i=t},this.getName=function(){return i},this.getSubjectEntity=function(){return o},this.getRootSubjectEntity=function(){for(var t=this.getSubjectEntity();t instanceof yx;)t=t.getSubjectEntity();return t},this.getSubjectEntityId=function(){return o.getEntityId()},this._get$node=function(){return r}}get$node(){this._get$node()}}class bx{constructor(t,e,n,i){var r=t,o=e,a=n,s=i;this.getEntityId=function(){return r},this.getName=function(){return o},this.getSubjectEntity=function(){return a},this.getRootSubjectEntity=function(){return s}}}class mx extends bx{constructor(t,e,n,i,r){super(t,e,n,i);var o=this,a=!1,s=$(su.template('<input\n  class="form-check-input val"\n  type="checkbox"\n  name="<%= name %>"\n  <% if (value) { %> checked="checked" <% } %> />\n')({name:e,options:r,value:a})),l=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),u=function(t){o.setValue(t.getValue())},c=function(t){u(t);var e=y.getMap("nodes").get(i.getEntityId());if(e){var n=t.toJSON();n.userId=l.getUser()[f_.NS.PERSON.JABBERID],e.set(o.getEntityId(),n)}},d=function(t){t instanceof I_&&t.getEntityId()===o.getEntityId()&&u(t)};this.setValue=function(t){a=t,s.prop("checked",t)},this.getValue=function(){return a},this.get$node=function(){return s},this.registerCallbacks=function(){l.registerOnDataReceivedCallback(d)},this.unregisterCallbacks=function(){l.unregisterOnDataReceivedCallback(d)},this.setValueFromJSON=function(t){this.setValue(t.value)},s.off(),s.change((function(){var t,e,n;t=f_.OPERATION.TYPE.UPDATE,e=this.checked,n=new I_(o.getEntityId(),e,t,null,l.getUser()[f_.NS.PERSON.JABBERID]),c(n)})),l&&o.registerCallbacks()}}class Ex extends yx{constructor(t,e,n,i){super(t,e,n);var r=new mx(t,e,this,this.getRootSubjectEntity(),i),o=$(su.template('<div class="attribute_single_value_attribute input-group mb-3">\n  <div class="attribute_name"></div>\n  <div class="attribute_value"></div>\n</div>\n')());if(this.setValue=function(t){r=t},this.getValue=function(){return r},this.get$node=function(){return o},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},o.find(".attribute_name").text(this.getName()),o.find(".attribute_value").append(r.get$node()),window.hasOwnProperty("y")){y.getMap("widgetConfig").get("view_only_property_browser")&&o.find(".val").attr("disabled","true")}}}const wx=(new H_).openapp;class _x extends bx{constructor(t,e,n,i,r){super(t,e,n,i);var o=this,a="",s=$(su.template('<div class="file">\n  <div class="select_file">\n    <input class="form-control" type="file" id="file_object" />\n    <input class="form-control" type="button" id="file_submit" value="Submit" />\n  </div>\n  <div class="manage_file">\n    <span id="file_name"></span>\n    <button id="file_preview">Preview</button>\n    <button>\n      <a\n        id="file_download"\n        href="#"\n        target="_blank"\n        style="color: #000; text-decoration: none"\n        >Download</a\n      >\n    </button>\n    <button id="file_delete">Delete</button>\n  </div>\n</div>\n')({name:e,options:r})),l=s.find(".select_file"),u=s.find(".manage_file"),c=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),d=function(t){o.setValue(t.getValue())},f=function(t,e,n){var i=new I_(o.getEntityId(),e,t,n);p(i)},p=function(t){d(t),c.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())},h=function(t){t instanceof I_&&t.getEntityId()===o.getEntityId()&&d(t)};this.setValue=function(t){var e=l.find("#file_object"),n=u.find("#file_name"),i=u.find("#file_download"),r=u.find("#file_preview");""===(a=t)?(e.replaceWith(e.clone(!0)),l.show(),u.hide()):$.get(a+"/:representation").done((function(t){i[0].download=t.name,i[0].href=t.data,r.click((function(e){e.preventDefault(),window.open(t.data,"_blank")})),n.text(t.name.length>15?t.name.substr(0,5)+".."+t.name.substr(-10):t.name),l.hide(),u.show()}))},this.getValue=function(){return a},this.get$node=function(){return s},this.registerCallbacks=function(){c.registerOnDataReceivedCallback(h)},this.unregisterCallbacks=function(){c.unregisterOnDataReceivedCallback(h)},this.setValueFromJSON=function(t){this.setValue(t.value)},l.find("#file_object").change((function(){var t=$(this)[0].files;t&&0!==t.length&&t[0].size>1048576&&alert("Chosen file is too large. Maximum size: 1MB")})),l.find("#file_submit").click((function(){var t,e,n=l.find("#file_object")[0].files;n&&0!==n.length&&(e=n[0],(t=new FileReader).onload=function(t){!function(t,e,n){new wx.oo.Resource(wx.param.space()).create({relation:wx.ns.role+"data",type:"my:ns:file",representation:{name:t,type:e,data:n},callback:function(t){t.uri&&f(f_.OPERATION.TYPE.UPDATE,t.uri,0)}})}(e.name,e.type,t.target.result)},t.readAsDataURL(e))})),u.find("#file_delete").click((function(){f(f_.OPERATION.TYPE.UPDATE,"",0)})),l.show(),u.hide(),c&&o.registerCallbacks()}}class Ox extends yx{constructor(t,e,n,i){super(t,e,n);var r=new _x(t,e,this,this.getRootSubjectEntity(),i),o=$(su.template('<div class="attribute_single_value_attribute input-group mb-3">\n  <div class="attribute_name"></div>\n  <div class="attribute_value"></div>\n</div>\n')());this.setValue=function(t){r=t},this.getValue=function(){return r},this.get$node=function(){return o},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},o.find(".attribute_name").text(this.getName()),o.find(".attribute_value").append(r.get$node())}}class Tx extends bx{constructor(t,e,n,i,r){super(t,e,n,i);var o=this,a=0,s=$(su.template('<input\n  class="form-control h-100 val"\n  type="number"\n  name="<%= name %>"\n  value="0"\n/>\n')({name:e,options:r})),l=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),u=function(t){o.setValue(t.getValue())},c=function(t){u(t);var e=y.getMap("nodes").get(i.getEntityId());e&&e.set(o.getEntityId(),t.toJSON())},d=function(t){t instanceof I_&&t.getEntityId()===o.getEntityId()&&u(t)};this.setValue=function(t){a=t,s.val(t)},this.getValue=function(){return a},this.get$node=function(){return s},this.registerCallbacks=function(){l.registerOnDataReceivedCallback(d)},this.unregisterCallbacks=function(){l.unregisterOnDataReceivedCallback(d)},this.setValueFromJSON=function(t){this.setValue(t.value)},s.off(),s.change((function(){var t=parseInt(s.val());isNaN(t)&&(t=0),function(t,e,n){var i=new I_(o.getEntityId(),e,t,n,l.getUser()[f_.NS.PERSON.JABBERID]);c(i)}(f_.OPERATION.TYPE.UPDATE,t,0)})),l&&o.registerCallbacks()}}class xx extends yx{constructor(t,e,n,i){super(t,e,n);var r=new Tx(t,e,this,this.getRootSubjectEntity(),i),o=$(su.template('<div class="attribute_single_value_attribute input-group mb-3 flex-nowrap">\n  <div\n    class="attribute_name input-group-text overflow-auto"\n    style="max-width: 50%"\n  ></div>\n  <div class="attribute_value flex-fill"></div>\n</div>\n')());if(this.setValue=function(t){r=t},this.getValue=function(){return r},this.get$node=function(){return o},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},o.find(".attribute_name").text(this.getName()),o.find(".attribute_value").append(r.get$node()),window.hasOwnProperty("y")){y.getMap("widgetConfig").get("view_only_property_browser")&&o.find(".val").attr("disabled","true")}}}var Ax,Sx={};"undefined"!=typeof self&&self,Ax=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=109)}([function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=n(17),r=n(18),o=n(19),a=n(45),s=n(46),l=n(47),u=n(48),c=n(49),d=n(12),f=n(32),p=n(33),h=n(31),g=n(1),v={Scope:g.Scope,create:g.create,find:g.find,query:g.query,register:g.register,Container:i.default,Format:r.default,Leaf:o.default,Embed:u.default,Scroll:a.default,Block:l.default,Inline:s.default,Text:c.default,Attributor:{Attribute:d.default,Class:f.default,Style:p.default,Store:h.default}};e.default=v},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){var n=this;return e="[Parchment] "+e,(n=t.call(this,e)||this).message=e,n.name=n.constructor.name,n}return r(e,t),e}(Error);e.ParchmentError=o;var a,s={},l={},u={},c={};function d(t,e){var n;if(void 0===e&&(e=a.ANY),"string"==typeof t)n=c[t]||s[t];else if(t instanceof Text||t.nodeType===Node.TEXT_NODE)n=c.text;else if("number"==typeof t)t&a.LEVEL&a.BLOCK?n=c.block:t&a.LEVEL&a.INLINE&&(n=c.inline);else if(t instanceof HTMLElement){var i=(t.getAttribute("class")||"").split(/\s+/);for(var r in i)if(n=l[i[r]])break;n=n||u[t.tagName]}return null==n?null:e&a.LEVEL&n.scope&&e&a.TYPE&n.scope?n:null}e.DATA_KEY="__blot",function(t){t[t.TYPE=3]="TYPE",t[t.LEVEL=12]="LEVEL",t[t.ATTRIBUTE=13]="ATTRIBUTE",t[t.BLOT=14]="BLOT",t[t.INLINE=7]="INLINE",t[t.BLOCK=11]="BLOCK",t[t.BLOCK_BLOT=10]="BLOCK_BLOT",t[t.INLINE_BLOT=6]="INLINE_BLOT",t[t.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",t[t.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",t[t.ANY=15]="ANY"}(a=e.Scope||(e.Scope={})),e.create=function(t,e){var n=d(t);if(null==n)throw new o("Unable to create "+t+" blot");var i=n,r=t instanceof Node||t.nodeType===Node.TEXT_NODE?t:i.create(e);return new i(r,e)},e.find=function t(n,i){return void 0===i&&(i=!1),null==n?null:null!=n[e.DATA_KEY]?n[e.DATA_KEY].blot:i?t(n.parentNode,i):null},e.query=d,e.register=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(e.length>1)return e.map((function(e){return t(e)}));var i=e[0];if("string"!=typeof i.blotName&&"string"!=typeof i.attrName)throw new o("Invalid definition");if("abstract"===i.blotName)throw new o("Cannot register abstract class");return c[i.blotName||i.attrName]=i,"string"==typeof i.keyName?s[i.keyName]=i:(null!=i.className&&(l[i.className]=i),null!=i.tagName&&(Array.isArray(i.tagName)?i.tagName=i.tagName.map((function(t){return t.toUpperCase()})):i.tagName=i.tagName.toUpperCase(),(Array.isArray(i.tagName)?i.tagName:[i.tagName]).forEach((function(t){null!=u[t]&&null!=i.className||(u[t]=i)})))),i}},function(t,e,n){var i=n(51),r=n(11),o=n(3),a=n(20),s=String.fromCharCode(0),l=function(t){Array.isArray(t)?this.ops=t:null!=t&&Array.isArray(t.ops)?this.ops=t.ops:this.ops=[]};l.prototype.insert=function(t,e){var n={};return 0===t.length?this:(n.insert=t,null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n))},l.prototype.delete=function(t){return t<=0?this:this.push({delete:t})},l.prototype.retain=function(t,e){if(t<=0)return this;var n={retain:t};return null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n)},l.prototype.push=function(t){var e=this.ops.length,n=this.ops[e-1];if(t=o(!0,{},t),"object"==typeof n){if("number"==typeof t.delete&&"number"==typeof n.delete)return this.ops[e-1]={delete:n.delete+t.delete},this;if("number"==typeof n.delete&&null!=t.insert&&(e-=1,"object"!=typeof(n=this.ops[e-1])))return this.ops.unshift(t),this;if(r(t.attributes,n.attributes)){if("string"==typeof t.insert&&"string"==typeof n.insert)return this.ops[e-1]={insert:n.insert+t.insert},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this;if("number"==typeof t.retain&&"number"==typeof n.retain)return this.ops[e-1]={retain:n.retain+t.retain},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this}}return e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),this},l.prototype.chop=function(){var t=this.ops[this.ops.length-1];return t&&t.retain&&!t.attributes&&this.ops.pop(),this},l.prototype.filter=function(t){return this.ops.filter(t)},l.prototype.forEach=function(t){this.ops.forEach(t)},l.prototype.map=function(t){return this.ops.map(t)},l.prototype.partition=function(t){var e=[],n=[];return this.forEach((function(i){(t(i)?e:n).push(i)})),[e,n]},l.prototype.reduce=function(t,e){return this.ops.reduce(t,e)},l.prototype.changeLength=function(){return this.reduce((function(t,e){return e.insert?t+a.length(e):e.delete?t-e.delete:t}),0)},l.prototype.length=function(){return this.reduce((function(t,e){return t+a.length(e)}),0)},l.prototype.slice=function(t,e){t=t||0,"number"!=typeof e&&(e=1/0);for(var n=[],i=a.iterator(this.ops),r=0;r<e&&i.hasNext();){var o;r<t?o=i.next(t-r):(o=i.next(e-r),n.push(o)),r+=a.length(o)}return new l(n)},l.prototype.compose=function(t){var e=a.iterator(this.ops),n=a.iterator(t.ops),i=[],o=n.peek();if(null!=o&&"number"==typeof o.retain&&null==o.attributes){for(var s=o.retain;"insert"===e.peekType()&&e.peekLength()<=s;)s-=e.peekLength(),i.push(e.next());o.retain-s>0&&n.next(o.retain-s)}for(var u=new l(i);e.hasNext()||n.hasNext();)if("insert"===n.peekType())u.push(n.next());else if("delete"===e.peekType())u.push(e.next());else{var c=Math.min(e.peekLength(),n.peekLength()),d=e.next(c),f=n.next(c);if("number"==typeof f.retain){var p={};"number"==typeof d.retain?p.retain=c:p.insert=d.insert;var h=a.attributes.compose(d.attributes,f.attributes,"number"==typeof d.retain);if(h&&(p.attributes=h),u.push(p),!n.hasNext()&&r(u.ops[u.ops.length-1],p)){var g=new l(e.rest());return u.concat(g).chop()}}else"number"==typeof f.delete&&"number"==typeof d.retain&&u.push(f)}return u.chop()},l.prototype.concat=function(t){var e=new l(this.ops.slice());return t.ops.length>0&&(e.push(t.ops[0]),e.ops=e.ops.concat(t.ops.slice(1))),e},l.prototype.diff=function(t,e){if(this.ops===t.ops)return new l;var n=[this,t].map((function(e){return e.map((function(n){if(null!=n.insert)return"string"==typeof n.insert?n.insert:s;throw new Error("diff() called "+(e===t?"on":"with")+" non-document")})).join("")})),o=new l,u=i(n[0],n[1],e),c=a.iterator(this.ops),d=a.iterator(t.ops);return u.forEach((function(t){for(var e=t[1].length;e>0;){var n=0;switch(t[0]){case i.INSERT:n=Math.min(d.peekLength(),e),o.push(d.next(n));break;case i.DELETE:n=Math.min(e,c.peekLength()),c.next(n),o.delete(n);break;case i.EQUAL:n=Math.min(c.peekLength(),d.peekLength(),e);var s=c.next(n),l=d.next(n);r(s.insert,l.insert)?o.retain(n,a.attributes.diff(s.attributes,l.attributes)):o.push(l).delete(n)}e-=n}})),o.chop()},l.prototype.eachLine=function(t,e){e=e||"\n";for(var n=a.iterator(this.ops),i=new l,r=0;n.hasNext();){if("insert"!==n.peekType())return;var o=n.peek(),s=a.length(o)-n.peekLength(),u="string"==typeof o.insert?o.insert.indexOf(e,s)-s:-1;if(u<0)i.push(n.next());else if(u>0)i.push(n.next(u));else{if(!1===t(i,n.next(1).attributes||{},r))return;r+=1,i=new l}}i.length()>0&&t(i,{},r)},l.prototype.transform=function(t,e){if(e=!!e,"number"==typeof t)return this.transformPosition(t,e);for(var n=a.iterator(this.ops),i=a.iterator(t.ops),r=new l;n.hasNext()||i.hasNext();)if("insert"!==n.peekType()||!e&&"insert"===i.peekType())if("insert"===i.peekType())r.push(i.next());else{var o=Math.min(n.peekLength(),i.peekLength()),s=n.next(o),u=i.next(o);if(s.delete)continue;u.delete?r.push(u):r.retain(o,a.attributes.transform(s.attributes,u.attributes,e))}else r.retain(a.length(n.next()));return r.chop()},l.prototype.transformPosition=function(t,e){e=!!e;for(var n=a.iterator(this.ops),i=0;n.hasNext()&&i<=t;){var r=n.peekLength(),o=n.peekType();n.next(),"delete"!==o?("insert"===o&&(i<t||!e)&&(t+=r),i+=r):t-=Math.min(r,t-i)}return t},t.exports=l},function(t,e){var n=Object.prototype.hasOwnProperty,i=Object.prototype.toString,r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,a=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===i.call(t)},s=function(t){if(!t||"[object Object]"!==i.call(t))return!1;var e,r=n.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&n.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!o)return!1;for(e in t);return void 0===e||n.call(t,e)},l=function(t,e){r&&"__proto__"===e.name?r(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},u=function(t,e){if("__proto__"===e){if(!n.call(t,e))return;if(o)return o(t,e).value}return t[e]};t.exports=function t(){var e,n,i,r,o,c,d=arguments[0],f=1,p=arguments.length,h=!1;for("boolean"==typeof d&&(h=d,d=arguments[1]||{},f=2),(null==d||"object"!=typeof d&&"function"!=typeof d)&&(d={});f<p;++f)if(null!=(e=arguments[f]))for(n in e)i=u(d,n),d!==(r=u(e,n))&&(h&&r&&(s(r)||(o=a(r)))?(o?(o=!1,c=i&&a(i)?i:[]):c=i&&s(i)?i:{},l(d,{name:n,newValue:t(h,c,r)})):void 0!==r&&l(d,{name:n,newValue:r}));return d}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.BlockEmbed=e.bubbleFormats=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=d(n(3)),a=d(n(2)),s=d(n(0)),l=d(n(16)),u=d(n(6)),c=d(n(7));function d(t){return t&&t.__esModule?t:{default:t}}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var g=function(t){function e(){return f(this,e),p(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return h(e,t),i(e,[{key:"attach",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"attach",this).call(this),this.attributes=new s.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return(new a.default).insert(this.value(),(0,o.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(t,e){var n=s.default.query(t,s.default.Scope.BLOCK_ATTRIBUTE);null!=n&&this.attributes.attribute(n,e)}},{key:"formatAt",value:function(t,e,n,i){this.format(n,i)}},{key:"insertAt",value:function(t,n,i){if("string"==typeof n&&n.endsWith("\n")){var o=s.default.create(v.blotName);this.parent.insertBefore(o,0===t?this:this.next),o.insertAt(0,n.slice(0,-1))}else r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insertAt",this).call(this,t,n,i)}}]),e}(s.default.Embed);g.scope=s.default.Scope.BLOCK_BLOT;var v=function(t){function e(t){f(this,e);var n=p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.cache={},n}return h(e,t),i(e,[{key:"delta",value:function(){return null==this.cache.delta&&(this.cache.delta=this.descendants(s.default.Leaf).reduce((function(t,e){return 0===e.length()?t:t.insert(e.value(),y(e))}),new a.default).insert("\n",y(this))),this.cache.delta}},{key:"deleteAt",value:function(t,n){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"deleteAt",this).call(this,t,n),this.cache={}}},{key:"formatAt",value:function(t,n,i,o){n<=0||(s.default.query(i,s.default.Scope.BLOCK)?t+n===this.length()&&this.format(i,o):r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"formatAt",this).call(this,t,Math.min(n,this.length()-t-1),i,o),this.cache={})}},{key:"insertAt",value:function(t,n,i){if(null!=i)return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insertAt",this).call(this,t,n,i);if(0!==n.length){var o=n.split("\n"),a=o.shift();a.length>0&&(t<this.length()-1||null==this.children.tail?r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insertAt",this).call(this,Math.min(t,this.length()-1),a):this.children.tail.insertAt(this.children.tail.length(),a),this.cache={});var s=this;o.reduce((function(t,e){return(s=s.split(t,!0)).insertAt(0,e),e.length}),t+a.length)}}},{key:"insertBefore",value:function(t,n){var i=this.children.head;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insertBefore",this).call(this,t,n),i instanceof l.default&&i.remove(),this.cache={}}},{key:"length",value:function(){return null==this.cache.length&&(this.cache.length=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"length",this).call(this)+1),this.cache.length}},{key:"moveChildren",value:function(t,n){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"moveChildren",this).call(this,t,n),this.cache={}}},{key:"optimize",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"optimize",this).call(this,t),this.cache={}}},{key:"path",value:function(t){return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"path",this).call(this,t,!0)}},{key:"removeChild",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"removeChild",this).call(this,t),this.cache={}}},{key:"split",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n&&(0===t||t>=this.length()-1)){var i=this.clone();return 0===t?(this.parent.insertBefore(i,this),this):(this.parent.insertBefore(i,this.next),i)}var o=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"split",this).call(this,t,n);return this.cache={},o}}]),e}(s.default.Block);function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==t?e:("function"==typeof t.formats&&(e=(0,o.default)(e,t.formats())),null==t.parent||"scroll"==t.parent.blotName||t.parent.statics.scope!==t.statics.scope?e:y(t.parent,e))}v.blotName="block",v.tagName="P",v.defaultChild="break",v.allowedChildren=[u.default,s.default.Embed,c.default],e.bubbleFormats=y,e.BlockEmbed=g,e.default=v},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.overload=e.expandConfig=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();n(50);var a=v(n(2)),s=v(n(14)),l=v(n(8)),u=v(n(9)),c=v(n(0)),d=n(15),f=v(d),p=v(n(3)),h=v(n(10)),g=v(n(34));function v(t){return t&&t.__esModule?t:{default:t}}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=(0,h.default)("quill"),m=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=E(e,i),this.container=this.options.container,null==this.container)return b.error("Invalid Quill container",e);this.options.debug&&t.debug(this.options.debug);var r=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new l.default,this.scroll=c.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new s.default(this.scroll),this.selection=new f.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(l.default.events.EDITOR_CHANGE,(function(t){t===l.default.events.TEXT_CHANGE&&n.root.classList.toggle("ql-blank",n.editor.isBlank())})),this.emitter.on(l.default.events.SCROLL_UPDATE,(function(t,e){var i=n.selection.lastRange,r=i&&0===i.length?i.index:void 0;w.call(n,(function(){return n.editor.update(null,e,r)}),t)}));var o=this.clipboard.convert("<div class='ql-editor' style=\"white-space: normal;\">"+r+"<p><br></p></div>");this.setContents(o),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return o(t,null,[{key:"debug",value:function(t){!0===t&&(t="log"),h.default.level(t)}},{key:"find",value:function(t){return t.__quill||c.default.find(t)}},{key:"import",value:function(t){return null==this.imports[t]&&b.error("Cannot import "+t+". Are you sure it was registered?"),this.imports[t]}},{key:"register",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof t){var r=t.attrName||t.blotName;"string"==typeof r?this.register("formats/"+r,t,e):Object.keys(t).forEach((function(i){n.register(i,t[i],e)}))}else null==this.imports[t]||i||b.warn("Overwriting "+t+" with",e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&"abstract"!==e.blotName?c.default.register(e):t.startsWith("modules")&&"function"==typeof e.register&&e.register()}}]),o(t,[{key:"addContainer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof t){var n=t;(t=document.createElement("div")).classList.add(n)}return this.container.insertBefore(t,e),t}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(t,e,n){var i=this,o=_(t,e,n),a=r(o,4);return t=a[0],e=a[1],n=a[3],w.call(this,(function(){return i.editor.deleteText(t,e)}),n,t,-1*e)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}},{key:"focus",value:function(){var t=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=t,this.scrollIntoView()}},{key:"format",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.default.sources.API;return w.call(this,(function(){var i=n.getSelection(!0),r=new a.default;if(null==i)return r;if(c.default.query(t,c.default.Scope.BLOCK))r=n.editor.formatLine(i.index,i.length,y({},t,e));else{if(0===i.length)return n.selection.format(t,e),r;r=n.editor.formatText(i.index,i.length,y({},t,e))}return n.setSelection(i,l.default.sources.SILENT),r}),i)}},{key:"formatLine",value:function(t,e,n,i,o){var a,s=this,l=_(t,e,n,i,o),u=r(l,4);return t=u[0],e=u[1],a=u[2],o=u[3],w.call(this,(function(){return s.editor.formatLine(t,e,a)}),o,t,0)}},{key:"formatText",value:function(t,e,n,i,o){var a,s=this,l=_(t,e,n,i,o),u=r(l,4);return t=u[0],e=u[1],a=u[2],o=u[3],w.call(this,(function(){return s.editor.formatText(t,e,a)}),o,t,0)}},{key:"getBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=void 0;n="number"==typeof t?this.selection.getBounds(t,e):this.selection.getBounds(t.index,t.length);var i=this.container.getBoundingClientRect();return{bottom:n.bottom-i.top,height:n.height,left:n.left-i.left,right:n.right-i.left,top:n.top-i.top,width:n.width}}},{key:"getContents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-t,n=_(t,e),i=r(n,2);return t=i[0],e=i[1],this.editor.getContents(t,e)}},{key:"getFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"==typeof t?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}},{key:"getIndex",value:function(t){return t.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(t){return this.scroll.leaf(t)}},{key:"getLine",value:function(t){return this.scroll.line(t)}},{key:"getLines",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!=typeof t?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}},{key:"getModule",value:function(t){return this.theme.modules[t]}},{key:"getSelection",value:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-t,n=_(t,e),i=r(n,2);return t=i[0],e=i[1],this.editor.getText(t,e)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(e,n,i){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.sources.API;return w.call(this,(function(){return r.editor.insertEmbed(e,n,i)}),o,e)}},{key:"insertText",value:function(t,e,n,i,o){var a,s=this,l=_(t,0,n,i,o),u=r(l,4);return t=u[0],a=u[2],o=u[3],w.call(this,(function(){return s.editor.insertText(t,e,a)}),o,t,e.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(t,e,n){this.clipboard.dangerouslyPasteHTML(t,e,n)}},{key:"removeFormat",value:function(t,e,n){var i=this,o=_(t,e,n),a=r(o,4);return t=a[0],e=a[1],n=a[3],w.call(this,(function(){return i.editor.removeFormat(t,e)}),n,t)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.default.sources.API;return w.call(this,(function(){t=new a.default(t);var n=e.getLength(),i=e.editor.deleteText(0,n),r=e.editor.applyDelta(t),o=r.ops[r.ops.length-1];return null!=o&&"string"==typeof o.insert&&"\n"===o.insert[o.insert.length-1]&&(e.editor.deleteText(e.getLength()-1,1),r.delete(1)),i.compose(r)}),n)}},{key:"setSelection",value:function(e,n,i){if(null==e)this.selection.setRange(null,n||t.sources.API);else{var o=_(e,n,i),a=r(o,4);e=a[0],n=a[1],i=a[3],this.selection.setRange(new d.Range(e,n),i),i!==l.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.default.sources.API,n=(new a.default).insert(t);return this.setContents(n,e)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.default.sources.USER,e=this.scroll.update(t);return this.selection.update(t),e}},{key:"updateContents",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.default.sources.API;return w.call(this,(function(){return t=new a.default(t),e.editor.applyDelta(t,n)}),n,!0)}}]),t}();function E(t,e){if((e=(0,p.default)(!0,{container:t,modules:{clipboard:!0,keyboard:!0,history:!0}},e)).theme&&e.theme!==m.DEFAULTS.theme){if(e.theme=m.import("themes/"+e.theme),null==e.theme)throw new Error("Invalid theme "+e.theme+". Did you register it?")}else e.theme=g.default;var n=(0,p.default)(!0,{},e.theme.DEFAULTS);[n,e].forEach((function(t){t.modules=t.modules||{},Object.keys(t.modules).forEach((function(e){!0===t.modules[e]&&(t.modules[e]={})}))}));var i=Object.keys(n.modules).concat(Object.keys(e.modules)).reduce((function(t,e){var n=m.import("modules/"+e);return null==n?b.error("Cannot load "+e+" module. Are you sure you registered it?"):t[e]=n.DEFAULTS||{},t}),{});return null!=e.modules&&e.modules.toolbar&&e.modules.toolbar.constructor!==Object&&(e.modules.toolbar={container:e.modules.toolbar}),e=(0,p.default)(!0,{},m.DEFAULTS,{modules:i},n,e),["bounds","container","scrollingContainer"].forEach((function(t){"string"==typeof e[t]&&(e[t]=document.querySelector(e[t]))})),e.modules=Object.keys(e.modules).reduce((function(t,n){return e.modules[n]&&(t[n]=e.modules[n]),t}),{}),e}function w(t,e,n,i){if(this.options.strict&&!this.isEnabled()&&e===l.default.sources.USER)return new a.default;var r=null==n?null:this.getSelection(),o=this.editor.delta,s=t();if(null!=r&&(!0===n&&(n=r.index),null==i?r=O(r,s,e):0!==i&&(r=O(r,n,i,e)),this.setSelection(r,l.default.sources.SILENT)),s.length()>0){var u,c,d=[l.default.events.TEXT_CHANGE,s,o,e];(u=this.emitter).emit.apply(u,[l.default.events.EDITOR_CHANGE].concat(d)),e!==l.default.sources.SILENT&&(c=this.emitter).emit.apply(c,d)}return s}function _(t,e,n,r,o){var a={};return"number"==typeof t.index&&"number"==typeof t.length?"number"!=typeof e?(o=r,r=n,n=e,e=t.length,t=t.index):(e=t.length,t=t.index):"number"!=typeof e&&(o=r,r=n,n=e,e=0),"object"===(void 0===n?"undefined":i(n))?(a=n,o=r):"string"==typeof n&&(null!=r?a[n]=r:o=n),[t,e,a,o=o||l.default.sources.API]}function O(t,e,n,i){if(null==t)return null;var o=void 0,s=void 0;if(e instanceof a.default){var u=[t.index,t.index+t.length].map((function(t){return e.transformPosition(t,i!==l.default.sources.USER)})),c=r(u,2);o=c[0],s=c[1]}else{var f=[t.index,t.index+t.length].map((function(t){return t<e||t===e&&i===l.default.sources.USER?t:n>=0?t+n:Math.max(e,t+n)})),p=r(f,2);o=p[0],s=p[1]}return new d.Range(o,s-o)}m.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},m.events=l.default.events,m.sources=l.default.sources,m.version="1.3.7",m.imports={delta:a.default,parchment:c.default,"core/module":u.default,"core/theme":g.default},e.expandConfig=E,e.overload=_,e.default=m},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=s(n(7)),a=s(n(0));function s(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"formatAt",value:function(t,n,i,o){if(e.compare(this.statics.blotName,i)<0&&a.default.query(i,a.default.Scope.BLOT)){var s=this.isolate(t,n);o&&s.wrap(i,o)}else r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"formatAt",this).call(this,t,n,i,o)}},{key:"optimize",value:function(t){if(r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"optimize",this).call(this,t),this.parent instanceof e&&e.compare(this.statics.blotName,this.parent.statics.blotName)>0){var n=this.parent.isolate(this.offset(),this.length());this.moveChildren(n),n.wrap(this)}}}],[{key:"compare",value:function(t,n){var i=e.order.indexOf(t),r=e.order.indexOf(n);return i>=0||r>=0?i-r:t===n?0:t<n?-1:1}}]),e}(a.default.Inline);l.allowedChildren=[l,a.default.Embed,o.default],l.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],e.default=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(0),o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((i=r)&&i.__esModule?i:{default:i}).default.Text);e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=a(n(54));function a(t){return t&&t.__esModule?t:{default:t}}var s=(0,a(n(10)).default)("quill:events");["selectionchange","mousedown","mouseup","click"].forEach((function(t){document.addEventListener(t,(function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];[].slice.call(document.querySelectorAll(".ql-container")).forEach((function(t){var n;t.__quill&&t.__quill.emitter&&(n=t.__quill.emitter).handleDOM.apply(n,e)}))}))}));var l=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.listeners={},t.on("error",s.error),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"emit",value:function(){s.log.apply(s,arguments),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];(this.listeners[t.type]||[]).forEach((function(e){var i=e.node,r=e.handler;(t.target===i||i.contains(t.target))&&r.apply(void 0,[t].concat(n))}))}},{key:"listenDOM",value:function(t,e,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push({node:e,handler:n})}}]),e}(o.default);l.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},l.sources={API:"api",SILENT:"silent",USER:"user"},e.default=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quill=e,this.options=n};i.DEFAULTS={},e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=["error","warn","log","info"],r="warn";function o(t){if(i.indexOf(t)<=i.indexOf(r)){for(var e,n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];(e=console)[t].apply(e,o)}}function a(t){return i.reduce((function(e,n){return e[n]=o.bind(console,n,t),e}),{})}o.level=a.level=function(t){r=t},e.default=a},function(t,e,n){var i=Array.prototype.slice,r=n(52),o=n(53),a=t.exports=function(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?n.strict?t===e:t==e:function(t,e,n){var u,c;if(s(t)||s(e))return!1;if(t.prototype!==e.prototype)return!1;if(o(t))return!!o(e)&&(t=i.call(t),e=i.call(e),a(t,e,n));if(l(t)){if(!l(e))return!1;if(t.length!==e.length)return!1;for(u=0;u<t.length;u++)if(t[u]!==e[u])return!1;return!0}try{var d=r(t),f=r(e)}catch(t){return!1}if(d.length!=f.length)return!1;for(d.sort(),f.sort(),u=d.length-1;u>=0;u--)if(d[u]!=f[u])return!1;for(u=d.length-1;u>=0;u--)if(c=d[u],!a(t[c],e[c],n))return!1;return typeof t==typeof e}(t,e,n))};function s(t){return null==t}function l(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(){function t(t,e,n){void 0===n&&(n={}),this.attrName=t,this.keyName=e;var r=i.Scope.TYPE&i.Scope.ATTRIBUTE;null!=n.scope?this.scope=n.scope&i.Scope.LEVEL|r:this.scope=i.Scope.ATTRIBUTE,null!=n.whitelist&&(this.whitelist=n.whitelist)}return t.keys=function(t){return[].map.call(t.attributes,(function(t){return t.name}))},t.prototype.add=function(t,e){return!!this.canAdd(t,e)&&(t.setAttribute(this.keyName,e),!0)},t.prototype.canAdd=function(t,e){return null!=i.query(t,i.Scope.BLOT&(this.scope|i.Scope.TYPE))&&(null==this.whitelist||("string"==typeof e?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1))},t.prototype.remove=function(t){t.removeAttribute(this.keyName)},t.prototype.value=function(t){var e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""},t}();e.default=r},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Code=void 0;var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=d(n(2)),s=d(n(0)),l=d(n(4)),u=d(n(6)),c=d(n(7));function d(t){return t&&t.__esModule?t:{default:t}}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var g=function(t){function e(){return f(this,e),p(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return h(e,t),e}(u.default);g.blotName="code",g.tagName="CODE";var v=function(t){function e(){return f(this,e),p(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return h(e,t),r(e,[{key:"delta",value:function(){var t=this,e=this.domNode.textContent;return e.endsWith("\n")&&(e=e.slice(0,-1)),e.split("\n").reduce((function(e,n){return e.insert(n).insert("\n",t.formats())}),new a.default)}},{key:"format",value:function(t,n){if(t!==this.statics.blotName||!n){var r=this.descendant(c.default,this.length()-1),a=i(r,1)[0];null!=a&&a.deleteAt(a.length()-1,1),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"format",this).call(this,t,n)}}},{key:"formatAt",value:function(t,n,i,r){if(0!==n&&null!=s.default.query(i,s.default.Scope.BLOCK)&&(i!==this.statics.blotName||r!==this.statics.formats(this.domNode))){var o=this.newlineIndex(t);if(!(o<0||o>=t+n)){var a=this.newlineIndex(t,!0)+1,l=o-a+1,u=this.isolate(a,l),c=u.next;u.format(i,r),c instanceof e&&c.formatAt(0,t-a+n-l,i,r)}}}},{key:"insertAt",value:function(t,e,n){if(null==n){var r=this.descendant(c.default,t),o=i(r,2),a=o[0],s=o[1];a.insertAt(s,e)}}},{key:"length",value:function(){var t=this.domNode.textContent.length;return this.domNode.textContent.endsWith("\n")?t:t+1}},{key:"newlineIndex",value:function(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return this.domNode.textContent.slice(0,t).lastIndexOf("\n");var e=this.domNode.textContent.slice(t).indexOf("\n");return e>-1?t+e:-1}},{key:"optimize",value:function(t){this.domNode.textContent.endsWith("\n")||this.appendChild(s.default.create("text","\n")),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"optimize",this).call(this,t);var n=this.next;null!=n&&n.prev===this&&n.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===n.statics.formats(n.domNode)&&(n.optimize(t),n.moveChildren(this),n.remove())}},{key:"replace",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"replace",this).call(this,t),[].slice.call(this.domNode.querySelectorAll("*")).forEach((function(t){var e=s.default.find(t);null==e?t.parentNode.removeChild(t):e instanceof s.default.Embed?e.remove():e.unwrap()}))}}],[{key:"create",value:function(t){var n=o(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,t);return n.setAttribute("spellcheck",!1),n}},{key:"formats",value:function(){return!0}}]),e}(l.default);v.blotName="code-block",v.tagName="PRE",v.TAB="  ",e.Code=g,e.default=v},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=y(n(2)),s=y(n(20)),l=y(n(0)),u=y(n(13)),c=y(n(24)),d=n(4),f=y(d),p=y(n(16)),h=y(n(21)),g=y(n(11)),v=y(n(3));function y(t){return t&&t.__esModule?t:{default:t}}var b=/^[ -~]*$/,m=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.scroll=e,this.delta=this.getDelta()}return o(t,[{key:"applyDelta",value:function(t){var e=this,n=!1;this.scroll.update();var o=this.scroll.length();return this.scroll.batchStart(),(t=function(t){return t.reduce((function(t,e){if(1===e.insert){var n=(0,h.default)(e.attributes);return delete n.image,t.insert({image:e.attributes.image},n)}if(null==e.attributes||!0!==e.attributes.list&&!0!==e.attributes.bullet||((e=(0,h.default)(e)).attributes.list?e.attributes.list="ordered":(e.attributes.list="bullet",delete e.attributes.bullet)),"string"==typeof e.insert){var i=e.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return t.insert(i,e.attributes)}return t.push(e)}),new a.default)}(t)).reduce((function(t,a){var u=a.retain||a.delete||a.insert.length||1,c=a.attributes||{};if(null!=a.insert){if("string"==typeof a.insert){var p=a.insert;p.endsWith("\n")&&n&&(n=!1,p=p.slice(0,-1)),t>=o&&!p.endsWith("\n")&&(n=!0),e.scroll.insertAt(t,p);var h=e.scroll.line(t),g=r(h,2),y=g[0],b=g[1],m=(0,v.default)({},(0,d.bubbleFormats)(y));if(y instanceof f.default){var E=y.descendant(l.default.Leaf,b),w=r(E,1)[0];m=(0,v.default)(m,(0,d.bubbleFormats)(w))}c=s.default.attributes.diff(m,c)||{}}else if("object"===i(a.insert)){var _=Object.keys(a.insert)[0];if(null==_)return t;e.scroll.insertAt(t,_,a.insert[_])}o+=u}return Object.keys(c).forEach((function(n){e.scroll.formatAt(t,u,n,c[n])})),t+u}),0),t.reduce((function(t,n){return"number"==typeof n.delete?(e.scroll.deleteAt(t,n.delete),t):t+(n.retain||n.insert.length||1)}),0),this.scroll.batchEnd(),this.update(t)}},{key:"deleteText",value:function(t,e){return this.scroll.deleteAt(t,e),this.update((new a.default).retain(t).delete(e))}},{key:"formatLine",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.scroll.update(),Object.keys(i).forEach((function(r){if(null==n.scroll.whitelist||n.scroll.whitelist[r]){var o=n.scroll.lines(t,Math.max(e,1)),a=e;o.forEach((function(e){var o=e.length();if(e instanceof u.default){var s=t-e.offset(n.scroll),l=e.newlineIndex(s+a)-s+1;e.formatAt(s,l,r,i[r])}else e.format(r,i[r]);a-=o}))}})),this.scroll.optimize(),this.update((new a.default).retain(t).retain(e,(0,h.default)(i)))}},{key:"formatText",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.keys(i).forEach((function(r){n.scroll.formatAt(t,e,r,i[r])})),this.update((new a.default).retain(t).retain(e,(0,h.default)(i)))}},{key:"getContents",value:function(t,e){return this.delta.slice(t,t+e)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce((function(t,e){return t.concat(e.delta())}),new a.default)}},{key:"getFormat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],i=[];0===e?this.scroll.path(t).forEach((function(t){var e=r(t,1)[0];e instanceof f.default?n.push(e):e instanceof l.default.Leaf&&i.push(e)})):(n=this.scroll.lines(t,e),i=this.scroll.descendants(l.default.Leaf,t,e));var o=[n,i].map((function(t){if(0===t.length)return{};for(var e=(0,d.bubbleFormats)(t.shift());Object.keys(e).length>0;){var n=t.shift();if(null==n)return e;e=E((0,d.bubbleFormats)(n),e)}return e}));return v.default.apply(v.default,o)}},{key:"getText",value:function(t,e){return this.getContents(t,e).filter((function(t){return"string"==typeof t.insert})).map((function(t){return t.insert})).join("")}},{key:"insertEmbed",value:function(t,e,n){return this.scroll.insertAt(t,e,n),this.update((new a.default).retain(t).insert(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},e,n)))}},{key:"insertText",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(t,e),Object.keys(i).forEach((function(r){n.scroll.formatAt(t,e.length,r,i[r])})),this.update((new a.default).retain(t).insert(e,(0,h.default)(i)))}},{key:"isBlank",value:function(){if(0==this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;var t=this.scroll.children.head;return t.statics.blotName===f.default.blotName&&!(t.children.length>1)&&t.children.head instanceof p.default}},{key:"removeFormat",value:function(t,e){var n=this.getText(t,e),i=this.scroll.line(t+e),o=r(i,2),s=o[0],l=o[1],c=0,d=new a.default;null!=s&&(c=s instanceof u.default?s.newlineIndex(l)-l+1:s.length()-l,d=s.delta().slice(l,l+c-1).insert("\n"));var f=this.getContents(t,e+c).diff((new a.default).insert(n).concat(d)),p=(new a.default).retain(t).concat(f);return this.applyDelta(p)}},{key:"update",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=this.delta;if(1===e.length&&"characterData"===e[0].type&&e[0].target.data.match(b)&&l.default.find(e[0].target)){var r=l.default.find(e[0].target),o=(0,d.bubbleFormats)(r),s=r.offset(this.scroll),u=e[0].oldValue.replace(c.default.CONTENTS,""),f=(new a.default).insert(u),p=(new a.default).insert(r.value());t=(new a.default).retain(s).concat(f.diff(p,n)).reduce((function(t,e){return e.insert?t.insert(e.insert,o):t.push(e)}),new a.default),this.delta=i.compose(t)}else this.delta=this.getDelta(),t&&(0,g.default)(i.compose(t),this.delta)||(t=i.diff(this.delta,n));return t}}]),t}();function E(t,e){return Object.keys(e).reduce((function(n,i){return null==t[i]||(e[i]===t[i]?n[i]=e[i]:Array.isArray(e[i])?e[i].indexOf(t[i])<0&&(n[i]=e[i].concat([t[i]])):n[i]=[e[i],t[i]]),n}),{})}e.default=m},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Range=void 0;var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=u(n(0)),a=u(n(21)),s=u(n(11)),l=u(n(8));function u(t){return t&&t.__esModule?t:{default:t}}function c(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var f=(0,u(n(10)).default)("quill:selection"),p=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;d(this,t),this.index=e,this.length=n},h=function(){function t(e,n){var i=this;d(this,t),this.emitter=n,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=o.default.create("cursor",this),this.lastRange=this.savedRange=new p(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,(function(){i.mouseDown||setTimeout(i.update.bind(i,l.default.sources.USER),1)})),this.emitter.on(l.default.events.EDITOR_CHANGE,(function(t,e){t===l.default.events.TEXT_CHANGE&&e.length()>0&&i.update(l.default.sources.SILENT)})),this.emitter.on(l.default.events.SCROLL_BEFORE_UPDATE,(function(){if(i.hasFocus()){var t=i.getNativeRange();null!=t&&t.start.node!==i.cursor.textNode&&i.emitter.once(l.default.events.SCROLL_UPDATE,(function(){try{i.setNativeRange(t.start.node,t.start.offset,t.end.node,t.end.offset)}catch(t){}}))}})),this.emitter.on(l.default.events.SCROLL_OPTIMIZE,(function(t,e){if(e.range){var n=e.range,r=n.startNode,o=n.startOffset,a=n.endNode,s=n.endOffset;i.setNativeRange(r,o,a,s)}})),this.update(l.default.sources.SILENT)}return r(t,[{key:"handleComposition",value:function(){var t=this;this.root.addEventListener("compositionstart",(function(){t.composing=!0})),this.root.addEventListener("compositionend",(function(){if(t.composing=!1,t.cursor.parent){var e=t.cursor.restore();if(!e)return;setTimeout((function(){t.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)}),1)}}))}},{key:"handleDragging",value:function(){var t=this;this.emitter.listenDOM("mousedown",document.body,(function(){t.mouseDown=!0})),this.emitter.listenDOM("mouseup",document.body,(function(){t.mouseDown=!1,t.update(l.default.sources.USER)}))}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(t,e){if(null==this.scroll.whitelist||this.scroll.whitelist[t]){this.scroll.update();var n=this.getNativeRange();if(null!=n&&n.native.collapsed&&!o.default.query(t,o.default.Scope.BLOCK)){if(n.start.node!==this.cursor.textNode){var i=o.default.find(n.start.node,!1);if(null==i)return;if(i instanceof o.default.Leaf){var r=i.split(n.start.offset);i.parent.insertBefore(this.cursor,r)}else i.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(t,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.scroll.length();t=Math.min(t,n-1),e=Math.min(t+e,n-1)-t;var r=void 0,o=this.scroll.leaf(t),a=i(o,2),s=a[0],l=a[1];if(null==s)return null;var u=s.position(l,!0),c=i(u,2);r=c[0],l=c[1];var d=document.createRange();if(e>0){d.setStart(r,l);var f=this.scroll.leaf(t+e),p=i(f,2);if(s=p[0],l=p[1],null==s)return null;var h=s.position(l,!0),g=i(h,2);return r=g[0],l=g[1],d.setEnd(r,l),d.getBoundingClientRect()}var v="left",y=void 0;return r instanceof Text?(l<r.data.length?(d.setStart(r,l),d.setEnd(r,l+1)):(d.setStart(r,l-1),d.setEnd(r,l),v="right"),y=d.getBoundingClientRect()):(y=s.domNode.getBoundingClientRect(),l>0&&(v="right")),{bottom:y.top+y.height,height:y.height,left:y[v],right:y[v],top:y.top,width:0}}},{key:"getNativeRange",value:function(){var t=document.getSelection();if(null==t||t.rangeCount<=0)return null;var e=t.getRangeAt(0);if(null==e)return null;var n=this.normalizeNative(e);return f.info("getNativeRange",n),n}},{key:"getRange",value:function(){var t=this.getNativeRange();return null==t?[null,null]:[this.normalizedToRange(t),t]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(t){var e=this,n=[[t.start.node,t.start.offset]];t.native.collapsed||n.push([t.end.node,t.end.offset]);var r=n.map((function(t){var n=i(t,2),r=n[0],a=n[1],s=o.default.find(r,!0),l=s.offset(e.scroll);return 0===a?l:s instanceof o.default.Container?l+s.length():l+s.index(r,a)})),a=Math.min(Math.max.apply(Math,c(r)),this.scroll.length()-1),s=Math.min.apply(Math,[a].concat(c(r)));return new p(s,a-s)}},{key:"normalizeNative",value:function(t){if(!g(this.root,t.startContainer)||!t.collapsed&&!g(this.root,t.endContainer))return null;var e={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[e.start,e.end].forEach((function(t){for(var e=t.node,n=t.offset;!(e instanceof Text)&&e.childNodes.length>0;)if(e.childNodes.length>n)e=e.childNodes[n],n=0;else{if(e.childNodes.length!==n)break;n=(e=e.lastChild)instanceof Text?e.data.length:e.childNodes.length+1}t.node=e,t.offset=n})),e}},{key:"rangeToNative",value:function(t){var e=this,n=t.collapsed?[t.index]:[t.index,t.index+t.length],r=[],o=this.scroll.length();return n.forEach((function(t,n){t=Math.min(o-1,t);var a,s=e.scroll.leaf(t),l=i(s,2),u=l[0],c=l[1],d=u.position(c,0!==n),f=i(d,2);a=f[0],c=f[1],r.push(a,c)})),r.length<2&&(r=r.concat(r)),r}},{key:"scrollIntoView",value:function(t){var e=this.lastRange;if(null!=e){var n=this.getBounds(e.index,e.length);if(null!=n){var r=this.scroll.length()-1,o=this.scroll.line(Math.min(e.index,r)),a=i(o,1)[0],s=a;if(e.length>0){var l=this.scroll.line(Math.min(e.index+e.length,r));s=i(l,1)[0]}if(null!=a&&null!=s){var u=t.getBoundingClientRect();n.top<u.top?t.scrollTop-=u.top-n.top:n.bottom>u.bottom&&(t.scrollTop+=n.bottom-u.bottom)}}}}},{key:"setNativeRange",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(f.info("setNativeRange",t,e,n,i),null==t||null!=this.root.parentNode&&null!=t.parentNode&&null!=n.parentNode){var o=document.getSelection();if(null!=o)if(null!=t){this.hasFocus()||this.root.focus();var a=(this.getNativeRange()||{}).native;if(null==a||r||t!==a.startContainer||e!==a.startOffset||n!==a.endContainer||i!==a.endOffset){"BR"==t.tagName&&(e=[].indexOf.call(t.parentNode.childNodes,t),t=t.parentNode),"BR"==n.tagName&&(i=[].indexOf.call(n.parentNode.childNodes,n),n=n.parentNode);var s=document.createRange();s.setStart(t,e),s.setEnd(n,i),o.removeAllRanges(),o.addRange(s)}}else o.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.default.sources.API;if("string"==typeof e&&(n=e,e=!1),f.info("setRange",t),null!=t){var i=this.rangeToNative(t);this.setNativeRange.apply(this,c(i).concat([e]))}else this.setNativeRange(null);this.update(n)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.default.sources.USER,e=this.lastRange,n=this.getRange(),r=i(n,2),o=r[0],u=r[1];if(this.lastRange=o,null!=this.lastRange&&(this.savedRange=this.lastRange),!(0,s.default)(e,this.lastRange)){var c;!this.composing&&null!=u&&u.native.collapsed&&u.start.node!==this.cursor.textNode&&this.cursor.restore();var d,f=[l.default.events.SELECTION_CHANGE,(0,a.default)(this.lastRange),(0,a.default)(e),t];(c=this.emitter).emit.apply(c,[l.default.events.EDITOR_CHANGE].concat(f)),t!==l.default.sources.SILENT&&(d=this.emitter).emit.apply(d,f)}}}]),t}();function g(t,e){try{e.parentNode}catch(t){return!1}return e instanceof Text&&(e=e.parentNode),t.contains(e)}e.Range=p,e.default=h},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(0),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"insertInto",value:function(t,n){0===t.children.length?o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insertInto",this).call(this,t,n):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),e}(((i=a)&&i.__esModule?i:{default:i}).default.Embed);s.blotName="break",s.tagName="BR",e.default=s},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(44),a=n(30),s=n(1),l=function(t){function e(e){var n=t.call(this,e)||this;return n.build(),n}return r(e,t),e.prototype.appendChild=function(t){this.insertBefore(t)},e.prototype.attach=function(){t.prototype.attach.call(this),this.children.forEach((function(t){t.attach()}))},e.prototype.build=function(){var t=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach((function(e){try{var n=u(e);t.insertBefore(n,t.children.head||void 0)}catch(t){if(t instanceof s.ParchmentError)return;throw t}}))},e.prototype.deleteAt=function(t,e){if(0===t&&e===this.length())return this.remove();this.children.forEachAt(t,e,(function(t,e,n){t.deleteAt(e,n)}))},e.prototype.descendant=function(t,n){var i=this.children.find(n),r=i[0],o=i[1];return null==t.blotName&&t(r)||null!=t.blotName&&r instanceof t?[r,o]:r instanceof e?r.descendant(t,o):[null,-1]},e.prototype.descendants=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=Number.MAX_VALUE);var r=[],o=i;return this.children.forEachAt(n,i,(function(n,i,a){(null==t.blotName&&t(n)||null!=t.blotName&&n instanceof t)&&r.push(n),n instanceof e&&(r=r.concat(n.descendants(t,i,o))),o-=a})),r},e.prototype.detach=function(){this.children.forEach((function(t){t.detach()})),t.prototype.detach.call(this)},e.prototype.formatAt=function(t,e,n,i){this.children.forEachAt(t,e,(function(t,e,r){t.formatAt(e,r,n,i)}))},e.prototype.insertAt=function(t,e,n){var i=this.children.find(t),r=i[0],o=i[1];if(r)r.insertAt(o,e,n);else{var a=null==n?s.create("text",e):s.create(e,n);this.appendChild(a)}},e.prototype.insertBefore=function(t,e){if(null!=this.statics.allowedChildren&&!this.statics.allowedChildren.some((function(e){return t instanceof e})))throw new s.ParchmentError("Cannot insert "+t.statics.blotName+" into "+this.statics.blotName);t.insertInto(this,e)},e.prototype.length=function(){return this.children.reduce((function(t,e){return t+e.length()}),0)},e.prototype.moveChildren=function(t,e){this.children.forEach((function(n){t.insertBefore(n,e)}))},e.prototype.optimize=function(e){if(t.prototype.optimize.call(this,e),0===this.children.length)if(null!=this.statics.defaultChild){var n=s.create(this.statics.defaultChild);this.appendChild(n),n.optimize(e)}else this.remove()},e.prototype.path=function(t,n){void 0===n&&(n=!1);var i=this.children.find(t,n),r=i[0],o=i[1],a=[[this,t]];return r instanceof e?a.concat(r.path(o,n)):(null!=r&&a.push([r,o]),a)},e.prototype.removeChild=function(t){this.children.remove(t)},e.prototype.replace=function(n){n instanceof e&&n.moveChildren(this),t.prototype.replace.call(this,n)},e.prototype.split=function(t,e){if(void 0===e&&(e=!1),!e){if(0===t)return this;if(t===this.length())return this.next}var n=this.clone();return this.parent.insertBefore(n,this.next),this.children.forEachAt(t,this.length(),(function(t,i,r){t=t.split(i,e),n.appendChild(t)})),n},e.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},e.prototype.update=function(t,e){var n=this,i=[],r=[];t.forEach((function(t){t.target===n.domNode&&"childList"===t.type&&(i.push.apply(i,t.addedNodes),r.push.apply(r,t.removedNodes))})),r.forEach((function(t){if(!(null!=t.parentNode&&"IFRAME"!==t.tagName&&document.body.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var e=s.find(t);null!=e&&(null!=e.domNode.parentNode&&e.domNode.parentNode!==n.domNode||e.detach())}})),i.filter((function(t){return t.parentNode==n.domNode})).sort((function(t,e){return t===e?0:t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1})).forEach((function(t){var e=null;null!=t.nextSibling&&(e=s.find(t.nextSibling));var i=u(t);i.next==e&&null!=i.next||(null!=i.parent&&i.parent.removeChild(n),n.insertBefore(i,e||void 0))}))},e}(a.default);function u(t){var e=s.find(t);if(null==e)try{e=s.create(t)}catch(n){e=s.create(s.Scope.INLINE),[].slice.call(t.childNodes).forEach((function(t){e.domNode.appendChild(t)})),t.parentNode&&t.parentNode.replaceChild(e.domNode,t),e.attach()}return e}e.default=l},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(12),a=n(31),s=n(17),l=n(1),u=function(t){function e(e){var n=t.call(this,e)||this;return n.attributes=new a.default(n.domNode),n}return r(e,t),e.formats=function(t){return"string"==typeof this.tagName||(Array.isArray(this.tagName)?t.tagName.toLowerCase():void 0)},e.prototype.format=function(t,e){var n=l.query(t);n instanceof o.default?this.attributes.attribute(n,e):e&&(null==n||t===this.statics.blotName&&this.formats()[t]===e||this.replaceWith(t,e))},e.prototype.formats=function(){var t=this.attributes.values(),e=this.statics.formats(this.domNode);return null!=e&&(t[this.statics.blotName]=e),t},e.prototype.replaceWith=function(e,n){var i=t.prototype.replaceWith.call(this,e,n);return this.attributes.copy(i),i},e.prototype.update=function(e,n){var i=this;t.prototype.update.call(this,e,n),e.some((function(t){return t.target===i.domNode&&"attributes"===t.type}))&&this.attributes.build()},e.prototype.wrap=function(n,i){var r=t.prototype.wrap.call(this,n,i);return r instanceof e&&r.statics.scope===this.statics.scope&&this.attributes.move(r),r},e}(s.default);e.default=u},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(30),a=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.value=function(t){return!0},e.prototype.index=function(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1},e.prototype.position=function(t,e){var n=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return t>0&&(n+=1),[this.parent.domNode,n]},e.prototype.value=function(){var t;return(t={})[this.statics.blotName]=this.statics.value(this.domNode)||!0,t},e.scope=a.Scope.INLINE_BLOT,e}(o.default);e.default=s},function(t,e,n){var i=n(11),r=n(3),o={attributes:{compose:function(t,e,n){"object"!=typeof t&&(t={}),"object"!=typeof e&&(e={});var i=r(!0,{},e);for(var o in n||(i=Object.keys(i).reduce((function(t,e){return null!=i[e]&&(t[e]=i[e]),t}),{})),t)void 0!==t[o]&&void 0===e[o]&&(i[o]=t[o]);return Object.keys(i).length>0?i:void 0},diff:function(t,e){"object"!=typeof t&&(t={}),"object"!=typeof e&&(e={});var n=Object.keys(t).concat(Object.keys(e)).reduce((function(n,r){return i(t[r],e[r])||(n[r]=void 0===e[r]?null:e[r]),n}),{});return Object.keys(n).length>0?n:void 0},transform:function(t,e,n){if("object"!=typeof t)return e;if("object"==typeof e){if(!n)return e;var i=Object.keys(e).reduce((function(n,i){return void 0===t[i]&&(n[i]=e[i]),n}),{});return Object.keys(i).length>0?i:void 0}}},iterator:function(t){return new a(t)},length:function(t){return"number"==typeof t.delete?t.delete:"number"==typeof t.retain?t.retain:"string"==typeof t.insert?t.insert.length:1}};function a(t){this.ops=t,this.index=0,this.offset=0}a.prototype.hasNext=function(){return this.peekLength()<1/0},a.prototype.next=function(t){t||(t=1/0);var e=this.ops[this.index];if(e){var n=this.offset,i=o.length(e);if(t>=i-n?(t=i-n,this.index+=1,this.offset=0):this.offset+=t,"number"==typeof e.delete)return{delete:t};var r={};return e.attributes&&(r.attributes=e.attributes),"number"==typeof e.retain?r.retain=t:"string"==typeof e.insert?r.insert=e.insert.substr(n,t):r.insert=e.insert,r}return{retain:1/0}},a.prototype.peek=function(){return this.ops[this.index]},a.prototype.peekLength=function(){return this.ops[this.index]?o.length(this.ops[this.index])-this.offset:1/0},a.prototype.peekType=function(){return this.ops[this.index]?"number"==typeof this.ops[this.index].delete?"delete":"number"==typeof this.ops[this.index].retain?"retain":"insert":"retain"},a.prototype.rest=function(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);var t=this.offset,e=this.index,n=this.next(),i=this.ops.slice(this.index);return this.offset=t,this.index=e,[n].concat(i)}return[]},t.exports=o},function(t,e){var n=function(){function t(t,e){return null!=e&&t instanceof e}var e,n,i;try{e=Map}catch(t){e=function(){}}try{n=Set}catch(t){n=function(){}}try{i=Promise}catch(t){i=function(){}}function r(o,s,l,u,c){"object"==typeof s&&(l=s.depth,u=s.prototype,c=s.includeNonEnumerable,s=s.circular);var d=[],f=[],p="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===l&&(l=1/0),function o(l,h){if(null===l)return null;if(0===h)return l;var g,v;if("object"!=typeof l)return l;if(t(l,e))g=new e;else if(t(l,n))g=new n;else if(t(l,i))g=new i((function(t,e){l.then((function(e){t(o(e,h-1))}),(function(t){e(o(t,h-1))}))}));else if(r.__isArray(l))g=[];else if(r.__isRegExp(l))g=new RegExp(l.source,a(l)),l.lastIndex&&(g.lastIndex=l.lastIndex);else if(r.__isDate(l))g=new Date(l.getTime());else{if(p&&Buffer.isBuffer(l))return g=Buffer.allocUnsafe?Buffer.allocUnsafe(l.length):new Buffer(l.length),l.copy(g),g;t(l,Error)?g=Object.create(l):void 0===u?(v=Object.getPrototypeOf(l),g=Object.create(v)):(g=Object.create(u),v=u)}if(s){var y=d.indexOf(l);if(-1!=y)return f[y];d.push(l),f.push(g)}for(var b in t(l,e)&&l.forEach((function(t,e){var n=o(e,h-1),i=o(t,h-1);g.set(n,i)})),t(l,n)&&l.forEach((function(t){var e=o(t,h-1);g.add(e)})),l){var m;v&&(m=Object.getOwnPropertyDescriptor(v,b)),m&&null==m.set||(g[b]=o(l[b],h-1))}if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(l);for(b=0;b<E.length;b++){var w=E[b];(!(O=Object.getOwnPropertyDescriptor(l,w))||O.enumerable||c)&&(g[w]=o(l[w],h-1),O.enumerable||Object.defineProperty(g,w,{enumerable:!1}))}}if(c){var _=Object.getOwnPropertyNames(l);for(b=0;b<_.length;b++){var O,T=_[b];(O=Object.getOwnPropertyDescriptor(l,T))&&O.enumerable||(g[T]=o(l[T],h-1),Object.defineProperty(g,T,{enumerable:!1}))}}return g}(o,l)}function o(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return r.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},r.__objToStr=o,r.__isDate=function(t){return"object"==typeof t&&"[object Date]"===o(t)},r.__isArray=function(t){return"object"==typeof t&&"[object Array]"===o(t)},r.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===o(t)},r.__getRegExpFlags=a,r}();"object"==typeof t&&t.exports&&(t.exports=n)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=p(n(0)),s=p(n(8)),l=n(4),u=p(l),c=p(n(16)),d=p(n(13)),f=p(n(25));function p(t){return t&&t.__esModule?t:{default:t}}function h(t){return t instanceof u.default||t instanceof l.BlockEmbed}var g=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.emitter=n.emitter,Array.isArray(n.whitelist)&&(i.whitelist=n.whitelist.reduce((function(t,e){return t[e]=!0,t}),{})),i.domNode.addEventListener("DOMNodeInserted",(function(){})),i.optimize(),i.enable(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(t,n){var r=this.line(t),a=i(r,2),s=a[0],u=a[1],f=this.line(t+n),p=i(f,1)[0];if(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"deleteAt",this).call(this,t,n),null!=p&&s!==p&&u>0){if(s instanceof l.BlockEmbed||p instanceof l.BlockEmbed)return void this.optimize();if(s instanceof d.default){var h=s.newlineIndex(s.length(),!0);if(h>-1&&(s=s.split(h+1))===p)return void this.optimize()}else if(p instanceof d.default){var g=p.newlineIndex(0);g>-1&&p.split(g+1)}var v=p.children.head instanceof c.default?null:p.children.head;s.moveChildren(p,v),s.remove()}this.optimize()}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.domNode.setAttribute("contenteditable",t)}},{key:"formatAt",value:function(t,n,i,r){(null==this.whitelist||this.whitelist[i])&&(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"formatAt",this).call(this,t,n,i,r),this.optimize())}},{key:"insertAt",value:function(t,n,i){if(null==i||null==this.whitelist||this.whitelist[n]){if(t>=this.length())if(null==i||null==a.default.query(n,a.default.Scope.BLOCK)){var r=a.default.create(this.statics.defaultChild);this.appendChild(r),null==i&&n.endsWith("\n")&&(n=n.slice(0,-1)),r.insertAt(0,n,i)}else{var s=a.default.create(n,i);this.appendChild(s)}else o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insertAt",this).call(this,t,n,i);this.optimize()}}},{key:"insertBefore",value:function(t,n){if(t.statics.scope===a.default.Scope.INLINE_BLOT){var i=a.default.create(this.statics.defaultChild);i.appendChild(t),t=i}o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insertBefore",this).call(this,t,n)}},{key:"leaf",value:function(t){return this.path(t).pop()||[null,-1]}},{key:"line",value:function(t){return t===this.length()?this.line(t-1):this.descendant(h,t)}},{key:"lines",value:function(){return function t(e,n,i){var r=[],o=i;return e.children.forEachAt(n,i,(function(e,n,i){h(e)?r.push(e):e instanceof a.default.Container&&(r=r.concat(t(e,n,o))),o-=i})),r}(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE)}},{key:"optimize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!0!==this.batch&&(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"optimize",this).call(this,t,n),t.length>0&&this.emitter.emit(s.default.events.SCROLL_OPTIMIZE,t,n))}},{key:"path",value:function(t){return o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"path",this).call(this,t).slice(1)}},{key:"update",value:function(t){if(!0!==this.batch){var n=s.default.sources.USER;"string"==typeof t&&(n=t),Array.isArray(t)||(t=this.observer.takeRecords()),t.length>0&&this.emitter.emit(s.default.events.SCROLL_BEFORE_UPDATE,n,t),o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t.concat([])),t.length>0&&this.emitter.emit(s.default.events.SCROLL_UPDATE,n,t)}}}]),e}(a.default.Scroll);g.blotName="scroll",g.className="ql-editor",g.tagName="DIV",g.defaultChild="block",g.allowedChildren=[u.default,l.BlockEmbed,f.default],e.default=g},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SHORTKEY=e.default=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=g(n(21)),s=g(n(11)),l=g(n(3)),u=g(n(2)),c=g(n(20)),d=g(n(0)),f=g(n(5)),p=g(n(10)),h=g(n(9));function g(t){return t&&t.__esModule?t:{default:t}}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=(0,p.default)("quill:keyboard"),b=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",m=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.bindings={},Object.keys(i.options.bindings).forEach((function(e){("list autofill"!==e||null==t.scroll.whitelist||t.scroll.whitelist.list)&&i.options.bindings[e]&&i.addBinding(i.options.bindings[e])})),i.addBinding({key:e.keys.ENTER,shiftKey:null},T),i.addBinding({key:e.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},(function(){})),/Firefox/i.test(navigator.userAgent)?(i.addBinding({key:e.keys.BACKSPACE},{collapsed:!0},w),i.addBinding({key:e.keys.DELETE},{collapsed:!0},_)):(i.addBinding({key:e.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},w),i.addBinding({key:e.keys.DELETE},{collapsed:!0,suffix:/^.?$/},_)),i.addBinding({key:e.keys.BACKSPACE},{collapsed:!1},O),i.addBinding({key:e.keys.DELETE},{collapsed:!1},O),i.addBinding({key:e.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},w),i.listen(),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,null,[{key:"match",value:function(t,e){return e=S(e),!["altKey","ctrlKey","metaKey","shiftKey"].some((function(n){return!!e[n]!==t[n]&&null!==e[n]}))&&e.key===(t.which||t.keyCode)}}]),o(e,[{key:"addBinding",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=S(t);if(null==i||null==i.key)return y.warn("Attempted to add invalid keyboard binding",i);"function"==typeof e&&(e={handler:e}),"function"==typeof n&&(n={handler:n}),i=(0,l.default)(i,e,n),this.bindings[i.key]=this.bindings[i.key]||[],this.bindings[i.key].push(i)}},{key:"listen",value:function(){var t=this;this.quill.root.addEventListener("keydown",(function(n){if(!n.defaultPrevented){var o=n.which||n.keyCode,a=(t.bindings[o]||[]).filter((function(t){return e.match(n,t)}));if(0!==a.length){var l=t.quill.getSelection();if(null!=l&&t.quill.hasFocus()){var u=t.quill.getLine(l.index),c=r(u,2),f=c[0],p=c[1],h=t.quill.getLeaf(l.index),g=r(h,2),v=g[0],y=g[1],b=0===l.length?[v,y]:t.quill.getLeaf(l.index+l.length),m=r(b,2),E=m[0],w=m[1],_=v instanceof d.default.Text?v.value().slice(0,y):"",O=E instanceof d.default.Text?E.value().slice(w):"",T={collapsed:0===l.length,empty:0===l.length&&f.length()<=1,format:t.quill.getFormat(l),offset:p,prefix:_,suffix:O};a.some((function(e){if(null!=e.collapsed&&e.collapsed!==T.collapsed)return!1;if(null!=e.empty&&e.empty!==T.empty)return!1;if(null!=e.offset&&e.offset!==T.offset)return!1;if(Array.isArray(e.format)){if(e.format.every((function(t){return null==T.format[t]})))return!1}else if("object"===i(e.format)&&!Object.keys(e.format).every((function(t){return!0===e.format[t]?null!=T.format[t]:!1===e.format[t]?null==T.format[t]:(0,s.default)(e.format[t],T.format[t])})))return!1;return!(null!=e.prefix&&!e.prefix.test(T.prefix)||null!=e.suffix&&!e.suffix.test(T.suffix)||!0===e.handler.call(t,l,T))}))&&n.preventDefault()}}}}))}}]),e}(h.default);function E(t,e){var n,i=t===m.keys.LEFT?"prefix":"suffix";return v(n={key:t,shiftKey:e,altKey:null},i,/^$/),v(n,"handler",(function(n){var i=n.index;t===m.keys.RIGHT&&(i+=n.length+1);var o=this.quill.getLeaf(i);return!(r(o,1)[0]instanceof d.default.Embed&&(t===m.keys.LEFT?e?this.quill.setSelection(n.index-1,n.length+1,f.default.sources.USER):this.quill.setSelection(n.index-1,f.default.sources.USER):e?this.quill.setSelection(n.index,n.length+1,f.default.sources.USER):this.quill.setSelection(n.index+n.length+1,f.default.sources.USER),1))})),n}function w(t,e){if(!(0===t.index||this.quill.getLength()<=1)){var n=this.quill.getLine(t.index),i=r(n,1)[0],o={};if(0===e.offset){var a=this.quill.getLine(t.index-1),s=r(a,1)[0];if(null!=s&&s.length()>1){var l=i.formats(),u=this.quill.getFormat(t.index-1,1);o=c.default.attributes.diff(l,u)||{}}}var d=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;this.quill.deleteText(t.index-d,d,f.default.sources.USER),Object.keys(o).length>0&&this.quill.formatLine(t.index-d,d,o,f.default.sources.USER),this.quill.focus()}}function _(t,e){var n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(!(t.index>=this.quill.getLength()-n)){var i={},o=0,a=this.quill.getLine(t.index),s=r(a,1)[0];if(e.offset>=s.length()-1){var l=this.quill.getLine(t.index+1),u=r(l,1)[0];if(u){var d=s.formats(),p=this.quill.getFormat(t.index,1);i=c.default.attributes.diff(d,p)||{},o=u.length()}}this.quill.deleteText(t.index,n,f.default.sources.USER),Object.keys(i).length>0&&this.quill.formatLine(t.index+o-1,n,i,f.default.sources.USER)}}function O(t){var e=this.quill.getLines(t),n={};if(e.length>1){var i=e[0].formats(),r=e[e.length-1].formats();n=c.default.attributes.diff(r,i)||{}}this.quill.deleteText(t,f.default.sources.USER),Object.keys(n).length>0&&this.quill.formatLine(t.index,1,n,f.default.sources.USER),this.quill.setSelection(t.index,f.default.sources.SILENT),this.quill.focus()}function T(t,e){var n=this;t.length>0&&this.quill.scroll.deleteAt(t.index,t.length);var i=Object.keys(e.format).reduce((function(t,n){return d.default.query(n,d.default.Scope.BLOCK)&&!Array.isArray(e.format[n])&&(t[n]=e.format[n]),t}),{});this.quill.insertText(t.index,"\n",i,f.default.sources.USER),this.quill.setSelection(t.index+1,f.default.sources.SILENT),this.quill.focus(),Object.keys(e.format).forEach((function(t){null==i[t]&&(Array.isArray(e.format[t])||"link"!==t&&n.quill.format(t,e.format[t],f.default.sources.USER))}))}function x(t){return{key:m.keys.TAB,shiftKey:!t,format:{"code-block":!0},handler:function(e){var n=d.default.query("code-block"),i=e.index,o=e.length,a=this.quill.scroll.descendant(n,i),s=r(a,2),l=s[0],u=s[1];if(null!=l){var c=this.quill.getIndex(l),p=l.newlineIndex(u,!0)+1,h=l.newlineIndex(c+u+o),g=l.domNode.textContent.slice(p,h).split("\n");u=0,g.forEach((function(e,r){t?(l.insertAt(p+u,n.TAB),u+=n.TAB.length,0===r?i+=n.TAB.length:o+=n.TAB.length):e.startsWith(n.TAB)&&(l.deleteAt(p+u,n.TAB.length),u-=n.TAB.length,0===r?i-=n.TAB.length:o-=n.TAB.length),u+=e.length+1})),this.quill.update(f.default.sources.USER),this.quill.setSelection(i,o,f.default.sources.SILENT)}}}}function A(t){return{key:t[0].toUpperCase(),shortKey:!0,handler:function(e,n){this.quill.format(t,!n.format[t],f.default.sources.USER)}}}function S(t){if("string"==typeof t||"number"==typeof t)return S({key:t});if("object"===(void 0===t?"undefined":i(t))&&(t=(0,a.default)(t,!1)),"string"==typeof t.key)if(null!=m.keys[t.key.toUpperCase()])t.key=m.keys[t.key.toUpperCase()];else{if(1!==t.key.length)return null;t.key=t.key.toUpperCase().charCodeAt(0)}return t.shortKey&&(t[b]=t.shortKey,delete t.shortKey),t}m.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},m.DEFAULTS={bindings:{bold:A("bold"),italic:A("italic"),underline:A("underline"),indent:{key:m.keys.TAB,format:["blockquote","indent","list"],handler:function(t,e){if(e.collapsed&&0!==e.offset)return!0;this.quill.format("indent","+1",f.default.sources.USER)}},outdent:{key:m.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(t,e){if(e.collapsed&&0!==e.offset)return!0;this.quill.format("indent","-1",f.default.sources.USER)}},"outdent backspace":{key:m.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(t,e){null!=e.format.indent?this.quill.format("indent","-1",f.default.sources.USER):null!=e.format.list&&this.quill.format("list",!1,f.default.sources.USER)}},"indent code-block":x(!0),"outdent code-block":x(!1),"remove tab":{key:m.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(t){this.quill.deleteText(t.index-1,1,f.default.sources.USER)}},tab:{key:m.keys.TAB,handler:function(t){this.quill.history.cutoff();var e=(new u.default).retain(t.index).delete(t.length).insert("\t");this.quill.updateContents(e,f.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index+1,f.default.sources.SILENT)}},"list empty enter":{key:m.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(t,e){this.quill.format("list",!1,f.default.sources.USER),e.format.indent&&this.quill.format("indent",!1,f.default.sources.USER)}},"checklist enter":{key:m.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(t){var e=this.quill.getLine(t.index),n=r(e,2),i=n[0],o=n[1],a=(0,l.default)({},i.formats(),{list:"checked"}),s=(new u.default).retain(t.index).insert("\n",a).retain(i.length()-o-1).retain(1,{list:"unchecked"});this.quill.updateContents(s,f.default.sources.USER),this.quill.setSelection(t.index+1,f.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:m.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(t,e){var n=this.quill.getLine(t.index),i=r(n,2),o=i[0],a=i[1],s=(new u.default).retain(t.index).insert("\n",e.format).retain(o.length()-a-1).retain(1,{header:null});this.quill.updateContents(s,f.default.sources.USER),this.quill.setSelection(t.index+1,f.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(t,e){var n=e.prefix.length,i=this.quill.getLine(t.index),o=r(i,2),a=o[0],s=o[1];if(s>n)return!0;var l=void 0;switch(e.prefix.trim()){case"[]":case"[ ]":l="unchecked";break;case"[x]":l="checked";break;case"-":case"*":l="bullet";break;default:l="ordered"}this.quill.insertText(t.index," ",f.default.sources.USER),this.quill.history.cutoff();var c=(new u.default).retain(t.index-s).delete(n+1).retain(a.length()-2-s).retain(1,{list:l});this.quill.updateContents(c,f.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(t.index-n,f.default.sources.SILENT)}},"code exit":{key:m.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(t){var e=this.quill.getLine(t.index),n=r(e,2),i=n[0],o=n[1],a=(new u.default).retain(t.index+i.length()-o-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(a,f.default.sources.USER)}},"embed left":E(m.keys.LEFT,!1),"embed left shift":E(m.keys.LEFT,!0),"embed right":E(m.keys.RIGHT,!1),"embed right shift":E(m.keys.RIGHT,!0)}},e.default=m,e.SHORTKEY=b},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=l(n(0)),s=l(n(7));function l(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.selection=n,i.textNode=document.createTextNode(e.CONTENTS),i.domNode.appendChild(i.textNode),i._length=0,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,null,[{key:"value",value:function(){}}]),o(e,[{key:"detach",value:function(){null!=this.parent&&this.parent.removeChild(this)}},{key:"format",value:function(t,n){if(0!==this._length)return r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"format",this).call(this,t,n);for(var i=this,o=0;null!=i&&i.statics.scope!==a.default.Scope.BLOCK_BLOT;)o+=i.offset(i.parent),i=i.parent;null!=i&&(this._length=e.CONTENTS.length,i.optimize(),i.formatAt(o,e.CONTENTS.length,t,n),this._length=0)}},{key:"index",value:function(t,n){return t===this.textNode?0:r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"index",this).call(this,t,n)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!this.selection.composing&&null!=this.parent){var t=this.textNode,n=this.selection.getNativeRange(),r=void 0,o=void 0,l=void 0;if(null!=n&&n.start.node===t&&n.end.node===t){var u=[t,n.start.offset,n.end.offset];r=u[0],o=u[1],l=u[2]}for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==e.CONTENTS){var c=this.textNode.data.split(e.CONTENTS).join("");this.next instanceof s.default?(r=this.next.domNode,this.next.insertAt(0,c),this.textNode.data=e.CONTENTS):(this.textNode.data=c,this.parent.insertBefore(a.default.create(this.textNode),this),this.textNode=document.createTextNode(e.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),null!=o){var d=[o,l].map((function(t){return Math.max(0,Math.min(r.data.length,t-1))})),f=i(d,2);return o=f[0],l=f[1],{startNode:r,startOffset:o,endNode:r,endOffset:l}}}}},{key:"update",value:function(t,e){var n=this;if(t.some((function(t){return"characterData"===t.type&&t.target===n.textNode}))){var i=this.restore();i&&(e.range=i)}}},{key:"value",value:function(){return""}}]),e}(a.default.Embed);u.blotName="cursor",u.className="ql-cursor",u.tagName="span",u.CONTENTS="\ufeff",e.default=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=a(n(0)),r=n(4),o=a(r);function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(i.default.Container);s.allowedChildren=[o.default,r.BlockEmbed,s],e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.ColorStyle=e.ColorClass=e.ColorAttributor=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(0),s=(i=a)&&i.__esModule?i:{default:i},l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"value",value:function(t){var n=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"value",this).call(this,t);return n.startsWith("rgb(")?(n=n.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+n.split(",").map((function(t){return("00"+parseInt(t).toString(16)).slice(-2)})).join("")):n}}]),e}(s.default.Attributor.Style),u=new s.default.Attributor.Class("color","ql-color",{scope:s.default.Scope.INLINE}),c=new l("color","color",{scope:s.default.Scope.INLINE});e.ColorAttributor=l,e.ColorClass=u,e.ColorStyle=c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.sanitize=e.default=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(6),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"format",value:function(t,n){if(t!==this.statics.blotName||!n)return o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"format",this).call(this,t,n);n=this.constructor.sanitize(n),this.domNode.setAttribute("href",n)}}],[{key:"create",value:function(t){var n=o(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,t);return t=this.sanitize(t),n.setAttribute("href",t),n.setAttribute("rel","noopener noreferrer"),n.setAttribute("target","_blank"),n}},{key:"formats",value:function(t){return t.getAttribute("href")}},{key:"sanitize",value:function(t){return l(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}}]),e}(((i=a)&&i.__esModule?i:{default:i}).default);function l(t,e){var n=document.createElement("a");n.href=t;var i=n.href.slice(0,n.href.indexOf(":"));return e.indexOf(i)>-1}s.blotName="link",s.tagName="A",s.SANITIZED_URL="about:blank",s.PROTOCOL_WHITELIST=["http","https","mailto","tel"],e.default=s,e.sanitize=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=s(n(23)),a=s(n(107));function s(t){return t&&t.__esModule?t:{default:t}}var l=0;function u(t,e){t.setAttribute(e,!("true"===t.getAttribute(e)))}var c=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",(function(){n.togglePicker()})),this.label.addEventListener("keydown",(function(t){switch(t.keyCode){case o.default.keys.ENTER:n.togglePicker();break;case o.default.keys.ESCAPE:n.escape(),t.preventDefault()}})),this.select.addEventListener("change",this.update.bind(this))}return r(t,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),u(this.label,"aria-expanded"),u(this.options,"aria-hidden")}},{key:"buildItem",value:function(t){var e=this,n=document.createElement("span");return n.tabIndex="0",n.setAttribute("role","button"),n.classList.add("ql-picker-item"),t.hasAttribute("value")&&n.setAttribute("data-value",t.getAttribute("value")),t.textContent&&n.setAttribute("data-label",t.textContent),n.addEventListener("click",(function(){e.selectItem(n,!0)})),n.addEventListener("keydown",(function(t){switch(t.keyCode){case o.default.keys.ENTER:e.selectItem(n,!0),t.preventDefault();break;case o.default.keys.ESCAPE:e.escape(),t.preventDefault()}})),n}},{key:"buildLabel",value:function(){var t=document.createElement("span");return t.classList.add("ql-picker-label"),t.innerHTML=a.default,t.tabIndex="0",t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),this.container.appendChild(t),t}},{key:"buildOptions",value:function(){var t=this,e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id="ql-picker-options-"+l,l+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,[].slice.call(this.select.options).forEach((function(n){var i=t.buildItem(n);e.appendChild(i),!0===n.selected&&t.selectItem(i)})),this.container.appendChild(e)}},{key:"buildPicker",value:function(){var t=this;[].slice.call(this.select.attributes).forEach((function(e){t.container.setAttribute(e.name,e.value)})),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var t=this;this.close(),setTimeout((function(){return t.label.focus()}),1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.container.querySelector(".ql-selected");if(t!==n&&(null!=n&&n.classList.remove("ql-selected"),null!=t&&(t.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(t.parentNode.children,t),t.hasAttribute("data-value")?this.label.setAttribute("data-value",t.getAttribute("data-value")):this.label.removeAttribute("data-value"),t.hasAttribute("data-label")?this.label.setAttribute("data-label",t.getAttribute("data-label")):this.label.removeAttribute("data-label"),e))){if("function"==typeof Event)this.select.dispatchEvent(new Event("change"));else if("object"===("undefined"==typeof Event?"undefined":i(Event))){var r=document.createEvent("Event");r.initEvent("change",!0,!0),this.select.dispatchEvent(r)}this.close()}}},{key:"update",value:function(){var t=void 0;if(this.select.selectedIndex>-1){var e=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];t=this.select.options[this.select.selectedIndex],this.selectItem(e)}else this.selectItem(null);var n=null!=t&&t!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",n)}}]),t}();e.default=c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=y(n(0)),r=y(n(5)),o=n(4),a=y(o),s=y(n(16)),l=y(n(25)),u=y(n(24)),c=y(n(35)),d=y(n(6)),f=y(n(22)),p=y(n(7)),h=y(n(55)),g=y(n(42)),v=y(n(23));function y(t){return t&&t.__esModule?t:{default:t}}r.default.register({"blots/block":a.default,"blots/block/embed":o.BlockEmbed,"blots/break":s.default,"blots/container":l.default,"blots/cursor":u.default,"blots/embed":c.default,"blots/inline":d.default,"blots/scroll":f.default,"blots/text":p.default,"modules/clipboard":h.default,"modules/history":g.default,"modules/keyboard":v.default}),i.default.register(a.default,s.default,u.default,d.default,f.default,p.default),e.default=r.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(){function t(t){this.domNode=t,this.domNode[i.DATA_KEY]={blot:this}}return Object.defineProperty(t.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),t.create=function(t){if(null==this.tagName)throw new i.ParchmentError("Blot definition missing tagName");var e;return Array.isArray(this.tagName)?("string"==typeof t&&(t=t.toUpperCase(),parseInt(t).toString()===t&&(t=parseInt(t))),e="number"==typeof t?document.createElement(this.tagName[t-1]):this.tagName.indexOf(t)>-1?document.createElement(t):document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e},t.prototype.attach=function(){null!=this.parent&&(this.scroll=this.parent.scroll)},t.prototype.clone=function(){var t=this.domNode.cloneNode(!1);return i.create(t)},t.prototype.detach=function(){null!=this.parent&&this.parent.removeChild(this),delete this.domNode[i.DATA_KEY]},t.prototype.deleteAt=function(t,e){this.isolate(t,e).remove()},t.prototype.formatAt=function(t,e,n,r){var o=this.isolate(t,e);if(null!=i.query(n,i.Scope.BLOT)&&r)o.wrap(n,r);else if(null!=i.query(n,i.Scope.ATTRIBUTE)){var a=i.create(this.statics.scope);o.wrap(a),a.format(n,r)}},t.prototype.insertAt=function(t,e,n){var r=null==n?i.create("text",e):i.create(e,n),o=this.split(t);this.parent.insertBefore(r,o)},t.prototype.insertInto=function(t,e){void 0===e&&(e=null),null!=this.parent&&this.parent.children.remove(this);var n=null;t.children.insertBefore(this,e),null!=e&&(n=e.domNode),this.domNode.parentNode==t.domNode&&this.domNode.nextSibling==n||t.domNode.insertBefore(this.domNode,n),this.parent=t,this.attach()},t.prototype.isolate=function(t,e){var n=this.split(t);return n.split(e),n},t.prototype.length=function(){return 1},t.prototype.offset=function(t){return void 0===t&&(t=this.parent),null==this.parent||this==t?0:this.parent.children.offset(this)+this.parent.offset(t)},t.prototype.optimize=function(t){null!=this.domNode[i.DATA_KEY]&&delete this.domNode[i.DATA_KEY].mutations},t.prototype.remove=function(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},t.prototype.replace=function(t){null!=t.parent&&(t.parent.insertBefore(this,t.next),t.remove())},t.prototype.replaceWith=function(t,e){var n="string"==typeof t?i.create(t,e):t;return n.replace(this),n},t.prototype.split=function(t,e){return 0===t?this:this.next},t.prototype.update=function(t,e){},t.prototype.wrap=function(t,e){var n="string"==typeof t?i.create(t,e):t;return null!=this.parent&&this.parent.insertBefore(n,this.next),n.appendChild(this),n},t.blotName="abstract",t}();e.default=r},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),r=n(32),o=n(33),a=n(1),s=function(){function t(t){this.attributes={},this.domNode=t,this.build()}return t.prototype.attribute=function(t,e){e?t.add(this.domNode,e)&&(null!=t.value(this.domNode)?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])},t.prototype.build=function(){var t=this;this.attributes={};var e=i.default.keys(this.domNode),n=r.default.keys(this.domNode),s=o.default.keys(this.domNode);e.concat(n).concat(s).forEach((function(e){var n=a.query(e,a.Scope.ATTRIBUTE);n instanceof i.default&&(t.attributes[n.attrName]=n)}))},t.prototype.copy=function(t){var e=this;Object.keys(this.attributes).forEach((function(n){var i=e.attributes[n].value(e.domNode);t.format(n,i)}))},t.prototype.move=function(t){var e=this;this.copy(t),Object.keys(this.attributes).forEach((function(t){e.attributes[t].remove(e.domNode)})),this.attributes={}},t.prototype.values=function(){var t=this;return Object.keys(this.attributes).reduce((function(e,n){return e[n]=t.attributes[n].value(t.domNode),e}),{})},t}();e.default=s},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function o(t,e){return(t.getAttribute("class")||"").split(/\s+/).filter((function(t){return 0===t.indexOf(e+"-")}))}Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.keys=function(t){return(t.getAttribute("class")||"").split(/\s+/).map((function(t){return t.split("-").slice(0,-1).join("-")}))},e.prototype.add=function(t,e){return!!this.canAdd(t,e)&&(this.remove(t),t.classList.add(this.keyName+"-"+e),!0)},e.prototype.remove=function(t){o(t,this.keyName).forEach((function(e){t.classList.remove(e)})),0===t.classList.length&&t.removeAttribute("class")},e.prototype.value=function(t){var e=(o(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""},e}(n(12).default);e.default=a},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});function o(t){var e=t.split("-"),n=e.slice(1).map((function(t){return t[0].toUpperCase()+t.slice(1)})).join("");return e[0]+n}Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.keys=function(t){return(t.getAttribute("style")||"").split(";").map((function(t){return t.split(":")[0].trim()}))},e.prototype.add=function(t,e){return!!this.canAdd(t,e)&&(t.style[o(this.keyName)]=e,!0)},e.prototype.remove=function(t){t.style[o(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")},e.prototype.value=function(t){var e=t.style[o(this.keyName)];return this.canAdd(t,e)?e:""},e}(n(12).default);e.default=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quill=e,this.options=n,this.modules={}}return i(t,[{key:"init",value:function(){var t=this;Object.keys(this.options.modules).forEach((function(e){null==t.modules[e]&&t.addModule(e)}))}},{key:"addModule",value:function(t){var e=this.quill.constructor.import("modules/"+t);return this.modules[t]=new e(this.quill,this.options.modules[t]||{}),this.modules[t]}}]),t}();r.DEFAULTS={modules:{}},r.themes={default:r},e.default=r},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=s(n(0)),a=s(n(7));function s(t){return t&&t.__esModule?t:{default:t}}var l="\ufeff",u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.contentNode=document.createElement("span"),n.contentNode.setAttribute("contenteditable",!1),[].slice.call(n.domNode.childNodes).forEach((function(t){n.contentNode.appendChild(t)})),n.leftGuard=document.createTextNode(l),n.rightGuard=document.createTextNode(l),n.domNode.appendChild(n.leftGuard),n.domNode.appendChild(n.contentNode),n.domNode.appendChild(n.rightGuard),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"index",value:function(t,n){return t===this.leftGuard?0:t===this.rightGuard?1:r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"index",this).call(this,t,n)}},{key:"restore",value:function(t){var e=void 0,n=void 0,i=t.data.split(l).join("");if(t===this.leftGuard)if(this.prev instanceof a.default){var r=this.prev.length();this.prev.insertAt(r,i),e={startNode:this.prev.domNode,startOffset:r+i.length}}else n=document.createTextNode(i),this.parent.insertBefore(o.default.create(n),this),e={startNode:n,startOffset:i.length};else t===this.rightGuard&&(this.next instanceof a.default?(this.next.insertAt(0,i),e={startNode:this.next.domNode,startOffset:i.length}):(n=document.createTextNode(i),this.parent.insertBefore(o.default.create(n),this.next),e={startNode:n,startOffset:i.length}));return t.data=l,e}},{key:"update",value:function(t,e){var n=this;t.forEach((function(t){if("characterData"===t.type&&(t.target===n.leftGuard||t.target===n.rightGuard)){var i=n.restore(t.target);i&&(e.range=i)}}))}}]),e}(o.default.Embed);e.default=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.AlignStyle=e.AlignClass=e.AlignAttribute=void 0;var i,r=n(0),o=(i=r)&&i.__esModule?i:{default:i},a={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},s=new o.default.Attributor.Attribute("align","align",a),l=new o.default.Attributor.Class("align","ql-align",a),u=new o.default.Attributor.Style("align","text-align",a);e.AlignAttribute=s,e.AlignClass=l,e.AlignStyle=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.BackgroundStyle=e.BackgroundClass=void 0;var i,r=n(0),o=(i=r)&&i.__esModule?i:{default:i},a=n(26),s=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),l=new a.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});e.BackgroundClass=s,e.BackgroundStyle=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.DirectionStyle=e.DirectionClass=e.DirectionAttribute=void 0;var i,r=n(0),o=(i=r)&&i.__esModule?i:{default:i},a={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},s=new o.default.Attributor.Attribute("direction","dir",a),l=new o.default.Attributor.Class("direction","ql-direction",a),u=new o.default.Attributor.Style("direction","direction",a);e.DirectionAttribute=s,e.DirectionClass=l,e.DirectionStyle=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.FontClass=e.FontStyle=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(0),s=(i=a)&&i.__esModule?i:{default:i},l={scope:s.default.Scope.INLINE,whitelist:["serif","monospace"]},u=new s.default.Attributor.Class("font","ql-font",l),c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"value",value:function(t){return o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"value",this).call(this,t).replace(/["']/g,"")}}]),e}(s.default.Attributor.Style),d=new c("font","font-family",l);e.FontStyle=d,e.FontClass=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.SizeStyle=e.SizeClass=void 0;var i,r=n(0),o=(i=r)&&i.__esModule?i:{default:i},a=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),s=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});e.SizeClass=a,e.SizeStyle=s},function(t,e,n){t.exports={align:{"":n(76),center:n(77),right:n(78),justify:n(79)},background:n(80),blockquote:n(81),bold:n(82),clean:n(83),code:n(58),"code-block":n(58),color:n(84),direction:{"":n(85),rtl:n(86)},float:{center:n(87),full:n(88),left:n(89),right:n(90)},formula:n(91),header:{1:n(92),2:n(93)},italic:n(94),image:n(95),indent:{"+1":n(96),"-1":n(97)},link:n(98),list:{ordered:n(99),bullet:n(100),check:n(101)},script:{sub:n(102),super:n(103)},strike:n(104),underline:n(105),video:n(106)}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.getLastChangeIndex=e.default=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=a(n(0)),o=a(n(5));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.lastRecorded=0,i.ignoreChange=!1,i.clear(),i.quill.on(o.default.events.EDITOR_CHANGE,(function(t,e,n,r){t!==o.default.events.TEXT_CHANGE||i.ignoreChange||(i.options.userOnly&&r!==o.default.sources.USER?i.transform(e):i.record(e,n))})),i.quill.keyboard.addBinding({key:"Z",shortKey:!0},i.undo.bind(i)),i.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},i.redo.bind(i)),/Win/i.test(navigator.platform)&&i.quill.keyboard.addBinding({key:"Y",shortKey:!0},i.redo.bind(i)),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),i(e,[{key:"change",value:function(t,e){if(0!==this.stack[t].length){var n=this.stack[t].pop();this.stack[e].push(n),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(n[t],o.default.sources.USER),this.ignoreChange=!1;var i=l(n[t]);this.quill.setSelection(i)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(t,e){if(0!==t.ops.length){this.stack.redo=[];var n=this.quill.getContents().diff(e),i=Date.now();if(this.lastRecorded+this.options.delay>i&&this.stack.undo.length>0){var r=this.stack.undo.pop();n=n.compose(r.undo),t=r.redo.compose(t)}else this.lastRecorded=i;this.stack.undo.push({redo:t,undo:n}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(t){this.stack.undo.forEach((function(e){e.undo=t.transform(e.undo,!0),e.redo=t.transform(e.redo,!0)})),this.stack.redo.forEach((function(e){e.undo=t.transform(e.undo,!0),e.redo=t.transform(e.redo,!0)}))}},{key:"undo",value:function(){this.change("undo","redo")}}]),e}(a(n(9)).default);function l(t){var e=t.reduce((function(t,e){return t+=e.delete||0}),0),n=t.length()-e;return function(t){var e=t.ops[t.ops.length-1];return null!=e&&(null!=e.insert?"string"==typeof e.insert&&e.insert.endsWith("\n"):null!=e.attributes&&Object.keys(e.attributes).some((function(t){return null!=r.default.query(t,r.default.Scope.BLOCK)})))}(t)&&(n-=1),n}s.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1},e.default=s,e.getLastChangeIndex=l},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.BaseTooltip=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=h(n(3)),a=h(n(2)),s=h(n(8)),l=h(n(23)),u=h(n(34)),c=h(n(59)),d=h(n(60)),f=h(n(28)),p=h(n(61));function h(t){return t&&t.__esModule?t:{default:t}}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var b=[!1,"center","right","justify"],m=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],E=[!1,"serif","monospace"],w=["1","2","3",!1],_=["small",!1,"large","huge"],O=function(t){function e(t,n){g(this,e);var i=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return t.emitter.listenDOM("click",document.body,(function e(n){if(!document.body.contains(t.root))return document.body.removeEventListener("click",e);null==i.tooltip||i.tooltip.root.contains(n.target)||document.activeElement===i.tooltip.textbox||i.quill.hasFocus()||i.tooltip.hide(),null!=i.pickers&&i.pickers.forEach((function(t){t.container.contains(n.target)||t.close()}))})),i}return y(e,t),i(e,[{key:"addModule",value:function(t){var n=r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"addModule",this).call(this,t);return"toolbar"===t&&this.extendToolbar(n),n}},{key:"buildButtons",value:function(t,e){t.forEach((function(t){(t.getAttribute("class")||"").split(/\s+/).forEach((function(n){if(n.startsWith("ql-")&&(n=n.slice("ql-".length),null!=e[n]))if("direction"===n)t.innerHTML=e[n][""]+e[n].rtl;else if("string"==typeof e[n])t.innerHTML=e[n];else{var i=t.value||"";null!=i&&e[n][i]&&(t.innerHTML=e[n][i])}}))}))}},{key:"buildPickers",value:function(t,e){var n=this;this.pickers=t.map((function(t){if(t.classList.contains("ql-align"))return null==t.querySelector("option")&&x(t,b),new d.default(t,e.align);if(t.classList.contains("ql-background")||t.classList.contains("ql-color")){var n=t.classList.contains("ql-background")?"background":"color";return null==t.querySelector("option")&&x(t,m,"background"===n?"#ffffff":"#000000"),new c.default(t,e[n])}return null==t.querySelector("option")&&(t.classList.contains("ql-font")?x(t,E):t.classList.contains("ql-header")?x(t,w):t.classList.contains("ql-size")&&x(t,_)),new f.default(t)})),this.quill.on(s.default.events.EDITOR_CHANGE,(function(){n.pickers.forEach((function(t){t.update()}))}))}}]),e}(u.default);O.DEFAULTS=(0,o.default)(!0,{},u.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var t=this,e=this.container.querySelector("input.ql-image[type=file]");null==e&&((e=document.createElement("input")).setAttribute("type","file"),e.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),e.classList.add("ql-image"),e.addEventListener("change",(function(){if(null!=e.files&&null!=e.files[0]){var n=new FileReader;n.onload=function(n){var i=t.quill.getSelection(!0);t.quill.updateContents((new a.default).retain(i.index).delete(i.length).insert({image:n.target.result}),s.default.sources.USER),t.quill.setSelection(i.index+1,s.default.sources.SILENT),e.value=""},n.readAsDataURL(e.files[0])}})),this.container.appendChild(e)),e.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var T=function(t){function e(t,n){g(this,e);var i=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.textbox=i.root.querySelector('input[type="text"]'),i.listen(),i}return y(e,t),i(e,[{key:"listen",value:function(){var t=this;this.textbox.addEventListener("keydown",(function(e){l.default.match(e,"enter")?(t.save(),e.preventDefault()):l.default.match(e,"escape")&&(t.cancel(),e.preventDefault())}))}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"link",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),null!=e?this.textbox.value=e:t!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+t)||""),this.root.setAttribute("data-mode",t)}},{key:"restoreFocus",value:function(){var t=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=t}},{key:"save",value:function(){var t,e,n=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":var i=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",n,s.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",n,s.default.sources.USER)),this.quill.root.scrollTop=i;break;case"video":n=(e=(t=n).match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/))?(e[1]||"https")+"://www.youtube.com/embed/"+e[2]+"?showinfo=0":(e=t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(e[1]||"https")+"://player.vimeo.com/video/"+e[2]+"/":t;case"formula":if(!n)break;var r=this.quill.getSelection(!0);if(null!=r){var o=r.index+r.length;this.quill.insertEmbed(o,this.root.getAttribute("data-mode"),n,s.default.sources.USER),"formula"===this.root.getAttribute("data-mode")&&this.quill.insertText(o+1," ",s.default.sources.USER),this.quill.setSelection(o+2,s.default.sources.USER)}}this.textbox.value="",this.hide()}}]),e}(p.default);function x(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.forEach((function(e){var i=document.createElement("option");e===n?i.setAttribute("selected","selected"):i.setAttribute("value",e),t.appendChild(i)}))}e.BaseTooltip=T,e.default=O},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.head=this.tail=null,this.length=0}return t.prototype.append=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.insertBefore(t[0],null),t.length>1&&this.append.apply(this,t.slice(1))},t.prototype.contains=function(t){for(var e,n=this.iterator();e=n();)if(e===t)return!0;return!1},t.prototype.insertBefore=function(t,e){t&&(t.next=e,null!=e?(t.prev=e.prev,null!=e.prev&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):null!=this.tail?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)},t.prototype.offset=function(t){for(var e=0,n=this.head;null!=n;){if(n===t)return e;e+=n.length(),n=n.next}return-1},t.prototype.remove=function(t){this.contains(t)&&(null!=t.prev&&(t.prev.next=t.next),null!=t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)},t.prototype.iterator=function(t){return void 0===t&&(t=this.head),function(){var e=t;return null!=t&&(t=t.next),e}},t.prototype.find=function(t,e){void 0===e&&(e=!1);for(var n,i=this.iterator();n=i();){var r=n.length();if(t<r||e&&t===r&&(null==n.next||0!==n.next.length()))return[n,t];t-=r}return[null,0]},t.prototype.forEach=function(t){for(var e,n=this.iterator();e=n();)t(e)},t.prototype.forEachAt=function(t,e,n){if(!(e<=0))for(var i,r=this.find(t),o=r[0],a=t-r[1],s=this.iterator(o);(i=s())&&a<t+e;){var l=i.length();t>a?n(i,t-a,Math.min(e,a+l-t)):n(i,0,Math.min(l,t+e-a)),a+=l}},t.prototype.map=function(t){return this.reduce((function(e,n){return e.push(t(n)),e}),[])},t.prototype.reduce=function(t,e){for(var n,i=this.iterator();n=i();)e=t(e,n);return e},t}();e.default=i},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(17),a=n(1),s={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},l=function(t){function e(e){var n=t.call(this,e)||this;return n.scroll=n,n.observer=new MutationObserver((function(t){n.update(t)})),n.observer.observe(n.domNode,s),n.attach(),n}return r(e,t),e.prototype.detach=function(){t.prototype.detach.call(this),this.observer.disconnect()},e.prototype.deleteAt=function(e,n){this.update(),0===e&&n===this.length()?this.children.forEach((function(t){t.remove()})):t.prototype.deleteAt.call(this,e,n)},e.prototype.formatAt=function(e,n,i,r){this.update(),t.prototype.formatAt.call(this,e,n,i,r)},e.prototype.insertAt=function(e,n,i){this.update(),t.prototype.insertAt.call(this,e,n,i)},e.prototype.optimize=function(e,n){var i=this;void 0===e&&(e=[]),void 0===n&&(n={}),t.prototype.optimize.call(this,n);for(var r=[].slice.call(this.observer.takeRecords());r.length>0;)e.push(r.pop());for(var s=function(t,e){void 0===e&&(e=!0),null!=t&&t!==i&&null!=t.domNode.parentNode&&(null==t.domNode[a.DATA_KEY].mutations&&(t.domNode[a.DATA_KEY].mutations=[]),e&&s(t.parent))},l=function(t){null!=t.domNode[a.DATA_KEY]&&null!=t.domNode[a.DATA_KEY].mutations&&(t instanceof o.default&&t.children.forEach(l),t.optimize(n))},u=e,c=0;u.length>0;c+=1){if(c>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(u.forEach((function(t){var e=a.find(t.target,!0);null!=e&&(e.domNode===t.target&&("childList"===t.type?(s(a.find(t.previousSibling,!1)),[].forEach.call(t.addedNodes,(function(t){var e=a.find(t,!1);s(e,!1),e instanceof o.default&&e.children.forEach((function(t){s(t,!1)}))}))):"attributes"===t.type&&s(e.prev)),s(e))})),this.children.forEach(l),r=(u=[].slice.call(this.observer.takeRecords())).slice();r.length>0;)e.push(r.pop())}},e.prototype.update=function(e,n){var i=this;void 0===n&&(n={}),(e=e||this.observer.takeRecords()).map((function(t){var e=a.find(t.target,!0);return null==e?null:null==e.domNode[a.DATA_KEY].mutations?(e.domNode[a.DATA_KEY].mutations=[t],e):(e.domNode[a.DATA_KEY].mutations.push(t),null)})).forEach((function(t){null!=t&&t!==i&&null!=t.domNode[a.DATA_KEY]&&t.update(t.domNode[a.DATA_KEY].mutations||[],n)})),null!=this.domNode[a.DATA_KEY].mutations&&t.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,n),this.optimize(e,n)},e.blotName="scroll",e.defaultChild="block",e.scope=a.Scope.BLOCK_BLOT,e.tagName="DIV",e}(o.default);e.default=l},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(18),a=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.formats=function(n){if(n.tagName!==e.tagName)return t.formats.call(this,n)},e.prototype.format=function(n,i){var r=this;n!==this.statics.blotName||i?t.prototype.format.call(this,n,i):(this.children.forEach((function(t){t instanceof o.default||(t=t.wrap(e.blotName,!0)),r.attributes.copy(t)})),this.unwrap())},e.prototype.formatAt=function(e,n,i,r){null!=this.formats()[i]||a.query(i,a.Scope.ATTRIBUTE)?this.isolate(e,n).format(i,r):t.prototype.formatAt.call(this,e,n,i,r)},e.prototype.optimize=function(n){t.prototype.optimize.call(this,n);var i=this.formats();if(0===Object.keys(i).length)return this.unwrap();var r=this.next;r instanceof e&&r.prev===this&&function(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(var n in t)if(t[n]!==e[n])return!1;return!0}(i,r.formats())&&(r.moveChildren(this),r.remove())},e.blotName="inline",e.scope=a.Scope.INLINE_BLOT,e.tagName="SPAN",e}(o.default);e.default=s},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(18),a=n(1),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.formats=function(n){var i=a.query(e.blotName).tagName;if(n.tagName!==i)return t.formats.call(this,n)},e.prototype.format=function(n,i){null!=a.query(n,a.Scope.BLOCK)&&(n!==this.statics.blotName||i?t.prototype.format.call(this,n,i):this.replaceWith(e.blotName))},e.prototype.formatAt=function(e,n,i,r){null!=a.query(i,a.Scope.BLOCK)?this.format(i,r):t.prototype.formatAt.call(this,e,n,i,r)},e.prototype.insertAt=function(e,n,i){if(null==i||null!=a.query(n,a.Scope.INLINE))t.prototype.insertAt.call(this,e,n,i);else{var r=this.split(e),o=a.create(n,i);r.parent.insertBefore(o,r)}},e.prototype.update=function(e,n){navigator.userAgent.match(/Trident/)?this.build():t.prototype.update.call(this,e,n)},e.blotName="block",e.scope=a.Scope.BLOCK_BLOT,e.tagName="P",e}(o.default);e.default=s},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.formats=function(t){},e.prototype.format=function(e,n){t.prototype.formatAt.call(this,0,this.length(),e,n)},e.prototype.formatAt=function(e,n,i,r){0===e&&n===this.length()?this.format(i,r):t.prototype.formatAt.call(this,e,n,i,r)},e.prototype.formats=function(){return this.statics.formats(this.domNode)},e}(n(19).default);e.default=o},function(t,e,n){var i,r=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(19),a=n(1),s=function(t){function e(e){var n=t.call(this,e)||this;return n.text=n.statics.value(n.domNode),n}return r(e,t),e.create=function(t){return document.createTextNode(t)},e.value=function(t){var e=t.data;return e.normalize&&(e=e.normalize()),e},e.prototype.deleteAt=function(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)},e.prototype.index=function(t,e){return this.domNode===t?e:-1},e.prototype.insertAt=function(e,n,i){null==i?(this.text=this.text.slice(0,e)+n+this.text.slice(e),this.domNode.data=this.text):t.prototype.insertAt.call(this,e,n,i)},e.prototype.length=function(){return this.text.length},e.prototype.optimize=function(n){t.prototype.optimize.call(this,n),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof e&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},e.prototype.position=function(t,e){return[this.domNode,t]},e.prototype.split=function(t,e){if(void 0===e&&(e=!1),!e){if(0===t)return this;if(t===this.length())return this.next}var n=a.create(this.domNode.splitText(t));return this.parent.insertBefore(n,this.next),this.text=this.statics.value(this.domNode),n},e.prototype.update=function(t,e){var n=this;t.some((function(t){return"characterData"===t.type&&t.target===n.domNode}))&&(this.text=this.statics.value(this.domNode))},e.prototype.value=function(){return this.text},e.blotName="text",e.scope=a.Scope.INLINE_BLOT,e}(o.default);e.default=s},function(t,e,n){var i=document.createElement("div");if(i.classList.toggle("test-class",!1),i.classList.contains("test-class")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return arguments.length>1&&!this.contains(t)==!e?e:r.call(this,t)}}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var n=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>n.length)&&(e=n.length),e-=t.length;var i=n.indexOf(t,e);return-1!==i&&i===e}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,r=arguments[1],o=0;o<i;o++)if(e=n[o],t.call(r,e,o,n))return e}}),document.addEventListener("DOMContentLoaded",(function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)}))},function(t,e){var n=-1,i=1,r=0;function o(t,e,c){if(t==e)return t?[[r,t]]:[];(c<0||t.length<c)&&(c=null);var f=s(t,e),p=t.substring(0,f);f=l(t=t.substring(f),e=e.substring(f));var h=t.substring(t.length-f),g=function(t,e){var u;if(!t)return[[i,e]];if(!e)return[[n,t]];var c=t.length>e.length?t:e,d=t.length>e.length?e:t,f=c.indexOf(d);if(-1!=f)return u=[[i,c.substring(0,f)],[r,d],[i,c.substring(f+d.length)]],t.length>e.length&&(u[0][0]=u[2][0]=n),u;if(1==d.length)return[[n,t],[i,e]];var p=function(t,e){var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;function r(t,e,n){for(var i,r,o,a,u=t.substring(n,n+Math.floor(t.length/4)),c=-1,d="";-1!=(c=e.indexOf(u,c+1));){var f=s(t.substring(n),e.substring(c)),p=l(t.substring(0,n),e.substring(0,c));d.length<p+f&&(d=e.substring(c-p,c)+e.substring(c,c+f),i=t.substring(0,n-p),r=t.substring(n+f),o=e.substring(0,c-p),a=e.substring(c+f))}return 2*d.length>=t.length?[i,r,o,a,d]:null}var o,a,u,c,d,f=r(n,i,Math.ceil(n.length/4)),p=r(n,i,Math.ceil(n.length/2));if(!f&&!p)return null;o=p?f&&f[4].length>p[4].length?f:p:f,t.length>e.length?(a=o[0],u=o[1],c=o[2],d=o[3]):(c=o[0],d=o[1],a=o[2],u=o[3]);var h=o[4];return[a,u,c,d,h]}(t,e);if(p){var h=p[0],g=p[1],v=p[2],y=p[3],b=p[4],m=o(h,v),E=o(g,y);return m.concat([[r,b]],E)}return function(t,e){for(var r=t.length,o=e.length,s=Math.ceil((r+o)/2),l=s,u=2*s,c=new Array(u),d=new Array(u),f=0;f<u;f++)c[f]=-1,d[f]=-1;c[l+1]=0,d[l+1]=0;for(var p=r-o,h=p%2!=0,g=0,v=0,y=0,b=0,m=0;m<s;m++){for(var E=-m+g;E<=m-v;E+=2){for(var w=l+E,_=(S=E==-m||E!=m&&c[w-1]<c[w+1]?c[w+1]:c[w-1]+1)-E;S<r&&_<o&&t.charAt(S)==e.charAt(_);)S++,_++;if(c[w]=S,S>r)v+=2;else if(_>o)g+=2;else if(h&&(x=l+p-E)>=0&&x<u&&-1!=d[x]&&S>=(T=r-d[x]))return a(t,e,S,_)}for(var O=-m+y;O<=m-b;O+=2){for(var T,x=l+O,A=(T=O==-m||O!=m&&d[x-1]<d[x+1]?d[x+1]:d[x-1]+1)-O;T<r&&A<o&&t.charAt(r-T-1)==e.charAt(o-A-1);)T++,A++;if(d[x]=T,T>r)b+=2;else if(A>o)y+=2;else if(!h){var S;if((w=l+p-O)>=0&&w<u&&-1!=c[w]&&(_=l+(S=c[w])-w,S>=(T=r-T)))return a(t,e,S,_)}}}return[[n,t],[i,e]]}(t,e)}(t=t.substring(0,t.length-f),e=e.substring(0,e.length-f));return p&&g.unshift([r,p]),h&&g.push([r,h]),u(g),null!=c&&(g=function(t,e){var i=function(t,e){if(0===e)return[r,t];for(var i=0,o=0;o<t.length;o++){var a=t[o];if(a[0]===n||a[0]===r){var s=i+a[1].length;if(e===s)return[o+1,t];if(e<s){t=t.slice();var l=e-i,u=[a[0],a[1].slice(0,l)],c=[a[0],a[1].slice(l)];return t.splice(o,1,u,c),[o+1,t]}i=s}}throw new Error("cursor_pos is out of bounds!")}(t,e),o=i[1],a=i[0],s=o[a],l=o[a+1];if(null==s)return t;if(s[0]!==r)return t;if(null!=l&&s[1]+l[1]===l[1]+s[1])return o.splice(a,2,l,s),d(o,a,2);if(null!=l&&0===l[1].indexOf(s[1])){o.splice(a,2,[l[0],s[1]],[0,s[1]]);var u=l[1].slice(s[1].length);return u.length>0&&o.splice(a+2,0,[l[0],u]),d(o,a,3)}return t}(g,c)),g=function(t){for(var e=!1,o=function(t){return t.charCodeAt(0)>=56320&&t.charCodeAt(0)<=57343},a=function(t){return t.charCodeAt(t.length-1)>=55296&&t.charCodeAt(t.length-1)<=56319},s=2;s<t.length;s+=1)t[s-2][0]===r&&a(t[s-2][1])&&t[s-1][0]===n&&o(t[s-1][1])&&t[s][0]===i&&o(t[s][1])&&(e=!0,t[s-1][1]=t[s-2][1].slice(-1)+t[s-1][1],t[s][1]=t[s-2][1].slice(-1)+t[s][1],t[s-2][1]=t[s-2][1].slice(0,-1));if(!e)return t;var l=[];for(s=0;s<t.length;s+=1)t[s][1].length>0&&l.push(t[s]);return l}(g),g}function a(t,e,n,i){var r=t.substring(0,n),a=e.substring(0,i),s=t.substring(n),l=e.substring(i),u=o(r,a),c=o(s,l);return u.concat(c)}function s(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,o=0;n<r;)t.substring(o,r)==e.substring(o,r)?o=n=r:i=r,r=Math.floor((i-n)/2+n);return r}function l(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,o=0;n<r;)t.substring(t.length-r,t.length-o)==e.substring(e.length-r,e.length-o)?o=n=r:i=r,r=Math.floor((i-n)/2+n);return r}function u(t){t.push([r,""]);for(var e,o=0,a=0,c=0,d="",f="";o<t.length;)switch(t[o][0]){case i:c++,f+=t[o][1],o++;break;case n:a++,d+=t[o][1],o++;break;case r:a+c>1?(0!==a&&0!==c&&(0!==(e=s(f,d))&&(o-a-c>0&&t[o-a-c-1][0]==r?t[o-a-c-1][1]+=f.substring(0,e):(t.splice(0,0,[r,f.substring(0,e)]),o++),f=f.substring(e),d=d.substring(e)),0!==(e=l(f,d))&&(t[o][1]=f.substring(f.length-e)+t[o][1],f=f.substring(0,f.length-e),d=d.substring(0,d.length-e))),0===a?t.splice(o-c,a+c,[i,f]):0===c?t.splice(o-a,a+c,[n,d]):t.splice(o-a-c,a+c,[n,d],[i,f]),o=o-a-c+(a?1:0)+(c?1:0)+1):0!==o&&t[o-1][0]==r?(t[o-1][1]+=t[o][1],t.splice(o,1)):o++,c=0,a=0,d="",f=""}""===t[t.length-1][1]&&t.pop();var p=!1;for(o=1;o<t.length-1;)t[o-1][0]==r&&t[o+1][0]==r&&(t[o][1].substring(t[o][1].length-t[o-1][1].length)==t[o-1][1]?(t[o][1]=t[o-1][1]+t[o][1].substring(0,t[o][1].length-t[o-1][1].length),t[o+1][1]=t[o-1][1]+t[o+1][1],t.splice(o-1,1),p=!0):t[o][1].substring(0,t[o+1][1].length)==t[o+1][1]&&(t[o-1][1]+=t[o+1][1],t[o][1]=t[o][1].substring(t[o+1][1].length)+t[o+1][1],t.splice(o+1,1),p=!0)),o++;p&&u(t)}var c=o;function d(t,e,n){for(var i=e+n-1;i>=0&&i>=e-1;i--)if(i+1<t.length){var r=t[i],o=t[i+1];r[0]===o[1]&&t.splice(i,2,[r[0],r[1]+o[1]])}return t}c.INSERT=i,c.DELETE=n,c.EQUAL=r,t.exports=c},function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n},function(t,e){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function i(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function r(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=n?i:r).supported=i,e.unsupported=r},function(t,e){var n=Object.prototype.hasOwnProperty,i="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),a.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t,e){var n=i?i+t:t,r=this._events[n];if(e)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var o=0,a=r.length,s=new Array(a);o<a;o++)s[o]=r[o].fn;return s},a.prototype.emit=function(t,e,n,r,o,a){var s=i?i+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,r),!0;case 5:return c.fn.call(c.context,e,n,r,o),!0;case 6:return c.fn.call(c.context,e,n,r,o,a),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var f,p=c.length;for(u=0;u<p;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,r);break;default:if(!l)for(f=1,l=new Array(d-1);f<d;f++)l[f-1]=arguments[f];c[u].fn.apply(c[u].context,l)}}return!0},a.prototype.on=function(t,e,n){var r=new o(e,n||this),a=i?i+t:t;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},a.prototype.once=function(t,e,n){var r=new o(e,n||this,!0),a=i?i+t:t;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],r]:this._events[a].push(r):(this._events[a]=r,this._eventsCount++),this},a.prototype.removeListener=function(t,e,n,o){var a=i?i+t:t;if(!this._events[a])return this;if(!e)return 0==--this._eventsCount?this._events=new r:delete this._events[a],this;var s=this._events[a];if(s.fn)s.fn!==e||o&&!s.once||n&&s.context!==n||(0==--this._eventsCount?this._events=new r:delete this._events[a]);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==e||o&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:0==--this._eventsCount?this._events=new r:delete this._events[a]}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&(0==--this._eventsCount?this._events=new r:delete this._events[e])):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=i,a.EventEmitter=a,void 0!==t&&(t.exports=a)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.matchText=e.matchSpacing=e.matchNewline=e.matchBlot=e.matchAttributor=e.default=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=m(n(3)),s=m(n(2)),l=m(n(0)),u=m(n(5)),c=m(n(10)),d=m(n(9)),f=n(36),p=n(37),h=m(n(13)),g=n(26),v=n(38),y=n(39),b=n(40);function m(t){return t&&t.__esModule?t:{default:t}}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=(0,c.default)("quill:clipboard"),_="__ql-matcher",O=[[Node.TEXT_NODE,L],[Node.TEXT_NODE,D],["br",function(t,e){return k(e,"\n")||e.insert("\n"),e}],[Node.ELEMENT_NODE,D],[Node.ELEMENT_NODE,M],[Node.ELEMENT_NODE,R],[Node.ELEMENT_NODE,j],[Node.ELEMENT_NODE,function(t,e){var n={},i=t.style||{};return i.fontStyle&&"italic"===I(t).fontStyle&&(n.italic=!0),i.fontWeight&&(I(t).fontWeight.startsWith("bold")||parseInt(I(t).fontWeight)>=700)&&(n.bold=!0),Object.keys(n).length>0&&(e=S(e,n)),parseFloat(i.textIndent||0)>0&&(e=(new s.default).insert("\t").concat(e)),e}],["li",function(t,e){var n=l.default.query(t);if(null==n||"list-item"!==n.blotName||!k(e,"\n"))return e;for(var i=-1,r=t.parentNode;!r.classList.contains("ql-clipboard");)"list"===(l.default.query(r)||{}).blotName&&(i+=1),r=r.parentNode;return i<=0?e:e.compose((new s.default).retain(e.length()-1).retain(1,{indent:i}))}],["b",C.bind(C,"bold")],["i",C.bind(C,"italic")],["style",function(){return new s.default}]],T=[f.AlignAttribute,v.DirectionAttribute].reduce((function(t,e){return t[e.keyName]=e,t}),{}),x=[f.AlignStyle,p.BackgroundStyle,g.ColorStyle,v.DirectionStyle,y.FontStyle,b.SizeStyle].reduce((function(t,e){return t[e.keyName]=e,t}),{}),A=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.quill.root.addEventListener("paste",i.onPaste.bind(i)),i.container=i.quill.addContainer("ql-clipboard"),i.container.setAttribute("contenteditable",!0),i.container.setAttribute("tabindex",-1),i.matchers=[],O.concat(i.options.matchers).forEach((function(t){var e=r(t,2),o=e[0],a=e[1];(n.matchVisual||a!==R)&&i.addMatcher(o,a)})),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"addMatcher",value:function(t,e){this.matchers.push([t,e])}},{key:"convert",value:function(t){if("string"==typeof t)return this.container.innerHTML=t.replace(/\>\r?\n +\</g,"><"),this.convert();var e=this.quill.getFormat(this.quill.selection.savedRange.index);if(e[h.default.blotName]){var n=this.container.innerText;return this.container.innerHTML="",(new s.default).insert(n,E({},h.default.blotName,e[h.default.blotName]))}var i=this.prepareMatching(),o=r(i,2),a=o[0],l=o[1],u=N(this.container,a,l);return k(u,"\n")&&null==u.ops[u.ops.length-1].attributes&&(u=u.compose((new s.default).retain(u.length()-1).delete(1))),w.log("convert",this.container.innerHTML,u),this.container.innerHTML="",u}},{key:"dangerouslyPasteHTML",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.default.sources.API;if("string"==typeof t)this.quill.setContents(this.convert(t),e),this.quill.setSelection(0,u.default.sources.SILENT);else{var i=this.convert(e);this.quill.updateContents((new s.default).retain(t).concat(i),n),this.quill.setSelection(t+i.length(),u.default.sources.SILENT)}}},{key:"onPaste",value:function(t){var e=this;if(!t.defaultPrevented&&this.quill.isEnabled()){var n=this.quill.getSelection(),i=(new s.default).retain(n.index),r=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(u.default.sources.SILENT),setTimeout((function(){i=i.concat(e.convert()).delete(n.length),e.quill.updateContents(i,u.default.sources.USER),e.quill.setSelection(i.length()-n.length,u.default.sources.SILENT),e.quill.scrollingContainer.scrollTop=r,e.quill.focus()}),1)}}},{key:"prepareMatching",value:function(){var t=this,e=[],n=[];return this.matchers.forEach((function(i){var o=r(i,2),a=o[0],s=o[1];switch(a){case Node.TEXT_NODE:n.push(s);break;case Node.ELEMENT_NODE:e.push(s);break;default:[].forEach.call(t.container.querySelectorAll(a),(function(t){t[_]=t[_]||[],t[_].push(s)}))}})),[e,n]}}]),e}(d.default);function S(t,e,n){return"object"===(void 0===e?"undefined":i(e))?Object.keys(e).reduce((function(t,n){return S(t,n,e[n])}),t):t.reduce((function(t,i){return i.attributes&&i.attributes[e]?t.push(i):t.insert(i.insert,(0,a.default)({},E({},e,n),i.attributes))}),new s.default)}function I(t){if(t.nodeType!==Node.ELEMENT_NODE)return{};var e="__ql-computed-style";return t[e]||(t[e]=window.getComputedStyle(t))}function k(t,e){for(var n="",i=t.ops.length-1;i>=0&&n.length<e.length;--i){var r=t.ops[i];if("string"!=typeof r.insert)break;n=r.insert+n}return n.slice(-1*e.length)===e}function P(t){if(0===t.childNodes.length)return!1;var e=I(t);return["block","list-item"].indexOf(e.display)>-1}function N(t,e,n){return t.nodeType===t.TEXT_NODE?n.reduce((function(e,n){return n(t,e)}),new s.default):t.nodeType===t.ELEMENT_NODE?[].reduce.call(t.childNodes||[],(function(i,r){var o=N(r,e,n);return r.nodeType===t.ELEMENT_NODE&&(o=e.reduce((function(t,e){return e(r,t)}),o),o=(r[_]||[]).reduce((function(t,e){return e(r,t)}),o)),i.concat(o)}),new s.default):new s.default}function C(t,e,n){return S(n,t,!0)}function j(t,e){var n=l.default.Attributor.Attribute.keys(t),i=l.default.Attributor.Class.keys(t),r=l.default.Attributor.Style.keys(t),o={};return n.concat(i).concat(r).forEach((function(e){var n=l.default.query(e,l.default.Scope.ATTRIBUTE);null!=n&&(o[n.attrName]=n.value(t),o[n.attrName])||(null==(n=T[e])||n.attrName!==e&&n.keyName!==e||(o[n.attrName]=n.value(t)||void 0),null==(n=x[e])||n.attrName!==e&&n.keyName!==e||(n=x[e],o[n.attrName]=n.value(t)||void 0))})),Object.keys(o).length>0&&(e=S(e,o)),e}function M(t,e){var n=l.default.query(t);if(null==n)return e;if(n.prototype instanceof l.default.Embed){var i={},r=n.value(t);null!=r&&(i[n.blotName]=r,e=(new s.default).insert(i,n.formats(t)))}else"function"==typeof n.formats&&(e=S(e,n.blotName,n.formats(t)));return e}function D(t,e){return k(e,"\n")||(P(t)||e.length()>0&&t.nextSibling&&P(t.nextSibling))&&e.insert("\n"),e}function R(t,e){if(P(t)&&null!=t.nextElementSibling&&!k(e,"\n\n")){var n=t.offsetHeight+parseFloat(I(t).marginTop)+parseFloat(I(t).marginBottom);t.nextElementSibling.offsetTop>t.offsetTop+1.5*n&&e.insert("\n")}return e}function L(t,e){var n=t.data;if("O:P"===t.parentNode.tagName)return e.insert(n.trim());if(0===n.trim().length&&t.parentNode.classList.contains("ql-clipboard"))return e;if(!I(t.parentNode).whiteSpace.startsWith("pre")){var i=function(t,e){return(e=e.replace(/[^\u00a0]/g,"")).length<1&&t?" ":e};n=(n=n.replace(/\r\n/g," ").replace(/\n/g," ")).replace(/\s\s+/g,i.bind(i,!0)),(null==t.previousSibling&&P(t.parentNode)||null!=t.previousSibling&&P(t.previousSibling))&&(n=n.replace(/^\s+/,i.bind(i,!1))),(null==t.nextSibling&&P(t.parentNode)||null!=t.nextSibling&&P(t.nextSibling))&&(n=n.replace(/\s+$/,i.bind(i,!1)))}return e.insert(n)}A.DEFAULTS={matchers:[],matchVisual:!0},e.default=A,e.matchAttributor=j,e.matchBlot=M,e.matchNewline=D,e.matchSpacing=R,e.matchText=L},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(6),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"optimize",value:function(t){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"optimize",this).call(this,t),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),e}(((i=a)&&i.__esModule?i:{default:i}).default);s.blotName="bold",s.tagName=["STRONG","B"],e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.addControls=e.default=void 0;var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=c(n(2)),a=c(n(0)),s=c(n(5)),l=c(n(10)),u=c(n(9));function c(t){return t&&t.__esModule?t:{default:t}}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var f=(0,l.default)("quill:toolbar"),p=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r,o=d(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));if(Array.isArray(o.options.container)){var a=document.createElement("div");g(a,o.options.container),t.container.parentNode.insertBefore(a,t.container),o.container=a}else"string"==typeof o.options.container?o.container=document.querySelector(o.options.container):o.container=o.options.container;return o.container instanceof HTMLElement?(o.container.classList.add("ql-toolbar"),o.controls=[],o.handlers={},Object.keys(o.options.handlers).forEach((function(t){o.addHandler(t,o.options.handlers[t])})),[].forEach.call(o.container.querySelectorAll("button, select"),(function(t){o.attach(t)})),o.quill.on(s.default.events.EDITOR_CHANGE,(function(t,e){t===s.default.events.SELECTION_CHANGE&&o.update(e)})),o.quill.on(s.default.events.SCROLL_OPTIMIZE,(function(){var t=o.quill.selection.getRange(),e=i(t,1)[0];o.update(e)})),o):(r=f.error("Container required for toolbar",o.options),d(o,r))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"addHandler",value:function(t,e){this.handlers[t]=e}},{key:"attach",value:function(t){var e=this,n=[].find.call(t.classList,(function(t){return 0===t.indexOf("ql-")}));if(n){if(n=n.slice("ql-".length),"BUTTON"===t.tagName&&t.setAttribute("type","button"),null==this.handlers[n]){if(null!=this.quill.scroll.whitelist&&null==this.quill.scroll.whitelist[n])return void f.warn("ignoring attaching to disabled format",n,t);if(null==a.default.query(n))return void f.warn("ignoring attaching to nonexistent format",n,t)}var r="SELECT"===t.tagName?"change":"click";t.addEventListener(r,(function(r){var l=void 0;if("SELECT"===t.tagName){if(t.selectedIndex<0)return;var u=t.options[t.selectedIndex];l=!u.hasAttribute("selected")&&(u.value||!1)}else l=!t.classList.contains("ql-active")&&(t.value||!t.hasAttribute("value")),r.preventDefault();e.quill.focus();var c=e.quill.selection.getRange(),d=i(c,1)[0];if(null!=e.handlers[n])e.handlers[n].call(e,l);else if(a.default.query(n).prototype instanceof a.default.Embed){if(!(l=prompt("Enter "+n)))return;e.quill.updateContents((new o.default).retain(d.index).delete(d.length).insert(function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},n,l)),s.default.sources.USER)}else e.quill.format(n,l,s.default.sources.USER);e.update(d)})),this.controls.push([n,t])}}},{key:"update",value:function(t){var e=null==t?{}:this.quill.getFormat(t);this.controls.forEach((function(n){var r=i(n,2),o=r[0],a=r[1];if("SELECT"===a.tagName){var s=void 0;if(null==t)s=null;else if(null==e[o])s=a.querySelector("option[selected]");else if(!Array.isArray(e[o])){var l=e[o];"string"==typeof l&&(l=l.replace(/\"/g,'\\"')),s=a.querySelector('option[value="'+l+'"]')}null==s?(a.value="",a.selectedIndex=-1):s.selected=!0}else if(null==t)a.classList.remove("ql-active");else if(a.hasAttribute("value")){var u=e[o]===a.getAttribute("value")||null!=e[o]&&e[o].toString()===a.getAttribute("value")||null==e[o]&&!a.getAttribute("value");a.classList.toggle("ql-active",u)}else a.classList.toggle("ql-active",null!=e[o])}))}}]),e}(u.default);function h(t,e,n){var i=document.createElement("button");i.setAttribute("type","button"),i.classList.add("ql-"+e),null!=n&&(i.value=n),t.appendChild(i)}function g(t,e){Array.isArray(e[0])||(e=[e]),e.forEach((function(e){var n=document.createElement("span");n.classList.add("ql-formats"),e.forEach((function(t){if("string"==typeof t)h(n,t);else{var e=Object.keys(t)[0],i=t[e];Array.isArray(i)?function(t,e,n){var i=document.createElement("select");i.classList.add("ql-"+e),n.forEach((function(t){var e=document.createElement("option");!1!==t?e.setAttribute("value",t):e.setAttribute("selected","selected"),i.appendChild(e)})),t.appendChild(i)}(n,e,i):h(n,e,i)}})),t.appendChild(n)}))}p.DEFAULTS={},p.DEFAULTS={container:null,handlers:{clean:function(){var t=this,e=this.quill.getSelection();if(null!=e)if(0==e.length){var n=this.quill.getFormat();Object.keys(n).forEach((function(e){null!=a.default.query(e,a.default.Scope.INLINE)&&t.quill.format(e,!1)}))}else this.quill.removeFormat(e,s.default.sources.USER)},direction:function(t){var e=this.quill.getFormat().align;"rtl"===t&&null==e?this.quill.format("align","right",s.default.sources.USER):t||"right"!==e||this.quill.format("align",!1,s.default.sources.USER),this.quill.format("direction",t,s.default.sources.USER)},indent:function(t){var e=this.quill.getSelection(),n=this.quill.getFormat(e),i=parseInt(n.indent||0);if("+1"===t||"-1"===t){var r="+1"===t?1:-1;"rtl"===n.direction&&(r*=-1),this.quill.format("indent",i+r,s.default.sources.USER)}},link:function(t){!0===t&&(t=prompt("Enter link URL:")),this.quill.format("link",t,s.default.sources.USER)},list:function(t){var e=this.quill.getSelection(),n=this.quill.getFormat(e);"check"===t?"checked"===n.list||"unchecked"===n.list?this.quill.format("list",!1,s.default.sources.USER):this.quill.format("list","unchecked",s.default.sources.USER):this.quill.format("list",t,s.default.sources.USER)}}},e.default=p,e.addControls=g},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(28),s=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.label.innerHTML=n,i.container.classList.add("ql-color-picker"),[].slice.call(i.container.querySelectorAll(".ql-picker-item"),0,7).forEach((function(t){t.classList.add("ql-primary")})),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"buildItem",value:function(t){var n=o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"buildItem",this).call(this,t);return n.style.backgroundColor=t.getAttribute("value")||"",n}},{key:"selectItem",value:function(t,n){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"selectItem",this).call(this,t,n);var i=this.label.querySelector(".ql-color-label"),r=t&&t.getAttribute("data-value")||"";i&&("line"===i.tagName?i.style.stroke=r:i.style.fill=r)}}]),e}(((i=a)&&i.__esModule?i:{default:i}).default);e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(28),s=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i.container.classList.add("ql-icon-picker"),[].forEach.call(i.container.querySelectorAll(".ql-picker-item"),(function(t){t.innerHTML=n[t.getAttribute("data-value")||""]})),i.defaultItem=i.container.querySelector(".ql-selected"),i.selectItem(i.defaultItem),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"selectItem",value:function(t,n){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"selectItem",this).call(this,t,n),t=t||this.defaultItem,this.label.innerHTML=t.innerHTML}}]),e}(((i=a)&&i.__esModule?i:{default:i}).default);e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.quill=e,this.boundsContainer=n||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",(function(){i.root.style.marginTop=-1*i.quill.root.scrollTop+"px"})),this.hide()}return i(t,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(t){var e=t.left+t.width/2-this.root.offsetWidth/2,n=t.bottom+this.quill.root.scrollTop;this.root.style.left=e+"px",this.root.style.top=n+"px",this.root.classList.remove("ql-flip");var i=this.boundsContainer.getBoundingClientRect(),r=this.root.getBoundingClientRect(),o=0;if(r.right>i.right&&(o=i.right-r.right,this.root.style.left=e+o+"px"),r.left<i.left&&(o=i.left-r.left,this.root.style.left=e+o+"px"),r.bottom>i.bottom){var a=r.bottom-r.top,s=t.bottom-t.top+a;this.root.style.top=n-s+"px",this.root.classList.add("ql-flip")}return o}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),t}();e.default=r},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=p(n(3)),s=p(n(8)),l=n(43),u=p(l),c=p(n(27)),d=n(15),f=p(n(41));function p(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function v(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var y=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],b=function(t){function e(t,n){h(this,e),null!=n.modules.toolbar&&null==n.modules.toolbar.container&&(n.modules.toolbar.container=y);var i=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.quill.container.classList.add("ql-snow"),i}return v(e,t),o(e,[{key:"extendToolbar",value:function(t){t.container.classList.add("ql-snow"),this.buildButtons([].slice.call(t.container.querySelectorAll("button")),f.default),this.buildPickers([].slice.call(t.container.querySelectorAll("select")),f.default),this.tooltip=new m(this.quill,this.options.bounds),t.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},(function(e,n){t.handlers.link.call(t,!n.format.link)}))}}]),e}(u.default);b.DEFAULTS=(0,a.default)(!0,{},u.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(t){if(t){var e=this.quill.getSelection();if(null==e||0==e.length)return;var n=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(n)&&0!==n.indexOf("mailto:")&&(n="mailto:"+n),this.quill.theme.tooltip.edit("link",n)}else this.quill.format("link",!1)}}}}});var m=function(t){function e(t,n){h(this,e);var i=g(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.preview=i.root.querySelector("a.ql-preview"),i}return v(e,t),o(e,[{key:"listen",value:function(){var t=this;r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",(function(e){t.root.classList.contains("ql-editing")?t.save():t.edit("link",t.preview.textContent),e.preventDefault()})),this.root.querySelector("a.ql-remove").addEventListener("click",(function(e){if(null!=t.linkRange){var n=t.linkRange;t.restoreFocus(),t.quill.formatText(n,"link",!1,s.default.sources.USER),delete t.linkRange}e.preventDefault(),t.hide()})),this.quill.on(s.default.events.SELECTION_CHANGE,(function(e,n,r){if(null!=e){if(0===e.length&&r===s.default.sources.USER){var o=t.quill.scroll.descendant(c.default,e.index),a=i(o,2),l=a[0],u=a[1];if(null!=l){t.linkRange=new d.Range(e.index-u,l.length());var f=c.default.formats(l.domNode);return t.preview.textContent=f,t.preview.setAttribute("href",f),t.show(),void t.position(t.quill.getBounds(t.linkRange))}}else delete t.linkRange;t.hide()}}))}},{key:"show",value:function(){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),e}(l.BaseTooltip);m.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),e.default=b},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i=D(n(29)),r=n(36),o=n(38),a=n(64),s=D(n(65)),l=D(n(66)),u=n(67),c=D(u),d=n(37),f=n(26),p=n(39),h=n(40),g=D(n(56)),v=D(n(68)),y=D(n(27)),b=D(n(69)),m=D(n(70)),E=D(n(71)),w=D(n(72)),_=D(n(73)),O=n(13),T=D(O),x=D(n(74)),A=D(n(75)),S=D(n(57)),I=D(n(41)),k=D(n(28)),P=D(n(59)),N=D(n(60)),C=D(n(61)),j=D(n(108)),M=D(n(62));function D(t){return t&&t.__esModule?t:{default:t}}i.default.register({"attributors/attribute/direction":o.DirectionAttribute,"attributors/class/align":r.AlignClass,"attributors/class/background":d.BackgroundClass,"attributors/class/color":f.ColorClass,"attributors/class/direction":o.DirectionClass,"attributors/class/font":p.FontClass,"attributors/class/size":h.SizeClass,"attributors/style/align":r.AlignStyle,"attributors/style/background":d.BackgroundStyle,"attributors/style/color":f.ColorStyle,"attributors/style/direction":o.DirectionStyle,"attributors/style/font":p.FontStyle,"attributors/style/size":h.SizeStyle},!0),i.default.register({"formats/align":r.AlignClass,"formats/direction":o.DirectionClass,"formats/indent":a.IndentClass,"formats/background":d.BackgroundStyle,"formats/color":f.ColorStyle,"formats/font":p.FontClass,"formats/size":h.SizeClass,"formats/blockquote":s.default,"formats/code-block":T.default,"formats/header":l.default,"formats/list":c.default,"formats/bold":g.default,"formats/code":O.Code,"formats/italic":v.default,"formats/link":y.default,"formats/script":b.default,"formats/strike":m.default,"formats/underline":E.default,"formats/image":w.default,"formats/video":_.default,"formats/list/item":u.ListItem,"modules/formula":x.default,"modules/syntax":A.default,"modules/toolbar":S.default,"themes/bubble":j.default,"themes/snow":M.default,"ui/icons":I.default,"ui/picker":k.default,"ui/icon-picker":N.default,"ui/color-picker":P.default,"ui/tooltip":C.default},!0),e.default=i.default},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.IndentClass=void 0;var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(0),s=(i=a)&&i.__esModule?i:{default:i},l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"add",value:function(t,n){if("+1"===n||"-1"===n){var i=this.value(t)||0;n="+1"===n?i+1:i-1}return 0===n?(this.remove(t),!0):o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"add",this).call(this,t,n)}},{key:"canAdd",value:function(t,n){return o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"canAdd",this).call(this,t,n)||o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"canAdd",this).call(this,t,parseInt(n))}},{key:"value",value:function(t){return parseInt(o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"value",this).call(this,t))||void 0}}]),e}(s.default.Attributor.Class),u=new l("indent","ql-indent",{scope:s.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});e.IndentClass=u},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(4),o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((i=r)&&i.__esModule?i:{default:i}).default);o.blotName="blockquote",o.tagName="blockquote",e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(4),a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,null,[{key:"formats",value:function(t){return this.tagName.indexOf(t.tagName)+1}}]),e}(((i=o)&&i.__esModule?i:{default:i}).default);a.blotName="header",a.tagName=["H1","H2","H3","H4","H5","H6"],e.default=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ListItem=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=l(n(0)),a=l(n(4)),s=l(n(25));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var f=function(t){function e(){return u(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return d(e,t),i(e,[{key:"format",value:function(t,n){t!==p.blotName||n?r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"format",this).call(this,t,n):this.replaceWith(o.default.create(this.statics.scope))}},{key:"remove",value:function(){null==this.prev&&null==this.next?this.parent.remove():r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(t,n){return this.parent.isolate(this.offset(this.parent),this.length()),t===this.parent.statics.blotName?(this.parent.replaceWith(t,n),this):(this.parent.unwrap(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"replaceWith",this).call(this,t,n))}}],[{key:"formats",value:function(t){return t.tagName===this.tagName?void 0:r(e.__proto__||Object.getPrototypeOf(e),"formats",this).call(this,t)}}]),e}(a.default);f.blotName="list-item",f.tagName="LI";var p=function(t){function e(t){u(this,e);var n=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=function(e){if(e.target.parentNode===t){var i=n.statics.formats(t),r=o.default.find(e.target);"checked"===i?r.format("list","unchecked"):"unchecked"===i&&r.format("list","checked")}};return t.addEventListener("touchstart",i),t.addEventListener("mousedown",i),n}return d(e,t),i(e,null,[{key:"create",value:function(t){var n="ordered"===t?"OL":"UL",i=r(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,n);return"checked"!==t&&"unchecked"!==t||i.setAttribute("data-checked","checked"===t),i}},{key:"formats",value:function(t){return"OL"===t.tagName?"ordered":"UL"===t.tagName?t.hasAttribute("data-checked")?"true"===t.getAttribute("data-checked")?"checked":"unchecked":"bullet":void 0}}]),i(e,[{key:"format",value:function(t,e){this.children.length>0&&this.children.tail.format(t,e)}},{key:"formats",value:function(){return t={},e=this.statics.blotName,n=this.statics.formats(this.domNode),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t;var t,e,n}},{key:"insertBefore",value:function(t,n){if(t instanceof f)r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insertBefore",this).call(this,t,n);else{var i=null==n?this.length():n.offset(this),o=this.split(i);o.parent.insertBefore(t,o)}}},{key:"optimize",value:function(t){r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"optimize",this).call(this,t);var n=this.next;null!=n&&n.prev===this&&n.statics.blotName===this.statics.blotName&&n.domNode.tagName===this.domNode.tagName&&n.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(n.moveChildren(this),n.remove())}},{key:"replace",value:function(t){if(t.statics.blotName!==this.statics.blotName){var n=o.default.create(this.statics.defaultChild);t.moveChildren(n),this.appendChild(n)}r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"replace",this).call(this,t)}}]),e}(s.default);p.blotName="list",p.scope=o.default.Scope.BLOCK_BLOT,p.tagName=["OL","UL"],p.defaultChild="list-item",p.allowedChildren=[f],e.ListItem=f,e.default=p},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(56),o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((i=r)&&i.__esModule?i:{default:i}).default);o.blotName="italic",o.tagName=["EM","I"],e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(6),s=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,null,[{key:"create",value:function(t){return"super"===t?document.createElement("sup"):"sub"===t?document.createElement("sub"):o(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,t)}},{key:"formats",value:function(t){return"SUB"===t.tagName?"sub":"SUP"===t.tagName?"super":void 0}}]),e}(((i=a)&&i.__esModule?i:{default:i}).default);s.blotName="script",s.tagName=["SUB","SUP"],e.default=s},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(6),o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((i=r)&&i.__esModule?i:{default:i}).default);o.blotName="strike",o.tagName="S",e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=n(6),o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((i=r)&&i.__esModule?i:{default:i}).default);o.blotName="underline",o.tagName="U",e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(0),s=(i=a)&&i.__esModule?i:{default:i},l=n(27),u=["alt","height","width"],c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"format",value:function(t,n){u.indexOf(t)>-1?n?this.domNode.setAttribute(t,n):this.domNode.removeAttribute(t):o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"format",this).call(this,t,n)}}],[{key:"create",value:function(t){var n=o(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,t);return"string"==typeof t&&n.setAttribute("src",this.sanitize(t)),n}},{key:"formats",value:function(t){return u.reduce((function(e,n){return t.hasAttribute(n)&&(e[n]=t.getAttribute(n)),e}),{})}},{key:"match",value:function(t){return/\.(jpe?g|gif|png)$/.test(t)||/^data:image\/.+;base64/.test(t)}},{key:"sanitize",value:function(t){return(0,l.sanitize)(t,["http","https","data"])?t:"//:0"}},{key:"value",value:function(t){return t.getAttribute("src")}}]),e}(s.default.Embed);c.blotName="image",c.tagName="IMG",e.default=c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var i,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},a=n(4),s=n(27),l=(i=s)&&i.__esModule?i:{default:i},u=["height","width"],c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"format",value:function(t,n){u.indexOf(t)>-1?n?this.domNode.setAttribute(t,n):this.domNode.removeAttribute(t):o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"format",this).call(this,t,n)}}],[{key:"create",value:function(t){var n=o(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,t);return n.setAttribute("frameborder","0"),n.setAttribute("allowfullscreen",!0),n.setAttribute("src",this.sanitize(t)),n}},{key:"formats",value:function(t){return u.reduce((function(e,n){return t.hasAttribute(n)&&(e[n]=t.getAttribute(n)),e}),{})}},{key:"sanitize",value:function(t){return l.default.sanitize(t)}},{key:"value",value:function(t){return t.getAttribute("src")}}]),e}(a.BlockEmbed);c.blotName="video",c.className="ql-video",c.tagName="IFRAME",e.default=c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.FormulaBlot=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=l(n(35)),a=l(n(5)),s=l(n(9));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var f=function(t){function e(){return u(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return d(e,t),i(e,null,[{key:"create",value:function(t){var n=r(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,t);return"string"==typeof t&&(window.katex.render(t,n,{throwOnError:!1,errorColor:"#f00"}),n.setAttribute("data-value",t)),n}},{key:"value",value:function(t){return t.getAttribute("data-value")}}]),e}(o.default);f.blotName="formula",f.className="ql-formula",f.tagName="SPAN";var p=function(t){function e(){u(this,e);var t=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));if(null==window.katex)throw new Error("Formula module requires KaTeX.");return t}return d(e,t),i(e,null,[{key:"register",value:function(){a.default.register(f,!0)}}]),e}(s.default);e.FormulaBlot=f,e.default=p},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CodeToken=e.CodeBlock=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},o=l(n(0)),a=l(n(5)),s=l(n(9));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var f=function(t){function e(){return u(this,e),c(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return d(e,t),i(e,[{key:"replaceWith",value:function(t){this.domNode.textContent=this.domNode.textContent,this.attach(),r(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"replaceWith",this).call(this,t)}},{key:"highlight",value:function(t){var e=this.domNode.textContent;this.cachedText!==e&&((e.trim().length>0||null==this.cachedText)&&(this.domNode.innerHTML=t(e),this.domNode.normalize(),this.attach()),this.cachedText=e)}}]),e}(l(n(13)).default);f.className="ql-syntax";var p=new o.default.Attributor.Class("token","hljs",{scope:o.default.Scope.INLINE}),h=function(t){function e(t,n){u(this,e);var i=c(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));if("function"!=typeof i.options.highlight)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var r=null;return i.quill.on(a.default.events.SCROLL_OPTIMIZE,(function(){clearTimeout(r),r=setTimeout((function(){i.highlight(),r=null}),i.options.interval)})),i.highlight(),i}return d(e,t),i(e,null,[{key:"register",value:function(){a.default.register(p,!0),a.default.register(f,!0)}}]),i(e,[{key:"highlight",value:function(){var t=this;if(!this.quill.selection.composing){this.quill.update(a.default.sources.USER);var e=this.quill.getSelection();this.quill.scroll.descendants(f).forEach((function(e){e.highlight(t.options.highlight)})),this.quill.update(a.default.sources.SILENT),null!=e&&this.quill.setSelection(e,a.default.sources.SILENT)}}}]),e}(s.default);h.DEFAULTS={highlight:null==window.hljs?null:function(t){return window.hljs.highlightAuto(t).value},interval:1e3},e.CodeBlock=f,e.CodeToken=p,e.default=h},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,e){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,e){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,e){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,e){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,e){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.BubbleTooltip=void 0;var i=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=d(n(3)),a=d(n(8)),s=n(43),l=d(s),u=n(15),c=d(n(41));function d(t){return t&&t.__esModule?t:{default:t}}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var g=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],v=function(t){function e(t,n){f(this,e),null!=n.modules.toolbar&&null==n.modules.toolbar.container&&(n.modules.toolbar.container=g);var i=p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.quill.container.classList.add("ql-bubble"),i}return h(e,t),r(e,[{key:"extendToolbar",value:function(t){this.tooltip=new y(this.quill,this.options.bounds),this.tooltip.root.appendChild(t.container),this.buildButtons([].slice.call(t.container.querySelectorAll("button")),c.default),this.buildPickers([].slice.call(t.container.querySelectorAll("select")),c.default)}}]),e}(l.default);v.DEFAULTS=(0,o.default)(!0,{},l.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(t){t?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var y=function(t){function e(t,n){f(this,e);var i=p(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.quill.on(a.default.events.EDITOR_CHANGE,(function(t,e,n,r){if(t===a.default.events.SELECTION_CHANGE)if(null!=e&&e.length>0&&r===a.default.sources.USER){i.show(),i.root.style.left="0px",i.root.style.width="",i.root.style.width=i.root.offsetWidth+"px";var o=i.quill.getLines(e.index,e.length);if(1===o.length)i.position(i.quill.getBounds(e));else{var s=o[o.length-1],l=i.quill.getIndex(s),c=Math.min(s.length()-1,e.index+e.length-l),d=i.quill.getBounds(new u.Range(l,c));i.position(d)}}else document.activeElement!==i.textbox&&i.quill.hasFocus()&&i.hide()})),i}return h(e,t),r(e,[{key:"listen",value:function(){var t=this;i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",(function(){t.root.classList.remove("ql-editing")})),this.quill.on(a.default.events.SCROLL_OPTIMIZE,(function(){setTimeout((function(){if(!t.root.classList.contains("ql-hidden")){var e=t.quill.getSelection();null!=e&&t.position(t.quill.getBounds(e))}}),1)}))}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(t){var n=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"position",this).call(this,t),r=this.root.querySelector(".ql-tooltip-arrow");if(r.style.marginLeft="",0===n)return n;r.style.marginLeft=-1*n-r.offsetWidth/2+"px"}}]),e}(s.BaseTooltip);y.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),e.BubbleTooltip=y,e.default=v},function(t,e,n){t.exports=n(63)}]).default},{get exports(){return Sx},set exports(t){Sx=t}}.exports=Ax();var Ix=Ss(Sx);class kx extends bx{constructor(t,e,n,i){super(t,e,n,i);var r=null,o="";let a=("editor-"+i.getEntityId()).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"-").replace("[","(").replace("]",")");a=a.toLowerCase();var l,u=$(su.template('<div id="<%= id %>"></div>\n')({id:a}));this.setValue=function(t){o=t,u.val(t)},this.getValue=function(){return o},this.get$node=function(){return u},this.setValueFromJSON=function(t){this.setValue(t.value)},this.getYText=function(){return r},this.registerYType=function(t){r=t;const n=u.get(0);if(l=new Ix(n,{theme:"snow",modules:{toolbar:!1},cursors:!1,placeholder:e}),!r)throw new Error("YText not found");new s(r,l),r?.observe((function(){o=r.toString()})),window.syncmetaLog.initializedYTexts+=1,window.syncmetaLog.hasOwnProperty(this.getEntityId())?window.syncmetaLog.objects[this.getEntityId()]+=1:window.syncmetaLog.objects[this.getEntityId()]=0}}}class Px extends yx{constructor(t,e,n){super(t,e,n);var i=new kx(t,e,this,this.getRootSubjectEntity()),r=$(su.template('<div class="attribute_single_quiz_attribute">\n  <span class="attribute_name" for="<%= id %>-value"></span>\n  <div class="value" id="<%= id %>-value"></div>\n  <table id="table" style="float: left; visibility: hidden">\n    <tr>\n      <th>Assessment Name :</th>\n      <th><input class="form-control" id="topic" /></th>\n    </tr>\n    <tr>\n      <td>Nr</td>\n      <td>Question</td>\n      <td>Correct Intent</td>\n      <td>Optional Hint</td>\n    </tr>\n  </table>\n  <button\n    id="b"\n    style="margin-left: 3px; float: left; width: 50%; visibility: hidden"\n  >\n    +\n  </button>\n  <button\n    id="c"\n    style="margin-left: 3px; float: left; width: 50%; visibility: hidden"\n  >\n    -\n  </button>\n  <button\n    id="submit"\n    style="margin-left: 3px; float: left; width: 50%; visibility: hidden"\n  >\n    Submit\n  </button>\n  <button\n    id="display"\n    style="margin-left: 3px; float: left; width: 50%; visibility: hidden"\n  >\n    Display\n  </button>\n</div>\n')({id:t}));function o(){var t=r.find("#table")[0],e=t.rows.length,n=t.insertRow(t.rows.length),i=n.insertCell(0),o=n.insertCell(1),a=n.insertCell(2),s=n.insertCell(3),l=document.createElement("input"),u=document.createElement("input"),c=document.createElement("input"),d=document.createElement("input");l.id=e+"0",u.id=e+"1",c.id=e+"2",d.id=e+"3",u.type="text",c.type="text",d.type="text",i.appendChild(l),o.appendChild(u),a.appendChild(c),s.appendChild(d)}this.setValue=function(t){i=t},this.getValue=function(){return i},this.get$node=function(){return r},this.setValueFromJSON=function(t){i.setValueFromJSON(t.value)},r.find(".attribute_name").text(this.getName()),r.find(".attribute_value").append(i.get$node()),this.showTable=function(){r.find("#table")[0].style.visibility="visible",r.find("#b")[0].style.visibility="visible",r.find("#c")[0].style.visibility="visible",r.find("#submit")[0].style.visibility="visible",r.find("#display")[0].style.visibility="visible"},this.hideTable=function(){r.find("#table")[0].style.visibility="hidden",r.find("#b")[0].style.visibility="hidden",r.find("#c")[0].style.visibility="hidden",r.find("#submit")[0].style.visibility="hidden",r.find("#display")[0].style.visibility="hidden"},r.find("#b").click((function(){o()})),r.find("#c").click((function(){var t=r.find("#table")[0],e=t.rows.length;t.deleteRow(e-1)})),r.find("#submit").click((function(){var t=r.find("#table")[0],e={};e.topic=r.find("#topic")[0].value;for(var n=[],i=[],o=[],a=[],s=t.rows.length,l=2;l<s;l++)""!=r.find("#"+l.toString()+"1")[0].value&&""!=r.find("#"+l.toString()+"2")[0].value&&(n.push(r.find("#"+l.toString()+"0")[0].value),i.push(r.find("#"+l.toString()+"1")[0].value),o.push(r.find("#"+l.toString()+"2")[0].value),""==r.find("#"+l.toString()+"3")[0].value?a.push("No Hint Available for this Question"):a.push(r.find("#"+l.toString()+"3")[0].value));e.Questions=i,e.Sequence=n,e.Intents=o,e.Hints=a,console.log(JSON.stringify(e)),r.find(".val")[0].value=JSON.stringify(e),r.find(".val")[0].dispatchEvent(new Event("input"))})),r.find("#display").click((function(){var t=r.find("#table")[0],e=r.find(".val")[0].value;console.log(e);var n=JSON.parse(e);r.find("#topic")[0].value=n.topic;var i=n.Questions.length;console.log(i);var a=t.rows.length-2;if(console.log(a),a<i)for(;a<i;a++)o();for(var s=2;s<i+2&&null!=r.find("#"+s.toString()+"0")[0].value;s++)r.find("#"+s.toString()+"0")[0].value=n.Sequence[s-2],r.find("#"+s.toString()+"1")[0].value=n.Questions[s-2],r.find("#"+s.toString()+"2")[0].value=n.Intents[s-2],r.find("#"+s.toString()+"3")[0].value=n.Hints[s-2]}))}}class Nx extends bx{constructor(t,e,n,i,r){super(t,e,n,i);var o=this,a=Object.keys(r)[0],s=$(su.template('<select class="val form-select mb-3 h-100">\n  <% _.each(options,function(option,key){ %>\n  <option value="<%= key %>"><%= option %></option>\n  <% }); %>\n</select>\n')({name:e,options:r})),l=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),u=function(t,e){o.setValue(t.getValue())};this.propagateValueChange=function(t,e,n){var i=new I_(o.getEntityId(),e,t,n,l.getUser()[f_.NS.PERSON.JABBERID]);c(i)};var c=function(t){u(t);var e=y.getMap("nodes").get(i.getEntityId());e&&e.set(o.getEntityId(),t.toJSON())},d=function(t){t instanceof I_&&t.getEntityId()===o.getEntityId()&&u(t)};this.setValue=function(t){void 0!==t?("Content Type"==e&&("Quiz"==t?Object.values(i.getAttributes()).forEach((t=>{t instanceof Px&&t.showTable()})):Object.values(i.getAttributes()).forEach((t=>{t instanceof Px&&t.hideTable()}))),a=t,s.val(t)):console.error("value is undefined")},this.getValue=function(){return a},this.get$node=function(){return s},this.registerCallbacks=function(){l.registerOnDataReceivedCallback(d)},this.unregisterCallbacks=function(){l.unregisterOnDataReceivedCallback(d)},this.setValueFromJSON=function(t){this.setValue(t.value)},s.off(),s.change((function(){o.propagateValueChange(f_.OPERATION.TYPE.UPDATE,$(this).val(),0)})),l&&o.registerCallbacks()}}class Cx extends yx{static TYPE="KeySelectionValueAttribute";constructor(t,e,n,i){super(t,e,n);var r=this,o=i,a=new kx(t+"[key]","Attribute Name",this,this.getRootSubjectEntity()),s=new Nx(t+"[value]","Attribute Type",this,this.getRootSubjectEntity(),o),l=$(su.template('<li class="attribute_key_value_attribute input-group mb-3">\n  <div class="key flex-fill"></div>\n  <div class="attribute_value"></div>\n  <button type="button" class="btn btn-danger">\n    <i class="bi bi-trash-fill"></i>\n  </button>\n</li>\n<hr />\n')({id:t})),u=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),c=function(t){t instanceof T_&&t.getEntityId()===r.getEntityId()&&function(t){n.deleteAttribute(t.getEntityId()),r.get$node().remove()}(t)};this.setKey=function(t){a=t},this.getKey=function(){return a},this.setValue=function(t){s=t},this.getValue=function(){return s},this.get$node=function(){return l},this.setValueFromJSON=function(t){a.setValueFromJSON(t.key),s.setValueFromJSON(t.value)},this.registerCallbacks=function(){u.registerOnDataReceivedCallback(c)},this.unregisterCallbacks=function(){u.unregisterOnDataReceivedCallback(c),s.unregisterCallbacks()},l.find(".key").append(a.get$node()),l.find(".attribute_value").append(s.get$node()),l.find(".btn-danger").click((function(){!function(t){u.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation()),uT.storeDataYjs()}(new T_(r.getEntityId(),r.getSubjectEntityId(),r.getRootSubjectEntity().getEntityId(),Cx.TYPE),f_.WIDGET.NAME.MAIN)})),u&&r.registerCallbacks()}}class jx extends yx{constructor(t,e,n,i){super(t,e,n);var r=this,o=i,a={},s=$(su.template('<div class="list_attribute">\n  <div class="attribute_name"></div>\n  <ul class="list"></ul>\n  <button type="button" class="btn btn-success">\n    <i class="bi bi-plus-circle-fill"></i>\n  </button>\n</div>\n')()),l=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),u=function(t){t instanceof O_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&function(t){var e=new Cx(t.getEntityId(),"Attribute",r,o),i=y.getMap("nodes").get(n.getEntityId()).get(e.getKey().getEntityId());if(!i)throw new Error("ytext is undefined");e.getKey().registerYType(i),r.addAttribute(e),0===s.find(".list").find("#"+e.getEntityId()).length&&s.find(".list").append(e.get$node())}(t)},c=function(t){t instanceof T_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&function(t){var e=r.getAttribute(t.getEntityId());e&&(r.deleteAttribute(e.getEntityId()),e.get$node().remove())}(t)};for(var d in this.addAttribute=function(t){var e=t.getEntityId();a.hasOwnProperty(e)||(a[e]=t)},this.getAttribute=function(t){return a.hasOwnProperty(t)?a[t]:null},this.deleteAttribute=function(t){a.hasOwnProperty(t)&&delete a[t]},this.getAttributes=function(){return a},this.setAttributes=function(t){a=t},this.get$node=function(){return s},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new Cx(n,n,r,o);i.setValueFromJSON(t.list[n]),r.addAttribute(i),s.find(".list").append(i.get$node())}))},this.unregisterCallbacks=function(){var t=this.getAttributes();for(var e in t)t.hasOwnProperty(e)&&t[e].unregisterCallbacks()},s.find(".attribute_name").text(this.getName()),a)a.hasOwnProperty(d)&&s.find(".list").append(a[d].get$node());s.find(".btn-success").click((function(){var t=Z_.generateRandomId();!function(t){l.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())}(new O_(t,r.getEntityId(),r.getRootSubjectEntity().getEntityId(),Cx.TYPE))}));y.getMap("nodes").get(n.getEntityId()).observe((function(t){Array.from(t.changes.keys.entries()).forEach((([t,e])=>{if(-1===t.indexOf("[key]"))return;switch(e.action){case"add":{const e=new O_(t.replace(/\[\w*\]/g,""),r.getEntityId(),r.getRootSubjectEntity().getEntityId(),r.constructor.name);u(e);break}case"delete":{const e=new T_(t.replace(/\[\w*\]/g,""),r.getEntityId(),r.getRootSubjectEntity().getEntityId(),r.constructor.name);c(e);break}}}))}))}}class Mx extends yx{static TYPE="KeySelectionValueSelectionValueAttribute";constructor(t,e,n,i,r){super(t,e,n);var o=this,a=i,s=r,l=new kx(t+"[key]","Attribute Name",this,this.getRootSubjectEntity()),u=new Nx(t+"[value]","Attribute Type",this,this.getRootSubjectEntity(),a),c=new Nx(t+"[value2]","Attribute Position",this,this.getRootSubjectEntity(),s),d=$(su.template('<li class="attribute_key_value_attribute input-group mb-3">\n  <div class="attribute_key flex-fill"></div>\n  <div class="attribute_value"></div>\n  <div class="attribute_value2"></div>\n  <button type="button" class="btn btn-danger">\n    <i class="bi bi-trash-fill"></i>\n  </button>\n</li>\n<hr />\n')({id:t})),f=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE);this.propagateAttributeDeleteOperation=function(t){f.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())};var p=function(t){t instanceof T_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&function(t){n.deleteAttribute(t.getEntityId()),o.get$node().remove()}(t)};this.setKey=function(t){l=t},this.getKey=function(){return l},this.setValue=function(t){u=t},this.getValue=function(){return u},this.setValue2=function(t){c=t},this.getValue2=function(){return c},this.get$node=function(){return d},this.setValueFromJSON=function(t){l.setValueFromJSON(t.key),u.setValueFromJSON(t.value),c.setValueFromJSON(t.value2||{value:""})},this.registerCallbacks=function(){f.registerOnDataReceivedCallback(p)},this.unregisterCallbacks=function(){f.unregisterOnDataReceivedCallback(p)},d.find(".attribute_key").append(l.get$node()),d.find(".attribute_value").append(u.get$node()),d.find(".attribute_value2").append(c.get$node()),d.find(".btn-danger").click((function(){var t=new T_(o.getEntityId(),o.getSubjectEntityId(),o.getRootSubjectEntity().getEntityId(),Mx.TYPE);o.propagateAttributeDeleteOperation(t)})),f&&o.registerCallbacks()}}class Dx extends yx{constructor(t,e,n,i,r){super(t,e,n);var o=this,a=i,s=r,l={},u=$(su.template('<div class="list_attribute">\n  <div class="attribute_name"></div>\n  <ul class="list"></ul>\n  <button type="button" class="btn btn-success">\n    <i class="bi bi-plus-circle-fill"></i>\n  </button>\n</div>\n')()),c=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),d=function(t){t instanceof T_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&function(t){var e=o.getAttribute(t.getEntityId());e&&(o.deleteAttribute(e.getEntityId()),e.get$node().remove())}(t)};this.propagateAttributeAddOperation=function(t){c.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())};var f=function(t){t instanceof O_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&function(t){var e=new Mx(t.getEntityId(),"Attribute",o,a,s),i=y.getMap("nodes").get(n.getEntityId()).get(e.getKey().getEntityId());if(!i)throw new Error("ytext is undefined");e.getKey().registerYType(i),o.addAttribute(e),0===u.find(".list").find("#"+e.getEntityId()).length&&u.find(".list").append(e.get$node())}(t)};for(var p in this.addAttribute=function(t){var e=t.getEntityId();l.hasOwnProperty(e)||(l[e]=t)},this.getAttribute=function(t){return l.hasOwnProperty(t)?l[t]:null},this.deleteAttribute=function(t){l.hasOwnProperty(t)&&delete l[t]},this.getAttributes=function(){return l},this.setAttributes=function(t){l=t},this.get$node=function(){return u},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new Mx(n,n,o,a,s);i.setValueFromJSON(t.list[n]),o.addAttribute(i),u.find(".list").append(i.get$node())}))},this.registerCallbacks=function(){c.registerOnDataReceivedCallback(d)},this.unregisterCallbacks=function(){c.unregisterOnDataReceivedCallback(d)},u.find(".attribute_name").text(this.getName()),l)l.hasOwnProperty(p)&&u.find(".list").append(l[p].get$node());u.find(".btn-success").click((function(){var t=Z_.generateRandomId(),e=new O_(t,o.getEntityId(),o.getRootSubjectEntity().getEntityId(),Mx.TYPE);o.propagateAttributeAddOperation(e)})),c&&o.registerCallbacks();y.getMap("nodes").get(n.getEntityId()).observe((function(t){Array.from(t.changes.keys.entries()).forEach((function(t){const e=t[0],n=t[1].action;if(-1!=e.indexOf("[key]"))switch(n){case"add":{const t=new O_(e.replace(/\[\w*\]/g,""),o.getEntityId(),o.getRootSubjectEntity().getEntityId(),o.constructor.name);f(t);break}case"delete":{const t=new T_(e.replace(/\[\w*\]/g,""),o.getEntityId(),o.getRootSubjectEntity().getEntityId(),o.constructor.name);d(t)}}}))}))}}class Rx extends bx{constructor(t,e,n,i){super(t,e,n,i);var r=this,o=null,a="",l=null,u=!1,c=$('<button\n  class="btn btn-outline-secondary"\n  data-bs-toggle="modal"\n  data-bs-target="#editor-modal"\n>\n  Open Code Editor\n</button>\n'),d=function(){var t=y.getMap("nodes").get(i.getEntityId());t&&function(t){u||(u=!0,new s(o=t,l),g(t,a))}(t.get(n.getEntityId()))};const f=p_(f_.WIDGET.NAME.ATTRIBUTE),p="editor-"+i.getEntityId();if(l)$(l.container).parent().show();else{var h=$(su.template('<div\n  class="modal"\n  tabindex="-1"\n  id="editor-modal"\n  style="z-index: 3000000000 !important"\n>\n  <div class="modal-dialog modal-dialog-scrollable">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title"><%= title %></h5>\n        <button\n          type="button"\n          class="btn-close"\n          data-bs-dismiss="modal"\n          aria-label="Close"\n        ></button>\n      </div>\n      <div class="modal-body">\n        <div id="<%= id %>"></div>\n      </div>\n    </div>\n  </div>\n</div>\n')({id:p,title:e}));$(f).find(".main-wrapper").append(h);const t=h.get(0).querySelector("#"+p);l=new Ix(t,{theme:"snow",modules:{toolbar:!1},placeholder:"Paste your SVG code here",syntax:!0})}c.click((function(){d()})),iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),this.setValue=function(t){a=t,c.val(t)},this.getValue=function(){return a},this.get$node=function(){return c},this.setValueFromJSON=function(t){this.setValue(t.value)};var g=function(t,e){e?e!==t.toString()&&(t.toString().length>0&&t.delete(0,t.toString().length),t.insert(0,e)):r.getValue()!==t.toString()&&(t.toString().length>0&&t.delete(0,t.toString().length),t.insert(0,r.getValue()))};this.getYText=function(){return o}}}class Lx extends yx{constructor(t,e,n){super(t,e,n);var i=new Rx(t,e,this,this.getRootSubjectEntity()),r=$(su.template('<div class="attribute_single_value_attribute form-floating mb-3">\n  <span class="attribute_name"></span>\n  <div class="attribute_value"></div>\n</div>\n')({id:t}));this.setValue=function(t){i=t},this.getValue=function(){return i},this.get$node=function(){return r},this.setValueFromJSON=function(t){i.setValueFromJSON(t.value)},r.find(".attribute_name").text(this.getName()),r.find(".attribute_value").append(i.get$node())}}class Yx extends bx{constructor(t,e,n,i){super(t,e,n,i);var r=this,o=null,a="",s=$(su.template('<input\n  class="form-control val color"\n  type="color"\n  placeholder="<%= name %>"\n/><span class="color_preview"></span>\n')({name:e})),l=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),u=function(t){t.getType()===f_.OPERATION.TYPE.INSERT?a=a.substr(0,t.getPosition())+t.getValue()+a.substring(t.getPosition()):t.getType()===f_.OPERATION.TYPE.DELETE&&(a=a.substr(0,t.getPosition())+a.substring(t.getPosition()+1)),function(t,e,n,i){var r,o,a=s[0].selectionStart,l=s[0].selectionEnd;if(s.is(":focus")){switch(t){case f_.OPERATION.TYPE.INSERT:i?n<=a?(r=a+1,o=l+1):n<l?(r=a,o=l+1):(r=a,o=l):(r=n+1,o=n+1);break;case f_.OPERATION.TYPE.DELETE:i?n<a?(r=a-1,o=l-1):n<l?(r=a,o=l-1):(r=a,o=l):(r=n,o=n)}s.val(e),s[0].selectionStart=r,s[0].selectionEnd=o,s.closest(".color_preview").css("backgroundColor","#FFFFFF").css("backgroundColor",e)}else s.val(e)}(t.getType(),a,t.getPosition(),t.getRemote())},c=function(t){t instanceof I_&&t.getEntityId()===r.getEntityId()&&u(t)};this.setValue=function(t){a=t,s.val(t),s.closest(".color_preview").css("backgroundColor","#FFFFFF").css("backgroundColor",t)},this.getValue=function(){return a},this.get$node=function(){return s},this.setValueFromJSON=function(t){this.setValue(t.value)},this.registerCallbacks=function(){l.registerOnDataReceivedCallback(c)},this.unregisterCallbacks=function(){l.unregisterOnDataReceivedCallback(c)};this.getYText=function(){return o},this.registerYType=function(t){o=t,function(t,e){e?e!==t.toString()&&(t.toString().length>0&&t.delete(0,t.toString().length),t.insert(0,e)):r.getValue()!==t.toString()&&(t.toString().length>0&&t.delete(0,t.toString().length),t.insert(0,r.getValue()))}(t)}}}class Vx extends yx{constructor(t,e,n){super(t,e,n);var i=new Yx(t,e,this,this.getRootSubjectEntity()),r=$(su.template('<div class="attribute_single_value_attribute form-floating mb-3">\n  <span class="attribute_name"></span>\n  <div class="attribute_value"></div>\n</div>\n')({id:t}));this.setValue=function(t){i=t},this.getValue=function(){return i},this.get$node=function(){return r},this.setValueFromJSON=function(t){i.setValueFromJSON(t.value)},r.find(".attribute_name").text(this.getName()),r.find(".attribute_value").append(i.get$node())}}class Bx extends bx{constructor(t,e,n,i){super(t,e,n,i);var r=this,o=null,a="";let l=e.replace(/ /g,"-");l=l.toLowerCase();var u,c=$(su.template('<div id="<%= id %>"></div>\n')({id:l}));iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),this.setValue=function(t){a=t,c.val(t)},this.getValue=function(){return a},this.get$node=function(){return c},this.setValueFromJSON=function(t){this.setValue(t.value)};this.registerYType=function(t){o=t;const n=document.querySelector("#"+l);if(!n)throw new Error("Editor not found "+l);if(u=new Ix(n,{theme:"snow",modules:{toolbar:!1},placeholder:e}),!o)throw new Error("YText not found");new s(o,u),o?.observe((function(){a=o.toString()})),window.syncmetaLog.initializedYTexts+=1,window.syncmetaLog.hasOwnProperty(this.getEntityId())?window.syncmetaLog.objects[this.getEntityId()]+=1:window.syncmetaLog.objects[this.getEntityId()]=0,function(t,e){e?e!==t.toString()&&(t.toString().length>0&&t.delete(0,t.toString().length),t.insert(0,e)):r.getValue()!==t.toString()&&(t.toString().length>0&&t.delete(0,t.toString().length),t.insert(0,r.getValue()))}(t)},this.getYText=function(){return o}}}class $x extends yx{constructor(t,e,n){super(t,e,n);var i=new Bx(t,e,this,this.getRootSubjectEntity()),r=$(su.template('<div class="attribute_single_value_attribute form-floating mb-3">\n  <span class="attribute_name"></span>\n  <div class="attribute_value"></div>\n</div>\n')({id:t}));this.setValue=function(t){i=t},this.getValue=function(){return i},this.get$node=function(){return r},this.setValueFromJSON=function(t){i.setValueFromJSON(t.value)},r.find(".attribute_name").text(this.getName()),r.find(".attribute_value").append(i.get$node())}}class Fx extends yx{constructor(t,e,n,i){super(t,e,n);var r=new Nx(t,e,this,this.getRootSubjectEntity(),i),o=$(su.template('<div class="attribute_single_value_attribute">\n  <div class="attribute_name"></div>\n  <div class="attribute_value"></div>\n</div>\n')());if(this.setValue=function(t){r=t},this.getValue=function(){return r},this.getOptionValue=function(){return i.hasOwnProperty(r.getValue())?i[r.getValue()]:null},this.get$node=function(){return o},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},o.find(".attribute_name").text(this.getName()),o.find(".attribute_value").append(r.get$node()),window.hasOwnProperty("y")){y.getMap("widgetConfig").get("view_only_property_browser")&&o.find(".val").attr("disabled","true")}}}class Gx extends yx{constructor(t,e,n){super(t,e,n);var i=new kx(t,e,this,this.getRootSubjectEntity()),r=$(su.template('<div class="attribute_single_value_attribute form-floating mb-3">\n  <span class="attribute_name"></span>\n  <div class="attribute_value"></div>\n</div>\n')({id:t}));if(this.setValue=function(t){i=t},this.getValue=function(){return i},this.get$node=function(){return r},this.setValueFromJSON=function(t){i.setValueFromJSON(t.value)},r.find("attribute_name").text(this.getName()),r.find(".attribute_value").append(i.get$node()),window.hasOwnProperty("y")){y.getMap("widgetConfig").get("view_only_property_browser")&&r.find(".val").attr("disabled","true")}}}class qx extends yx{constructor(t,e,n){super(t,e,n);var i=this,r=new kx(t,e,this,this.getRootSubjectEntity()),o=$(su.template('<div class="attribute_single_value_attribute input-group mb-3">\n  <div\n    class="attribute_name input-group-text overflow-auto"\n    style="max-width: 40%"\n  ></div>\n  <div class="attribute_value flex-fill"></div>\n  <button type="button" class="btn btn-danger">\n    <i class="bi bi-trash-fill"></i>\n  </button>\n</div>\n')({id:t})),a=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE,window.y),s=function(t){t instanceof T_&&t.getRootSubjectEntityId()===i.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===i.getEntityId()&&function(t){n.deleteAttribute(t.getEntityId()),i.get$node().remove()}(t)};this.setValue=function(t){r=t},this.getValue=function(){return r},this.get$node=function(){return o},this.setValueFromJSON=function(t){r.setValueFromJSON(t.value)},this.registerCallbacks=function(){a.registerOnDataReceivedCallback(s)},this.unregisterCallbacks=function(){a.unregisterOnDataReceivedCallback(s)},o.find(".attribute_name").text(this.getName()),o.find(".attribute_value").append(r.get$node()),o.find(".btn-danger").click((function(){!function(t){a.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())}(new T_(i.getEntityId(),i.getSubjectEntityId(),i.getRootSubjectEntity().getEntityId(),qx.TYPE),f_.WIDGET.NAME.MAIN)})),a&&i.registerCallbacks()}}class Ux extends yx{constructor(t,e,n){super(t,e,n);var i=this,r={},o=$(su.template('<div class="list_attribute">\n  <div class="attribute_name"></div>\n  <ul class="list"></ul>\n  <button type="button" class="btn btn-success">\n    <i class="bi bi-plus-circle-fill"></i>\n  </button>\n</div>\n')()),a=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE,window.y),s=function(t){t instanceof O_&&t.getRootSubjectEntityId()===i.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===i.getEntityId()&&function(t){var e=new qx(t.getEntityId()+"[value]","Attribute",i),r=y.getMap("nodes").get(n.getEntityId()).get(e.getValue().getEntityId());e.getValue().registerYType(r),i.addAttribute(e),0===o.find(".list").find("#"+e.getEntityId().replace("[","\\[").replace("]","\\]")).length&&o.find(".list").append(e.get$node())}(t)},l=function(t){t instanceof T_&&t.getRootSubjectEntityId()===i.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===i.getEntityId()&&function(t){var e=i.getAttribute(t.getEntityId());e&&(i.deleteAttribute(e.getEntityId()),e.get$node().remove())}(t)};for(var u in this.addAttribute=function(t){var e=t.getEntityId();r.hasOwnProperty(e)||(r[e]=t)},this.getAttribute=function(t){return r.hasOwnProperty(t)?r[t]:null},this.deleteAttribute=function(t){r.hasOwnProperty(t)&&delete r[t]},this.getAttributes=function(){return r},this.setAttributes=function(t){r=t},this.get$node=function(){return o},this.setValueFromJSON=t=>{su.forEach(t.list,(function(e,n){var r=new qx(n,"Attribute",i);r.setValueFromJSON(t.list[n]),i.addAttribute(r),o.find(".list").append(r.get$node())}))},o.find(".attribute_name").text(this.getName()),r)r.hasOwnProperty(u)&&o.find(".list").append(r[u].get$node());o.find(".btn-success").click((function(){var t=Z_.generateRandomId();const e=y.getMap("users");!function(t){a.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())}(new O_(t,i.getEntityId(),i.getRootSubjectEntity().getEntityId(),qx.TYPE,e.get(y.clientID)))}));y.getMap("nodes").get(n.getEntityId()).observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{if(-1!=e.indexOf("[value]"))switch(n.action){case"add":{if(t.currentTarget.get("jabberId")===iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE).getUser()[f_.NS.PERSON.JABBERID])return;const n=new O_(e.replace(/\[\w*\]/g,""),i.getEntityId(),i.getRootSubjectEntity().getEntityId(),i.constructor.name);s(n);break}case"delete":{const t=new T_(e,i.getEntityId(),i.getRootSubjectEntity().getEntityId(),i.constructor.name);l(t);break}}}))}))}}function zx(t,e){function n(n,i,r){var o=new e(n,i,r);return o.applyAttributeRenaming(t),o}return n.getAttributes=function(){return t},n.getTargetEdgeType=function(){return e},n}function Jx(t,e,n){function i(t,i,r,o,a,s){var l=new n(t,i,r,o,a,s);return l.applyAttributeRenaming(e),l}return i.prototype.constructor=i,i.getTargetNodeType=function(){return n},i.getAttributes=function(){return e},i}class Wx extends yx{static TYPE="ConditionPredicateAttribute";constructor(t,e,n,i,r){super(t,e,n);var o=this,a=i,s=r,l=new kx(t+"[value]","Attribute Value",this,this.getRootSubjectEntity()),u=new Nx(t+"[property]","Attribute Name",this,this.getRootSubjectEntity(),a),c=new Nx(t+"[operator]","Logical Operator",this,this.getRootSubjectEntity(),s),d=$(su.template('<li class="condition_predicate">\n  <div class="property"></div>\n  <div class="operator"></div>\n  <div class="val"></div>\n  <div class="operator2" style="display: none"></div>\n  <button type="button" class="btn btn-danger">\n    <i class="bi bi-trash-fill"></i>\n  </button>\n</li>\n')()),f=iO.getInstance(CONFIG.WIDGET.NAME.ATTRIBUTE);this.propagateAttributeDeleteOperation=function(t){p(t),f.sendLocalOTOperation(CONFIG.WIDGET.NAME.MAIN,t.getOTOperation())};var p=function(t){n.deleteAttribute(t.getEntityId()),o.get$node().remove()},h=function(t){t instanceof T_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&p(t)};this.setKey=function(t){l=t},this.getKey=function(){return l},this.setValue=function(t){u=t},this.getValue=function(){return u},this.setValue2=function(t){c=t},this.getValue2=function(){return c},this.get$node=function(){return d},this.setValueFromJSON=function(t){l.setValueFromJSON(t.val),u.setValueFromJSON(t.property),c.setValueFromJSON(t.operator||{value:""})},this.registerCallbacks=function(){f.registerOnDataReceivedCallback(h)},this.unregisterCallbacks=function(){f.unregisterOnDataReceivedCallback(h)},d.find(".val").append(l.get$node()),d.find(".property").append(u.get$node()),d.find(".operator").append(c.get$node()),d.find(".btn-danger").click((function(){var t=new T_(o.getEntityId(),o.getSubjectEntityId(),o.getRootSubjectEntity().getEntityId(),Wx.TYPE);o.propagateAttributeDeleteOperation(t)})),f&&o.registerCallbacks()}}class Hx extends yx{constructor(t,e,n,i,r){super(t,e,n);var o=this,a=i,s=r,l={},u=$(su.template('<div class="list_attribute">\n  <div class="attribute_name"></div>\n  <ul class="list"></ul>\n  <button type="button" class="btn btn-success">\n    <i class="bi bi-plus-circle-fill"></i>\n  </button>\n</div>\n')()),c=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),d=function(t){t instanceof T_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&function(t){var e=o.getAttribute(t.getEntityId());e&&(o.deleteAttribute(e.getEntityId()),e.get$node().remove())}(t)},f=function(t){t instanceof O_&&t.getRootSubjectEntityId()===o.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===o.getEntityId()&&function(t){var e;o.getAttributes().hasOwnProperty(t.getEntityId())?e=o.getAttribute(t.getEntityId()):(e=new Wx(t.getEntityId(),"Attribute",o,a,s),o.addAttribute(e),u.find(".list").append(e.get$node()));var i=y.getMap("nodes").get(n.getEntityId()).get(e.getKey().getEntityId());if(!i)throw new Error("ytext is undefined");e.getKey().registerYType(i),u.find(".list .operator2").show(),u.find(".list").append(e.get$node())}(t)};for(var p in this.addAttribute=function(t){var e=t.getEntityId();l.hasOwnProperty(e)||(l[e]=t)},this.getAttribute=function(t){return l.hasOwnProperty(t)?l[t]:null},this.deleteAttribute=function(t){l.hasOwnProperty(t)&&delete l[t]},this.getAttributes=function(){return l},this.setAttributes=function(t){l=t},this.get$node=function(){return u},this.setOptions=function(t){a=t},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new Wx(n,n,o,a,s);i.setValueFromJSON(t.list[n]),o.addAttribute(i),u.find(".list").append(i.get$node())}))},u.find(".attribute_name").text(this.getName()),l)l.hasOwnProperty(p)&&u.find(".list").append(l[p].get$node());u.find(".btn-success").click((function(){var t=Z_.generateRandomId();!function(t){c.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())}(new O_(t,o.getEntityId(),o.getRootSubjectEntity().getEntityId(),Wx.TYPE))}));y.getMap("nodes").get(n.getEntityId()).observe((function(t){Array.from(t.changes.keys.entries()).forEach((([e,n])=>{if(-1!=e.indexOf("[value]"))switch(n.action){case"add":{const t=new O_(e.replace(/\[\w*\]/g,""),o.getEntityId(),o.getRootSubjectEntity().getEntityId(),o.constructor.name);f(t);break}case"delete":{const t=new T_(e.replace(/\[\w*\]/g,""),o.getEntityId(),o.getRootSubjectEntity().getEntityId(),o.constructor.name);d(t);break}}else-1!=e.indexOf("updateConditionOption")&&o.setOptions(t.value)}))}))}}class Xx extends yx{static TYPE="RenamingAttribute";constructor(t,e,n,i){super(t,e,n);var r=this,o=i,a=new kx(t+"[val]","Attribute Name",this,this.getRootSubjectEntity()),s=new kx(t+"[ref]","Attribute Reference",this,this.getRootSubjectEntity()),l=new Nx(t+"[vis]","Attribute Visibility",this,this.getRootSubjectEntity(),o),u=$(su.template('<li class="renaming_attr">\n    <div class="val"></div>\n    <div class="ref" ></div>\n    <div class="vis"></div>\n</li>')()),c=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE);this.propagateAttributeDeleteOperation=function(t){d(t),c.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())};var d=function(t){n.deleteAttribute(t.getEntityId()),r.get$node().remove()},f=function(t){t instanceof T_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&d(t)};this.setKey=function(t){a=t},this.getKey=function(){return a},this.getRef=function(){return s},this.setVisibility=function(t){l=t},this.get$node=function(){return u},this.setValueFromJSON=function(t){a.setValueFromJSON(t.val),s.setValueFromJSON(t.ref),l.setValueFromJSON(t.vis||{value:""})},this.registerCallbacks=function(){c.registerOnDataReceivedCallback(f)},this.unregisterCallbacks=function(){c.unregisterOnDataReceivedCallback(f)},u.find(".val").append(a.get$node()),u.find(".ref").append(s.get$node()),u.find(".vis").append(l.get$node()),u.find(".ref").find("input").prop("disabled",!0),c&&r.registerCallbacks()}}class Zx extends yx{constructor(t,e,n,i){super(t,e,n);var r=this,o=i,a={},s=$(su.template('<div class="list_attribute">\n  <div class="attribute_name"></div>\n  <ul class="list"></ul>\n  <button type="button" class="btn btn-success">\n    <i class="bi bi-plus-circle-fill"></i>\n  </button>\n</div>\n')());s.find(".btn-success").parent().remove();var l=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),u=function(t){t instanceof T_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&function(t){var e=r.getAttribute(t.getEntityId());e&&(r.deleteAttribute(e.getEntityId()),e.get$node().remove())}(t)};this.propagateAttributeAddOperation=function(t){l.sendLocalOTOperation(f_.WIDGET.NAME.MAIN,t.getOTOperation())};var c=function(t){t instanceof O_&&t.getRootSubjectEntityId()===r.getRootSubjectEntity().getEntityId()&&t.getSubjectEntityId()===r.getEntityId()&&(!function(t){var e;r.getAttributes().hasOwnProperty(t.getEntityId())?e=r.getAttribute(t.getEntityId()):(e=new Xx(t.getEntityId(),"Attribute",r,o),r.addAttribute(e),s.find(".list").append(e.get$node()));var i=y.getMap("nodes").get(n.getEntityId()),a=i.get(e.getKey().getEntityId());if(!a)throw new Error("ytext is undefined");e.getKey().registerYType(a);var l=i.get(e.getRef().getEntityId());e.getRef().registerYType(l)}(t),n.showAttributes())};for(var d in this.addAttribute=function(t){var e=t.getEntityId();a.hasOwnProperty(e)||(a[e]=t)},this.getAttribute=function(t){return a.hasOwnProperty(t)?a[t]:null},this.deleteAttribute=function(t){a.hasOwnProperty(t)&&delete a[t]},this.getAttributes=function(){return a},this.setAttributes=function(t){a=t},this.get$node=function(){return s},this.setOptions=function(t){o=t},this.setValueFromJSON=function(t){su.forEach(t.list,(function(e,n){var i=new Xx(n,"Attribute",r,o);i.setValueFromJSON(t.list[n]),r.addAttribute(i),s.find(".list").append(i.get$node())}))},s.find(".attribute_name").text(this.getName()),a)a.hasOwnProperty(d)&&s.find(".list").append(a[d].get$node());y.getMap("nodes").get(n.getEntityId()).observe((function(t){Array.from(t.changes.keys.entries()).forEach((function([t,e]){if(-1!=t.indexOf("[val]")){switch(e.action){case"add":{const e=new O_(t.replace(/\[\w*\]/g,""),r.getEntityId(),r.getRootSubjectEntity().getEntityId(),r.constructor.name);c(e);break}case"delete":{const e=new T_(t.replace(/\[\w*\]/g,""),r.getEntityId(),r.getRootSubjectEntity().getEntityId(),r.constructor.name);u(e);break}}}}))}))}}const Kx='<div class="attribute_default_node">\n  <h4 class="attribute_type text-center"><%=type%></h4>\n  <div class="label"></div>\n  <div class="attributes"></div>\n  <p class="show_hint"><a href="#">Show list of possible connections</a></p>\n  <p class="hint"></p>\n</div>\n',Qx='<div class="attribute_default_node">\n  <h4 class="attribute_type text-center"><%=type%></h4>\n  <div class="label"></div>\n  <div class="attributes"></div>\n  <p class="show_hint"><a href="#">Show list of possible connections</a></p>\n  <p class="hint"></p>\n</div>\n',tA='<div class="attribute_default_node">\n  <h4 class="attribute_type text-center"><%= type %></h4>\n  <div class="label"></div>\n  <div class="attributes"></div>\n  <p class="show_hint"><a href="#">Show list of possible connections</a></p>\n  <p class="hint"></p>\n</div>\n';const eA=new class{constructor(){var t=null,e=null,n={},i={},r={},o=function(t){var e,i=t.nodes,r={};for(var o in i)i.hasOwnProperty(o)&&((e=i[o]).hasOwnProperty("targetName")&&!$.isEmptyObject(n)&&n.hasOwnProperty(e.targetName)?(r[e.label]=Jx(e.label,e.attributes,n[e.targetName]),n[e.targetName].VIEWTYPE=e.label):r[e.label]=nA(e.label,e.shape.shape,e.shape.customShape,e.shape.customAnchors,e.shape.color,e.attributes));return r},a=function(t){var e,n=t.edges,r={},o={};for(var a in n)n.hasOwnProperty(a)&&((e=n[a]).hasOwnProperty("targetName")&&!$.isEmptyObject(i)&&i.hasOwnProperty(e.targetName)?(r[e.label]=zx(e.attributes,i[e.targetName]),i[e.targetName].VIEWTYPE=e.label):r[e.label]=aA(e.label,e.shape.arrow,e.shape.shape,e.shape.color,e.shape.overlay,e.shape.overlayPosition,e.shape.overlayRotate,e.attributes),o[e.label]=e.relations);return{edgeTypes:r,relations:o}},s={},l=null,u={},c={},d={};this.createNode=function(t,e,i,r,o,a,c,d){var f;return u.hasOwnProperty(t)&&l?f=u[t](e,i,r,o,a,d):n.hasOwnProperty(t)&&(f=new n[t](e,i,r,o,a,d)),s[e]=f,f},this.createModelAttributesNode=function(){return new uA("modelAttributes",t?t.attributes:null)},this.findNode=function(t){return s.hasOwnProperty(t)?s[t]:null},this.deleteNode=function(t){s.hasOwnProperty(t)&&delete s[t]},this.getNodesByType=function(t){var e,n,i={};for(e in"string"==typeof t&&(t=[t]),s)s.hasOwnProperty(e)&&(n=s[e],-1!==t.indexOf(n.getType())&&(i[e]=n));return i},this.getEdgesByType=function(t){var e,n,i={};for(e in d)d.hasOwnProperty(e)&&(n=d[e]).getType()===t&&(i[e]=n);return i},this.createEdge=function(t,e,n,r){if(!n||!r)throw new Error("Source or target node is not defined");var o;return l&&c.hasOwnProperty(t)?o=c[t](e,n,r):i.hasOwnProperty(t)&&(o=new i[t](e,n,r)),n.addOutgoingEdge(o),r.addIngoingEdge(o),d[e]=o,o},this.findEdge=function(t){return d.hasOwnProperty(t)?d[t]:null},this.deleteEdge=function(t){d.hasOwnProperty(t)&&delete d[t]},this.find=function(t){return this.findNode(t)||this.findEdge(t)},this.createModelAttributesNodeFromJSON=function(t){var e=this.createModelAttributesNode();if(e)for(var n in e.getLabel().getValue().setValue(t.label.value.value),t.attributes)if(t.attributes.hasOwnProperty(n)){var i=e.getAttribute(n);i&&i.setValueFromJSON(t.attributes[n])}return e},this.createNodeFromJSON=function(t,e,n,i,r,o,a,s){var l=this.createNode(t,e,n,i,r,o,a,s);if(!l)return console.error("Node could not be created: "+t+" "+e),null;for(var u in l.getLabel().getValue().setValue(s.label.value.value),s.attributes)if(s.attributes.hasOwnProperty(u)){var c=l.getAttribute(u);if(c)c.setValueFromJSON(s.attributes[u]);else{var d=u.replace(/[^\[\]]*/,e);if(c=l.getAttribute(d))c.setValueFromJSON(s.attributes[u]);else{var f=l.getAttributes();this.setAttributesByName(f,s.attributes[u].name,s.attributes[u])}}}return l},this.createEdgeFromJSON=function(t,e,n,i,r){const o=this.findNode(n),a=this.findNode(i);var s=this.createEdge(t,e,o,a,l);if(s)for(var u in s.getLabel().getValue().setValue(r.label.value.value),r.attributes)if(r.attributes.hasOwnProperty(u)){var c=s.getAttribute(u);if(c)c.setValueFromJSON(r.attributes[u]);else{var d=s.getAttributes();this.setAttributesByName(d,r.attributes[u].name,r.attributes[u])}}return s},this.setAttributesByName=(t,e,n)=>{for(var i in t)if(t.hasOwnProperty(i)&&t[i].getName()===e){t[i].setValueFromJSON(n);break}},this.generateConnectToText=t=>{function e(t){return"<i>"+t+"</i>"}var n,i,o,a,s,l,u,c,d,f,p,h,g,v;for(n in s=[],r)if(r.hasOwnProperty(n)){for(l=[],c=0,d=r[n].length;c<d;c++)if(i=r[n][c].sourceTypes,o=r[n][c].targetTypes,-1!==i.indexOf(t.getType()))for(f=0,p=o.length;f<p;f++){for(g in a=o[f],u=[],h=this.getNodesByType(a))if(h.hasOwnProperty(g)){if((v=h[g])===t||v.getNeighbors().hasOwnProperty(t.getEntityId()))continue;u.push(v.getLabel().getValue().getValue()||v.getType())}u.sort(),su.size(u)>0&&l.push(" to <strong>"+a+"</strong> "+su.map(u,e).join(", "))}su.size(l)>0&&s.push("..with <strong>"+n+"</strong> "+l.join(", "))}return su.size(s)>0?"This node can be connected..<br>"+su.map(s,(function(t){return t+"<br>"})).join(""):""},this.initNodeTypes=t=>{n=o(t)},this.initEdgeTypes=function(t){var e=a(t);i=e.edgeTypes,r=e.relations},this.initModelTypes=function(t){this.initNodeTypes(t),this.initEdgeTypes(t)},this.getNodeType=function(t){return n.hasOwnProperty(t)?n[t]:null},this.getEdgeType=function(t){return i.hasOwnProperty(t)?i[t]:null},this.initViewNodeTypes=function(t){for(var e in n)n.hasOwnProperty(e)&&delete n[e].VIEWTYPE;u=o(t)},this.initViewEdgeTypes=function(t){for(var e in i)i.hasOwnProperty(e)&&delete i[e].VIEWTYPE;var n=a(t);c=n.edgeTypes,r=n.relations},this.initViewTypes=function(t){this.setViewId(t.id),this.initViewNodeTypes(t),this.initViewEdgeTypes(t)},this.getViewNodeType=function(t){return u.hasOwnProperty(t)?u[t]:null},this.getViewEdgeType=function(t){return c.hasOwnProperty(t)?c[t]:null},this.setViewId=function(t){l=t},this.getViewId=function(){return l},this.getLayer=function(){return e},this.init=function(s){if(console.log("init model types for attribute widget"),(t=s)&&t.hasOwnProperty("nodes")?(n=o(t),e=f_.LAYER.MODEL):(e=f_.LAYER.META,n[dA.TYPE]=dA,n[oA.TYPE]=oA,n[pA.TYPE]=pA,n[fA.TYPE]=fA,n[lA.TYPE]=lA,n[cA.TYPE]=cA,n[sA.TYPE]=sA,n[hA.TYPE]=hA,n[gA.TYPE]=gA),t&&t.hasOwnProperty("edges")){var l=a(t);i=l.edgeTypes,r=l.relations}else i[bA.TYPE]=bA,i[yA.TYPE]=yA,i[vA.TYPE]=vA,r[yA.TYPE]=yA.RELATIONS,r[vA.TYPE]=vA.RELATIONS,r[bA.TYPE]=bA.RELATIONS},this.getEdges=function(){return d},this.getNodes=function(){return s}}};function nA(t,e,n,i,r,o){return class extends iA{constructor(e,n,i,r,a){super(e,t,n,i,r,a);var s=this,l=$(su.template(tA)({type:t})),u=iA.prototype.get$node.call(this).append(l);!function(){var t,n,i={};for(n in o)if(o.hasOwnProperty(n)){if((t=o[n]).hasOwnProperty("visibility")&&"hide"===t.visibility)continue;switch(t.value){case"boolean":i[n]=new Ex(e+"["+t.key.toLowerCase()+"]",t.key,s);break;case"string":i[n]=new Gx(e+"["+t.key.toLowerCase()+"]",t.key,s),"label"!==t.key.toLowerCase()&&"title"!==t.key.toLowerCase()&&"name"!==t.key.toLowerCase()||s.setLabel(i[n]);break;case"integer":i[n]=new xx(e+"["+t.key.toLowerCase()+"]",t.key,s);break;case"file":i[n]=new Ox(e+"["+t.key.toLowerCase()+"]",t.key,s);break;case"quiz":i[n]=new Px(e+"["+t.key.toLowerCase()+"]",t.key,s),"label"!==t.key.toLowerCase()&&"title"!==t.key.toLowerCase()&&"name"!==t.key.toLowerCase()||s.setLabel(i[n]);default:t.options&&(i[n]=new Fx(e+"["+t.key.toLowerCase()+"]",t.key,s,t.options))}}s.setAttributes(i);var r=u.find(".attributes");for(var a in i)i.hasOwnProperty(a)&&r.append(i[a].get$node())}()}static getType(){return t}static getAttributes(){return o}registerYType(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(this.getEntityId()),e=this.getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getValue(),r=t.get(i.getEntityId());i.hasOwnProperty("registerYType")&&i.registerYType(r)}}applyAttributeRenaming(t){var e,n,i=this.getAttributes();for(var r in i)i.hasOwnProperty(r)&&(e=t[r],n=i[r].get$node(),e?"hide"===e.visibility?n.hide():(n.find(".attribute_name").text(e.key),n.is(":hidden")&&n.show()):n.hide())}}}class iA extends vx{constructor(t,e,n,i,r,o,a,s){super(t);var l=this,u=s,c=e,d=a,f=new Gx(t+"[label]","Label",this),p={left:n,top:i,width:r,height:o},h=null,g=$(su.template('<div class="attribute_abstract-node"></div>\n')({id:t})),v=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),b={},m={},E={},w={},_={},O=function(t){t instanceof k_&&t.getSelectedEntityId()===l.getEntityId()&&($(".ace-container").hide(),h.get$node().is(":hidden")&&h.get$node().show(),h.select(l))},T=function(t){t instanceof m_&&t.getEntityId()===l.getEntityId()&&function(t){var e,n=l.getEdges();for(e in n)n.hasOwnProperty(e)&&n[e].remove();l.remove()}()};this.addToWrapper=function(t){(h=t).get$node().append(g.hide()),g.find(".show_hint a").click((function(t){var e=$(this),n=g.find(".hint");t.preventDefault(),n.is(":visible")?(n.hide(),e.text("Show list of possible connections")):(n.show(),e.text("Hide list of possible connections"))})).text("Show list of possible connections"),g.find(".hint").hide()},this.removeFromWrapper=function(){h=null,g.remove()},this.addAttribute=function(t){var e=t.getEntityId();b.hasOwnProperty(e)||(b[e]=t)},this.getAttribute=function(t){return b.hasOwnProperty(t)?b[t]:null},this.deleteAttribute=function(t){b.hasOwnProperty(t)||delete b[t]},this.setAttributes=function(t){b=t},this.getAttributes=function(){return b},this.setLabel=function(t){f=t},this.getViewId=function(){return u},this.setViewId=function(t){u=t},this.getLabel=function(){return f},this.getType=function(){return c},this.getContainment=function(){return d},this._get$node=function(){return g},this.addIngoingEdge=function(t){var e=t.getEntityId(),n=t.getSource(),i=n.getEntityId();m.hasOwnProperty(e)||(m[e]=t,w.hasOwnProperty(i)||(w[i]=n))},this.addOutgoingEdge=function(t){var e=t.getEntityId(),n=t.getTarget(),i=n?.getEntityId();E.hasOwnProperty(e)||(E[e]=t,_.hasOwnProperty(i)||(_[i]=n))},this.deleteIngoingEdge=function(t){var e=t.getEntityId(),n=t.getSource().getEntityId(),i=!1;if(m.hasOwnProperty(e)){for(var r in delete m[e],m)m.hasOwnProperty(r)&&m[r].getSource().getEntityId()===n&&(i=!0);i||delete w[n]}},this.deleteOutgoingEdge=function(t){var e=t.getEntityId(),n=t.getTarget(),i=n?.getEntityId(),r=!1;if(E.hasOwnProperty(e)){for(var o in delete E[e],E)E.hasOwnProperty(o)&&E[o].getTarget().getEntityId()===i&&(r=!0);r||delete _[i]}},this.getIngoingEdges=function(){return m},this.getOutgoingEdges=function(){return E},this.getEdges=function(){return Z_.union(m,E)},this.getIngoingNeighbors=function(){return w},this.getOutgoingNeighbors=function(){return _},this.getNeighbors=function(){return Z_.union(w,_)},this.select=function(){var t=eA.generateConnectToText(this);g.find(".hint").html(t).hide(),g.find(".show_hint").toggle(""!==t),this.show()},this.unselect=function(){this.hide()},this.hide=function(){g.hide()},this.show=function(){g.show()},this._remove=function(){this.removeFromWrapper(),this.unregisterCallbacks(),eA.deleteNode(this.getEntityId()),this.unregisterCallbacks()},this.toJSON=function(){return{id:t,label:f.getValue(),appearance:p}},this.registerCallbacks=function(){v.registerOnDataReceivedCallback(O),v.registerOnDataReceivedCallback(T)},this.unregisterCallbacks=function(){v.unregisterOnDataReceivedCallback(O),v.unregisterOnDataReceivedCallback(T)},this._registerYType=function(){var t=y.getMap("nodes").get(l.getEntityId());if(t){var e=t.get(l.getLabel().getValue().getEntityId());l.getLabel().getValue().registerYType(e)}},v&&l.registerCallbacks()}draw(){return this._draw()}get$node(){return this._get$node()}registerYType(){this._registerYType()}remove(){this._remove()}}class rA extends vx{constructor(t,e,n,i,r){super(e);var o=this,a=t,s=r,l=new Gx(e+"[label]","Label",this),u={source:n,target:i},c=$(su.template('<div class="abstract-edge">\n  <div class="attribute_default_node">\n    <h4 class="attribute_type text-center"><%= type %></h4>\n    <div class="label"></div>\n    <div class="attributes"></div>\n  </div>\n</div>\n')({id:e,type:t})),d=null,f=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),p={},h=function(t){t instanceof k_&&t.getSelectedEntityId()===o.getEntityId()&&($(".ace-container").hide(),d.get$node().is(":hidden")&&d.get$node().show(),d.select(o))},g=function(t){t instanceof w_&&t.getEntityId()===o.getEntityId()&&(o.getSource().deleteOutgoingEdge(o),o.getTarget().deleteIngoingEdge(o),o.remove())};this.addToWrapper=function(t){(d=t).get$node().append(c.hide())},this.removeFromWrapper=function(){d=null,c.detach()},this.addAttribute=function(t){var e=t.getEntityId();p.hasOwnProperty(e)||(p[e]=t)},this.setAttributes=function(t){p=t},this.getAttributes=function(){return p},this.getAttribute=function(t){return p.hasOwnProperty(t)?p[t]:null},this.deleteAttribute=function(t){p.hasOwnProperty(t)||delete p[t]},this.setLabel=function(t){l=t},this.getLabel=function(){return l},this.getViewId=function(){return s},this.setViewId=function(t){s=t},this.getType=function(){return a},this.getSource=function(){return u.source},this.getTarget=function(){return u.target},this._get$node=function(){return c},this.select=function(){this.show()},this.unselect=function(){this.hide()},this.hide=function(){c.hide()},this.show=function(){c.show()},this.remove=function(){n.deleteOutgoingEdge(this),i.deleteIngoingEdge(this),this.removeFromWrapper(),this.unregisterCallbacks(),eA.deleteEdge(this.getEntityId())},this.toJSON=function(){return{id:e,label:l,appearance:u}},this.registerCallbacks=function(){f.registerOnDataReceivedCallback(h),f.registerOnDataReceivedCallback(g)},this.unregisterCallbacks=function(){f.unregisterOnDataReceivedCallback(h),f.unregisterOnDataReceivedCallback(g)},this._registerYType=function(){var t=y.getMap("edges").get(o.getEntityId());if(t){var e=t.get(o.getLabel().getValue().getEntityId());o.getLabel().getValue().registerYType(e)}},c.find(".label").append(this.getLabel().get$node()),f&&o.registerCallbacks()}get$node(){return this._get$node()}registerYType(){this._registerYType()}}class oA extends iA{static TYPE="Abstract Class";constructor(t,e,n,i,r){super(t,oA.TYPE,e,n,i,r);var o=this,a=$(su.template('<div class="default_node">\n  <div class="attribute_attribute_type">Abstract Class</div>\n  <div class="label"></div>\n  <div class="attributes"></div>\n  <p class="show_hint"><a href="#">Show list of possible connections</a></p>\n  <p class="hint"></p>\n</div>\n')()),s=iA.prototype.get$node.call(this).append(a),l=s.find(".attributes"),u=this.getAttributes();for(var c in this.addAttribute(new jx("[attributes]","Attributes",this,{string:"String",boolean:"Boolean",integer:"Integer",file:"File",quiz:"Questions"})),s.find(".label").append(this.getLabel().get$node()),this.registerYType=function(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(o.getEntityId()),e=u["[attributes]"].getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getKey(),r=t.get(i.getEntityId());i.registerYType(r)}},u)u.hasOwnProperty(c)&&l.append(u[c].get$node())}}function aA(t,e,n,i,r,o,a,s){return class extends rA{constructor(e,n,i){super(t,e,n,i);var r=this,o=rA.prototype.get$node.call(this);this.registerYType=function(){rA.prototype.registerYType.call(this);var t=y.getMap("edges").get(r.getEntityId()),e=r.getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getValue();if(i.hasOwnProperty("registerYType")){var o=t.get(i.getEntityId());i.registerYType(o)}}},function(){var t,n,i={};for(n in s)if(s.hasOwnProperty(n)){if((t=s[n]).hasOwnProperty("position")&&"hide"===t.position)continue;switch(t.value){case"boolean":i[n]=new Ex(e+"["+t.key.toLowerCase()+"]",t.key,r);break;case"string":i[n]=new Gx(e+"["+t.key.toLowerCase()+"]",t.key,r);break;case"integer":i[n]=new xx(e+"["+t.key.toLowerCase()+"]",t.key,r);break;case"file":i[n]=new Ox(e+"["+t.key.toLowerCase()+"]",t.key,r);break;default:t.options&&(i[n]=new Fx(e+"["+t.key.toLowerCase()+"]",t.key,r,t.options))}}r.setAttributes(i);var a=o.find(".attributes");for(var l in i)i.hasOwnProperty(l)&&a.append(i[l].get$node())}()}static getType(){return t}static getAttributes(){return s}applyAttributeRenaming(t){var e,n,i=this.getAttributes();for(var r in i)i.hasOwnProperty(r)&&(e=t[r],n=i[r].get$node(),e?"hide"===e.position?n.hide():(n.find(".attribute_name").text(e.key),n.is(":hidden")&&n.show()):n.hide())}}}class sA extends iA{static TYPE="Edge Shape";constructor(t,e,n,i,r){super(t,sA.TYPE,e,n,i,r);var o=this,a=$(su.template('<div class="attribute_default_node">\n  <div class="attribute_type">Edge Shape</div>\n  <div class="label"></div>\n  <div class="attributes"></div>\n  <p class="show_hint"><a href="#">Show list of possible connections</a></p>\n  <p class="hint"></p>\n</div>\n')()),s=iA.prototype.get$node.call(this).append(a),l=s.find(".attributes"),u=this.getAttributes();for(var c in this.addAttribute(new Fx(this.getEntityId()+"[arrow]","Arrow",this,{bidirassociation:"---",unidirassociation:"--\x3e",generalisation:"--▷",diamond:"-◁▷"})),this.addAttribute(new Fx(this.getEntityId()+"[shape]","Shape",this,{straight:"Straight",curved:"Curved",segmented:"Segmented"})),this.addAttribute(new Vx(this.getEntityId()+"[color]","Color",this)),this.addAttribute(new Gx(this.getEntityId()+"[overlay]","Overlay Text",this)),this.addAttribute(new Fx(this.getEntityId()+"[overlayPosition]","Overlay Position",this,{hidden:"Hide",top:"Top",center:"Center",bottom:"Bottom"})),this.addAttribute(new Ex(this.getEntityId()+"[overlayRotate]","Autoflip Overlay",this)),s.find(".label").append(this.getLabel().get$node()),this.registerYType=function(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(o.getEntityId()),e=o.getAttribute(o.getEntityId()+"[color]").getValue(),n=t.get(e.getEntityId());e.registerYType(n);var i=o.getAttribute(o.getEntityId()+"[overlay]").getValue(),r=t.get(i.getEntityId());i.registerYType(r)},u)u.hasOwnProperty(c)&&l.append(u[c].get$node())}}class lA extends iA{static TYPE="Enumeration";constructor(t,e,n,i,r){super(t,lA.TYPE,e,n,i,r);var o=this,a=$(su.template('<div class="attribute_default_node">\n  <div class="attribute_type">Enumeration</div>\n  <div class="label"></div>\n  <div class="attributes"></div>\n  <p class="show_hint"><a href="#">Show list of possible connections</a></p>\n  <p class="hint"></p>\n</div>\n')()),s=iA.prototype.get$node.call(this).append(a),l=s.find(".attributes"),u=this.getAttributes();for(var c in this.addAttribute(new Ux("[attributes]","Attributes",this)),s.find(".label").append(this.getLabel().get$node()),this.registerYMap=function(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(o.getEntityId()),e=u["[attributes]"].getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getValue(),r=t.get(i.getEntityId());i.registerYType(r)}},u)u.hasOwnProperty(c)&&l.append(u[c].get$node())}}class uA extends iA{static TYPE="ModelAttributesNode";constructor(t,e){super(t,uA.TYPE,0,0,0,0);var n=$(su.template('<div class="attribute_default_node">\n  <div class="attribute_type">Model Attributes</div>\n  <div class="label"></div>\n  <div class="attributes"></div>\n</div>\n')()),i=iA.prototype.get$node.call(this).append(n),r=i.find(".attributes"),o=this.getAttributes();if(e){for(var a in 0===su.size(e)&&i.children().hide(),e)if(e.hasOwnProperty(a))switch(e[a].value){case"boolean":this.addAttribute(new Ex(this.getEntityId()+"["+e[a].key.toLowerCase()+"]",e[a].key,this));break;case"string":this.addAttribute(new Gx(this.getEntityId()+"["+e[a].key.toLowerCase()+"]",e[a].key,this));break;case"integer":this.addAttribute(new xx(this.getEntityId()+"["+e[a].key.toLowerCase()+"]",e[a].key,this));break;case"file":this.addAttribute(new Ox(this.getEntityId()+"["+e[a].key.toLowerCase()+"]",e[a].key,this));break;default:e[a].options&&this.addAttribute(new Fx(this.getEntityId()+"["+e[a].key.toLowerCase()+"]",e[a].key,this,e[a].options))}}else this.addAttribute(new Gx(this.getEntityId()+"[name]","Name",this)),this.addAttribute(new $x(this.getEntityId()+"[description]","Description",this));for(var s in this.registerYType=function(){var t=this.getAttributes();for(var e in t)if(t.hasOwnProperty(e)){var n=t[e].getValue();if("Value"===n.constructor.name||"MultiLineValue"===n.constructor.name){var i=y.getMap("nodes").get(this.getEntityId());if(!i)throw new Error("YMap not found");var r=i.get(n.getEntityId());n.registerYType(r)}}},i.find(".label").hide(),o)o.hasOwnProperty(s)&&r.append(o[s].get$node())}}class cA extends iA{static TYPE="Node Shape";constructor(t,e,n,i,r,o){super(t,cA.TYPE,e,n,i,r,o);var a=this,s=$(su.template('<div class="attribute_default_node">\n  <h4 class="attribute_type text-center">Node Shape</h4>\n  <div class="label"></div>\n  <div class="attributes"></div>\n  <p class="show_hint"><a href="#">Show list of possible connections</a></p>\n  <p class="hint"></p>\n</div>\n')()),l=iA.prototype.get$node.call(this).append(s),u=l.find(".attributes"),c=this.getAttributes();for(var d in this.addAttribute(new Fx(this.getEntityId()+"[shape]","Shape",this,{circle:"Circle",diamond:"Diamond",rectangle:"Rectangle",rounded_rectangle:"Rounded Rectangle",triangle:"Triangle"})),this.addAttribute(new Vx(this.getEntityId()+"[color]","Color",this)),this.addAttribute(new xx(this.getEntityId()+"[defaultWidth]","Default Width",this)),this.addAttribute(new xx(this.getEntityId()+"[defaultHeight]","Default Height",this)),this.addAttribute(new Ex(this.getEntityId()+"[containment]","Containment",this)),this.addAttribute(new Lx(this.getEntityId()+"[customShape]","Custom Shape",this)),this.addAttribute(new Gx(this.getEntityId()+"[customAnchors]","Custom Anchors",this)),l.find(".label").append(this.getLabel().get$node()),this.registerYType=function(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(a.getEntityId()),e=a.getAttribute(a.getEntityId()+"[color]").getValue(),n=t.get(e.getEntityId());e.registerYType(n);var i=a.getAttribute(a.getEntityId()+"[customAnchors]").getValue(),r=t.get(i.getEntityId());i.registerYType(r)},c)c.hasOwnProperty(d)&&u.append(c[d].get$node())}}class dA extends iA{static TYPE="Object";constructor(t,e,n,i,r){super(t,dA.TYPE,e,n,i,r);var o=this,a=$(su.template(Qx)({type:"Object"})),s=iA.prototype.get$node.call(this).append(a),l=s.find(".attributes"),u=this.getAttributes();for(var c in this.registerYType=function(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(o.getEntityId()),e=u["[attributes]"].getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getKey(),r=t.get(i.getEntityId());i.registerYType(r)}},this.remove=function(){iA.prototype.remove.call(this),this.getAttribute("[attributes]").unregisterCallbacks()},this.addAttribute(new jx("[attributes]","Attributes",this,{string:"String",boolean:"Boolean",integer:"Integer",file:"File",quiz:"Questions"})),s.find(".label").append(this.getLabel().get$node()),u)u.hasOwnProperty(c)&&l.append(u[c].get$node())}}class fA extends iA{static TYPE="Relation";constructor(t,e,n,i,r){super(t,fA.TYPE,e,n,i,r);var o=$(su.template('<div class="attribute_default_node">\n  <div class="attribute_type">Relation</div>\n  <div class="label"></div>\n  <div class="attributes"></div>\n  <p class="show_hint"><a href="#">Show list of possible connections</a></p>\n  <p class="hint"></p>\n</div>\n')()),a=iA.prototype.get$node.call(this).append(o),s=a.find(".attributes"),l=this.getAttributes();for(var u in a.find(".label").append(this.getLabel().get$node()),l)l.hasOwnProperty(u)&&s.append(l[u].get$node())}}class pA extends iA{static TYPE="Relationship";constructor(t,e,n,i,r){super(t,pA.TYPE,e,n,i,r);var o=this,a=$(su.template(Kx)({type:"Relationship"})),s=iA.prototype.get$node.call(this).append(a),l=s.find(".attributes"),u=this.getAttributes();for(var c in this.addAttribute(new Dx("[attributes]","Attributes",this,{string:"String",boolean:"Boolean",integer:"Integer",file:"File"},{hidden:"Hide",top:"Top",center:"Center",bottom:"Bottom"})),this.registerYType=function(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(o.getEntityId()),e=u["[attributes]"].getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getKey(),r=t.get(i.getEntityId());i.registerYType(r)}},s.find(".label").append(this.getLabel().get$node()),u)u.hasOwnProperty(c)&&l.append(u[c].get$node())}}class hA extends iA{static TYPE="ViewObject";constructor(t,e,n,i,r,o){super(t,"ViewObject",e,n,i,r,o);var a,s,l,u,c=this,d=$(su.template(Qx)({type:"ViewObject"})),f=iA.prototype.get$node.call(this).append(d),p=f.find(".attributes"),h=this.getAttributes();this.showAttributes=function(){s.get$node().is(":hidden")&&s.get$node().show(),l.get$node().is(":hidden")&&l.get$node().show(),u.get$node().is(":hidden")&&u.get$node().show(),a.get$node().is(":hidden")||a.get$node().hide()},this.createConditionListAttribute=function(t){var e={};if(t&&"RenamingListAttribute"===t.constructor.name){var n=t.getAttributes();for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i].getKey().getValue())}else for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i].val.value);var r=new Hx("[condition]","Conditions",c,e,VO);return c.addAttribute(r),p.append(r.get$node()),r.get$node().hide(),r},f.find(".label").append(this.getLabel().get$node());var g=y.getMap("data").get("model");if(g){var v=mO.GetAllNodesOfBaseModelAsSelectionList2(g.nodes,["Object"]);a=new Fx(t+"[target]","Target",c,v),c.addAttribute(a),p.prepend(a.get$node()),s=new Zx("[attributes]","Attributes",c,{show:"Visible",hide:"Hidden"}),c.addAttribute(s),p.append(s.get$node()),s.get$node().hide(),l=new Fx(t+"[conjunction]","Conjunction",c,YO),c.addAttribute(l),p.append(l.get$node()),l.get$node().hide(),o?(u=c.createConditionListAttribute(o.attributes["[attributes]"].list),c.showAttributes(),a.get$node().hide()):u=c.createConditionListAttribute()}this.registerYType=function(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(c.getEntityId()),e=h["[attributes]"].getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getKey(),r=t.get(i.getEntityId());i.registerYType(r)}if(h["[condition]"]){var o=h["[condition]"].getAttributes();for(var a in o)if(o.hasOwnProperty(a)){i=e[n].getKey(),r=t.get(i.getEntityId());i.registerYType(r)}}}}}class gA extends iA{static TYPE="ViewRelationship";constructor(t,e,n,i,r,o){super(t,gA.TYPE,e,n,i,r,o);var a,s,l,u,c=this,d=$(su.template(Kx)({type:"ViewRelationship"})),f=iA.prototype.get$node.call(this).append(d),p=f.find(".attributes"),h=this.getAttributes();this.showAttributes=function(){s.get$node().is(":hidden")&&s.get$node().show(),l.get$node().is(":hidden")&&l.get$node().show(),u.get$node().is(":hidden")&&u.get$node().show(),a.get$node().is(":hidden")||a.get$node().hide()},this.createConditionListAttribute=function(t){var e={};if(t&&"RenamingListAttribute"===t.constructor.name){var n=t.getAttributes();for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i].getKey().getValue())}else for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i].val.value);var r=new Hx("[condition]","Conditions",c,e,VO);return c.addAttribute(r),p.append(r.get$node()),r.get$node().hide(),r},f.find(".label").append(this.getLabel().get$node());var g=y.getMap("data").get("model");if(g){var v=mO.GetAllNodesOfBaseModelAsSelectionList2(g.nodes,["Relationship"]);a=new Fx(t+"[target]","Reference",c,v),c.addAttribute(a),p.prepend(a.get$node()),s=new Zx("[attributes]","Attributes",c,{hidden:"Show",top:"Show Top",center:"Show Center",bottom:"Show Bottom",hide:"Hide"}),c.addAttribute(s),p.append(s.get$node()),s.get$node().hide(),l=new Fx(t+"[conjunction]","Conjunction",c,YO),c.addAttribute(l),p.append(l.get$node()),l.get$node().hide(),o?(u=c.createConditionListAttribute(o.attributes["[attributes]"].list),c.showAttributes(),a.get$node().hide()):u=c.createConditionListAttribute()}this.registerYType=function(){iA.prototype.registerYType.call(this);var t=y.getMap("nodes").get(c.getEntityId()),e=h["[attributes]"].getAttributes();for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].getKey(),r=t.get(i.getEntityId());i.registerYType(r)}if(h["[condition]"]){var o=h["[condition]"].getAttributes();for(var a in o)if(o.hasOwnProperty(a)){i=e[n].getKey(),r=t.get(i.getEntityId());i.registerYType(r)}}}}}class vA extends rA{static TYPE="Uni-Dir-Association";static RELATIONS=[{sourceTypes:[dA.TYPE],targetTypes:[lA.TYPE,cA.TYPE,pA.TYPE,fA.TYPE,gA.TYPE]},{sourceTypes:[pA.TYPE],targetTypes:[lA.TYPE,sA.TYPE,dA.TYPE,oA.TYPE,hA.TYPE]},{sourceTypes:[fA.TYPE],targetTypes:[dA.TYPE,oA.TYPE]},{sourceTypes:[oA.TYPE],targetTypes:[lA.TYPE,pA.TYPE,fA.TYPE]},{sourceTypes:[hA.TYPE],targetTypes:[lA.TYPE,cA.TYPE,pA.TYPE,fA.TYPE,gA.TYPE]},{sourceTypes:[gA.TYPE],targetTypes:[lA.TYPE,sA.TYPE,dA.TYPE,oA.TYPE,hA.TYPE]}];constructor(t,e,n){super("Uni-Dir-Association",t,e,n)}}class yA extends rA{static TYPE="Bi-Dir-Association";static RELATIONS=[{sourceTypes:[dA.TYPE],targetTypes:[lA.TYPE,cA.TYPE,pA.TYPE,fA.TYPE,gA.TYPE]},{sourceTypes:[pA.TYPE],targetTypes:[lA.TYPE,sA.TYPE,dA.TYPE,oA.TYPE,hA.TYPE]},{sourceTypes:[fA.TYPE],targetTypes:[dA.TYPE,oA.TYPE]},{sourceTypes:[oA.TYPE],targetTypes:[lA.TYPE,pA.TYPE,fA.TYPE]},{sourceTypes:[lA.TYPE],targetTypes:[dA.TYPE,pA.TYPE,oA.TYPE]},{sourceTypes:[cA.TYPE],targetTypes:[dA.TYPE]},{sourceTypes:[sA.TYPE],targetTypes:[pA.TYPE]},{sourceTypes:[hA.TYPE],targetTypes:[lA.TYPE,cA.TYPE,pA.TYPE,fA.TYPE,gA.TYPE]},{sourceTypes:[gA.TYPE],targetTypes:[lA.TYPE,sA.TYPE,dA.TYPE,oA.TYPE,hA.TYPE]}];constructor(t,e,n){super(yA.TYPE,t,e,n)}}class bA extends rA{static TYPE="Generalisation";static RELATIONS=[{sourceTypes:[dA.TYPE],targetTypes:[dA.TYPE,oA.TYPE]},{sourceTypes:[pA.TYPE],targetTypes:[pA.TYPE,oA.TYPE]},{sourceTypes:[fA.TYPE],targetTypes:[pA.TYPE]},{sourceTypes:[oA.TYPE],targetTypes:[oA.TYPE]},{sourceTypes:[lA.TYPE],targetTypes:[lA.TYPE]}];constructor(t,e,n){super("Generalisation",t,e,n)}}class mA{constructor(t){var e=this,n=t,i=null,r=null,o=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE),a=function(n){n instanceof k_&&null===n.getSelectedEntityId()&&(e.select(r),t.is(":hidden")&&t.show(),$(".ace-container").hide())};if(this.get$node=function(){return n},this.setModelAttributesNode=function(t){r=t},this.getModelAttributesNode=function(){return r},this.select=function(t){i!=t&&(i&&i.unselect(),t&&t.select(),i=t)},this.registerCallbacks=function(){o.registerOnDataReceivedCallback(a)},this.unregisterCallbacks=function(){o.unregisterOnDataReceivedCallback(a)},o&&e.registerCallbacks(),y){const t=y.getMap("nodes");t.observe((function(n){Array.from(n.changes.keys.entries()).forEach((function(n){const i=n[0];if("add"===n[1].action)t.get(i).observe((function(t){t.keysChanged.forEach((function(n){const i=t.currentTarget;if("add"===t.changes.keys.get(n).action&&-1!=n.search(/\w*\[(\w|\s)*\]/g)&&i.has("jabberId")){var r,o,a;(r=new E_(i.get("id"),i.get("type"),i.get("left"),i.get("top"),i.get("width"),i.get("height"),i.get("zIndex"),i.get("containment"),i.get("json"),null,null,n))instanceof E_&&(r.getViewId()===eA.getViewId()||eA.getLayer()===f_.LAYER.META?o=r.getType():(o=r.getViewId()?r.getOriginType():r.getType(),eA.getViewId()&&(a=eA.getNodeType(o).VIEWTYPE)&&(o=a)),(r.getJSON()?eA.createNodeFromJSON(o,r.getEntityId(),r.getLeft(),r.getTop(),r.getWidth(),r.getHeight(),r.getContainment(),r.getJSON()):eA.createNode(o,r.getEntityId(),r.getLeft(),r.getTop(),r.getWidth(),r.getHeight(),r.getContainment())).addToWrapper(e));var s=eA.findNode(t.currentTarget.get("id"));if(!s)throw new Error("node is null");if(s&&s.getLabel().getEntityId()===n)s.getLabel().getValue().registerYType(t.currentTarget.get(n));else{var l=null;if(eA.getLayer()===f_.LAYER.META){l=(l=s.getAttribute("[attributes]"))?l.getAttributes():s.getAttributes();var u=n.replace(/\[\w*\]/g,"");if(l.hasOwnProperty(u))(d=l[u]).hasOwnProperty("getKey")?-1!=n.indexOf("ref")?d.getRef().registerYType(t.value):d.getKey().hasOwnProperty("registerYType")&&-1===n.indexOf("value")&&d.getKey().registerYType(t.currentTarget.get(n)):d.hasOwnProperty("getValue")&&d.getValue().hasOwnProperty("registerYType")&&d.getValue().registerYType(t.currentTarget.get(n));else if(l.hasOwnProperty(n)){(d=l[n]).getValue().hasOwnProperty("registerYType")&&d.getValue().registerYType(t.currentTarget.get(n))}}else for(var c in l=s.getAttributes()){var d;if(l.hasOwnProperty(c))(d=l[c]).getEntityId()===n&&d.getValue().hasOwnProperty("registerYType")&&d.getValue().registerYType(t.currentTarget.get(n))}}}}))}))}))}));const n=y.getMap("edges");n.observe((function(t){Array.from(t.changes.keys.entries()).forEach((function(i){const r=i[0];if("add"!==i[1].action)return;const o=n.get(r).get("jabberId");if(!o)return;const a=t.currentTarget.get(r);!function(t){if(t instanceof __){var n,i,r;t.getViewId()===eA.getViewId()||eA.getLayer()===f_.LAYER.META?i=t.getType():(i=t.getViewId()?t.getOriginType():t.getType(),eA.getViewId()&&(r=eA.getEdgeType(i).VIEWTYPE)&&(i=r));var o=t.getJSON();if(o)n=eA.createEdgeFromJSON(i,t.getEntityId(),t.getSource(),t.getTarget(),o);else{const e=eA.findNode(t.getSource()),r=eA.findNode(t.getTarget());if(!e||!r)throw new Error("Source or target node not found for edge "+t.getEntityId());n=eA.createEdge(i,t.getEntityId(),e,r)}n.addToWrapper(e)}}(new __(a.get("id"),a.get("type"),a.get("source"),a.get("target"),null,null,null,o));var s=eA.findEdge(a.get("id"));if(!s)throw new Error("edge is null");var l=s.getAttributes();if(s.getLabel().getEntityId()===r)s.getLabel().getValue().registerYType(a.get(r));else{l=s.getAttributes();for(var u in l)if(l.hasOwnProperty(u)&&l[u].getEntityId()===r){var c=l[u];c.getValue().hasOwnProperty("registerYType")&&c.getValue().registerYType(a.get(r))}}}))}))}this.select(r)}}function EA(){}function wA(t,e){e.applyAttributeRenaming(t.getAttributes())}function _A(t,e){for(var n in e)e.hasOwnProperty(n)&&wA(t,e[n])}function OA(t,e){e.applyAttributeRenaming(t.getAttributes())}function TA(t,e){for(var n in e)e.hasOwnProperty(n)&&OA(t,e[n])}async function xA(t,e,n=10,i=3e3){const r=iO.getInstance(t,e);var o=!1,a=null;r.registerOnDataReceivedCallback((t=>{t.hasOwnProperty("getType")&&"WaitForCanvasOperation"===t.getType()&&(o=!0,a=t.getData())}));try{return await async function({action:t,validate:e,interval:n,maxAttempts:i}){let r=0;const o=async(a,s)=>{const l=await t();return r++,e(l)?a(l):i&&r===i?s(new Error("Exceeded max attempts")):void setTimeout(o,n,a,s)};return new Promise(o)}({interval:i,maxAttempts:n,validate:()=>o,action:()=>{const e=new y_("WaitForCanvasOperation",JSON.stringify({widget:t}));r.sendLocalNonOTOperation(f_.WIDGET.NAME.MAIN,e)}}),a}catch(t){throw t}}EA.generate=function(t,e){var n={},i=e.nodes;for(var r in i)if(i.hasOwnProperty(r)){var o=i[r];if(o.hasOwnProperty("target")){n[o.target]=!0;var a=eA.getViewNodeType(o.label);_A(a,eA.getNodesByType(a.getTargetNodeType().getType()))}}var s=e.edges;for(var l in s)if(s.hasOwnProperty(l)){var u=s[l];if(u.hasOwnProperty("target")){n[u.target]=!0;var c=eA.getViewEdgeType(u.label);TA(c,eA.getEdgesByType(c.getTargetEdgeType().getType()))}}},EA.reset=function(t){var e,n=t.nodes;for(var i in n)n.hasOwnProperty(i)&&(e=n[i].label,_A(eA.getNodeType(e),eA.getNodesByType(e)));var r=t.edges;for(var o in r)r.hasOwnProperty(o)&&(e=r[o].label,TA(eA.getEdgeType(e),eA.getEdgesByType(e)))};let AA=class extends(hx(n,p_(f_.WIDGET.NAME.ATTRIBUTE))){constructor(){super(...arguments),this.widgetName=p_(f_.WIDGET.NAME.ATTRIBUTE)}firstUpdated(t){super.firstUpdated(t);const e=dx();try{fx().then((t=>{xA(f_.WIDGET.NAME.ATTRIBUTE,t).then((n=>{var i=iO.getInstance(f_.WIDGET.NAME.ATTRIBUTE,t);i.setSpace(n),window.y||(window.y=t),window.syncmetaLog={widget:"Attribute",initializedYTexts:0,objects:{},errors:{},firstAttemptFail:{}},console.info("ATTRIBUTE: Yjs successfully initialized in room undefined with y-user-id: "+t.clientID);t.getMap("users").set(t.clientID,i.getUser()[f_.NS.PERSON.JABBERID]);const r=t.getMap("data");var o=r.get("model");if(o&&console.info("ATTRIBUTE: Found model in yjs room with "+Object.keys(o.nodes).length+" nodes and "+Object.keys(o.edges).length+" edges."),e.isGuidanceEditor()){const e=t.getMap("data");eA.init(e.get("guidancemetamodel")),o=e.get("guidancemodel")}else eA.init(r.get("metamodel"));var a=new mA($("#wrapper"));o&&function(t,e){var n,i,r;t.attributes&&Object.keys(t.attributes).length>0&&(n=eA.createModelAttributesNodeFromJSON(t.attributes),e.setModelAttributesNode(n),n.registerYType(),n.addToWrapper(e),e.select(n));for(i in t.nodes)if(t.nodes.hasOwnProperty(i)){var o=eA.createNodeFromJSON(t.nodes[i].type,i,t.nodes[i].left,t.nodes[i].top,t.nodes[i].width,t.nodes[i].height,t.nodes[i].zIndex,t.nodes[i]);if(!o)throw new Error("Node could not be created from JSON");"registerYMap"in o?o.registerYMap():o.registerYType(),o.addToWrapper(e)}for(r in t.edges)if(t.edges.hasOwnProperty(r)){var a=eA.createEdgeFromJSON(t.edges[r].type,r,t.edges[r].source,t.edges[r].target,t.edges[r]);a.registerYType(),a.addToWrapper(e)}}(o,a),console.info("ATTRIBUTE: Initialization of model completed",window.syncmetaLog),i.registerOnDataReceivedCallback((function(e){var n;if(e instanceof V_)null===(n=a.getModelAttributesNode())&&(n=eA.createModelAttributesNode(),a.setModelAttributesNode(n),n.registerYType(),n.addToWrapper(a)),a.select(n);else if(e instanceof R_){var i=e.getVLS();var r=t.getMap("data").get("metamodel");i.hasOwnProperty("id")?(eA.initViewTypes(i),e.getViewGenerationFlag()&&EA.generate(r,i)):(eA.setViewId(null),e.getViewGenerationFlag()&&EA.reset(r))}}));var s=new V_;i.sendLocalNonOTOperation(f_.WIDGET.NAME.MAIN,s.toNonOTOperation());t.getMap("canvas").observe((function(t){t.keysChanged.forEach((t=>{if("ReloadWidgetOperation"===t)location.reload()}))}))})).catch((function(t){console.error(t),this.showErrorAlert("Cannot connect to Canvas widget.")})).finally((()=>{$(p_(f_.WIDGET.NAME.ATTRIBUTE)).find("loading-spinner").hide()}))})).catch((t=>{console.error(t),this.showErrorAlert("Cannot connect to Yjs server.")}))}catch(t){console.error(t)}}hideErrorAlert(){$(this.widgetName).find("#alert-message").text(""),$(this.widgetName).find("error-alert").hide()}showErrorAlert(t){$(this.widgetName).find("#alert-message").text(t),$(this.widgetName).find("error-alert").hide()}render(){return e`
      <style>
        ${p_(f_.WIDGET.NAME.ATTRIBUTE)} {
          height: 100%;
          position: relative;
        }
        .ql-container {
          border-radius: 0.25rem;
        }
        #wrapper {
          overflow: auto;
          height: 100%;
          position: relative;
        }
        .main-wrapper {
          height: 100%;
        }
        .list_attribute ul.list {
          list-style: none;
          padding-left: 10px;
          margin: 5px 0;
        }

        .list_attribute div span.ui-icon {
          margin-left: 10px;
        }

        .key_value_attribute,
        .condition_predicate,
        .renaming_attr {
          overflow: auto;
        }

        .key_value_attribute div,
        .condition_predicate div,
        .renaming_attr div {
          width: 30%;
          float: left;
        }

        .key_value_attribute div input,
        .condition_predicate div input,
        .renaming_attr div input {
          border: 1px solid #aaaaaa;
        }

        .key_value_attribute span.ui-icon,
        .condition_predicate span.ui-icon {
          margin-top: 3px;
        }

        .single_value_attribute {
          overflow: auto;
        }

        .single_quiz_attribute {
          overflow: auto;
        }

        .single_value_attribute div {
          float: left;
          margin-right: 10px;
        }

        .single_quiz_attribute div {
          float: left;
          margin-right: 10px;
        }

        .list .single_value_attribute .name {
          display: none;
        }
        .list .single_quiz_attribute .name {
          display: none;
        }

        .single_value_attribute .name {
          width: 120px;
        }
        .single_quiz_attribute .name {
          width: 120px;
        }

        .single_value_attribute div.value span.color_preview {
          width: 12px;
          height: 18px;
          background-color: #ffffff;
          display: inline-block;
          border: 1px solid #4a4a4a;
          position: relative;
          top: 5px;
          left: -14px;
        }

        .single_quiz_attribute div.value span.color_preview {
          width: 12px;
          height: 18px;
          background-color: #ffffff;
          display: inline-block;
          border: 1px solid #4a4a4a;
          position: relative;
          top: 5px;
          left: -14px;
        }

        .single_value_attribute div.value textarea {
          width: 400px;
          height: 80px;
        }

        .single_quiz_attribute div.value textarea {
          width: 400px;
          height: 80px;
        }

        #modelAttributes .attribute_default_node .label {
          font-weight: bold;
        }

        .label {
          text-transform: capitalize;
        }

        .key_value_attribute input,
        select {
          width: 150px;
        }
        .condition_predicate input,
        select {
          width: 150px;
        }

        .renaming_attr input,
        select {
          width: 150px;
        }

        .type {
          font-weight: bold;
          margin: 0 0 3px;
        }

        .show_hint {
          font-size: 12px;
        }

        .hint {
          font-size: 12px;
          overflow-y: auto;
          max-height: 150px;
        }

        .codeEditorValue {
          position: absolute;
          width: 560px;
          height: 200px;
          overflow-y: auto;
        }
        .main-wrapper {
          position: relative;
        }
      </style>
      <link
        rel="stylesheet"
        type="text/css"
        href="https://code.jquery.com/ui/1.13.1/themes/smoothness/jquery-ui.css"
      />
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
        crossorigin="anonymous"
      />

      <link
        href="https://cdn.quilljs.com/1.3.7/quill.snow.css"
        rel="stylesheet"
      />

      <div class="main-wrapper">
        <error-alert></error-alert>
        <div id="loading" class="loading"></div>
        <div id="wrapper"></div>
        <div id="q"></div>
        <loading-spinner></loading-spinner>
      </div>
    `}connectedCallback(){super.connectedCallback(),px()}disconnectedCallback(){super.disconnectedCallback()}};AA=l([u(p_(f_.WIDGET.NAME.ATTRIBUTE))],AA);let SA=class extends(hx(n,p_(f_.WIDGET.NAME.DEBUG))){constructor(){super(...arguments),this.widgetName=p_(f_.WIDGET.NAME.DEBUG)}firstUpdated(t){super.firstUpdated(t);const e=$(p_(f_.WIDGET.NAME.DEBUG)).find("loading-spinner"),n=dx();fx().then((t=>{const o=t.getMap("data");console.info("DEBUG: Yjs successfully initialized in room "+window.spaceTitle+" with y-user-id: "+t.clientID);var a=$("#delete-meta-model").prop("disabled",!1),s=$("#export-meta-model").prop("disabled",!1),l=$("#import-meta-model"),u=$("#delete-model").prop("disabled",!1),c=$("#export-model").prop("disabled",!1),d=$("#import-model"),f=$("#delete-guidance-model").prop("disabled",!0),p=$("#export-guidance-model").prop("disabled",!0),h=$("#import-guidance-model"),g=$("#file-object"),v=$("#export-activity-list").prop("disabled",!1),y=$("#delete-activity-list").prop("disabled",!1),b=function(t){alert(t),e.hide()};h.hide(),l.hide(),d.hide();var m=function(){var t,e,n=g[0].files,i=$.Deferred();n&&0!==n.length||i.reject("No files selected"),e=n[0],(t=new FileReader).onload=function(t){var e=t.target.result;try{e=JSON.parse(e)}catch(t){i.reject("Incorrect file type. Please make sure that your file is in JSON format")}i.resolve(e)};try{return t.readAsText(e),i.promise()}catch(t){return i.reject("Incorrect file type. Please make sure that your file is in JSON format")}};u.click((function(){if(confirm("Are you sure you want to delete the model ?")){e.show(),c.prop("disabled",!0),u.prop("disabled",!0);t.getMap("data").set("model",null);t.getMap("canvas").set("ReloadWidgetOperation","delete"),b("The model was deleted. The page will be reloaded."),location.reload()}})),a.click((function(){if(confirm("Are you sure you want to delete the Metamodel ?")){e.show(),s.prop("disabled",!0),a.prop("disabled",!0);t.getMap("data").set("metamodel",null);t.getMap("canvas").set("ReloadWidgetOperation","meta_delete"),b("The meta model was deleted. The page will be reloaded."),location.reload()}})),f.click((function(){if(confirm("Are you sure you want to delete the Guidancemodel ?")){e.show(),p.prop("disabled",!0),f.prop("disabled",!0);t.getMap("data").set("guidancemodel",null),b("The guidance model was deleted. The page will be reloaded."),location.reload()}})),y.click((function(){if(confirm("Are you sure you want to delete the activity list ?")){e.show();t.getMap("activity").set("log",null),b("The activity log has been deleted. The page will be reloaded."),location.reload()}})),c.click((function(){e.show();const n=t.getMap("data");var i=document.createElement("a");i.download="model.json",i.href="data:,"+encodeURIComponent(JSON.stringify(n.get("model"),null,4)),i.click(),e.hide()})),s.click((function(){e.show();const n=t.getMap("data");var i=document.createElement("a");i.download="vls.json",i.href="data:,"+encodeURIComponent(JSON.stringify(n.get("metamodel"),null,4)),i.click(),e.hide()})),p.click((function(){e.show();const n=t.getMap("data");var i=document.createElement("a");i.download="guidance_model.json",i.href="data:,"+encodeURI(JSON.stringify(n.get("guidancemodel"),null,4)),i.click(),e.hide()})),v.click((function(){e.show();const n=t.getMap("activity");var i=document.createElement("a");i.download="activityList.json",i.href="data:,"+encodeURI(JSON.stringify(n.get("log"),null,4)),i.click(),e.hide()})),d.click((function(){e.show(),m().then((function(e){var o=function(t,e){if(t.hasOwnProperty("[attributes]")){var n=t["[attributes]"].list;for(var r in n){if(n.hasOwnProperty(r))if(n[r].hasOwnProperty("key"))e.set(n[r].key.id,new i).insert(0,n[r].key.value);else e.set(n[r].value.id,new i).insert(0,n[r].value.value)}}else for(var r in t)if(t.hasOwnProperty(r)){var o=t[r].value;if(!o.hasOwnProperty("option"))if(o.value instanceof String)e.set(o.id,new i).insert(0,o.value)}};const a=t.getMap("data");for(var s in n.isGuidanceEditor()?a.set("guidancemodel",e):a.set("model",e),e.nodes)if(e.nodes.hasOwnProperty(s)){var l=e.nodes[s];const n=t.getMap("nodes");n.set(s,new r);var u=l.attributes;if(l.hasOwnProperty("label")){var c=new i(l.label.value.id);n.set(l.label.value.id,c),c.insert(0,l.label.value.value)}o(u,n)}for(var s in e.edges)if(e.edges.hasOwnProperty(s)){l=e.edges[s];var d=t.getMap("edges").set(s,new r);u=l.attributes;if(l.hasOwnProperty("label")){const t=new i;d.set(l.label.value.id,t),t.insert(0,l.label.value.value)}o(u,d)}t.getMap("canvas").set("ReloadWidgetOperation","import"),b("Imported model successfully! The page will be reloaded."),location.reload()})).catch((function(t){console.error(t),b("Error: "+t),e.hide()}))})),l.click((function(){e.show(),l.prop("disabled",!0),m().then((function(n){const i=t.getMap("data");try{var r=JT(n,t);0===su.keys(r.nodes).length&&0===su.keys(r.edges).length&&0===su.keys(r.attributes).length?i.set("metamodel",n):i.set("metamodel",r),b("Imported Meta Model, the page will reload now"),setTimeout((()=>{location.reload()}),1e3)}catch(t){throw b("Error: "+t),t}l.prop("disabled",!1),e.hide()})).catch((function(t){console.error(t),b("Error: "+t),l.prop("disabled",!1),e.hide()}))})),h.click((function(){e.show(),m().then((function(i){const r=t.getMap("data");p.prop("disabled",!1),f.prop("disabled",!1),uT.setGuidance(n),r.set("guidancemodel",uT.generateLogicalGuidanceRepresentation(i)),b("Done!"),e.hide()})).catch((function(t){b("Error: "+t),e.hide()}))}));var E=function(){o.get("model")?(c.prop("disabled",!1),u.prop("disabled",!1)):(c.prop("disabled",!0),u.prop("disabled",!0)),o.get("metamodel")?(s.prop("disabled",!1),a.prop("disabled",!1)):(s.prop("disabled",!0),a.prop("disabled",!0));t.getMap("activity").get("log")?(v.prop("disabled",!1),y.prop("disabled",!1)):(v.prop("disabled",!0),y.prop("disabled",!0)),o.get("guidancemodel")?(p.prop("disabled",!1),f.prop("disabled",!1)):(p.prop("disabled",!0),f.prop("disabled",!0))};E(),setInterval(E,1e4),e.hide(),$("input:file").change((()=>{h.show(),l.show(),d.show()}))})).catch((t=>{console.error(t),this.showErrorAlert("Cannot connect to Yjs server.")}))}hideErrorAlert(){$(this.widgetName).find("#alert-message").text(""),$(this.widgetName).find("error-alert").hide()}showErrorAlert(t){$(this.widgetName).find("#alert-message").text(t),$(this.widgetName).find("error-alert").hide()}render(){return e`
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
        crossorigin="anonymous"
      />
      <style>
        #debug-container {
          position: relative;
        }
        ${p_(f_.WIDGET.NAME.DEBUG)} {
          position: relative;
          overflow-y: auto;
        }
      </style>

      
              <div id="debug-container">
                 <error-alert></error-alert>

                <div class="seperating_box">
                  <h6>Select a JSON file</h6>
                  <input
                    class="form-control"
                    type="file"
                    id="file-object"
                    accept=".json"
                    value="Load a file"
                  />
                </div>

                <hr />
                <div id="import-export-container">
                  <div id="modelDiv" class="seperating_box">
                    <h6>
                      <strong>(Meta- or Guidance-)Model</strong>
                    </h6>
                    <button
                      id="import-model"
                      class="btn btn-primary"
                      title="Import a model to the canvas"
                    >
                      Import
                    </button>
                    <button
                      id="export-model"
                      class="btn btn-secondary"
                      title="export the model as JSON"
                    >
                      Export
                    </button>
                    <button
                      id="delete-model"
                      title="delete the model"
                      class="btn btn-danger"
                    >
                      Delete
                    </button>
                  </div>
                  <hr />
                  <div id="vlsDiv" class="seperating_box">
                    <h6><strong>Metamodel</strong> (Model Editor only)</h6>
                    <button
                      class="btn btn-primary"
                      id="import-meta-model"
                      title="Refresh the role space to apply the new VLS."
                    >
                      Import
                    </button>
                    <button
                      id="export-meta-model"
                      title="Download the VLS as JSON"
                      class="btn btn-secondary"
                    >
                      Export
                    </button>
                    <button
                      id="delete-meta-model"
                      title="Refresh the role space and delete the current modeling language"
                      class="btn btn-danger"
                    >
                      Delete
                    </button>
                  </div>
                  <hr />
                  <div id="guidanceDiv" class="seperating_box">
                    <h6>
                      <strong>Logical Guidancemodel</strong> (Model Editor only)
                    </h6>
                    <button id="import-guidance-model" class="btn btn-primary">
                      Import
                    </button>
                    <button
                      id="export-guidance-model"
                      class="btn btn-secondary"
                    >
                      Export
                    </button>
                    <button id="delete-guidance-model" class="btn btn-danger">
                      Delete
                    </button>
                  </div>
                  <hr />
                  <div id="activityDiv" class="seperating_box">
                    <h6><strong>Activity list</strong></h6>
                    <button id="export-activity-list" class="btn btn-secondary">
                      Export
                    </button>
                    <button id="delete-activity-list" class="btn btn-danger">
                      Delete
                    </button>
                  </div>
                </div>
                <loading-spinner></loading-spinner>
              </div>
              <br />
            </div>
          
    `}connectedCallback(){super.connectedCallback(),px()}disconnectedCallback(){super.disconnectedCallback()}};SA=l([u(p_(f_.WIDGET.NAME.DEBUG))],SA);const IA='<button class="btn btn-light my-1 border border-dark flex w-100">\n  <div\n    style="max-height: 30px"\n    class="d-flex justify-content-between align-items-center"\n  >\n    <% if (type == "svg" ) { %> <%=icon%> <% } else { %>\n    <img\n      style="background-color: <%= color %>"\n      width="12px"\n      height="12px "\n      src="<%= icon %>"\n    />\n\n    <% } %>\n    <span style="text-align: right"><%= label %></span>\n  </div>\n</button>\n';class kA{_name;_label;_description;_icon;_color;_$node;get$node;setName;getName;setLabel;getLabel;setDescription;getDescription;setIcon;getIcon;setColor;getColor;select;unselect;constructor(t,e,n,i,r=null,o="svg"){i||(i='<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-box" viewBox="0 0 16 16"><path d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5 8 5.961 14.154 3.5 8.186 1.113zM15 4.239l-6.5 2.6v7.922l6.5-2.6V4.24zM7.5 14.762V6.838L1 4.239v7.923l6.5 2.6zM7.443.184a1.5 1.5 0 0 1 1.114 0l7.129 2.852A.5.5 0 0 1 16 3.5v8.662a1 1 0 0 1-.629.928l-7.185 2.874a.5.5 0 0 1-.372 0L.63 13.09a1 1 0 0 1-.63-.928V3.5a.5.5 0 0 1 .314-.464L7.443.184z"/></svg>');var a,s=t,l=e,u=n,c=i,d=r||"#000000";if("function"==typeof i.find){const t=i.find("svg");t&&(t.height(30),t.width(30),o="svg",i=t.get(0).outerHTML)}a="svg"==o?$(su.template(IA)({icon:i,label:l,color:d,type:o})):$(su.template(IA)({icon:"",label:l,color:d,type:o})),this.get$node=function(){return a},this.setName=function(t){s=t},this.getName=function(){return s},this.setLabel=function(t){l=t},this.getLabel=function(){return l},this.setDescription=function(t){u=t},this.getDescription=function(){return u},this.setIcon=function(t){c=t},this.getIcon=function(){return c},this.setColor=function(t){d=t},this.getColor=function(){return d},this.select=function(){a.addClass("selected"),a.removeClass("btn-light"),a.addClass("btn-primary")},this.unselect=function(){a.removeClass("selected"),a.removeClass("btn-primary"),a.addClass("btn-light")},c instanceof $&&a.find(".icon").empty().append(c)}}class PA extends kA{constructor(t=null,e=null,n=null,i=null,r="svg"){super(t||"Abstract Class",e||"Abstract Class",n||"Click on an empty part of the canvas to add a node",i,null,r)}}class NA extends kA{constructor(t=null,e=null,n=null,i='<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-left-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/></svg>',r="svg"){super(t||"Bi-Dir-Association",e||"Bi-Dir-Assoc",n||"Click and hold on one Node and release on another node to add an edge between these two nodes.",i,null,r)}}class CA extends kA{constructor(t=null,e=null,n=null,i=null,r="svg"){super(t||"Edge Shape",e||"Edge Shape",n||"Click on an empty part of the canvas to add a node",i,null,r)}}class jA extends kA{constructor(t=null,e=null,n=null,i=null,r="svg"){super(t||"Enumeration",e||"Enum",n||"Click on an empty part of the canvas to add a node",i,null,r)}}class MA extends kA{constructor(t=null,e=null,n=null,i='<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/></svg>',r="svg"){super(t||"Generalisation",e||"Generalisation",n||"Click and hold on one Node and release on another node to add an edge between these two nodes.",i,null,r)}}class DA extends kA{constructor(t=null,e=null,n=null,i=null,r=null){super(t||"MoveTool",e||"Move",n||"Move a node by dragging and dropping it. Resize a node by dragging and dropping its bottom right corner. Remove a node or edge by clicking on it with the right mouse button and selecting 'Delete'.",i||'<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrows-move" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10zM.146 8.354a.5.5 0 0 1 0-.708l2-2a.5.5 0 1 1 .708.708L1.707 7.5H5.5a.5.5 0 0 1 0 1H1.707l1.147 1.146a.5.5 0 0 1-.708.708l-2-2zM10 8a.5.5 0 0 1 .5-.5h3.793l-1.147-1.146a.5.5 0 0 1 .708-.708l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L14.293 8.5H10.5A.5.5 0 0 1 10 8z"/>\n</svg>',"#FFFFFF",r||"svg")}}class RA extends kA{constructor(t=null,e=null,n=null,i=null,r="svg"){super(t||"Node Shape",e||"Node Shape",n||"Click on an empty part of the canvas to add a node",i,null,r)}}class LA extends kA{constructor(t=null,e=null,n=null,i=null,r="svg"){super(t||"Object",e||"Object",n||"Click on an empty part of the canvas to add a node",i,null,r)}}class YA extends kA{constructor(t,e,n,i,r="img"){super(t,e,n||"Click on an empty part of the canvas to add a node",i,null,"svg")}}class VA extends kA{constructor(t,e,n,i,r,o="img"){if(i&&i.includes(".png")){let t=i.split(".");t.pop();const e=t.join(".");e in BA&&(i=BA[e],o="svg")}super(t,e,n||"Click and hold on one Node and release on another node to add an edge between these two nodes.",i||BA.unidirassociation,r||"#000000",o)}}const BA={unidirassociation:'<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/></svg>',generalisation:'<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/></svg>',bidirassociation:'<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-left-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/></svg>'};class $A{constructor(t,e){var n=this,i={},r=null,o=iO.getInstance(f_.WIDGET.NAME.PALETTE),a=function(t){var n;i.hasOwnProperty(t)&&(r&&(i[r].unselect(),e.text("")),(n=i[t]).select(),e.text(n.getDescription()),r=t)},s=function(t){t instanceof P_&&a(t.getSelectedToolName())},l=function(t){t instanceof D_&&(t.getFlag()&&i.hasOwnProperty("ViewObject")&&i.hasOwnProperty("ViewRelationship")?(i.ViewObject.get$node().show(),i.ViewRelationship.get$node().show(),i.Object.get$node().hide(),i.Enumeration.get$node().hide(),i.Relationship.get$node().hide(),i["Abstract Class"].get$node().hide()):!t.getFlag()&&i.hasOwnProperty("ViewObject")&&i.hasOwnProperty("ViewRelationship")&&(i.ViewObject.get$node().hide(),i.ViewRelationship.get$node().hide(),i.Object.get$node().show(),i.Enumeration.get$node().show(),i.Relationship.get$node().show(),i["Abstract Class"].get$node().show()))},u=function(e){if(e instanceof R_){var o=e.getVLS();$.isEmptyObject(i)||(i={},t.empty()),n.addTool(new DA),n.addSeparator(),n.initNodePalette(o),n.addSeparator(),n.iniEdgePalette(o),r="MoveTool"}};this.addTool=function(e){var r,o=e.getName();i.hasOwnProperty(o)||(i[o]=e,(r=e.get$node()).on("mousedown",(function(t){1==t.which&&n.selectTool(o)})),t.append(r))},this.addSeparator=function(){t.append($('<hr style="margin-top: 8px; margin-bottom: 8px;" />'))},this.getTool=function(t){return i.hasOwnProperty(t)?i[t]:null},this.selectTool=function(t){if(i.hasOwnProperty(t)){a(t);var e=new P_(t,null);o.sendLocalNonOTOperation(f_.WIDGET.NAME.MAIN,e.toNonOTOperation())}},this.getCurrentToolName=function(){return r},this.registerCallbacks=function(){o.registerOnDataReceivedCallback(s),o.registerOnDataReceivedCallback(l),o.registerOnDataReceivedCallback(u)},this.unregisterCallbacks=function(){o.unregisterOnDataReceivedCallback(s),o.unregisterOnDataReceivedCallback(l),o.unregisterOnDataReceivedCallback(u)},o&&this.registerCallbacks(),this.initNodePalette=function(t){var e,i,r,o,a={circle:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <circle\n      cx="50"\n      cy="50"\n      r="50"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n',diamond:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <rect\n      x="15"\n      y="15"\n      width="70"\n      height="70"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n      transform="rotate(-45 50 50)"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n',rectangle:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <rect\n      x="0"\n      y="0"\n      width="100"\n      height="100"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n',rounded_rectangle:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <rect\n      x="0"\n      y="0"\n      rx="20"\n      ry="20"\n      width="100"\n      height="100"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n',triangle:'<div class="custom_node">\n  <div class="type"><%= type %></div>\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    preserveAspectRatio="none"\n    viewBox="0 0 100 100"\n    class="fill_parent"\n  >\n    <path\n      d="M0,100 L50,0 L100,100 L0,100"\n      fill="<%= color %>"\n      stroke="lightgray"\n      stroke-width="2"\n    />\n  </svg>\n  <div class="fill_parent">\n    <div\n      style="\n        position: absolute;\n        left: 50%;\n        top: -10px;\n        -webkit-transform: translateY(-50%) translateX(-50%);\n      "\n      class="label"\n    ></div>\n  </div>\n</div>\n'},s=$("<div></div>"),l=t.nodes;for(var u in l)l.hasOwnProperty(u)&&(e=l[u],i=e.shape?.customShape?e.shape.customShape:e.shape&&a.hasOwnProperty(e.shape.shape)?a[e.shape.shape]:su.keys(a)[0],e.shape?.customAnchors?e.shape.customAnchors:e.shape?.shape,r=e.shape?.color?s.css("color","#FFFFFF").css("color",e.shape.color).css("color"):"#FFFFFF",(o=$("<div>").css("display","table-cell").css("verticalAlign","middle").css("width",e.shape?.defaultWidth||100).css("height",e.shape?.defaultHeight||50).append($(su.template(i)({color:r,type:e.label})))).find(".type").hide(),n.addTool(new YA(e.label,e.label,null,o)))},this.iniEdgePalette=function(t){var e,i=t.edges;for(var r in i)i.hasOwnProperty(r)&&(e=i[r],n.addTool(new VA(e.label,e.label,null,e.shape?e.shape.arrow+".png":null,e.shape?.color)))}}}class FA extends kA{constructor(t=null,e=null,n=null,i=null,r="svg"){super(t||"Relation",e||"Relation",n||"Click on an empty part of the canvas to add a node",i,null,r)}}class GA extends kA{constructor(t=null,e=null,n=null,i=null,r="svg"){super(t||"Relationship",e||"Relationship",n||"Click on an empty part of the canvas to add a node",i,null,r)}}class qA extends kA{constructor(t=null,e=null,n=null,i='<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/></svg>',r="svg"){super(t||"Uni-Dir-Association",e||"Uni-Dir-Assoc",n||"Click and hold on one Node and release on another node to add an edge between these two nodes.",i,null,r)}}class UA extends kA{constructor(t=null,e=null,n=null,i=null){super(t||"ViewObject",e||"ViewObject",n||"Click on an empty part of the canvas to add a view type",i,null)}}class zA extends kA{constructor(t=null,e=null,n=null,i=null){super(t||"ViewRelationship",e||"ViewRelationship",n||"Click on an empty part of the canvas to add a view type",i,null)}}let JA=class extends(hx(n,p_(f_.WIDGET.NAME.PALETTE))){constructor(){super(...arguments),this.widgetName=p_(f_.WIDGET.NAME.PALETTE)}async firstUpdated(t){super.firstUpdated(t),this.hideErrorAlert(),fx().then((t=>{console.info("PALETTE: Yjs successfully initialized in room "+window.spaceTitle+" with y-user-id: "+t.clientID),xA(f_.WIDGET.NAME.PALETTE,t).then((t=>{window.scrollTo(0,document.body.scrollHeight);var e=new $A($("#palette"),$("#info"));if(e.addTool(new DA),e.addSeparator(),$.isEmptyObject(t)){e.addTool(new PA),e.addTool(new LA),e.addTool(new GA),e.addTool(new FA),e.addTool(new jA),e.addTool(new RA),e.addTool(new CA);var n=new UA;e.addTool(n),n.get$node().hide();var i=new zA;e.addTool(i),i.get$node().hide(),e.addSeparator(),e.addTool(new NA),e.addTool(new qA),e.addTool(new MA)}else t.hasOwnProperty("nodes")&&e.initNodePalette(t),t.hasOwnProperty("edges")&&e.iniEdgePalette(t)})).catch((t=>{console.error("PALETTE: Error while waiting for CANVAS: ",t),this.showErrorAlert("Cannot connect to Canvas widget.")})).finally((()=>{$(p_(f_.WIDGET.NAME.PALETTE)).find("loading-spinner").hide()}))})).catch((t=>{console.error("PALETTE: Error while waiting for CANVAS: ",t),this.showErrorAlert("Cannot connect to Yjs server.")}))}createRenderRoot(){return this}hideErrorAlert(){$(this.widgetName).find("#alert-message").text(""),$(this.widgetName).find("error-alert").hide()}showErrorAlert(t){$(this.widgetName).find("#alert-message").text(t),$(this.widgetName).find("error-alert").hide()}render(){return e`
      <style>
        ${p_(f_.WIDGET.NAME.PALETTE)} {
          height: 100%;
          position: relative;
        }

        button .icon div.fill_parent {
          display: none;
        }

        button span {
          padding-left: 10px;
        }

        hr {
          border-width: 0 0 1px 0;
          border-color: #cccccc;
          margin: 0.2em 0;
        }
        p#info {
          font-size: 0.6em;
        }
      </style>
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
        crossorigin="anonymous"
      />
      <link
        rel="stylesheet"
        type="text/css"
        href="https://code.jquery.com/ui/1.13.1/themes/smoothness/jquery-ui.css"
      />
      <div class="h-100" style="overflow-y:auto">
        <error-alert></error-alert>
        <div id="palette"></div>
        <p id="info"></p>
        <div id="q"></div>
        <loading-spinner></loading-spinner>
      </div>
    `}connectedCallback(){super.connectedCallback(),px()}disconnectedCallback(){super.disconnectedCallback()}};JA=l([u(p_(f_.WIDGET.NAME.PALETTE))],JA);let WA=class extends n{createRenderRoot(){return this}render(){return e`
      <div class="alert alert-danger d-flex align-items-center" role="alert">
        <i class="bi bi-exclamation-triangle-fill"></i>
        <div id="alert-message"></div>
      </div>
    `}};WA=l([u("error-alert")],WA);class HA{_type=void 0;constructor(t,e,n,i){var r=this,o=!1,a=iO.getInstance(f_.WIDGET.NAME.ACTIVITY),s=t,l=e,u=n,c=i;this._type=void 0;var d,f=su.template('<div\n  class="toast w-100 d-block me-2 mb-3"\n  role="alert"\n  aria-live="assertive"\n  aria-atomic="true"\n  style="border: 3px; border-style: solid; border-color: <%= color %>"\n>\n  <div class="toast-header">\n    <svg\n      class="bd-placeholder-img rounded me-2"\n      width="20"\n      height="20"\n      xmlns="http://www.w3.org/2000/svg"\n      aria-hidden="true"\n      preserveAspectRatio="xMidYMid slice"\n      focusable="false"\n    >\n      <rect width="100%" height="100%" fill="<%= color %>"></rect>\n    </svg>\n    <strong class="me-1"><%= heading %></strong>\n    <small style="font-size: 0.7em; text-align: end; margin-left: auto"\n      ><%= timestamp %></small\n    >\n  </div>\n  <div class="toast-body"><%= text %></div>\n</div>\n'),p=function(){const t=new Date;var e=new Date(c);if(e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear())return(n=e.getHours())<10&&(n="0"+n),(i=e.getMinutes())<10&&(i="0"+i),n+":"+i;var n,i,r=e.getFullYear()%100,o=["01","02","03","04","05","06","07","08","09","10","11","12"][e.getMonth()],a=e.getDate();return(n=e.getHours())<10&&(n="0"+n),(i=e.getMinutes())<10&&(i="0"+i),e.getFullYear()===t.getFullYear()?a+"."+o+"/"+n+":"+i:a+"."+o+"."+r+"/"+n+":"+i};if(l){const t=y.getMap("userList");let e;t.get(l)?(e=t.get(l)[f_.NS.PERSON.TITLE],t.get(l).self&&(e+=" (You)")):e="Anonymous",d=$(f({heading:e,text:u,color:t.get(l)?Z_.getColor(t.get(l).globalId):"#C0C5CE",timestamp:p()})).hide()}else d=$(f({heading:"",text:"",color:"#000000",timestamp:p()})).hide();var h=d.find(".text");this.getEntityId=function(){return s},this.getSender=function(){return l},this.getTimestampe=function(){return c},this.getText=function(){return u},this.setText=function(t){u=t,h.text(t)},this.get$node=function(){return d},this.isTrackable=function(){return o},this.hide=function(){this.get$node().hide()},this.show=function(){this.get$node().show()},this.setType=function(t){this._type=t},this.getType=function(){return this._type},this._toJSON=function(){var t={entityId:s,sender:l,text:u,timestamp:c,type:this._type};var n=y.getMap("userList").get(e);return n&&(t.user={},t.user.title=n[f_.NS.PERSON.TITLE],t.user.mail=n[f_.NS.PERSON.MBOX],t.user.color=Z_.getColor(n.globalId)),t},this.trackable=function(){d.click((function(t){var e=new U_(r.getEntityId(),!1);a.sendLocalNonOTOperation(f_.WIDGET.NAME.MAIN,e.toNonOTOperation())})),d.hover((function(){const t=y.getMap("userList").get(l)?Z_.getColor(y.getMap("userList").get(l).globalId):"#ccc";$(this).css("border","5px solid "+t)}),(function(){const t=y.getMap("userList").get(l)?Z_.getColor(y.getMap("userList").get(l).globalId):"#ccc";$(this).css("border","1px solid"+t)})),d.find(".timestamp").css("border-color","rgb(112, 222, 148)"),o=!0},this.untrackable=function(){const t=y.getMap("userList").get(l)?.globalId?Z_.getColor(y.getMap("userList").get(l).globalId):"rgb(112, 222, 148)";d.off(),d.find(".timestamp").css("border-color",t),o=!1}}toJSON(){return this._toJSON()}}class XA extends HA{static TYPE="NodeAddActivity";constructor(t,e,n,i,r){super(t,e,n,i),this.toJSON=function(){var t=HA.prototype.toJSON.call(this);return t.nodeType=r,t.type=XA.TYPE,t}}}class ZA extends HA{static TYPE="NodeDeleteActivity";constructor(t,e,n,i){super(t,e,n,i),this.toJSON=function(){var t=HA.prototype.toJSON.call(this);return t.type=ZA.TYPE,t}}}class KA extends HA{static TYPE="NodeMoveActivity";constructor(t,e,n,i,r){super(t,e,n,i),this.toJSON=function(){var t=HA.prototype.toJSON.call(this);return t.type=KA.TYPE,t.nodeType=r,t}}}class QA extends HA{static TYPE="NodeResizeActivity";constructor(t,e,n,i,r){super(t,e,n,i),this.toJSON=function(){var t=HA.prototype.toJSON.call(this);return t.type=QA.TYPE,t.nodeType=r,t}}}class tS extends HA{static TYPE="EdgeAddActivity";constructor(t,e,n,i,r,o,a,s,l,u,c){super(t,e,n,i);var d=r,f=o,p=a,h=s,g=l,v=u,y=c;this.toJSON=function(){var t=HA.prototype.toJSON.call(this);return t.type=tS.TYPE,t.edgeType=d,t.edgeLabel="",t.sourceNodeLabel=f,t.sourceNodeId=p,t.sourceNodeType=h,t.targetNodeLabel=g,t.targetNodeId=v,t.targetNodeType=y,t}}}class eS extends HA{static TYPE="EdgeDeleteActivity";constructor(t,e,n,i){super(t,e,n,i),this.toJSON=function(){var t=HA.prototype.toJSON.call(this);return t.type=eS.TYPE,t}}}class nS extends HA{static TYPE="EditorGenerateActivity";constructor(t,e,n,i){super(t,e,n,i),this.toJSON=function(){var t=HA.prototype.toJSON.call(this);return t.type=nS.TYPE,t}}}class iS extends HA{static TYPE="UserJoinActivity";constructor(t,e,n,i){super(t,e,n,i)}}class rS extends HA{static TYPE="ValueChangeActivity";constructor(t,e,n,i,r,o,a,s){super(t,e,n,i);var l=r,u=o,c=a,d=s;this.getValue=function(){return l},this.getSubjectEntityName=function(){return u},this.getRootSubjectEntityType=function(){return c},this.getRootSubjectEntityId=function(){return d},this.toJSON=function(){var t=HA.prototype.toJSON.call(this);return t.value=l,t.type=rS.TYPE,t.subjectEntityName=u,t.rootSubjectEntityId=d,t.rootSubjectEntityType=c,t}}}class oS extends HA{static TYPE="ViewApplyActivity";constructor(t,e,n){super(null,e,n);var i=t;this.getViewId=function(){return i}}}class aS extends HA{static TYPE="ReloadWidgetActivity";constructor(t,e,n,i){super(t,e,n,i)}}class sS{isAnonymous=!0;constructor(t,e,n){var i=this,r=t;const o=y.getMap("userList");this.isAnonymous=!o.get(t);var a=e,s=su.template('<div\n  class="item card card-body rounded mb-2"\n  style="background-color: <%= color %>"\n>\n  <div class="d-flex">\n    <h6 class="me-1"><%= heading %></h6>\n    <span class="text ms-auto align-bottom"><%= text %> ago</span>\n  </div>\n  \x3c!-- <h3 class="lblViewId"><%=view%></h3> --\x3e\n</div>\n');let l;o.get(t)?(l=o.get(t)[f_.NS.PERSON.TITLE],o.get(t).self&&(l+=" (You)")):l="Anonymous";var u=$(s({heading:l,text:"",color:o.get(t)?Z_.getColor(o.get(t).globalId):"#C0C5CE",view:""})).hide(),c=u.find(".text");this.getJabberId=function(){return r},this.setLastActivityDate=function(t){a=t,f()},this.getLastActivityDate=function(){return a};var d=function(t){c.text(t)};this.get$node=function(){return u},this.hide=function(){this.get$node().hide()},this.show=function(){this.get$node().show()};var f=function(){var t=Math.floor(new Date-i.getLastActivityDate()),e=10*Math.floor(t/1e4),n=Math.floor(e/60),r=Math.floor(n/60),o=Math.floor(r/24);d(e<60?"last seen: "+e+"s ago":n<60?"last seen: "+n+"m ago":r<24?"last seen: "+r+"h ago":o+"d ago")};f(),setInterval(f,1e4)}}class lS{that;_$userListNode;_$activityListNode;userList={};activityList=[];addUser;getUser;removeUser;addActivity;addActivityToLog;getFirst;toJSON;operationCallback;findUntrackableActivities;findTrackableActivities;init;constructor(t,e){var n=this,i=t,r=e,o={},a=[];this.addUser=function(t,e=!1){var n;if(t)if(o.hasOwnProperty(t))(n=o[t]).setLastActivityDate(new Date),n.show();else{const r=su.some(o,(t=>t.isLocalUser));if((n=new sS(t,new Date,e)).isLocalUser&&r)return void console.warn("Local user already exists in user list. Not adding new local user.");n.isAnonymous&&Object.values(o).some((t=>t.isAnonymous))||(o[t]=n,i.append(n.get$node().show("clip",{},200)))}else console.error("jabberid not valid",t,"aborting")},this.getUser=function(t){return o.hasOwnProperty(t)?o[t]:null},this.removeUser=function(t){var e;o.hasOwnProperty(t)&&((e=o[t]).setLastActivityDate(new Date),e.hide())},this.addActivity=function(t){a.unshift(t),r.prepend(t.get$node().show("clip",{},200))},this.addActivityToLog=function(t,e){const i=y.getMap("activity");var r=i.get("log");if(r){var o=t.toJSON();e&&(o.data=e),r.unshift(o),i.set("log",r)}else i.set("log",n.toJSON())},this.getFirst=function(){return a.length>0?a[0]:null},this.toJSON=function(){var t=[];return su.forEach(a,(function(e){t.unshift(e.toJSON())})),t};if(this.findUntrackableActivities=function(t){for(var e=0;e<a.length;e++){var n=a[e];n.isTrackable&&(t.getEntityId()===n.getEntityId()||n instanceof ZA||n instanceof tS)&&n.untrackable()}},this.findTrackableActivities=function(t){for(var e=0;e<a.length;e++){var n=a[e];n.isTrackable()||t.getEntityId()!==n.getEntityId()||n instanceof ZA||n instanceof eS||n.trackable()}},this.init=function(){var t,e=y.getMap("activity").get("log");e&&su.forEachRight(e,(function(e){switch(e.type){case XA.TYPE:t=new XA(e.entityId,e.sender,e.text,e.timestamp,e.nodeType),n.addActivity(t);break;case ZA.TYPE:t=new ZA(e.entityId,e.sender,e.text,e.timestamp),n.addActivity(t);break;case tS.TYPE:t=new tS(e.entityId,e.sender,e.text,e.timestamp,e.nodeType,e.sourceNodeLabel,e.sourceNodeId,e.sourceNodeType,e.targetNodeLabel,e.targetNodeId,e.targetNodeType),n.addActivity(t);break;case eS.TYPE:t=new eS(e.entityId,e.sender,e.text,e.timestamp),n.addActivity(t);break;case KA.TYPE:t=new KA(e.entityId,e.sender,e.text,e.timestamp,e.nodeType),n.addActivity(t);break;case QA.TYPE:t=new QA(e.entityId,e.sender,e.text,e.timestamp,e.nodeType),n.addActivity(t);if(y.getMap("nodes").size>0)break;case rS.TYPE:t=new rS(e.entityId,e.sender,e.text,e.timestamp,e.value,e.subjectEntityName,e.rootSubjectEntityType,e.rootSubjectEntityId),n.addActivity(t);break;case nS.TYPE:t=new nS(e.entityId,e.sender,e.text,e.timestamp),n.addActivity(t);break;default:t=new HA(e.entityId,e.sender,e.text,e.timestamp),n.addActivity(t)}!function(t){const e=y.getMap("nodes"),n=y.getMap("edges");return!(!e.has(t)&&!n.has(t))}(t.getEntityId())?t.untrackable():t.trackable()}))},y){y.getMap("activity").observe((function(t){t.keysChanged.forEach((e=>{if("log"==e)return;const i=t.currentTarget.get(e);i&&function(t){var e,i,r,a;if(t instanceof N_){if(a=t.getData(),!t.getType())return void console.warn("Operation type not set",t);switch(t.getType()){case XA.TYPE:e=new XA(t.getEntityId(),t.getSender(),t.getText(),Date.now(),a.nodeType),n.addActivity(e),n.findTrackableActivities(e);break;case tS.TYPE:e=new tS(t.getEntityId(),t.getSender(),t.getText(),Date.now(),a.nodeType,a.sourceNodeLabel,a.sourceNodeId,a.sourceNodeType,a.targetNodeLabel,a.targetNodeId,a.targetNodeType),n.findTrackableActivities(e),n.addActivity(e),n.findTrackableActivities(e);break;case ZA.TYPE:e=new ZA(t.getEntityId(),t.getSender(),t.getText(),Date.now()),n.addActivity(e),n.findUntrackableActivities(e);break;case eS.TYPE:e=new eS(t.getEntityId(),t.getSender(),t.getText(),Date.now()),n.addActivity(e),n.findUntrackableActivities(e);break;case KA.TYPE:e=new KA(t.getEntityId(),t.getSender(),t.getText(),Date.now(),a.nodeType),n.addActivity(e),e.trackable();break;case QA.TYPE:e=new QA(t.getEntityId(),t.getSender(),t.getText(),Date.now(),a.nodeType),n.addActivity(e),e.trackable();break;case rS.TYPE:e=new rS(t.getEntityId(),t.getSender(),t.getText(),Date.now(),a.value,a.subjectEntityName,a.rootSubjectEntityType,a.rootSubjectEntityId),(r=n.getFirst())&&r instanceof rS&&r.getEntityId()===e.getEntityId()&&r.getSender()===e.getSender()?r.setText(e.getText()):n.addActivity(e),e.trackable();break;case nS.TYPE:e=new nS(t.getEntityId(),t.getSender(),t.getText(),Date.now()),n.addActivity(e);break;case iS.TYPE:n.addUser(t.getSender());break;case"UserLeftActivity":{const i=t.getSender()||"Anonymous";(e=new HA(null,i,".. left the space",Date.now())).setType("UserLeftActivity"),n.addActivity(e),n.removeUser(t.getSender());break}case"ApplyLayoutActivity":(e=new HA(null,t.getSender(),t.getText(),Date.now())).setType("ApplyLayoutActivity"),n.addActivity(e);break;case"ReloadWidgetOperation":(e=new aS(t.getEntityId(),t.getSender(),t.getText(),Date.now())).setType("ReloadWidgetOperation"),n.addActivity(e);break;case oS.TYPE:e=new oS(t.getEntityId(),t.getSender()),o.hasOwnProperty(e.getSender())&&o[e.getSender()].get$node().find(".lblViewId").text(e.getViewId());break;case"WidgetTrackingActivity":(e=new HA(t.getEntityId(),t.getSender(),t.getText(),Date.now())).setType(t.getType());break;default:(e=new HA(t.getEntityId(),t.getSender(),t.getText(),Date.now())).setType(t.getType()),n.addActivity(e)}(i=n.getUser(t.getSender()))&&(i.setLastActivityDate(new Date),y.getMap("users").get(y.clientID)===t.getSender()&&n.addActivityToLog(e,a))}}(new N_(i.type,i.entityId,i.sender,i.text,i.data))}))}));y.getMap("select").observe((function(t){t.keysChanged.forEach((e=>{const n=t.currentTarget.get(e);null===n?su.each(a,(function(t){t.show()})):(su.each(a,(function(t){t.show()})),su.each(su.filter(a,(function(t){return t instanceof rS?t.getRootSubjectEntityId()!==n:t.getEntityId()!==n})),(function(t){t.hide()})))}))}))}}}var uS=new function(){var t;return{init:function(e,n=$(frameElement.offsetParent).parent()){n.find(".widget-wrapper").each((function(){$(this).hover((function(e){t=$.now()}),(function(n){var i,r=$.now();if(i=$(n.target).is(".widget-wrapper")?$(n.target):$(n.target).parents(".widget-wrapper"),r-t>=1500){y.getMap("activity").set("ActivityOperation",{sender:e,type:"WidgetTrackingActivity",entityId:i.find(".widget-title-bar span").text(),text:"",data:{start:t,end:r}})}}))}))}}};let cS=class extends n{render(){return e`
      <style>
        @keyframes ldio-y0l1rz5jzvl {
          0% {
            opacity: 1;
          }
          100% {
            opacity: 0;
          }
        }
        #loading_overlay {
          position: absolute;
          top: 0;
          left: 0;
          height: 100%;
          width: 100%;
          background-color: rgba(255, 255, 255, 0.5448185483870968);
        }
        .ldio-y0l1rz5jzvl div {
          left: 50%;
          top: 50%;
          position: absolute;
          animation: ldio-y0l1rz5jzvl linear 1s infinite;
          background: #00549f;
          width: 14px;
          height: 14px;
          margin-left: -7px;
          margin-top: -7px;
          border-radius: 7px / 7px;
          transform-origin: 7px 47px;
        }
        .ldio-y0l1rz5jzvl div:nth-child(1) {
          transform: rotate(0deg);
          animation-delay: -0.9166666666666666s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(2) {
          transform: rotate(30deg);
          animation-delay: -0.8333333333333334s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(3) {
          transform: rotate(60deg);
          animation-delay: -0.75s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(4) {
          transform: rotate(90deg);
          animation-delay: -0.6666666666666666s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(5) {
          transform: rotate(120deg);
          animation-delay: -0.5833333333333334s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(6) {
          transform: rotate(150deg);
          animation-delay: -0.5s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(7) {
          transform: rotate(180deg);
          animation-delay: -0.4166666666666667s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(8) {
          transform: rotate(210deg);
          animation-delay: -0.3333333333333333s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(9) {
          transform: rotate(240deg);
          animation-delay: -0.25s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(10) {
          transform: rotate(270deg);
          animation-delay: -0.16666666666666666s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(11) {
          transform: rotate(300deg);
          animation-delay: -0.08333333333333333s;
          background: #00549f;
        }
        .ldio-y0l1rz5jzvl div:nth-child(12) {
          transform: rotate(330deg);
          animation-delay: 0s;
          background: #00549f;
        }
        .loadingio-spinner-spinner-bl6ykl6ungk {
          width: 100%;
          height: 100%;
          display: inline-block;
          overflow: hidden;
          background: rgba(255, 255, 255, 0.5448185483870968);
        }
        .ldio-y0l1rz5jzvl {
          width: 100%;
          height: 100%;
          position: relative;
          transform: translateZ(0) scale(1);
          backface-visibility: hidden;
          transform-origin: 0 0; /* see note above */
        }
        .ldio-y0l1rz5jzvl div {
          box-sizing: content-box;
        }
        /* generated by https://loading.io/ */
      </style>

      <div id="loading_overlay">
        <div class="loadingio-spinner-spinner-bl6ykl6ungk">
          <div class="ldio-y0l1rz5jzvl">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>
      </div>
    `}};cS=l([u("loading-spinner")],cS);let dS=class extends(hx(n,p_(f_.WIDGET.NAME.ACTIVITY))){firstUpdated(t){super.firstUpdated(t),fx().then((t=>{window.y=t,console.info("ACTIVITY: Yjs successfully initialized in room "+window.spaceTitle+" with y-user-id: "+t.clientID),xA(f_.WIDGET.NAME.ACTIVITY,t).then((function(e){var n=new lS($("#user_list"),$("#activity_list"));t.getMap("join").observe((function(t){t.keysChanged.forEach((e=>{"invisible_user"!=e&&n.addUser(e,t.currentTarget.get(e))}))})),console.info("ACTIVITY: Got message from CANVAS");var i=e.local.user;const r=t.getMap("users"),o=t.getMap("userList");r.set(t.clientID,i[f_.NS.PERSON.JABBERID]);const a=$(p_(f_.WIDGET.NAME.ACTIVITY));uS.init(i[f_.NS.PERSON.JABBERID],a),o.get(i[f_.NS.PERSON.JABBERID])||(i.globalId=Z_.getGlobalId(e.local,t),o.set(i[f_.NS.PERSON.JABBERID],i));for(var s=e.list,l=0;l<s.length;l++)n.addUser(s[l]);n.init(),$(p_(f_.WIDGET.NAME.ACTIVITY)).find("loading-spinner").hide()})).catch((function(t){console.error("ACTIVITY: Error while waiting for CANVAS: ",t)}))})).catch((function(t){console.error("ACTIVITY: Error while initializing Yjs: "+t),this.showErrorAlert("Cannot connect to Yjs server.")}))}render(){return e`
      <style>
        ${p_(f_.WIDGET.NAME.ACTIVITY)} {
          height: 100%;
          position: relative;
        }
        h2 {
          font-size: 0.8em;
          margin: 1px 1px 3px;
          color: #666666;
        }

        .list {
          width: 100%;
          height: auto;
          overflow: hidden;
        }
        .fs-sm {
          font-size: 50%;
        }
        .toast {
          display: block;
        }
        #user_list .item {
          background-color: rgb(138, 255, 200);
          display: block;
          border-radius: 3px;
          border: 2px solid #ccc;
          box-shadow: 2px 2px 2px #e3e3e3;
          position: relative;
          margin-top: 5px;
          margin-bottom: 5px;
        }

        #user_list .item h3 {
          white-space: nowrap;
          text-overflow: ellipsis;
          overflow: hidden;
        }

        #user_list .item span {
          font-size: 0.8em;
          text-align: end;
        }

        #activity_list {
          width: auto;
          box-sizing: border-box;
          padding-bottom: 150%;
          overflow-y: auto;
        }

        #activity_list .item {
          border: 1px solid #ccc;
          border-radius: 4px;
          padding: 0.4em;
          margin: 0 0.5em 0.5em 0;
          background: #f3f3f3 linear-gradient(to bottom, #ffffff, #e3e3e3);
          box-shadow: 2px 2px 2px #e3e3e3;
        }
        #activity_list .item h3 {
          background: #d3d3d3
            linear-gradient(
              to bottom,
              rgba(255, 255, 255, 0.7),
              rgba(200, 200, 200, 0)
            );
          border: 1px solid #ccc;
          border-radius: 2px;
          margin: 0;
          padding: 0.2em;
          text-align: center;
          font-size: 1.1em;
          font-weight: bold;
          overflow: hidden;
          white-space: nowrap;
          text-overflow: ellipsis;
        }
        #activity_list .item p {
          margin: 0.4em 0.2em;
        }

        .timestamp {
          border-radius: 8px;
          border-style: solid;
          border-width: 0.5px;
          text-align: center;
        }
        /* custom scrollbar */
        ::-webkit-scrollbar {
          width: 20px;
        }

        ::-webkit-scrollbar-track {
          background-color: transparent;
        }

        ::-webkit-scrollbar-thumb {
          background-color: #d6dee1;
          border-radius: 20px;
          border: 6px solid transparent;
          background-clip: content-box;
        }

        ::-webkit-scrollbar-thumb:hover {
          background-color: #a8bbbf;
        }
      </style>
      <link
        rel="stylesheet"
        type="text/css"
        href="https://code.jquery.com/ui/1.13.1/themes/smoothness/jquery-ui.css"
      />
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
        crossorigin="anonymous"
      />
      <div class="h-100" style="overflow-y:auto">
        <error-alert></error-alert>
        <h4>Users online</h4>
        <div class="list_wrapper">
          <div id="user_list" class="list"></div>
        </div>
        <h4>Activities</h4>
        <div class="list_wrapper">
          <div id="activity_list" class="list"></div>
        </div>
        <div id="q"></div>
        <loading-spinner></loading-spinner>
      </div>
    `}connectedCallback(){super.connectedCallback(),px()}disconnectedCallback(){super.disconnectedCallback()}};dS=l([u(p_(f_.WIDGET.NAME.ACTIVITY))],dS);let fS=class extends n{createRenderRoot(){return this}constructor(){super()}render(){return e`
      <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
        crossorigin="anonymous"
      />
      <style>
        :host {
          display: block;
        }

        .innercontainer {
          border-radius: 5px;
          flex: 1;
          height: 100%;
          resize: horizontal;
          -webkit-box-shadow: 0px 0px 30px 3px rgba(158, 158, 158, 0.89);
          box-shadow: 0px 0px 30px 3px rgba(158, 158, 158, 0.59);
        }
        .innercontainer:nth-of-type(1) {
          flex: 4;
          display: flex;
          flex-flow: column;
        }
        .innercontainer:nth-of-type(3) {
          display: flex;
          flex-flow: column;
        }
        .middle-container {
          flex: 2;
          display: flex;
          justify-content: space-between;
          flex-direction: column;
        }
      </style>
      <div class="container-fluid row w-100 px-0 mx-0" style="height:98vh">
        <div class="col-9 innercontainer">
          <div class="row h-100">
            <div class="col-9 px-1 border-end h-100">
              <canvas-widget></canvas-widget>
            </div>
            <div class="col-3  h-100">
              <palette-widget> </palette-widget>
            </div>
          </div>
        </div>
        <div class="col-3 innercontainer ">
          <property-browser-widget></property-browser-widget>
        </div>

        <div
          class="modal fade"
          id="exportModal"
          tabindex="-1"
          aria-labelledby="exampleModalLabel"
          aria-hidden="true"
          style="z-index: 2147483647 !important;"
        >
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button
                  type="button"
                  class="btn-close"
                  data-bs-dismiss="modal"
                  aria-label="Close"
                ></button>
              </div>
              <div class="modal-body">
                <debug-widget></debug-widget>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div
        class="offcanvas offcanvas-end"
        tabindex="-1"
        id="offcanvasRight"
        aria-labelledby="offcanvasRightLabel"
      >
        <div class="offcanvas-header">
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="offcanvas"
            aria-label="Close"
          ></button>
        </div>
        <div class="offcanvas-body">
          <user-activity-widget></user-activity-widget>
        </div>
      </div>
    `}connectedCallback(){super.connectedCallback(),setTimeout((()=>{var t,e;const n=document.querySelector("#main-widget-utilities-container");(null==n?void 0:n.firstElementChild)?(null===(t=n.firstElementChild)||void 0===t||t.appendChild((new DOMParser).parseFromString(' <button\n        class="btn btn-outline-primary me-1"\n        type="button"\n        data-bs-toggle="offcanvas"\n        data-bs-target="#offcanvasRight"\n        aria-controls="offcanvasRight",\n        title="User Activities"\n      >\n        <i class="bi bi-people-fill me-1"></i> Activities \n      </button>',"text/html").body.firstChild),null===(e=n.firstElementChild)||void 0===e||e.appendChild((new DOMParser).parseFromString('<button\n                type="button"\n                class="btn btn-outline-secondary "\n                data-bs-toggle="modal"\n                data-bs-target="#exportModal"\n                id="exportModel"\n                title="Export/Import Utilities"\n              >\n                <i class="bi bi-cloud-fill me-1"></i> Export/Import\n              </button>',"text/html").body.firstChild)):console.error(`Could not find the first col of row container. ${document.querySelector("#main-widget-utilities-container")} \n          This means that the debug widget button will not be added. \n          Make sure that the following selector is correct: #main-widget-utilities-container. The first child will be used to append the button.`)}),100)}};fS=l([u("widget-container")],fS);var pS=Object.freeze({__proto__:null,default:function(t){var e=y.getMap("data").get("model"),n=new graphlib.Graph;su.forEach(e.nodes,(function(t,e){n.setNode(e,t)})),su.forEach(e.edges,(function(t,e){t.id=e,n.setEdge(t.source,t.target,t)}));var i=t.getAttribute(t.getEntityId()+"[target]").getValue().getValue(),r=n.neighbors(i),o=t.getCanvas(),a=$("#lblCurrentView").text().replace("View:","");su.forEach(r,(function(e){var r,s=n.node(e);if("Node Shape"===s.type||"Edge Shape"===s.type||"Relation"===s.type)r=a+"_"+e,uT.findNode(r)||o.createNode(s.type,s.left,s.top,s.width,s.height,s.zIndex,s.containment,s,r);else if("ViewObject"===t.getType()&&"Relationship"===s.type){var l=uT.getNodesByType("ViewRelationship");for(var u in l){if(l.hasOwnProperty(u))(c=l[u]).getAttribute(c.getEntityId()+"[target]").getValue().getValue()===e&&(r=c.getEntityId())}}else if("ViewRelationship"===t.getType()&&"Object"===s.type){l=uT.getNodesByType("ViewObject");for(var u in l){var c;if(l.hasOwnProperty(u))(c=l[u]).getAttribute(c.getEntityId()+"[target]").getValue().getValue()===e&&(r=c.getEntityId())}}if(r){var d=n.edge(i,e);d?o.createEdge(d.type,t.getEntityId(),r,d,a+"_"+d.id,a):(d=n.edge(e,i),o.createEdge(d.type,r,t.getEntityId(),d,a+"_"+d.id,a))}}))}});export{fS as WidgetContainer};
//# sourceMappingURL=widget.container.min.js.map
